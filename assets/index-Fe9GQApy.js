import{a as Ji,b as er,r as g,u as ps,N as Nt,d as it,O as tr,e as gs,L as xs,f as ar,B as sr,h as ir,i as K}from"./react-vendor-DaGjvQ9R.js";import{t as rr,c as nr,a as At}from"./utils-BMrmdSYR.js";import{H as or,B as lr,D as ce,L as bs,a as De,T as ee,b as _t,U as da,C as kt,S as cr,c as U,d as It,e as fs,X as je,A as re,m as M,I as Lt,f as le,g as oe,h as Ne,i as ie,j as rt,k as ye,l as Ct,R as et,n as dr,o as mr,p as fe,Z as Le,q as z,M as X,r as ys,s as ur,t as vs,W as ma,u as nt,v as hr,w as ua,x as Et,y as Wt,Y as Ht,z as Vt,E as Ve,F as Pe,G as ha,J as de,K as Ae,N as Aa,O as pa,P as _e,Q as pr,V as ws,_ as gr,$ as xr,a0 as br,a1 as fr,a2 as js,a3 as ot,a4 as Ot,a5 as Bt,a6 as yr,a7 as Oe,a8 as ke,a9 as Ns,aa as _s,ab as ve,ac as tt,ad as pe,ae as Fe,af as vr,ag as wr,ah as ks,ai as Cs,aj as jr,ak as Nr,al as ga,am as _r,an as kr,ao as Ia,ap as Cr,aq as Sr,ar as Tr,as as xa,at as Mr,au as Jt,av as ea,aw as Rr,ax as Ss,ay as Pr,az as Dr,aA as Ar,aB as Ir,aC as Lr,aD as Er,aE as Wr,aF as Hr,aG as Vr,aH as Or,aI as Br}from"./ui-vendor-D_jYp3_c.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();var Ut={exports:{}},ze={};var La;function Fr(){if(La)return ze;La=1;var t=Ji(),a=Symbol.for("react.element"),s=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n={key:!0,ref:!0,__self:!0,__source:!0};function o(c,l,d){var u,m={},h=null,p=null;d!==void 0&&(h=""+d),l.key!==void 0&&(h=""+l.key),l.ref!==void 0&&(p=l.ref);for(u in l)i.call(l,u)&&!n.hasOwnProperty(u)&&(m[u]=l[u]);if(c&&c.defaultProps)for(u in l=c.defaultProps,l)m[u]===void 0&&(m[u]=l[u]);return{$$typeof:a,type:c,key:h,ref:p,props:m,_owner:r.current}}return ze.Fragment=s,ze.jsx=o,ze.jsxs=o,ze}var Ea;function $r(){return Ea||(Ea=1,Ut.exports=Fr()),Ut.exports}var e=$r(),pt={},Wa;function zr(){if(Wa)return pt;Wa=1;var t=er();return pt.createRoot=t.createRoot,pt.hydrateRoot=t.hydrateRoot,pt}var Gr=zr();function x(...t){return rr(nr(t))}const ne="focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-500 focus-visible:ring-offset-2",q={fast:"transition-all duration-150 ease-in-out",colors:"transition-colors duration-200",transform:"transition-transform duration-200"},Ts=[{to:"/",icon:or,label:"Home",exact:!0},{to:"/clients",icon:lr,label:"Clients"},{to:"/data",icon:ce,label:"Data",exact:!0},{to:"/integration",icon:bs,label:"Devices"},{to:"/insights",icon:De,label:"Insights"},{to:"/data-value",icon:ee,label:"Data Value"},{to:"/protocols",icon:_t,label:"Protocols"},{to:"/coach",icon:da,label:"Coach"},{to:"/api",icon:kt,label:"API"},{to:"/admin",icon:cr,label:"Settings"}],Ms=g.forwardRef(({className:t,...a},s)=>{const i=ps();return e.jsxs("aside",{ref:s,className:x("w-64 bg-white border-r border-slate-200 flex flex-col h-screen sticky top-0",t),...a,children:[e.jsx("div",{className:"h-24 flex items-center px-5 border-b border-slate-100",children:e.jsxs(Nt,{to:"/",className:"flex items-center gap-3",children:[e.jsx("img",{src:"/serif-demo/serif_shine.png",alt:"Serif",className:"w-[72px] h-[72px] object-contain"}),e.jsx("span",{className:"font-semibold text-xl text-slate-800 tracking-tight",children:"Serif"})]})}),e.jsx("nav",{className:"flex-1 py-4 px-3 overflow-y-auto",children:e.jsx("ul",{className:"space-y-0.5",children:Ts.map(r=>{const n=r.icon,o=r.exact?i.pathname===r.to:i.pathname.startsWith(r.to);return e.jsx("li",{children:e.jsxs(Nt,{to:r.to,className:x("flex items-center gap-3 px-4 py-2.5 text-sm font-medium rounded-lg","transition-all duration-200",o?"bg-primary-50 text-primary-600 border-l-2 border-l-serif-cyan":"text-slate-600 hover:bg-slate-50 hover:text-slate-900 border-l-2 border-l-transparent"),children:[e.jsx(n,{className:x("w-[18px] h-[18px]",o?"text-primary-500":"text-slate-400")}),r.label]})},r.to)})})}),e.jsx("div",{className:"px-5 py-4 border-t border-slate-100",children:e.jsx("p",{className:"text-[10px] text-slate-400 font-medium tracking-wide",children:"Personalized Health Intelligence"})})]})});Ms.displayName="Sidebar";const Ur=g.forwardRef(({className:t,isCollapsed:a=!1,onToggle:s,...i},r)=>{const n=ps();return e.jsxs("aside",{ref:r,className:x("bg-white border-r border-slate-200 flex flex-col h-screen sticky top-0","transition-all duration-200",a?"w-[72px]":"w-64",t),...i,children:[e.jsxs("div",{className:"h-24 flex items-center justify-between px-3 border-b border-slate-100",children:[e.jsxs(Nt,{to:"/",className:"flex items-center gap-2",children:[e.jsx("img",{src:"/serif-demo/serif_shine.png",alt:"Serif",className:"w-[72px] h-[72px] object-contain flex-shrink-0"}),!a&&e.jsx("span",{className:"font-semibold text-lg text-slate-800 tracking-tight",children:"Serif"})]}),e.jsx("button",{onClick:s,className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-50 rounded-lg transition-colors",children:a?e.jsx(U,{className:"w-4 h-4"}):e.jsx(It,{className:"w-4 h-4"})})]}),e.jsx("nav",{className:"flex-1 py-4 px-2 overflow-y-auto",children:e.jsx("ul",{className:"space-y-0.5",children:Ts.map(o=>{const c=o.icon,l=o.exact?n.pathname===o.to:n.pathname.startsWith(o.to);return e.jsx("li",{children:e.jsxs(Nt,{to:o.to,className:x("flex items-center gap-3 px-3 py-2.5 rounded-lg","transition-all duration-200",a&&"justify-center",l?"bg-primary-50 text-primary-600":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"),title:a?o.label:void 0,children:[e.jsx(c,{className:x("w-[18px] h-[18px] flex-shrink-0",l?"text-primary-500":"text-slate-400")}),!a&&e.jsx("span",{className:"text-sm font-medium",children:o.label})]})},o.to)})})})]})});Ur.displayName="CollapsibleSidebar";const lt=At((t,a)=>({isGuidedMode:!1,guidedMode:!1,currentStepIndex:0,isPaused:!1,showChaos:!1,chaosMode:!1,config:{certaintyThreshold:.75,minEffectSize:.1,minDataDays:14,populationPriorEnabled:!0},certaintyThreshold:75,connectedDevices:["oura","apple-watch"],labConnectionStatus:"disconnected",syncSchedule:{wearables:"hourly",bloodwork:"on-result",insightDelivery:"immediate",protocolTimes:["04:00","12:00"]},syncLog:[],isSyncing:!1,syncStatus:"idle",activeInsightId:null,activeMemberId:null,simulatorActions:{},toasts:[],setGuidedMode:s=>t({isGuidedMode:s,guidedMode:s,currentStepIndex:0}),nextStep:()=>t(s=>({currentStepIndex:s.currentStepIndex+1})),prevStep:()=>t(s=>({currentStepIndex:Math.max(0,s.currentStepIndex-1)})),goToStep:s=>t({currentStepIndex:s}),togglePause:()=>t(s=>({isPaused:!s.isPaused})),toggleChaos:()=>{const s=!a().showChaos;t({showChaos:s,chaosMode:s}),a().addToast({type:s?"warning":"info",title:s?"Chaos Mode Enabled":"Chaos Mode Disabled",message:s?"Simulating degraded conditions":"Normal operation restored"})},toggleChaosMode:()=>{a().toggleChaos()},setCertaintyThreshold:s=>t(i=>({certaintyThreshold:s,config:{...i.config,certaintyThreshold:s/100}})),updateConfig:s=>t(i=>({config:{...i.config,...s}})),toggleDevice:s=>t(i=>({connectedDevices:i.connectedDevices.includes(s)?i.connectedDevices.filter(r=>r!==s):[...i.connectedDevices,s]})),setLabConnection:s=>t({labConnectionStatus:s}),setSyncStatus:s=>t({syncStatus:s}),updateSyncSchedule:s=>t(i=>({syncSchedule:{...i.syncSchedule,...s}})),addSyncLog:s=>t(i=>({syncLog:[s,...i.syncLog].slice(0,20)})),triggerSync:async()=>{t({isSyncing:!0}),await new Promise(r=>setTimeout(r,1500));const s=a().showChaos,i={id:`sync_${Date.now()}`,timestamp:new Date().toISOString(),type:"full",duration:s?"4.2s":"1.5s",status:s?"partial":"success",rowsIngested:s?8421:14203,source:"Health Connect + Mito Labs"};t(r=>({isSyncing:!1,syncLog:[i,...r.syncLog].slice(0,20)})),a().addToast({type:s?"warning":"success",title:s?"Partial Sync Complete":"Sync Complete",message:`${i.rowsIngested.toLocaleString()} rows ingested in ${i.duration}`})},setActiveInsight:s=>t({activeInsightId:s}),setActiveMember:s=>t({activeMemberId:s}),toggleSimulatorAction:s=>t(i=>({simulatorActions:{...i.simulatorActions,[s]:!i.simulatorActions[s]}})),setSimulatorAction:(s,i)=>t(r=>({simulatorActions:{...r.simulatorActions,[s]:i}})),resetSimulator:()=>t({simulatorActions:{}}),addToast:s=>{const i=`toast_${Date.now()}`;t(n=>({toasts:[...n.toasts,{...s,id:i}]}));const r=s.duration??4e3;setTimeout(()=>{a().removeToast(i)},r)},removeToast:s=>t(i=>({toasts:i.toasts.filter(r=>r.id!==s)}))})),Yr={id:"default",name:"Loading...",avatar:"",age:0,archetype:"",narrative:"",daysOfData:0,devices:[],hasBloodwork:!1,labDraws:0,thresholds:{caffeineCutoff:"14:00",workoutEndTime:"19:00",bedroomTempCeiling:20,eatingWindowHours:10,minSleepHours:7,maxAlcoholUnits:2},currentMetrics:{sleepScore:0,deepSleepMin:0,remSleepMin:0,sleepLatencyMin:0,hrv:0,restingHr:0,fastingGlucose:0,weight:0,trainingLoad:"optimal"},tags:[]},Be=At((t,a)=>({activePersonaId:"rajan",personas:[],isLoading:!0,getActivePersona:()=>{const{activePersonaId:s,personas:i}=a();return i.find(r=>r.id===s)||i[0]||Yr},setActivePersona:s=>t({activePersonaId:s}),setPersonas:s=>t({personas:s,isLoading:!1})})),Rs={id:"rajan",name:"Rajan P.",avatar:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face",age:34,archetype:"The Pressure-Forged Pro",narrative:"High performer struggling with sleep due to late workouts; Zone 2 success story",daysOfData:45,devices:["oura","fitbit","mito-app","bloodwork","weather"],deviceConnections:[{deviceId:"oura",isActive:!0,firstConnected:"2024-10-15",lastRefreshed:"2025-01-11T04:30:00Z"},{deviceId:"fitbit",isActive:!1,firstConnected:"2024-08-20",lastRefreshed:"2024-11-05T12:00:00Z"},{deviceId:"mito-app",isActive:!0,firstConnected:"2024-10-15",lastRefreshed:"2025-01-11T04:30:00Z"},{deviceId:"bloodwork",isActive:!0,firstConnected:"2024-10-15",lastRefreshed:"2025-01-11T04:30:00Z"},{deviceId:"weather",isActive:!0,firstConnected:"2024-10-15",lastRefreshed:"2025-01-11T04:30:00Z"}],hasBloodwork:!0,labDraws:3,thresholds:{caffeineCutoff:"14:15",workoutEndTime:"19:00",bedroomTempCeiling:22,eatingWindowHours:10,minSleepHours:7,maxAlcoholUnits:2},currentMetrics:{sleepScore:65,deepSleepMin:40,remSleepMin:85,sleepLatencyMin:22,hrv:42,restingHr:61,fastingGlucose:104,weight:175,trainingLoad:"optimal"},loads:[{id:"sleep-debt",label:"Sleep Debt",kind:"load",value:72,trend:"rising",trendPositive:!1,status:"high",unit:"hrs",detail:"~6.2 hrs accumulated over 14 days — late bedtimes averaging 11:30 PM"},{id:"training-load",label:"Training Load",kind:"load",value:65,trend:"stable",status:"moderate",unit:"AU",detail:"Volume is optimal but timing (post-8 PM) is disrupting recovery"},{id:"work-stress",label:"Work Stress",kind:"load",value:78,trend:"rising",trendPositive:!1,status:"high",unit:"score",detail:"Self-reported 8/10; HRV suppression on weekdays vs weekends confirms physiological load"},{id:"acr-ratio",label:"ACR (Acute:Chronic)",kind:"load",value:45,trend:"stable",status:"moderate",unit:"ratio",detail:"Ratio 1.15 — within safe zone but approaching overreach threshold at 1.3"},{id:"caffeine-load",label:"Caffeine Load",kind:"load",value:60,trend:"stable",status:"moderate",unit:"mg",detail:"Avg 320 mg/day with last intake at 2:15 PM — borderline for sleep disruption at his threshold"},{id:"glycemic-stress",label:"Glycemic Stress",kind:"marker",value:58,trend:"rising",trendPositive:!1,status:"moderate",unit:"mg/dL",detail:"Fasting glucose crept 95 → 104 over 3 months; sleep debt is a contributing factor"},{id:"hrv-suppression",label:"HRV Suppression",kind:"marker",value:68,trend:"rising",trendPositive:!1,status:"moderate",unit:"ms",detail:"Weekday HRV 35 ms vs weekend 48 ms — chronic work stress driving autonomic imbalance"},{id:"cortisol-pattern",label:"Cortisol Rhythm",kind:"marker",value:72,trend:"rising",trendPositive:!1,status:"high",unit:"score",detail:"Flattened diurnal cortisol curve — morning peak blunted, evening cortisol elevated"},{id:"lipid-ratio",label:"ApoB:ApoA1",kind:"marker",value:55,trend:"stable",status:"moderate",unit:"ratio",detail:"Ratio 0.72 — borderline; sleep improvement may lower ApoB independently"},{id:"testosterone",label:"Testosterone",kind:"marker",value:52,trend:"falling",trendPositive:!1,status:"moderate",unit:"ng/dL",detail:"Total T 485 ng/dL — declining 8% over 6 months; sleep debt and cortisol likely contributors"},{id:"fasting-insulin",label:"Fasting Insulin",kind:"marker",value:62,trend:"rising",trendPositive:!1,status:"moderate",unit:"μIU/mL",detail:"Fasting insulin 9.2 μIU/mL — early insulin resistance signal, tracks with glucose creep"},{id:"vitamin-d",label:"Vitamin D",kind:"marker",value:45,trend:"falling",trendPositive:!1,status:"moderate",unit:"ng/mL",detail:"25(OH)D at 28 ng/mL — suboptimal; office-bound lifestyle limiting sun exposure"}],tags:["high-performer","sleep-issues","zone2-success"]},Ps=[{id:"rajan-insight-001",personaId:"rajan",category:"sleep",variableType:"outcome",title:"BEDTIME HOUR → SLEEP EFFICIENCY",headline:"Late bedtimes are hurting your sleep efficiency",recommendation:"Get to bed before 10:15 PM",explanation:"Each hour after your threshold costs 2.3% efficiency",causalParams:{source:"bedtime_hour",target:"sleep_efficiency_pct",curveType:"plateau_down",theta:{value:22.25,unit:"hour",low:21.92,high:22.58,displayValue:"10:15 PM"},betaBelow:{value:.1,unit:"%",description:"+0.1%/hr (stable)"},betaAbove:{value:-2.3,unit:"%",description:"-2.3%/hr (sharp drop)"},observations:243,completePct:99.2,changepointProb:.99,sizeCategory:"large",currentValue:23.5,currentStatus:"above_optimal"},cause:{behavior:"bedtime_hour",threshold:"22:15",unit:"time",direction:"before"},outcome:{metric:"sleep_efficiency",effect:"-2.3% per hour after threshold",direction:"negative"},certainty:.94,evidence:{personalDays:243,personalWeight:.89,populationWeight:.11,stability:.94},dataSources:["oura","apple-watch"],comparison:{before:{value:78,label:"After 11 PM"},after:{value:89,label:"Before 10:15 PM"}},whyNow:"Your average bedtime shifted from 10:30 PM to 11:30 PM over the past 2 weeks.",holdoutPreview:{metric:"sleep_efficiency",expectedChange:5,unit:"%",horizon:"7 days"},showWork:"On 156 nights when you went to bed before 10:15 PM, your sleep efficiency averaged 89%. On 87 nights after 11 PM, it dropped to 78%. This relationship held after controlling for alcohol, stress, and exercise. Your personal threshold (10:15 PM) is earlier than population average (11:00 PM).",actionable:!0,priority:1},{id:"rajan-insight-002",personaId:"rajan",category:"sleep",variableType:"outcome",title:"ZONE 2 MINUTES → DEEP SLEEP",headline:"Zone 2 training is boosting your deep sleep",recommendation:"Keep Zone 2 workouts under 52 minutes",explanation:"+3.8 seconds deep sleep per minute (up to threshold)",causalParams:{source:"zone2_minutes",target:"deep_seconds",curveType:"plateau_up",theta:{value:52,unit:"minutes",low:44.2,high:59.8,displayValue:"52 min"},betaBelow:{value:3.8,unit:"sec",description:"+3.8 sec/min (strong)"},betaAbove:{value:.2,unit:"sec",description:"+0.2 sec/min (diminishing)"},observations:156,completePct:94.9,changepointProb:.96,sizeCategory:"medium",currentValue:45,currentStatus:"below_optimal"},cause:{behavior:"zone2_minutes",threshold:52,unit:"minutes",direction:"below"},outcome:{metric:"deep_sleep_seconds",effect:"+3.8 sec per minute up to threshold",direction:"positive"},certainty:.87,evidence:{personalDays:156,personalWeight:.68,populationWeight:.32,stability:.89},dataSources:["garmin","oura"],comparison:{before:{value:42,label:"No Zone 2"},after:{value:58,label:"At threshold"}},whyNow:"Your Zone 2 average increased to 45 min—approaching your optimal threshold.",holdoutPreview:{metric:"deep_sleep",expectedChange:26,unit:"seconds",horizon:"7 days"},showWork:"On days with Zone 2 training, deep sleep increased by 3.8 seconds per minute trained, up to 52 minutes. Beyond that, returns diminish to +0.2 sec/min. Your optimal is 52 minutes—more provides minimal additional benefit while increasing recovery demands.",actionable:!0,priority:2},{id:"rajan-insight-003",personaId:"rajan",category:"sleep",variableType:"outcome",title:"ALCOHOL UNITS → REM SLEEP",headline:"Even moderate alcohol is destroying your REM",recommendation:"Limit alcohol to half a drink for REM preservation",explanation:"-3.2% REM per unit above your threshold",causalParams:{source:"alcohol_units",target:"rem_sleep_pct",curveType:"plateau_down",theta:{value:.5,unit:"units",low:.28,high:.72,displayValue:"0.5 drinks"},betaBelow:{value:-.8,unit:"%",description:"-0.8%/unit (mild)"},betaAbove:{value:-3.2,unit:"%",description:"-3.2%/unit (severe)"},observations:167,completePct:100,changepointProb:.88,sizeCategory:"large",currentValue:1.8,currentStatus:"above_optimal"},cause:{behavior:"alcohol_units",threshold:.5,unit:"drinks",direction:"below"},outcome:{metric:"rem_sleep_pct",effect:"-3.2% per drink above threshold",direction:"negative"},certainty:.85,evidence:{personalDays:167,personalWeight:.65,populationWeight:.35,stability:.9},dataSources:["oura"],comparison:{before:{value:18,label:"2+ drinks"},after:{value:24,label:"0-0.5 drinks"}},whyNow:"Your REM percentage dropped 4% this week—coinciding with evening drinks.",holdoutPreview:{metric:"rem_sleep_pct",expectedChange:4,unit:"%",horizon:"5 days"},showWork:"Your alcohol threshold is unusually low at 0.5 drinks—you are alcohol-sensitive. On 89 nights with no alcohol, REM averaged 24%. On 78 nights with 2+ drinks, it dropped to 18%. Even one drink costs you ~2.7% REM.",actionable:!0,priority:1},{id:"rajan-insight-004",personaId:"rajan",category:"recovery",variableType:"outcome",title:"ACUTE:CHRONIC RATIO → NEXT DAY HRV",headline:"Your training load ratio affects recovery",recommendation:"Maintain training load ratio at 1.05",explanation:"Deviation in either direction hurts HRV",causalParams:{source:"acute_chronic_ratio",target:"next_day_hrv",curveType:"v_max",theta:{value:1.05,unit:"ratio",low:.9,high:1.2,displayValue:"1.05"},betaBelow:{value:2.3,unit:"ms",description:"+2.3 ms/0.1 (undertraining)"},betaAbove:{value:-4.8,unit:"ms",description:"-4.8 ms/0.1 (overtraining)"},observations:134,completePct:96.3,changepointProb:.97,sizeCategory:"medium",currentValue:1.08,currentStatus:"at_optimal"},cause:{behavior:"acute_chronic_ratio",threshold:1.05,unit:"ratio",direction:"above"},outcome:{metric:"next_day_hrv",effect:"±4.8 ms per 0.1 deviation",direction:"negative"},certainty:.86,evidence:{personalDays:134,personalWeight:.73,populationWeight:.27,stability:.92},dataSources:["garmin","oura"],comparison:{before:{value:38,label:"ACR > 1.3"},after:{value:52,label:"ACR at 1.05"}},whyNow:"Your ACR is at 1.08—in the optimal zone. Keep it there.",showWork:"Your HRV peaks when ACR is between 0.9-1.2, with optimal at 1.05. Going above 1.2 (overtraining) costs 4.8 ms per 0.1 increase. Going below 0.9 (undertraining) costs 2.3 ms per 0.1 decrease. The penalty is asymmetric—overtraining hurts more.",actionable:!0,priority:3},{id:"rajan-insight-005",personaId:"rajan",category:"sleep",variableType:"outcome",title:"BEDROOM TEMP → DEEP SLEEP",headline:"Your bedroom temperature has an optimal sweet spot",recommendation:"Set bedroom temperature to 18.5°C (65°F)",explanation:"Both too cold and too warm reduce deep sleep",causalParams:{source:"bedroom_temp_c",target:"deep_sleep_pct",curveType:"v_max",theta:{value:18.5,unit:"°C",low:17.7,high:19.3,displayValue:"18.5°C (65°F)"},betaBelow:{value:.8,unit:"%",description:"+0.8%/°C (toward optimal)"},betaAbove:{value:-1.2,unit:"%",description:"-1.2%/°C (too warm)"},observations:142,completePct:97.9,changepointProb:.89,sizeCategory:"medium",currentValue:21.5,currentStatus:"above_optimal"},cause:{behavior:"bedroom_temp",threshold:18.5,unit:"celsius",direction:"below"},outcome:{metric:"deep_sleep_pct",effect:"-1.2% per °C above optimal",direction:"negative"},certainty:.75,evidence:{personalDays:142,personalWeight:.67,populationWeight:.33,stability:.82},dataSources:["oura","eight-sleep"],comparison:{before:{value:15,label:"At 22°C"},after:{value:19,label:"At 18.5°C"}},whyNow:"Winter heating raised your bedroom to 21.5°C—3°C above your optimal.",holdoutPreview:{metric:"deep_sleep_pct",expectedChange:3.6,unit:"%",horizon:"3 days"},showWork:"Your deep sleep percentage peaks at 18.5°C. Going warmer costs 1.2% per degree. Going colder costs 0.8% per degree. At your current 21.5°C, you're losing ~3.6% deep sleep versus optimal.",actionable:!0,priority:2},{id:"rajan-insight-006",personaId:"rajan",category:"sleep",variableType:"outcome",title:"LAST MEAL HOUR → DEEP SLEEP",headline:"Late dinners are cutting into your deep sleep",recommendation:"Finish eating before 7:30 PM",explanation:"-1.8% deep sleep per hour after threshold",causalParams:{source:"last_meal_hour",target:"deep_sleep_pct",curveType:"plateau_down",theta:{value:19.5,unit:"hour",low:18.7,high:20.3,displayValue:"7:30 PM"},betaBelow:{value:.2,unit:"%",description:"+0.2%/hr (stable)"},betaAbove:{value:-1.8,unit:"%",description:"-1.8%/hr (drops fast)"},observations:156,completePct:98.7,changepointProb:.92,sizeCategory:"medium",currentValue:20.5,currentStatus:"above_optimal"},cause:{behavior:"last_meal_hour",threshold:"19:30",unit:"time",direction:"before"},outcome:{metric:"deep_sleep_pct",effect:"-1.8% per hour after threshold",direction:"negative"},certainty:.82,evidence:{personalDays:156,personalWeight:.71,populationWeight:.29,stability:.85},dataSources:["oura"],comparison:{before:{value:16,label:"Dinner at 9 PM"},after:{value:19,label:"Dinner by 7:30 PM"}},whyNow:"Your average dinner time shifted to 8:30 PM this week.",holdoutPreview:{metric:"deep_sleep_pct",expectedChange:1.8,unit:"%",horizon:"5 days"},showWork:"Eating after 7:30 PM costs 1.8% deep sleep per hour. Your current 8:30 PM average is costing you ~1.8% deep sleep versus eating by 7:30 PM. The effect is consistent across different meal sizes.",actionable:!0,priority:2},{id:"rajan-insight-007",personaId:"rajan",category:"recovery",variableType:"outcome",title:"SLEEP CONSISTENCY → HRV VARIABILITY",headline:"Inconsistent sleep times are destabilizing your HRV",recommendation:"Maintain sleep consistency score at 85+",explanation:"-0.15 CV per point below threshold",causalParams:{source:"sleep_consistency_score",target:"weekly_hrv_cv",curveType:"v_min",theta:{value:85,unit:"score",low:78.8,high:91.2,displayValue:"85 score"},betaBelow:{value:-.15,unit:"CV",description:"-0.15 CV/pt (improves toward θ)"},betaAbove:{value:-.08,unit:"CV",description:"-0.08 CV/pt (diminishing)"},observations:198,completePct:98,changepointProb:.91,sizeCategory:"medium",currentValue:72,currentStatus:"below_optimal"},cause:{behavior:"sleep_consistency",threshold:85,unit:"score",direction:"above"},outcome:{metric:"hrv_cv",effect:"Lower CV = more stable HRV",direction:"positive"},certainty:.78,evidence:{personalDays:198,personalWeight:.81,populationWeight:.19,stability:.89},dataSources:["oura"],comparison:{before:{value:18,label:"Inconsistent (score 60)"},after:{value:9,label:"Consistent (score 85+)"}},whyNow:"Your sleep consistency dropped to 72 this week due to weekend variability.",showWork:"HRV variability (CV) decreases as sleep consistency improves—reaching optimal stability at score 85. Below 85, each point costs 0.15 CV. Your weekend sleep timing is 2+ hours different from weekdays, hurting your score.",actionable:!0,priority:3},{id:"rajan-insight-008",personaId:"rajan",category:"metabolic",variableType:"marker",title:"ZONE 2 MINUTES → FASTING GLUCOSE",headline:"Zone 2 cardio is lowering your fasting glucose",recommendation:"Maintain 150+ Zone 2 minutes per week",explanation:"-0.8 mg/dL per 10 minutes above threshold",causalParams:{source:"weekly_zone2_min",target:"fasting_glucose_mgdl",curveType:"plateau_down",theta:{value:150,unit:"min/week",low:125,high:175,displayValue:"150 min/week"},betaBelow:{value:.2,unit:"mg/dL",description:"+0.2 mg/dL per 10min less"},betaAbove:{value:-.8,unit:"mg/dL",description:"-0.8 mg/dL per 10min more"},observations:12,completePct:100,changepointProb:.94,sizeCategory:"large",currentValue:180,currentStatus:"above_optimal"},cause:{behavior:"weekly_zone2_minutes",threshold:150,unit:"minutes",direction:"above"},outcome:{metric:"fasting_glucose",effect:"-0.8 mg/dL per 10 minutes",direction:"positive"},certainty:.91,evidence:{personalDays:90,personalWeight:.45,populationWeight:.55,stability:.88},dataSources:["garmin","bloodwork"],comparison:{before:{value:108,label:"<100 min/week"},after:{value:98,label:"150+ min/week"}},whyNow:"Your Zone 2 has increased to 180 min/week—glucose trending down.",holdoutPreview:{metric:"fasting_glucose",expectedChange:-4,unit:"mg/dL",horizon:"4 weeks"},showWork:"Each 10 minutes of weekly Zone 2 above 150 min correlates with 0.8 mg/dL lower fasting glucose. Your increase from 120 to 180 min/week predicts a ~5 mg/dL improvement over 4-6 weeks. Population data strongly supports this relationship.",actionable:!0,priority:1},{id:"rajan-insight-009",personaId:"rajan",category:"metabolic",variableType:"marker",title:"EATING WINDOW → TRIGLYCERIDES",headline:"Shorter eating windows correlate with lower triglycerides",recommendation:"Keep eating window under 10 hours",explanation:"-8 mg/dL per hour reduction in window",causalParams:{source:"eating_window_hours",target:"triglycerides_mgdl",curveType:"linear",theta:{value:10,unit:"hours",low:8,high:12,displayValue:"10 hours"},betaBelow:{value:-8,unit:"mg/dL",description:"-8 mg/dL per hour shorter"},betaAbove:{value:12,unit:"mg/dL",description:"+12 mg/dL per hour longer"},observations:8,completePct:100,changepointProb:.87,sizeCategory:"medium",currentValue:11,currentStatus:"above_optimal"},cause:{behavior:"eating_window",threshold:10,unit:"hours",direction:"below"},outcome:{metric:"triglycerides",effect:"-8 mg/dL per hour",direction:"positive"},certainty:.88,evidence:{personalDays:60,personalWeight:.38,populationWeight:.62,stability:.82},dataSources:["mito-app","bloodwork"],comparison:{before:{value:142,label:"14-hour window"},after:{value:98,label:"10-hour window"}},whyNow:"Your eating window averaged 11 hours this month.",holdoutPreview:{metric:"triglycerides",expectedChange:-12,unit:"mg/dL",horizon:"6 weeks"},showWork:"Population research shows each hour reduction in eating window correlates with ~8 mg/dL lower triglycerides. Your personal data from 8 lab draws shows similar pattern. Reducing from 11 to 10 hours could lower your triglycerides by ~12 mg/dL.",actionable:!0,priority:2},{id:"rajan-insight-010",personaId:"rajan",category:"metabolic",variableType:"marker",title:"SLEEP DURATION → HBA1C",headline:"Sleep under 7 hours is raising your HbA1c",recommendation:"Get at least 7 hours of sleep",explanation:"+0.1% HbA1c per hour below threshold",causalParams:{source:"avg_sleep_hours",target:"hba1c_pct",curveType:"plateau_up",theta:{value:7,unit:"hours",low:6.5,high:7.5,displayValue:"7 hours"},betaBelow:{value:.1,unit:"%",description:"+0.1% per hour less sleep"},betaAbove:{value:-.02,unit:"%",description:"-0.02% per hour more (minimal)"},observations:12,completePct:100,changepointProb:.96,sizeCategory:"large",currentValue:6.2,currentStatus:"below_optimal"},cause:{behavior:"sleep_duration",threshold:7,unit:"hours",direction:"above"},outcome:{metric:"hba1c",effect:"+0.1% per hour below",direction:"negative"},certainty:.93,evidence:{personalDays:180,personalWeight:.52,populationWeight:.48,stability:.91},dataSources:["oura","bloodwork"],comparison:{before:{value:5.8,label:"6 hours avg"},after:{value:5.4,label:"7+ hours avg"}},whyNow:"Your sleep average dropped to 6.2 hours—your HbA1c rose 0.2% last quarter.",holdoutPreview:{metric:"hba1c",expectedChange:-.08,unit:"%",horizon:"12 weeks"},showWork:"Sleep deprivation impairs glucose regulation. Your data shows a clear threshold at 7 hours—below which HbA1c increases ~0.1% per hour of lost sleep. Getting back to 7 hours could reduce your HbA1c by 0.08% over 3 months.",actionable:!0,priority:1},{id:"rajan-insight-011",personaId:"rajan",category:"metabolic",variableType:"marker",title:"OMEGA-3 INTAKE → HSCRP",headline:"Fish oil supplementation is lowering your inflammation",recommendation:"Continue 2g EPA+DHA daily",explanation:"-0.3 mg/L per gram above threshold",causalParams:{source:"daily_omega3_g",target:"hscrp_mgl",curveType:"plateau_down",theta:{value:2,unit:"grams",low:1.5,high:2.5,displayValue:"2g EPA+DHA"},betaBelow:{value:.15,unit:"mg/L",description:"+0.15 mg/L per gram less"},betaAbove:{value:-.3,unit:"mg/L",description:"-0.3 mg/L per gram more"},observations:6,completePct:100,changepointProb:.89,sizeCategory:"medium",currentValue:2.5,currentStatus:"above_optimal"},cause:{behavior:"omega3_intake",threshold:2,unit:"grams",direction:"above"},outcome:{metric:"hscrp",effect:"-0.3 mg/L per gram",direction:"positive"},certainty:.86,evidence:{personalDays:120,personalWeight:.35,populationWeight:.65,stability:.79},dataSources:["mito-app","bloodwork"],comparison:{before:{value:2.1,label:"No supplementation"},after:{value:.9,label:"2g+ daily"}},whyNow:"Your hsCRP dropped from 2.1 to 0.9 since starting fish oil 4 months ago.",holdoutPreview:{metric:"hscrp",expectedChange:-.15,unit:"mg/L",horizon:"8 weeks"},showWork:"Omega-3 supplementation above 2g daily shows strong anti-inflammatory effects. Your hsCRP dropped 57% since starting supplementation. Population data confirms this effect size. Continuing at 2.5g maintains optimal levels.",actionable:!0,priority:2},{id:"rajan-insight-012",personaId:"rajan",category:"cardio",variableType:"marker",title:"RESTING HR TREND → LDL CHOLESTEROL",headline:"Lower resting HR correlates with improved LDL",recommendation:"Maintain cardio to keep RHR under 60",explanation:"-2 mg/dL LDL per 1 bpm reduction",causalParams:{source:"resting_hr_bpm",target:"ldl_mgdl",curveType:"linear",theta:{value:60,unit:"bpm",low:55,high:65,displayValue:"60 bpm"},betaBelow:{value:-2,unit:"mg/dL",description:"-2 mg/dL per bpm lower"},betaAbove:{value:3,unit:"mg/dL",description:"+3 mg/dL per bpm higher"},observations:12,completePct:100,changepointProb:.92,sizeCategory:"medium",currentValue:61,currentStatus:"above_optimal"},cause:{behavior:"resting_hr",threshold:60,unit:"bpm",direction:"below"},outcome:{metric:"ldl_cholesterol",effect:"-2 mg/dL per bpm",direction:"positive"},certainty:.84,evidence:{personalDays:270,personalWeight:.58,populationWeight:.42,stability:.86},dataSources:["oura","bloodwork"],comparison:{before:{value:128,label:"RHR 68 bpm"},after:{value:112,label:"RHR 60 bpm"}},whyNow:"Your RHR dropped from 68 to 61 over the past 6 months with increased cardio.",holdoutPreview:{metric:"ldl_cholesterol",expectedChange:-2,unit:"mg/dL",horizon:"8 weeks"},showWork:"Cardiovascular fitness (as measured by lower RHR) correlates with improved lipid profiles. Your 7 bpm RHR reduction correlated with a 16 mg/dL LDL improvement. Each additional bpm reduction predicts ~2 mg/dL further improvement.",actionable:!0,priority:2},{id:"rajan-insight-013",personaId:"rajan",category:"metabolic",variableType:"marker",title:"STRENGTH TRAINING → INSULIN SENSITIVITY (HOMA-IR)",headline:"Resistance training is improving your insulin sensitivity",recommendation:"Maintain 3+ strength sessions per week",explanation:"-0.15 HOMA-IR per weekly session",causalParams:{source:"weekly_strength_sessions",target:"homa_ir",curveType:"plateau_down",theta:{value:3,unit:"sessions",low:2,high:4,displayValue:"3 sessions/week"},betaBelow:{value:.2,unit:"HOMA-IR",description:"+0.2 per session less"},betaAbove:{value:-.15,unit:"HOMA-IR",description:"-0.15 per session more"},observations:8,completePct:100,changepointProb:.91,sizeCategory:"large",currentValue:3,currentStatus:"at_optimal"},cause:{behavior:"strength_training_frequency",threshold:3,unit:"sessions/week",direction:"above"},outcome:{metric:"homa_ir",effect:"-0.15 per session",direction:"positive"},certainty:.89,evidence:{personalDays:180,personalWeight:.42,populationWeight:.58,stability:.85},dataSources:["garmin","bloodwork"],comparison:{before:{value:2.4,label:"1 session/week"},after:{value:1.6,label:"3+ sessions/week"}},whyNow:"Your HOMA-IR improved from 2.4 to 1.6 since increasing to 3 sessions/week.",holdoutPreview:{metric:"homa_ir",expectedChange:0,unit:"",horizon:"maintain"},showWork:"Resistance training increases muscle glucose uptake and improves insulin sensitivity. Your HOMA-IR dropped 33% after increasing from 1 to 3 weekly sessions. Population research confirms threshold effect at 3 sessions.",actionable:!0,priority:1}];function Zr(){const t=[],a=new Date("2024-11-01");for(let s=0;s<45;s++){const i=new Date(a);i.setDate(i.getDate()+s);const r=i.toISOString().split("T")[0],n=s>=30&&s<40,o=s>=40,c=Math.sin(s*.5)*5,d=`${(n||o?19+Math.floor(Math.random()*2):17+Math.floor(Math.random()*2)).toString().padStart(2,"0")}:${Math.floor(Math.random()*60).toString().padStart(2,"0")}`,m=`${(n||o?14+Math.floor(Math.random()*3):12+Math.floor(Math.random()*2)).toString().padStart(2,"0")}:${Math.floor(Math.random()*60).toString().padStart(2,"0")}`,h=o?62:n?68:78,p=o?24:n?18:11,b=o?38:n?45:58,y=o?40:n?44:48,w=s<20?19.5+Math.random():21.5+Math.random()*2,v={date:r,sleepScore:Math.round(h+c+Math.random()*6),sleepDuration:Math.round(380+Math.random()*80-(n?40:0)),deepSleep:Math.round(b+Math.random()*10),remSleep:Math.round(75+Math.random()*25),lightSleep:Math.round(200+Math.random()*60),sleepLatency:Math.round(p+Math.random()*8),sleepEfficiency:.82+Math.random()*.1-(n?.05:0),bedtime:`${22+Math.floor(Math.random()*2)}:${Math.floor(Math.random()*60).toString().padStart(2,"0")}`,wakeTime:`${6+Math.floor(Math.random()*2)}:${Math.floor(Math.random()*60).toString().padStart(2,"0")}`,hrv:Math.round(y+Math.random()*8),restingHr:Math.round(56+Math.random()*8+(n?4:0)),respiratoryRate:13.5+Math.random()*1.5,bodyTemp:-.2+Math.random()*.4,steps:Math.round(7e3+Math.random()*5e3),activeCalories:Math.round(350+Math.random()*250),moderateMinutes:Math.round(20+Math.random()*30),vigorousMinutes:Math.round(15+Math.random()*25),zone2Minutes:Math.round(25+Math.random()*20),trainingLoad:Math.round(60+Math.random()*40),caffeineCutoff:m,alcoholUnits:Math.random()>.7?Math.floor(Math.random()*3):0,eatingWindowStart:"07:30",eatingWindowEnd:`${17+Math.floor(Math.random()*3)}:${Math.floor(Math.random()*60).toString().padStart(2,"0")}`,bedroomTemp:Math.round(w*10)/10,workoutTime:Math.random()>.15?d:null,workoutType:Math.random()>.15?["strength","cardio","hiit","zone2"][Math.floor(Math.random()*4)]:null,mood:Math.round(4+Math.random()*2-(n?1:0)),energy:Math.round(4+Math.random()*2-(n?1:0)),focus:Math.round(4+Math.random()*2-(n?1:0)),stress:Math.round(3+Math.random()*2+(n?2:0)),events:n&&Math.random()>.5?["late_work"]:void 0};t.push(v)}return t}const qr=Zr(),Kr=[{date:"2024-10-15",fastingGlucose:92,hba1c:5.2,totalCholesterol:195,ldl:118,hdl:52,triglycerides:156,hsCrp:1.8,vitaminD:42,testosterone:487},{date:"2024-11-20",fastingGlucose:95,hba1c:5.2,totalCholesterol:188,ldl:112,hdl:54,triglycerides:142,hsCrp:1.5,vitaminD:45,testosterone:545},{date:"2024-12-28",fastingGlucose:104,hba1c:5.3,totalCholesterol:182,ldl:108,hdl:55,triglycerides:131,hsCrp:1.4,vitaminD:48,testosterone:612}],Ds=[{id:"rajan-protocol-sleep",personaId:"rajan",name:"Sleep Efficiency Protocol",description:"Optimize sleep efficiency based on your personal thresholds",category:"sleep",status:"active",outcome:"sleep_efficiency",baseline:{value:.78,unit:"efficiency"},actions:[{id:"action-bedtime",label:"In bed by 10:15 PM",category:"sleep",isActive:!0,impact:.06,actionType:"cutoff",time:"10:15 PM",linkedInsightId:"rajan-insight-001"},{id:"action-caffeine",label:"No caffeine after 2:15 PM",category:"sleep",isActive:!0,impact:.04,actionType:"cutoff",time:"2:15 PM"},{id:"action-workout-time",label:"Finish workouts by 7:00 PM",category:"sleep",isActive:!1,impact:.05,actionType:"cutoff",time:"7:00 PM"},{id:"action-last-meal",label:"Last meal by 7:30 PM",category:"sleep",isActive:!0,impact:.03,actionType:"cutoff",time:"7:30 PM",linkedInsightId:"rajan-insight-006"},{id:"action-bedroom-temp",label:"Set bedroom to 18.5°C",category:"sleep",isActive:!1,impact:.04,actionType:"target",linkedInsightId:"rajan-insight-005"},{id:"action-alcohol",label:"Limit to 0.5 drinks",category:"sleep",isActive:!1,impact:.03,actionType:"target",linkedInsightId:"rajan-insight-003"},{id:"action-zone2-workout",label:"Zone 2 Cardio (45-52 min)",category:"activity",isActive:!0,impact:.05,actionType:"duration",startTime:"5:00 PM",endTime:"6:00 PM",linkedInsightId:"rajan-insight-002"},{id:"action-post-dinner-walk",label:"Post-Dinner Walk (15 min)",category:"activity",isActive:!0,impact:.03,actionType:"duration",startTime:"7:45 PM",endTime:"8:00 PM",linkedInsightId:"rajan-insight-006"}],states:[{id:"state-high-strain",label:"High strain day",isActive:!1},{id:"state-travel",label:"Travel day",isActive:!1},{id:"state-deadline",label:"Work deadline",isActive:!0}],triggers:[{if:["state-high-strain"],then:["action-caffeine","action-workout-time"],reason:"High strain increases sleep pressure, making timing even more critical"},{if:["state-deadline"],then:["action-caffeine","action-bedtime"],reason:"Deadlines often lead to late caffeine and delayed bedtime"}],simulator:{deltas:{"action-bedtime":.06,"action-caffeine":.04,"action-workout-time":.05,"action-last-meal":.03,"action-bedroom-temp":.04,"action-alcohol":.03}},evidenceLevel:89,difficulty:2},{id:"rajan-protocol-zone2",personaId:"rajan",name:"Deep Sleep Optimizer",description:"Maximize deep sleep through Zone 2 training",category:"sleep",status:"active",outcome:"deep_sleep_minutes",baseline:{value:42,unit:"minutes"},actions:[{id:"action-zone2-duration",label:"45-52 min Zone 2 cardio",category:"activity",isActive:!0,impact:12,actionType:"duration",linkedInsightId:"rajan-insight-002"},{id:"action-zone2-timing",label:"Zone 2 before 5:00 PM",category:"activity",isActive:!0,impact:4,actionType:"cutoff",time:"5:00 PM"}],states:[{id:"state-recovery-day",label:"Recovery day",isActive:!1}],triggers:[{if:["state-recovery-day"],then:[],reason:"Skip Zone 2 on recovery days"}],simulator:{deltas:{"action-zone2-duration":12,"action-zone2-timing":4}},evidenceLevel:87,difficulty:3},{id:"rajan-protocol-glucose",personaId:"rajan",name:"Glucose Optimization Protocol",description:"Lower fasting glucose through exercise and meal timing",category:"metabolic",status:"active",outcome:"fasting_glucose",baseline:{value:104,unit:"mg/dL"},actions:[{id:"action-weekly-zone2",label:"150+ min Zone 2 per week",category:"activity",isActive:!0,impact:-6,actionType:"duration",linkedInsightId:"rajan-insight-008"},{id:"action-eating-window",label:"10-hour eating window",category:"metabolic",isActive:!0,impact:-4,actionType:"duration",linkedInsightId:"rajan-insight-009"},{id:"action-sleep-7hrs",label:"Get 7+ hours sleep",category:"sleep",isActive:!1,impact:-3,actionType:"target",linkedInsightId:"rajan-insight-010"},{id:"action-strength-3x",label:"3x strength training per week",category:"activity",isActive:!0,impact:-5,actionType:"duration",linkedInsightId:"rajan-insight-013"}],states:[{id:"state-travel",label:"Travel week",isActive:!1}],triggers:[{if:["state-travel"],then:["action-eating-window"],reason:"Eating window is portable even when traveling"}],simulator:{deltas:{"action-weekly-zone2":-6,"action-eating-window":-4,"action-sleep-7hrs":-3,"action-strength-3x":-5}},evidenceLevel:91,difficulty:3},{id:"rajan-protocol-inflammation",personaId:"rajan",name:"Inflammation Control",description:"Reduce hsCRP through supplementation and cardio",category:"metabolic",status:"suggested",outcome:"hscrp",baseline:{value:1.4,unit:"mg/L"},actions:[{id:"action-omega3",label:"2g EPA+DHA daily",category:"metabolic",isActive:!0,impact:-.5,actionType:"target",linkedInsightId:"rajan-insight-011"},{id:"action-rhr-cardio",label:"Cardio to lower RHR to 60",category:"cardio",isActive:!1,impact:-.2,actionType:"target",linkedInsightId:"rajan-insight-012"}],states:[],triggers:[],simulator:{deltas:{"action-omega3":-.5,"action-rhr-cardio":-.2}},evidenceLevel:86,difficulty:2}],Xr={personaId:"rajan",date:new Date().toISOString().split("T")[0],greeting:"Good morning, Rajan. Your HRV was 42ms last night—below your baseline. Let's focus on recovery today.",priorities:{high:[{id:"plan-001",text:"Finish workouts before 7 PM",explanation:"Your late workouts are adding 10+ minutes to your sleep latency",evidenceWeight:"89% your data, 11% population",status:"pending"},{id:"plan-002",text:"No caffeine after 2:15 PM",explanation:"Late caffeine is suppressing your overnight HRV by 8ms",evidenceWeight:"84% your data, 16% population",status:"pending"}],moderate:[{id:"plan-003",text:"Set bedroom to 19°C tonight",explanation:"Cooler temps correlate with +14 min deep sleep for you",evidenceWeight:"76% your data, 24% population",status:"pending"},{id:"plan-004",text:"Get 30+ min Zone 2 cardio",explanation:"You're on track for 175 min/week—keep it up for lipid benefits",evidenceWeight:"55% your data, 45% population",status:"pending"}],maintain:[{id:"plan-005",text:"Keep eating window to 10 hours",explanation:"Your current window is working well for glucose control",evidenceWeight:"70% your data, 30% population",status:"pending"}]},eveningCheckIn:{completed:[],pending:[],prediction:{sleepScore:72,deepSleep:48,sleepLatency:14,confidence:.78}}},As={id:"sarah",name:"Sarah M.",avatar:"https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=150&h=150&fit=crop&crop=face",age:41,archetype:"The Metabolic Optimizer",narrative:"Pre-diabetic turned success story; reversed glucose trends through lifestyle changes",daysOfData:90,devices:["oura","fitbit","mito-app","bloodwork","weather"],deviceConnections:[{deviceId:"oura",isActive:!0,firstConnected:"2024-07-01",lastRefreshed:"2025-01-11T04:30:00Z"},{deviceId:"fitbit",isActive:!1,firstConnected:"2024-05-10",lastRefreshed:"2024-09-20T08:00:00Z"},{deviceId:"mito-app",isActive:!0,firstConnected:"2024-07-01",lastRefreshed:"2025-01-11T04:30:00Z"},{deviceId:"bloodwork",isActive:!0,firstConnected:"2024-07-01",lastRefreshed:"2025-01-11T04:30:00Z"},{deviceId:"weather",isActive:!0,firstConnected:"2024-07-01",lastRefreshed:"2025-01-11T04:30:00Z"}],hasBloodwork:!0,labDraws:4,thresholds:{caffeineCutoff:"16:30",workoutEndTime:"20:00",bedroomTempCeiling:19,eatingWindowHours:8,minSleepHours:7.5,maxAlcoholUnits:1},currentMetrics:{sleepScore:82,deepSleepMin:55,remSleepMin:95,sleepLatencyMin:9,hrv:52,restingHr:54,fastingGlucose:94,weight:145,trainingLoad:"optimal"},loads:[{id:"glycemic-variability",label:"Glucose Variability",kind:"load",value:32,trend:"falling",trendPositive:!0,status:"low",unit:"mg/dL",detail:"Daily glucose CV down from 24% to 14% over 90 days — eating window is working"},{id:"sleep-debt",label:"Sleep Debt",kind:"load",value:25,trend:"stable",status:"low",unit:"hrs",detail:"Minimal sleep debt (~1.5 hrs/14d) — consistent 7.5+ hr nights"},{id:"meal-timing-load",label:"Late Meal Load",kind:"load",value:55,trend:"rising",trendPositive:!1,status:"moderate",unit:"events",detail:"3 meals after 7 PM this week — each late meal adds +12 mg/dL to morning glucose"},{id:"stress-load",label:"Stress Load",kind:"load",value:40,trend:"stable",status:"moderate",unit:"score",detail:"Self-reported 5/10; manageable but spikes on weeks with irregular eating schedule"},{id:"alcohol-load",label:"Alcohol Load",kind:"load",value:30,trend:"falling",trendPositive:!0,status:"low",unit:"units",detail:"Down to 2 units/week from 6 — each unit adds +8 mg/dL to next-morning glucose"},{id:"exercise-consistency",label:"Exercise Consistency",kind:"load",value:22,trend:"falling",trendPositive:!0,status:"low",unit:"score",detail:"5x/week Zone 2 walks — highly consistent; key driver of glucose improvement"},{id:"fasting-glucose",label:"Fasting Glucose",kind:"marker",value:38,trend:"falling",trendPositive:!0,status:"low",unit:"mg/dL",detail:"Fasting glucose 94 mg/dL, down from 118 — now out of pre-diabetic range"},{id:"hba1c",label:"HbA1c",kind:"marker",value:35,trend:"falling",trendPositive:!0,status:"low",unit:"%",detail:"HbA1c 5.4%, down from 6.1% — reflecting 3 months of glucose improvement"},{id:"hscrp",label:"hsCRP",kind:"marker",value:42,trend:"stable",status:"moderate",unit:"mg/L",detail:"hsCRP 1.8 mg/L — borderline; metabolic inflammation still present"},{id:"triglycerides",label:"Triglycerides",kind:"marker",value:48,trend:"falling",trendPositive:!0,status:"moderate",unit:"mg/dL",detail:"Triglycerides 142 mg/dL — down from 198; eating window driving improvement"},{id:"fasting-insulin",label:"Fasting Insulin",kind:"marker",value:50,trend:"falling",trendPositive:!0,status:"moderate",unit:"μIU/mL",detail:"Fasting insulin 7.8 μIU/mL — improved from 14.2; HOMA-IR normalizing"},{id:"liver-alt",label:"ALT (Liver)",kind:"marker",value:35,trend:"falling",trendPositive:!0,status:"low",unit:"U/L",detail:"ALT 22 U/L — normalized from 38; hepatic fat likely decreasing with metabolic improvement"},{id:"vitamin-d",label:"Vitamin D",kind:"marker",value:28,trend:"rising",trendPositive:!0,status:"low",unit:"ng/mL",detail:"25(OH)D at 42 ng/mL — optimal range; supplementation + outdoor walks working"}],tags:["metabolic-success","cgm-user","consistency-champion"]},Is=[{id:"sarah-insight-001",personaId:"sarah",category:"metabolic",variableType:"marker",title:"EATING WINDOW → FASTING GLUCOSE",headline:"Your 8-hour eating window is transforming your glucose",recommendation:"Maintain 8-hour eating window (10 AM - 6 PM)",explanation:"Time-restricted eating reduced your fasting glucose by 24 mg/dL",cause:{behavior:"eating_window",threshold:8,unit:"hours",direction:"below"},populationThreshold:{value:12,label:"Typical Eating Window",variance:"4 hours shorter than typical"},outcome:{metric:"fasting_glucose",effect:"-24 mg/dL from baseline",direction:"positive"},certainty:.93,evidence:{personalDays:87,personalWeight:.93,populationWeight:.07,stability:.91},dataSources:["dexcom","apple-watch"],comparison:{before:{value:118,label:"Before TRE (Aug)"},after:{value:94,label:"Current (Dec)"}},whyNow:"You've maintained your eating window consistently for 90 days—your glucose is responding.",holdoutPreview:{metric:"fasting_glucose",expectedChange:-3,unit:"mg/dL",horizon:"30 days"},showWork:"Over 87 days of CGM data, your fasting glucose dropped from 118 mg/dL to 94 mg/dL. The improvement accelerated after 6 weeks of consistent 8-hour eating windows. Your glucose variability also decreased by 40%, indicating improved metabolic flexibility. This matches research showing TRE benefits compound over time."},{id:"sarah-insight-002",personaId:"sarah",category:"metabolic",variableType:"outcome",title:"POST-MEAL WALKS → GLUCOSE SPIKE",headline:"15-minute walks are cutting your glucose spikes in half",recommendation:"Walk for 15 min after meals",explanation:"Post-meal movement reduces glucose spike by 28 mg/dL",cause:{behavior:"post_meal_walk",threshold:15,unit:"minutes",direction:"above"},populationThreshold:{value:"20 mg/dL",label:"Population Avg Reduction",variance:"Your response is 40% stronger than average"},outcome:{metric:"glucose_spike",effect:"-28 mg/dL peak reduction",direction:"positive"},certainty:.88,evidence:{personalDays:65,personalWeight:.88,populationWeight:.12,stability:.85},dataSources:["dexcom","apple-watch"],comparison:{before:{value:156,label:"No walk post-meal"},after:{value:128,label:"With 15-min walk"}},whyNow:"CGM data shows clear pattern on walk vs. no-walk days.",holdoutPreview:{metric:"time_in_range",expectedChange:8,unit:"%",horizon:"14 days"},showWork:"Comparing 42 meals followed by walks vs. 38 meals without, your average glucose peak was 128 mg/dL vs. 156 mg/dL. The effect is most pronounced after carb-heavy meals. Your personal response is stronger than the population average (28 mg/dL vs. 20 mg/dL reduction)."},{id:"sarah-insight-003",personaId:"sarah",category:"sleep",variableType:"outcome",title:"CAFFEINE TIMING → SLEEP QUALITY",headline:"Your caffeine cutoff can be later than average",recommendation:"Caffeine is fine until 4:30 PM for you",explanation:"You metabolize caffeine faster—no sleep impact until after 4:30 PM",cause:{behavior:"caffeine_cutoff",threshold:"16:30",unit:"time",direction:"before"},populationThreshold:{value:"14:00",label:"Population Average",variance:"2.5 hours later than average"},outcome:{metric:"sleep_quality",effect:"No degradation until after 4:30 PM",direction:"positive"},certainty:.79,evidence:{personalDays:72,personalWeight:.79,populationWeight:.21,stability:.74},dataSources:["oura"],comparison:{before:{value:78,label:"Caffeine at 5 PM"},after:{value:82,label:"Caffeine before 4:30 PM"}},whyNow:"Your personalized threshold differs from the population average (2:00 PM).",showWork:"Analysis of your 72 days with caffeine tracking shows no significant sleep quality difference when caffeine is consumed before 4:30 PM. After 5 PM, your sleep score drops by 4 points on average. Your threshold is 2.5 hours later than the population average, suggesting faster caffeine metabolism."},{id:"sarah-insight-004",personaId:"sarah",category:"cardio",variableType:"outcome",title:"HRV TREND → RECOVERY STATUS",headline:"Your HRV consistency indicates excellent recovery",recommendation:"Maintain current recovery practices",explanation:"Your HRV variability is 40% lower than baseline, showing adaptation",cause:{behavior:"recovery_practices",threshold:0,unit:"composite",direction:"above"},populationThreshold:{value:"52 ms",label:"Avg for Your Age",variance:"Your HRV is in the top 20% for your demographic"},outcome:{metric:"hrv_stability",effect:"Day-to-day variance reduced 40%",direction:"positive"},certainty:.85,evidence:{personalDays:90,personalWeight:.85,populationWeight:.15,stability:.88},dataSources:["oura"],comparison:{before:{value:18,label:"HRV variance (Aug)"},after:{value:11,label:"HRV variance (Dec)"}},whyNow:"Three months of consistent data shows your recovery has stabilized.",showWork:"Your HRV standard deviation dropped from 18ms to 11ms over 90 days while your average HRV increased from 44ms to 52ms. Lower day-to-day variance combined with higher baseline indicates improved autonomic regulation and recovery capacity."},{id:"sarah-insight-005",personaId:"sarah",category:"metabolic",variableType:"outcome",title:"SLEEP DURATION → TIME IN RANGE",headline:"Sleep under 7 hours spikes your glucose the next day",recommendation:"Prioritize 7.5+ hours of sleep",explanation:"Short sleep reduces your time-in-range by 15%",cause:{behavior:"sleep_duration",threshold:7,unit:"hours",direction:"above"},populationThreshold:{value:6.5,label:"Population Average Need",variance:"You need 30 min more than average"},outcome:{metric:"time_in_range",effect:"-15% when sleep is under 7 hours",direction:"negative"},certainty:.86,evidence:{personalDays:82,personalWeight:.86,populationWeight:.14,stability:.82},dataSources:["oura","dexcom"],comparison:{before:{value:72,label:"<7 hrs sleep"},after:{value:87,label:"7.5+ hrs sleep"}},whyNow:"Cross-referencing your sleep and CGM data reveals this pattern.",holdoutPreview:{metric:"time_in_range",expectedChange:5,unit:"%",horizon:"7 days"},showWork:"On 24 nights with less than 7 hours of sleep, your next-day time-in-range averaged 72%. On 58 nights with 7.5+ hours, it averaged 87%. The effect is most pronounced in the morning hours, suggesting sleep impacts your dawn phenomenon response."},{id:"sarah-insight-006",personaId:"sarah",category:"metabolic",variableType:"marker",title:"TIME-RESTRICTED EATING → HBA1C",headline:"Your HbA1c dropped from pre-diabetic to optimal range",recommendation:"Continue 8-hour eating window for HbA1c maintenance",explanation:"HbA1c improved 0.6% in 4 months",causalParams:{source:"eating_window_hours",target:"hba1c_pct",curveType:"plateau_down",theta:{value:8,unit:"hours",low:7,high:9,displayValue:"8 hours"},betaBelow:{value:-.05,unit:"%",description:"-0.05% per hour shorter"},betaAbove:{value:.12,unit:"%",description:"+0.12% per hour longer"},observations:4,completePct:100,changepointProb:.95,sizeCategory:"large",currentValue:8,currentStatus:"at_optimal"},cause:{behavior:"eating_window",threshold:8,unit:"hours",direction:"below"},outcome:{metric:"hba1c",effect:"-0.6% over 4 months",direction:"positive"},certainty:.96,evidence:{personalDays:120,personalWeight:.82,populationWeight:.18,stability:.94},dataSources:["mito-app","bloodwork"],comparison:{before:{value:5.9,label:"Aug (pre-TRE)"},after:{value:5.3,label:"Dec (4 months TRE)"}},whyNow:"Your HbA1c dropped from 5.9% to 5.3%—out of pre-diabetic range.",holdoutPreview:{metric:"hba1c",expectedChange:-.1,unit:"%",horizon:"12 weeks"},showWork:"Four consecutive lab draws show steady HbA1c improvement: 5.9% → 5.7% → 5.5% → 5.3%. The 0.6% total reduction correlates perfectly with your consistent 8-hour eating window. Population research supports TRE for glycemic control, but your response is stronger than average.",actionable:!0,priority:1},{id:"sarah-insight-007",personaId:"sarah",category:"metabolic",variableType:"marker",title:"LIFESTYLE CHANGES → TRIGLYCERIDES",headline:"Your triglycerides dropped 33% without medication",recommendation:"Continue current lifestyle protocol",explanation:"Triglycerides improved from 168 to 112 mg/dL",causalParams:{source:"combined_lifestyle_score",target:"triglycerides_mgdl",curveType:"linear",theta:{value:80,unit:"score",low:70,high:90,displayValue:"80+ lifestyle score"},betaBelow:{value:8,unit:"mg/dL",description:"+8 mg/dL per point lower"},betaAbove:{value:-4,unit:"mg/dL",description:"-4 mg/dL per point higher"},observations:4,completePct:100,changepointProb:.93,sizeCategory:"large",currentValue:85,currentStatus:"above_optimal"},cause:{behavior:"lifestyle_composite",threshold:80,unit:"score",direction:"above"},outcome:{metric:"triglycerides",effect:"-56 mg/dL over 4 months",direction:"positive"},certainty:.94,evidence:{personalDays:120,personalWeight:.78,populationWeight:.22,stability:.91},dataSources:["bloodwork","mito-app","oura"],comparison:{before:{value:168,label:"Aug baseline"},after:{value:112,label:"Dec current"}},whyNow:"Your triglycerides are now in optimal range (<150 mg/dL).",holdoutPreview:{metric:"triglycerides",expectedChange:-8,unit:"mg/dL",horizon:"8 weeks"},showWork:"Your triglyceride improvement tracks with multiple lifestyle changes: time-restricted eating, regular post-meal walks, reduced alcohol, and improved sleep. The combined effect exceeds what any single intervention would achieve. Your trajectory suggests continued improvement.",actionable:!0,priority:1},{id:"sarah-insight-008",personaId:"sarah",category:"metabolic",variableType:"marker",title:"HDL IMPROVEMENT → CARDIOVASCULAR RISK",headline:"Your HDL increased 25% from lifestyle changes",recommendation:"Add 2 servings fatty fish per week for further HDL boost",explanation:"HDL improved from 48 to 60 mg/dL",causalParams:{source:"weekly_exercise_minutes",target:"hdl_mgdl",curveType:"plateau_up",theta:{value:150,unit:"min/week",low:120,high:180,displayValue:"150 min/week"},betaBelow:{value:.5,unit:"mg/dL",description:"+0.5 mg/dL per 10min more"},betaAbove:{value:.15,unit:"mg/dL",description:"+0.15 mg/dL per 10min (diminishing)"},observations:4,completePct:100,changepointProb:.88,sizeCategory:"medium",currentValue:180,currentStatus:"above_optimal"},cause:{behavior:"exercise_frequency",threshold:150,unit:"minutes/week",direction:"above"},outcome:{metric:"hdl_cholesterol",effect:"+12 mg/dL over 4 months",direction:"positive"},certainty:.91,evidence:{personalDays:120,personalWeight:.72,populationWeight:.28,stability:.87},dataSources:["bloodwork","oura","apple-watch"],comparison:{before:{value:48,label:"Aug (low)"},after:{value:60,label:"Dec (optimal)"}},whyNow:"Your HDL crossed the 60 mg/dL threshold—now cardioprotective.",holdoutPreview:{metric:"hdl_cholesterol",expectedChange:2,unit:"mg/dL",horizon:"8 weeks"},showWork:"HDL increase correlates with your consistent exercise routine (averaging 180 min/week). Your HDL:LDL ratio improved from 0.36 to 0.61. Combined with triglyceride reduction, your cardiovascular risk profile improved substantially.",actionable:!0,priority:2},{id:"sarah-insight-009",personaId:"sarah",category:"metabolic",variableType:"marker",title:"INFLAMMATION REDUCTION → HSCRP",headline:"Your inflammation marker dropped 63%",recommendation:"Maintain anti-inflammatory lifestyle practices",explanation:"hsCRP improved from 2.4 to 0.9 mg/L",causalParams:{source:"metabolic_health_score",target:"hscrp_mgl",curveType:"plateau_down",theta:{value:75,unit:"score",low:65,high:85,displayValue:"75+ score"},betaBelow:{value:.15,unit:"mg/L",description:"+0.15 mg/L per point lower"},betaAbove:{value:-.08,unit:"mg/L",description:"-0.08 mg/L per point higher"},observations:4,completePct:100,changepointProb:.92,sizeCategory:"large",currentValue:85,currentStatus:"above_optimal"},cause:{behavior:"metabolic_health",threshold:75,unit:"score",direction:"above"},outcome:{metric:"hscrp",effect:"-1.5 mg/L over 4 months",direction:"positive"},certainty:.93,evidence:{personalDays:120,personalWeight:.75,populationWeight:.25,stability:.89},dataSources:["bloodwork"],comparison:{before:{value:2.4,label:"Aug (elevated)"},after:{value:.9,label:"Dec (optimal)"}},whyNow:"Your hsCRP is now in optimal range (<1.0 mg/L), indicating low systemic inflammation.",holdoutPreview:{metric:"hscrp",expectedChange:-.1,unit:"mg/L",horizon:"8 weeks"},showWork:"hsCRP reduction parallels your metabolic improvements. Improved glucose control, weight management, and reduced visceral fat all contribute to lower inflammation. Your 63% reduction exceeds typical lifestyle intervention results.",actionable:!0,priority:1},{id:"sarah-insight-010",personaId:"sarah",category:"metabolic",variableType:"marker",title:"VITAMIN D OPTIMIZATION → MULTIPLE MARKERS",headline:"Vitamin D supplementation is supporting your metabolic health",recommendation:"Continue 4000 IU Vitamin D3 daily",explanation:"Vitamin D increased from 28 to 48 ng/mL",causalParams:{source:"daily_vitamin_d_iu",target:"vitamin_d_ngml",curveType:"plateau_up",theta:{value:4e3,unit:"IU",low:3e3,high:5e3,displayValue:"4000 IU daily"},betaBelow:{value:.8,unit:"ng/mL",description:"+0.8 ng/mL per 500 IU more"},betaAbove:{value:.2,unit:"ng/mL",description:"+0.2 ng/mL per 500 IU (diminishing)"},observations:4,completePct:100,changepointProb:.9,sizeCategory:"medium",currentValue:4e3,currentStatus:"at_optimal"},cause:{behavior:"vitamin_d_supplementation",threshold:4e3,unit:"IU",direction:"above"},outcome:{metric:"vitamin_d",effect:"+20 ng/mL over 4 months",direction:"positive"},certainty:.89,evidence:{personalDays:120,personalWeight:.55,populationWeight:.45,stability:.86},dataSources:["bloodwork","mito-app"],comparison:{before:{value:28,label:"Aug (insufficient)"},after:{value:48,label:"Dec (optimal)"}},whyNow:"Your Vitamin D reached optimal range (40-60 ng/mL).",holdoutPreview:{metric:"vitamin_d",expectedChange:2,unit:"ng/mL",horizon:"8 weeks"},showWork:"Vitamin D insufficiency is linked to insulin resistance. Your improvement from 28 to 48 ng/mL coincided with improved insulin sensitivity. Population research suggests Vitamin D supports glucose metabolism, which your data confirms.",actionable:!0,priority:2},{id:"sarah-insight-011",personaId:"sarah",category:"metabolic",variableType:"marker",title:"LDL REDUCTION → CARDIOVASCULAR RISK",headline:"Your LDL dropped 34 points from lifestyle alone",recommendation:"Add 10g soluble fiber daily for additional LDL reduction",explanation:"LDL improved from 132 to 98 mg/dL",causalParams:{source:"dietary_fiber_g",target:"ldl_mgdl",curveType:"plateau_down",theta:{value:25,unit:"grams",low:20,high:30,displayValue:"25g fiber/day"},betaBelow:{value:3,unit:"mg/dL",description:"+3 mg/dL per 5g less fiber"},betaAbove:{value:-2,unit:"mg/dL",description:"-2 mg/dL per 5g more fiber"},observations:4,completePct:100,changepointProb:.91,sizeCategory:"large",currentValue:28,currentStatus:"above_optimal"},cause:{behavior:"dietary_fiber",threshold:25,unit:"grams",direction:"above"},outcome:{metric:"ldl_cholesterol",effect:"-34 mg/dL over 4 months",direction:"positive"},certainty:.92,evidence:{personalDays:120,personalWeight:.68,populationWeight:.32,stability:.88},dataSources:["bloodwork","mito-app"],comparison:{before:{value:132,label:"Aug (elevated)"},after:{value:98,label:"Dec (optimal)"}},whyNow:"Your LDL dropped below 100 mg/dL—now in optimal range.",holdoutPreview:{metric:"ldl_cholesterol",expectedChange:-5,unit:"mg/dL",horizon:"8 weeks"},showWork:"Your LDL reduction correlates with increased fiber intake, time-restricted eating, and improved metabolic health. The 26% reduction without medication is exceptional. Adding soluble fiber (oats, beans) could push LDL even lower.",actionable:!0,priority:2}];function Qr(){const t=[],a=new Date("2024-09-15");for(let s=0;s<90;s++){const i=new Date(a);i.setDate(i.getDate()+s);const r=i.toISOString().split("T")[0],n=s/90,o=72+n*10,c=44+n*8,l={date:r,sleepScore:Math.round(o+Math.random()*8-4),sleepDuration:Math.round(420+Math.random()*60),deepSleep:Math.round(48+n*10+Math.random()*10),remSleep:Math.round(85+Math.random()*20),lightSleep:Math.round(220+Math.random()*40),sleepLatency:Math.round(12-n*4+Math.random()*5),sleepEfficiency:.85+n*.05+Math.random()*.05,bedtime:`22:${Math.floor(Math.random()*30).toString().padStart(2,"0")}`,wakeTime:`06:${Math.floor(15+Math.random()*30).toString().padStart(2,"0")}`,hrv:Math.round(c+Math.random()*10),restingHr:Math.round(58-n*4+Math.random()*4),respiratoryRate:13+Math.random()*1,bodyTemp:-.1+Math.random()*.3,steps:Math.round(8e3+Math.random()*4e3),activeCalories:Math.round(300+Math.random()*200),moderateMinutes:Math.round(30+Math.random()*20),vigorousMinutes:Math.round(10+Math.random()*15),zone2Minutes:Math.round(20+Math.random()*25),trainingLoad:Math.round(50+Math.random()*30),caffeineCutoff:`${14+Math.floor(Math.random()*3)}:${Math.floor(Math.random()*60).toString().padStart(2,"0")}`,alcoholUnits:Math.random()>.85?1:0,eatingWindowStart:"10:00",eatingWindowEnd:"18:00",bedroomTemp:18+Math.random()*1.5,workoutTime:Math.random()>.2?`${17+Math.floor(Math.random()*3)}:${Math.floor(Math.random()*60).toString().padStart(2,"0")}`:null,workoutType:Math.random()>.2?["strength","yoga","cardio","walking"][Math.floor(Math.random()*4)]:null,mood:Math.round(5+n+Math.random()),energy:Math.round(5+n+Math.random()),focus:Math.round(5+n*.5+Math.random()),stress:Math.round(4-n+Math.random())};t.push(l)}return t}const Jr=Qr(),en=[{date:"2024-08-01",fastingGlucose:118,hba1c:5.9,totalCholesterol:210,ldl:132,hdl:48,triglycerides:168,hsCrp:2.4,vitaminD:28},{date:"2024-09-15",fastingGlucose:112,hba1c:5.7,totalCholesterol:198,ldl:122,hdl:52,triglycerides:148,hsCrp:1.9,vitaminD:35},{date:"2024-11-01",fastingGlucose:102,hba1c:5.5,totalCholesterol:185,ldl:108,hdl:56,triglycerides:128,hsCrp:1.4,vitaminD:42},{date:"2024-12-15",fastingGlucose:94,hba1c:5.3,totalCholesterol:178,ldl:98,hdl:60,triglycerides:112,hsCrp:.9,vitaminD:48}],Ls=[{id:"sarah-protocol-glucose",personaId:"sarah",name:"Glucose Optimization Protocol",description:"Maximize time-in-range through meal timing and movement",category:"metabolic",status:"active",outcome:"time_in_range",baseline:{value:.72,unit:"%"},actions:[{id:"action-eating-start",label:"Start eating at 10:00 AM",category:"metabolic",isActive:!0,impact:.04,actionType:"cutoff",time:"10:00 AM",linkedInsightId:"sarah-insight-001"},{id:"action-eating-end",label:"Last meal by 6:00 PM",category:"metabolic",isActive:!0,impact:.04,actionType:"cutoff",time:"6:00 PM",linkedInsightId:"sarah-insight-001"},{id:"action-post-meal-walk",label:"15-min walk after meals",category:"metabolic",isActive:!0,impact:.06,actionType:"duration",linkedInsightId:"sarah-insight-002"},{id:"action-sleep-priority",label:"Get 7.5+ hours sleep",category:"sleep",isActive:!0,impact:.05,actionType:"target",linkedInsightId:"sarah-insight-005"},{id:"action-protein-first",label:"Eat protein before carbs",category:"nutrition",isActive:!1,impact:.03,actionType:"target"}],states:[{id:"state-stress",label:"High stress day",isActive:!1},{id:"state-period",label:"Menstrual cycle day 1-5",isActive:!1}],triggers:[{if:["state-stress"],then:["action-post-meal-walk","action-sleep-priority"],reason:"Stress hormones elevate glucose—prioritize movement and sleep"}],simulator:{deltas:{"action-eating-start":.04,"action-eating-end":.04,"action-post-meal-walk":.06,"action-sleep-priority":.05,"action-protein-first":.03}},evidenceLevel:93,difficulty:2},{id:"sarah-protocol-metabolic-reversal",personaId:"sarah",name:"Metabolic Health Protocol",description:"Continue reversing pre-diabetic markers through lifestyle",category:"metabolic",status:"active",outcome:"hba1c",baseline:{value:5.3,unit:"%"},actions:[{id:"action-tre-8hr",label:"8-hour eating window daily",category:"metabolic",isActive:!0,impact:-.15,actionType:"duration",linkedInsightId:"sarah-insight-006"},{id:"action-fiber-25g",label:"25g+ fiber daily",category:"nutrition",isActive:!0,impact:-.08,actionType:"target",linkedInsightId:"sarah-insight-011"},{id:"action-vitamin-d",label:"4000 IU Vitamin D3 daily",category:"metabolic",isActive:!0,impact:-.05,actionType:"target",linkedInsightId:"sarah-insight-010"},{id:"action-weekly-exercise",label:"150+ min exercise weekly",category:"activity",isActive:!0,impact:-.1,actionType:"duration",linkedInsightId:"sarah-insight-008"}],states:[{id:"state-vacation",label:"On vacation",isActive:!1}],triggers:[{if:["state-vacation"],then:["action-tre-8hr"],reason:"Maintain eating window even on vacation—it's the most impactful"}],simulator:{deltas:{"action-tre-8hr":-.15,"action-fiber-25g":-.08,"action-vitamin-d":-.05,"action-weekly-exercise":-.1}},evidenceLevel:94,difficulty:3},{id:"sarah-protocol-lipids",personaId:"sarah",name:"Lipid Optimization Protocol",description:"Maintain and improve lipid panel through diet and exercise",category:"cardio",status:"active",outcome:"ldl_cholesterol",baseline:{value:98,unit:"mg/dL"},actions:[{id:"action-soluble-fiber",label:"10g soluble fiber daily",category:"nutrition",isActive:!0,impact:-8,actionType:"target",linkedInsightId:"sarah-insight-011"},{id:"action-fatty-fish",label:"2 servings fatty fish weekly",category:"nutrition",isActive:!1,impact:-5,actionType:"target",linkedInsightId:"sarah-insight-008"},{id:"action-cardio-150",label:"150+ min cardio weekly",category:"activity",isActive:!0,impact:-6,actionType:"duration",linkedInsightId:"sarah-insight-008"}],states:[],triggers:[],simulator:{deltas:{"action-soluble-fiber":-8,"action-fatty-fish":-5,"action-cardio-150":-6}},evidenceLevel:91,difficulty:2},{id:"sarah-protocol-sleep",personaId:"sarah",name:"Sleep Quality Protocol",description:"Optimize sleep for metabolic health",category:"sleep",status:"suggested",outcome:"sleep_score",baseline:{value:82,unit:"score"},actions:[{id:"action-caffeine-cutoff",label:"No caffeine after 4:30 PM",category:"sleep",isActive:!0,impact:3,actionType:"cutoff",time:"4:30 PM",linkedInsightId:"sarah-insight-003"},{id:"action-bedtime",label:"In bed by 10:30 PM",category:"sleep",isActive:!0,impact:4,actionType:"cutoff",time:"10:30 PM"},{id:"action-bedroom-temp",label:"Set bedroom to 19°C",category:"sleep",isActive:!1,impact:2,actionType:"target"}],states:[],triggers:[],simulator:{deltas:{"action-caffeine-cutoff":3,"action-bedtime":4,"action-bedroom-temp":2}},evidenceLevel:85,difficulty:1}],tn={personaId:"sarah",date:new Date().toISOString().split("T")[0],greeting:"Good morning, Sarah! Your time-in-range was 89% yesterday—you're crushing it.",priorities:{high:[{id:"plan-001",text:"Start eating window at 10 AM",explanation:"Your 8-hour window is key to your glucose improvements",evidenceWeight:"93% your data, 7% population",status:"pending"}],moderate:[{id:"plan-002",text:"15-min walk after lunch",explanation:"Cuts your post-meal spike by 28 mg/dL on average",evidenceWeight:"88% your data, 12% population",status:"pending"},{id:"plan-003",text:"Close eating window by 6 PM",explanation:"Late eating increases your overnight glucose by 12 mg/dL",evidenceWeight:"82% your data, 18% population",status:"pending"}],maintain:[{id:"plan-004",text:"Get to bed by 10:30 PM",explanation:"Your glucose tomorrow depends on tonight's sleep",evidenceWeight:"86% your data, 14% population",status:"pending"}]},eveningCheckIn:{completed:[],pending:[],prediction:{sleepScore:84,deepSleep:56,sleepLatency:8,confidence:.82}}},Es={id:"marcus",name:"Marcus J.",avatar:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=150&h=150&fit=crop&crop=face",age:47,archetype:"The Recovery Specialist",narrative:"Former athlete managing inflammation through optimized recovery protocols",daysOfData:60,devices:["oura","fitbit","mito-app","bloodwork","weather"],deviceConnections:[{deviceId:"oura",isActive:!0,firstConnected:"2024-09-01",lastRefreshed:"2025-01-11T04:30:00Z"},{deviceId:"fitbit",isActive:!0,firstConnected:"2024-07-15",lastRefreshed:"2025-01-11T04:30:00Z"},{deviceId:"mito-app",isActive:!0,firstConnected:"2024-09-01",lastRefreshed:"2025-01-11T04:30:00Z"},{deviceId:"bloodwork",isActive:!0,firstConnected:"2024-09-15",lastRefreshed:"2025-01-11T04:30:00Z"},{deviceId:"weather",isActive:!0,firstConnected:"2024-09-01",lastRefreshed:"2025-01-11T04:30:00Z"}],hasBloodwork:!0,labDraws:2,thresholds:{caffeineCutoff:"12:00",workoutEndTime:"17:00",bedroomTempCeiling:18,eatingWindowHours:12,minSleepHours:8,maxAlcoholUnits:0},currentMetrics:{sleepScore:76,deepSleepMin:62,remSleepMin:78,sleepLatencyMin:8,hrv:58,restingHr:52,fastingGlucose:88,weight:195,trainingLoad:"high"},loads:[{id:"training-load",label:"Training Load",kind:"load",value:82,trend:"rising",trendPositive:!1,status:"high",unit:"TRIMP",detail:"Accumulated strain spiking — 3 consecutive high-intensity sessions without deload"},{id:"recovery-deficit",label:"Recovery Deficit",kind:"load",value:68,trend:"rising",trendPositive:!1,status:"moderate",unit:"hrs",detail:"HRV takes 48+ hours to normalize; only 36 hrs between sessions"},{id:"sleep-debt",label:"Sleep Debt",kind:"load",value:55,trend:"rising",trendPositive:!1,status:"moderate",unit:"hrs",detail:"~4 hrs accumulated over 14 days — caffeine after noon disrupting deep sleep"},{id:"joint-load",label:"Joint Stress",kind:"load",value:70,trend:"stable",status:"high",unit:"score",detail:"Knee and shoulder load elevated from increased lifting volume"},{id:"caffeine-load",label:"Caffeine Load",kind:"load",value:75,trend:"stable",status:"high",unit:"mg",detail:"Avg 400 mg/day with last intake at 1 PM — high sensitivity; even noon cutoff may not be enough"},{id:"alcohol-load",label:"Alcohol Load",kind:"load",value:15,trend:"stable",status:"low",unit:"units",detail:"Zero alcohol maintained for 60 days — key anti-inflammatory intervention"},{id:"hscrp",label:"hsCRP",kind:"marker",value:72,trend:"falling",trendPositive:!0,status:"high",unit:"mg/L",detail:"hsCRP 3.2 mg/L — down from 5.1 but still elevated; systemic inflammation persists"},{id:"cortisol-ratio",label:"Cortisol:DHEA",kind:"marker",value:65,trend:"rising",trendPositive:!1,status:"moderate",unit:"ratio",detail:"Ratio 0.38 — trending toward catabolic state; recovery days help reset"},{id:"omega3-index",label:"Omega-3 Index",kind:"marker",value:48,trend:"rising",trendPositive:!0,status:"moderate",unit:"%",detail:"Omega-3 index 5.8% — improved from 4.2% but target is >8% for anti-inflammatory effect"},{id:"testosterone",label:"Testosterone",kind:"marker",value:58,trend:"falling",trendPositive:!1,status:"moderate",unit:"ng/dL",detail:"Total T 520 ng/dL — age-expected but declining; overtraining may be suppressing"},{id:"ferritin",label:"Ferritin",kind:"marker",value:65,trend:"stable",status:"moderate",unit:"ng/mL",detail:"Ferritin 85 ng/mL — adequate but inflammation can falsely elevate; iron panel needed"},{id:"uric-acid",label:"Uric Acid",kind:"marker",value:70,trend:"rising",trendPositive:!1,status:"high",unit:"mg/dL",detail:"Uric acid 7.4 mg/dL — elevated; joint pain may be gout-related, not purely mechanical"},{id:"vitamin-d",label:"Vitamin D",kind:"marker",value:40,trend:"stable",status:"moderate",unit:"ng/mL",detail:"25(OH)D at 32 ng/mL — suboptimal for recovery and inflammation management"}],tags:["recovery-focused","inflammation-management","sleep-optimizer"]},Ws=[{id:"marcus-insight-001",personaId:"marcus",category:"recovery",variableType:"outcome",title:"TRAINING LOAD → HRV RECOVERY",headline:"Your HRV needs 48 hours to recover from high-strain days",recommendation:"Space high-intensity workouts 48+ hours apart",explanation:"Back-to-back intense sessions suppress your HRV for 72+ hours",cause:{behavior:"training_spacing",threshold:48,unit:"hours",direction:"above"},outcome:{metric:"hrv_recovery",effect:"Full HRV recovery in 48 hours vs 72+ when stacked",direction:"positive"},certainty:.91,evidence:{personalDays:58,personalWeight:.91,populationWeight:.09,stability:.87},dataSources:["whoop","oura"],comparison:{before:{value:44,label:"Back-to-back high strain"},after:{value:62,label:"48hr spacing"}},whyNow:"You had 3 high-strain days in a row last week—your HRV is still recovering.",holdoutPreview:{metric:"hrv",expectedChange:8,unit:"ms",horizon:"7 days"},showWork:"WHOOP data shows your strain score exceeded 15 on 18 days. When followed by another high-strain day within 24 hours (8 occurrences), your HRV dropped to 44ms and took 72+ hours to recover. With 48+ hour spacing (10 occurrences), HRV stayed at 62ms with full recovery. Your recovery rate is 15% slower than typical for your age."},{id:"marcus-insight-002",personaId:"marcus",category:"recovery",variableType:"marker",title:"ALCOHOL → INFLAMMATION (hsCRP)",headline:"Even moderate alcohol is elevating your inflammation markers",recommendation:"Consider eliminating alcohol entirely",explanation:"Any alcohol consumption raises your hsCRP by 40% for 48 hours",cause:{behavior:"alcohol_consumption",threshold:0,unit:"drinks",direction:"below"},outcome:{metric:"hsCrp",effect:"+40% inflammation for 48 hours after drinking",direction:"negative"},certainty:.87,evidence:{personalDays:60,personalWeight:.72,populationWeight:.28,stability:.8},dataSources:["oura","apple-watch"],comparison:{before:{value:2.8,label:"After alcohol"},after:{value:1.6,label:"No alcohol"}},whyNow:"Your hsCRP dropped 43% when you did a 30-day alcohol-free experiment.",showWork:"During your alcohol-free period, hsCRP dropped from 2.8 mg/L to 1.6 mg/L. When you reintroduced occasional drinks, we observed HRV dropping 15% and resting HR increasing 8% for 48 hours post-consumption. Your inflammatory response to alcohol is above average, possibly due to your history of joint issues."},{id:"marcus-insight-003",personaId:"marcus",category:"sleep",variableType:"outcome",title:"CAFFEINE TIMING → DEEP SLEEP",headline:"Your caffeine sensitivity requires a noon cutoff",recommendation:"No caffeine after 12:00 PM",explanation:"Caffeine after noon cuts your deep sleep by 25 minutes",cause:{behavior:"caffeine_cutoff",threshold:"12:00",unit:"time",direction:"before"},outcome:{metric:"deep_sleep",effect:"-25 min when caffeine after noon",direction:"negative"},certainty:.83,evidence:{personalDays:55,personalWeight:.83,populationWeight:.17,stability:.79},dataSources:["oura"],comparison:{before:{value:42,label:"Afternoon caffeine"},after:{value:67,label:"Morning only caffeine"}},whyNow:"Your deep sleep has been under 50 minutes on days with afternoon caffeine.",holdoutPreview:{metric:"deep_sleep",expectedChange:18,unit:"minutes",horizon:"5 days"},showWork:"Your caffeine threshold (noon) is 2-4 hours earlier than population average. On 32 days with no caffeine after noon, deep sleep averaged 67 minutes. On 23 days with afternoon caffeine, it dropped to 42 minutes. Genetic factors may contribute to your slower caffeine metabolism—consider CYP1A2 testing."},{id:"marcus-insight-004",personaId:"marcus",category:"cardio",variableType:"outcome",title:"COLD EXPOSURE → RECOVERY SCORE",headline:"Cold showers are boosting your recovery scores",recommendation:"Continue 2-min cold exposure post-workout",explanation:"Cold exposure improves your next-day recovery by 12%",cause:{behavior:"cold_exposure",threshold:2,unit:"minutes",direction:"above"},outcome:{metric:"recovery_score",effect:"+12% recovery score next day",direction:"positive"},certainty:.74,evidence:{personalDays:42,personalWeight:.74,populationWeight:.26,stability:.68},dataSources:["whoop"],comparison:{before:{value:58,label:"No cold exposure"},after:{value:70,label:"With cold exposure"}},whyNow:"You've been consistent with cold exposure for 6 weeks—the pattern is clear.",showWork:"On 28 days with documented cold exposure (2+ minutes), your next-day WHOOP recovery averaged 70%. On 14 days without, it averaged 58%. The effect is most pronounced after high-strain workouts, suggesting cold exposure helps manage exercise-induced inflammation."},{id:"marcus-insight-005",personaId:"marcus",category:"sleep",variableType:"outcome",title:"BEDROOM TEMP → SLEEP EFFICIENCY",headline:"You sleep best at 17°C—cooler than most",recommendation:"Set bedroom to 17°C (63°F)",explanation:"Each degree above 18°C costs you 3% sleep efficiency",cause:{behavior:"bedroom_temp",threshold:18,unit:"celsius",direction:"below"},outcome:{metric:"sleep_efficiency",effect:"-3% per degree above threshold",direction:"negative"},certainty:.81,evidence:{personalDays:52,personalWeight:.81,populationWeight:.19,stability:.77},dataSources:["oura","eight-sleep"],comparison:{before:{value:82,label:"At 21°C"},after:{value:91,label:"At 17°C"}},whyNow:"Winter heating is pushing your bedroom above optimal.",holdoutPreview:{metric:"sleep_efficiency",expectedChange:4,unit:"%",horizon:"3 days"},showWork:"Your optimal temperature threshold (17-18°C) is 2-3 degrees cooler than population average. This may be related to your higher muscle mass and metabolic rate. On nights at 17°C, your sleep efficiency averaged 91%. At 21°C, it dropped to 82%."}];function an(){const t=[],a=new Date("2024-10-15");for(let s=0;s<60;s++){const i=new Date(a);i.setDate(i.getDate()+s);const r=i.toISOString().split("T")[0],n=s%3===0,o=s%3===2,c=o?62:n?48:55,d={date:r,sleepScore:Math.round((o?82:n?70:76)+Math.random()*10-5),sleepDuration:Math.round(450+Math.random()*60),deepSleep:Math.round(55+Math.random()*20),remSleep:Math.round(70+Math.random()*20),lightSleep:Math.round(240+Math.random()*40),sleepLatency:Math.round(6+Math.random()*6),sleepEfficiency:.88+Math.random()*.06,bedtime:`21:${Math.floor(30+Math.random()*30).toString().padStart(2,"0")}`,wakeTime:`05:${Math.floor(30+Math.random()*30).toString().padStart(2,"0")}`,hrv:Math.round(c+Math.random()*12),restingHr:Math.round(50+Math.random()*6),respiratoryRate:12.5+Math.random()*1,bodyTemp:-.3+Math.random()*.4,steps:Math.round(6e3+Math.random()*4e3),activeCalories:Math.round(n?600+Math.random()*200:300+Math.random()*150),moderateMinutes:Math.round(25+Math.random()*25),vigorousMinutes:Math.round(n?40+Math.random()*20:10+Math.random()*15),zone2Minutes:Math.round(20+Math.random()*30),trainingLoad:Math.round(n?85+Math.random()*15:40+Math.random()*30),caffeineCutoff:`${10+Math.floor(Math.random()*3)}:${Math.floor(Math.random()*60).toString().padStart(2,"0")}`,alcoholUnits:0,eatingWindowStart:"07:00",eatingWindowEnd:"19:00",bedroomTemp:17+Math.random()*2,workoutTime:n?`${6+Math.floor(Math.random()*2)}:${Math.floor(Math.random()*60).toString().padStart(2,"0")}`:null,workoutType:n?["strength","hiit","crossfit"][Math.floor(Math.random()*3)]:o?"yoga":null,mood:Math.round(5+Math.random()*1.5),energy:Math.round(o?6+Math.random():5+Math.random()),focus:Math.round(5+Math.random()*1.5),stress:Math.round(3+Math.random()*1.5),events:n?["high_strain"]:void 0};t.push(d)}return t}const sn=an(),rn=[{date:"2024-10-01",fastingGlucose:92,hba1c:5.1,totalCholesterol:175,ldl:95,hdl:62,triglycerides:88,hsCrp:2.8,homocysteine:9.2,vitaminD:55,testosterone:580,cortisol:18},{date:"2024-12-01",fastingGlucose:88,hba1c:5,totalCholesterol:168,ldl:88,hdl:65,triglycerides:78,hsCrp:1.6,homocysteine:8.1,vitaminD:62,testosterone:615,cortisol:14}],Hs=[{id:"marcus-protocol-recovery",personaId:"marcus",name:"HRV Recovery Protocol",description:"Optimize training spacing and recovery for maximum HRV",category:"recovery",status:"active",outcome:"hrv",baseline:{value:48,unit:"ms"},actions:[{id:"action-training-spacing",label:"48+ hours between HIIT",category:"recovery",isActive:!0,impact:14,actionType:"duration",linkedInsightId:"marcus-insight-001"},{id:"action-cold-exposure",label:"2-min cold shower post-workout",category:"recovery",isActive:!0,impact:6,actionType:"duration",linkedInsightId:"marcus-insight-004"},{id:"action-no-alcohol",label:"Zero alcohol",category:"recovery",isActive:!0,impact:8,actionType:"target",linkedInsightId:"marcus-insight-002"},{id:"action-workout-end",label:"Workouts done by 5:00 PM",category:"recovery",isActive:!0,impact:4,actionType:"cutoff",time:"5:00 PM"}],states:[{id:"state-high-strain",label:"High strain yesterday",isActive:!0},{id:"state-competition",label:"Competition week",isActive:!1}],triggers:[{if:["state-high-strain"],then:["action-cold-exposure","action-training-spacing"],reason:"Post-high-strain recovery requires cold exposure and spacing"}],simulator:{deltas:{"action-training-spacing":14,"action-cold-exposure":6,"action-no-alcohol":8,"action-workout-end":4}},evidenceLevel:91,difficulty:3},{id:"marcus-protocol-deep-sleep",personaId:"marcus",name:"Deep Sleep Protocol",description:"Maximize deep sleep for recovery through caffeine timing and temperature",category:"sleep",status:"active",outcome:"deep_sleep",baseline:{value:42,unit:"minutes"},actions:[{id:"action-caffeine-noon",label:"No caffeine after 12:00 PM",category:"sleep",isActive:!0,impact:25,actionType:"cutoff",time:"12:00 PM",linkedInsightId:"marcus-insight-003"},{id:"action-bedroom-17c",label:"Set bedroom to 17°C",category:"sleep",isActive:!0,impact:9,actionType:"target",linkedInsightId:"marcus-insight-005"},{id:"action-sleep-8hrs",label:"In bed 8+ hours",category:"sleep",isActive:!0,impact:8,actionType:"target"},{id:"action-bedtime",label:"In bed by 9:30 PM",category:"sleep",isActive:!0,impact:5,actionType:"cutoff",time:"9:30 PM"}],states:[{id:"state-travel",label:"Travel day",isActive:!1}],triggers:[{if:["state-travel"],then:["action-caffeine-noon","action-sleep-8hrs"],reason:"Maintain caffeine cutoff even when traveling"}],simulator:{deltas:{"action-caffeine-noon":25,"action-bedroom-17c":9,"action-sleep-8hrs":8,"action-bedtime":5}},evidenceLevel:83,difficulty:2},{id:"marcus-protocol-inflammation",personaId:"marcus",name:"Inflammation Control Protocol",description:"Reduce hsCRP through lifestyle interventions",category:"recovery",status:"active",outcome:"hscrp",baseline:{value:2.8,unit:"mg/L"},actions:[{id:"action-zero-alcohol",label:"Alcohol-free",category:"recovery",isActive:!0,impact:-1.2,actionType:"target",linkedInsightId:"marcus-insight-002"},{id:"action-cold-therapy",label:"Daily cold exposure",category:"recovery",isActive:!0,impact:-.3,actionType:"duration",linkedInsightId:"marcus-insight-004"},{id:"action-recovery-days",label:"2 recovery days per week",category:"recovery",isActive:!0,impact:-.2,actionType:"duration",linkedInsightId:"marcus-insight-001"},{id:"action-sleep-quality",label:"Deep sleep 60+ min",category:"sleep",isActive:!1,impact:-.15,actionType:"target",linkedInsightId:"marcus-insight-003"}],states:[],triggers:[],simulator:{deltas:{"action-zero-alcohol":-1.2,"action-cold-therapy":-.3,"action-recovery-days":-.2,"action-sleep-quality":-.15}},evidenceLevel:87,difficulty:3}],nn={personaId:"marcus",date:new Date().toISOString().split("T")[0],greeting:"Good morning, Marcus. Yesterday was a high-strain day—today's focus is recovery.",priorities:{high:[{id:"plan-001",text:"No high-intensity workout today",explanation:"Your HRV needs 48 hours to fully recover from yesterday's strain",evidenceWeight:"91% your data, 9% population",status:"pending"},{id:"plan-002",text:"Last caffeine by noon",explanation:"Your deep sleep depends on an early caffeine cutoff",evidenceWeight:"83% your data, 17% population",status:"pending"}],moderate:[{id:"plan-003",text:"Light mobility or yoga",explanation:"Active recovery promotes blood flow without adding strain",evidenceWeight:"74% your data, 26% population",status:"pending"},{id:"plan-004",text:"Cold shower post-activity",explanation:"Cold exposure boosts your recovery score by 12%",evidenceWeight:"74% your data, 26% population",status:"pending"}],maintain:[{id:"plan-005",text:"Set bedroom to 17°C tonight",explanation:"You sleep best at cooler temps than most people",evidenceWeight:"81% your data, 19% population",status:"pending"}]},eveningCheckIn:{completed:[],pending:[],prediction:{sleepScore:80,deepSleep:65,sleepLatency:6,confidence:.81}}},Vs={id:"emma",name:"Emma L.",avatar:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face",age:28,archetype:"The New Explorer",narrative:"Recently started tracking; demonstrates Serif's value with limited data via population priors",daysOfData:12,devices:["oura","fitbit","mito-app","bloodwork","weather"],deviceConnections:[{deviceId:"oura",isActive:!1,firstConnected:void 0,lastRefreshed:void 0},{deviceId:"fitbit",isActive:!0,firstConnected:"2025-01-01",lastRefreshed:"2025-01-11T04:30:00Z"},{deviceId:"mito-app",isActive:!0,firstConnected:"2025-01-01",lastRefreshed:"2025-01-11T04:30:00Z"},{deviceId:"bloodwork",isActive:!1,firstConnected:void 0,lastRefreshed:void 0},{deviceId:"weather",isActive:!0,firstConnected:"2025-01-01",lastRefreshed:"2025-01-11T04:30:00Z"}],hasBloodwork:!1,labDraws:0,thresholds:{caffeineCutoff:"14:00",workoutEndTime:"20:00",bedroomTempCeiling:20,eatingWindowHours:12,minSleepHours:7,maxAlcoholUnits:2},currentMetrics:{sleepScore:71,deepSleepMin:45,remSleepMin:82,sleepLatencyMin:15,hrv:38,restingHr:68,fastingGlucose:0,weight:135,trainingLoad:"low"},loads:[{id:"sleep-irregularity",label:"Sleep Irregularity",kind:"load",value:74,trend:"stable",status:"high",unit:"score",detail:"Bedtime varies by 2.5+ hrs between weekdays and weekends — social jet lag pattern"},{id:"screen-load",label:"Screen Time Load",kind:"load",value:62,trend:"rising",trendPositive:!1,status:"moderate",unit:"hrs",detail:"Avg 3.2 hrs screen time after 9 PM — correlating with +18 min sleep latency"},{id:"caffeine-load",label:"Caffeine Load",kind:"load",value:48,trend:"stable",status:"moderate",unit:"mg",detail:"Avg 280 mg/day with last intake at 3 PM — population priors suggest cutting off by 2 PM"},{id:"hydration-load",label:"Hydration Deficit",kind:"load",value:58,trend:"rising",trendPositive:!1,status:"moderate",unit:"score",detail:"Avg 1.4L/day water intake — population target for her weight is 2.2L; RHR elevated on low days"},{id:"social-jetlag",label:"Social Jet Lag",kind:"load",value:82,trend:"stable",status:"high",unit:"hrs",detail:"Weekend wake time 2.5 hrs later than weekday — equivalent to flying 2 time zones every Monday"},{id:"stress-load",label:"Perceived Stress",kind:"load",value:52,trend:"rising",trendPositive:!1,status:"moderate",unit:"score",detail:"Self-reported 6/10; exam season approaching — HRV suppression starting to appear"},{id:"resting-hr",label:"Resting HR",kind:"marker",value:60,trend:"stable",status:"moderate",unit:"bpm",detail:"RHR 68 bpm — higher than expected for age; limited data but tracking"},{id:"hrv-baseline",label:"HRV Baseline",kind:"marker",value:55,trend:"stable",status:"moderate",unit:"ms",detail:"HRV 38 ms — below population median of 45 ms for age group; only 12 days of data"},{id:"sleep-efficiency",label:"Sleep Efficiency",kind:"marker",value:62,trend:"stable",status:"moderate",unit:"%",detail:"Sleep efficiency 79% — screen time and irregular schedule dragging it below 85% target"},{id:"deep-sleep-pct",label:"Deep Sleep %",kind:"marker",value:48,trend:"falling",trendPositive:!1,status:"moderate",unit:"%",detail:"Deep sleep 14% of total — population median for age is 20%; caffeine timing suspect"},{id:"body-temp-deviation",label:"Temp Deviation",kind:"marker",value:35,trend:"stable",status:"low",unit:"°C",detail:"Overnight skin temp deviation +0.1°C — within normal; no illness signal detected"}],tags:["new-user","limited-data","population-priors"]},Os=[{id:"emma-insight-001",personaId:"emma",category:"sleep",variableType:"outcome",title:"BEDTIME CONSISTENCY → SLEEP QUALITY",headline:"Irregular bedtimes may be affecting your sleep",recommendation:"Try a consistent 10:30 PM bedtime",explanation:"Your bedtime variance is 90+ minutes—consistency helps",cause:{behavior:"bedtime_consistency",threshold:30,unit:"minutes variance",direction:"below"},outcome:{metric:"sleep_score",effect:"+8 points with consistent bedtime",direction:"positive"},certainty:.62,evidence:{personalDays:12,personalWeight:.35,populationWeight:.65,stability:.48},dataSources:["apple-watch"],comparison:{before:{value:68,label:"Variable bedtime"},after:{value:76,label:"Consistent bedtime (projected)"}},whyNow:"We've noticed significant bedtime variation in your first 12 days.",holdoutPreview:{metric:"sleep_score",expectedChange:6,unit:"points",horizon:"14 days"},showWork:"Based on 12 days of data, your bedtime ranges from 10 PM to 12:30 AM. Population research strongly supports bedtime consistency for sleep quality. As we collect more of your data, this recommendation will become more personalized to your specific patterns."},{id:"emma-insight-002",personaId:"emma",category:"recovery",variableType:"outcome",title:"STEP COUNT → ENERGY LEVELS",headline:"More movement may boost your daily energy",recommendation:"Aim for 8,000+ steps daily",explanation:"Population data shows strong energy correlation at this threshold",cause:{behavior:"daily_steps",threshold:8e3,unit:"steps",direction:"above"},outcome:{metric:"energy_level",effect:"+1.2 points on high-step days",direction:"positive"},certainty:.58,evidence:{personalDays:12,personalWeight:.28,populationWeight:.72,stability:.42},dataSources:["apple-watch"],comparison:{before:{value:4.2,label:"Under 5k steps"},after:{value:5.4,label:"8k+ steps (projected)"}},whyNow:"Your average step count is 5,200—below the optimal threshold.",showWork:"Your data shows 4 days above 7,000 steps with slightly higher energy ratings. Population research strongly supports the 8,000 step threshold for energy and mood. We'll refine your personal threshold as more data comes in."},{id:"emma-insight-003",personaId:"emma",category:"sleep",variableType:"outcome",title:"CAFFEINE TIMING → SLEEP ONSET",headline:"Caffeine timing affects most people's sleep",recommendation:"Try cutting caffeine after 2 PM",explanation:"Population data suggests a 2 PM cutoff for optimal sleep",cause:{behavior:"caffeine_cutoff",threshold:"14:00",unit:"time",direction:"before"},outcome:{metric:"sleep_latency",effect:"-8 min average (population data)",direction:"positive"},certainty:.55,evidence:{personalDays:12,personalWeight:.18,populationWeight:.82,stability:.38},dataSources:["apple-watch"],comparison:{before:{value:18,label:"Late caffeine (population avg)"},after:{value:10,label:"Early cutoff (population avg)"}},whyNow:"This is a population-based recommendation while we learn your patterns.",showWork:"We don't have enough data yet to determine your personal caffeine threshold. Population research shows the average person should cut caffeine by 2 PM for optimal sleep. Your personal threshold may be earlier or later—we'll know more in 3-4 weeks."},{id:"emma-insight-004",personaId:"emma",category:"sleep",variableType:"outcome",title:"SCREEN TIME → SLEEP ONSET",headline:"Evening screen exposure delays sleep onset",recommendation:"Reduce screens 1 hour before bed",explanation:"Blue light suppresses melatonin—well established in research",causalParams:{source:"screen_time_before_bed_min",target:"sleep_latency_min",curveType:"linear",theta:{value:60,unit:"minutes",low:45,high:75,displayValue:"60 min before bed"},betaBelow:{value:-.15,unit:"min",description:"-0.15 min latency per min less screen"},betaAbove:{value:.2,unit:"min",description:"+0.2 min latency per min more screen"},observations:12,completePct:100,changepointProb:.88,sizeCategory:"medium",currentValue:45,currentStatus:"below_optimal"},cause:{behavior:"screen_time_before_bed",threshold:60,unit:"minutes",direction:"below"},outcome:{metric:"sleep_latency",effect:"-3 min per 15 min less screen time",direction:"positive"},certainty:.78,evidence:{personalDays:12,personalWeight:.25,populationWeight:.75,stability:.72},dataSources:["fitbit"],comparison:{before:{value:18,label:"With screens"},after:{value:11,label:"Screen-free hour"}},whyNow:"Your early data shows correlation with late screen use.",holdoutPreview:{metric:"sleep_latency",expectedChange:-5,unit:"min",horizon:"7 days"},showWork:"Blue light from screens suppresses melatonin production—this is one of the most robust findings in sleep research. Your 12 days of data shows 14-22 min sleep latency. Population research strongly supports a screen-free hour before bed for faster sleep onset.",actionable:!0,priority:1},{id:"emma-insight-005",personaId:"emma",category:"recovery",variableType:"outcome",title:"SLEEP DURATION → NEXT DAY HRV",headline:"Sleep duration strongly predicts your recovery",recommendation:"Aim for 7-8 hours of sleep",explanation:"Each hour below 7 reduces next-day HRV by ~5ms",causalParams:{source:"sleep_duration_hours",target:"next_day_hrv_ms",curveType:"plateau_up",theta:{value:7,unit:"hours",low:6.5,high:7.5,displayValue:"7 hours"},betaBelow:{value:5,unit:"ms",description:"+5 ms HRV per hour more sleep"},betaAbove:{value:1,unit:"ms",description:"+1 ms per hour (diminishing)"},observations:12,completePct:100,changepointProb:.92,sizeCategory:"large",currentValue:6.5,currentStatus:"below_optimal"},cause:{behavior:"sleep_duration",threshold:7,unit:"hours",direction:"above"},outcome:{metric:"hrv",effect:"+5 ms per hour toward 7 hours",direction:"positive"},certainty:.82,evidence:{personalDays:12,personalWeight:.3,populationWeight:.7,stability:.78},dataSources:["fitbit"],comparison:{before:{value:35,label:"6 hours sleep"},after:{value:42,label:"7+ hours sleep"}},whyNow:"Your average sleep is 6.5 hours—below optimal for recovery.",holdoutPreview:{metric:"hrv",expectedChange:4,unit:"ms",horizon:"7 days"},showWork:"Sleep duration is one of the strongest predictors of HRV and recovery. Your 12 nights average 6.5 hours with HRV around 37ms. Population research shows 7+ hours optimizes recovery. This relationship is consistent across age groups and fitness levels.",actionable:!0,priority:1},{id:"emma-insight-006",personaId:"emma",category:"activity",variableType:"outcome",title:"MORNING MOVEMENT → ENERGY LEVELS",headline:"Morning activity boosts all-day energy",recommendation:"Add 15-20 min morning walk or exercise",explanation:"Morning movement elevates cortisol and energy for hours",causalParams:{source:"morning_active_minutes",target:"daily_energy_score",curveType:"plateau_up",theta:{value:20,unit:"minutes",low:15,high:25,displayValue:"20 min"},betaBelow:{value:.15,unit:"pts",description:"+0.15 energy per min activity"},betaAbove:{value:.03,unit:"pts",description:"+0.03 per min (diminishing)"},observations:12,completePct:100,changepointProb:.85,sizeCategory:"medium",currentValue:8,currentStatus:"below_optimal"},cause:{behavior:"morning_activity",threshold:20,unit:"minutes",direction:"above"},outcome:{metric:"energy_score",effect:"+1.5 points with morning activity",direction:"positive"},certainty:.76,evidence:{personalDays:12,personalWeight:.28,populationWeight:.72,stability:.7},dataSources:["fitbit"],comparison:{before:{value:5.2,label:"No morning activity"},after:{value:6.7,label:"With morning activity"}},whyNow:"Your morning activity averages 8 minutes—adding more could boost energy.",holdoutPreview:{metric:"energy_score",expectedChange:1,unit:"pts",horizon:"7 days"},showWork:"Morning exercise elevates cortisol at the optimal time, supporting natural circadian rhythms. Population research shows 15-20 minutes of morning movement significantly improves perceived energy. Your 3 mornings with activity showed higher energy ratings.",actionable:!0,priority:2}];function on(){const t=[],a=new Date;a.setDate(a.getDate()-12);for(let s=0;s<12;s++){const i=new Date(a);i.setDate(i.getDate()+s);const r=i.toISOString().split("T")[0],n=22+Math.floor(Math.random()*3),o=i.getDay()===0||i.getDay()===6,c={date:r,sleepScore:Math.round(65+Math.random()*15),sleepDuration:Math.round(360+Math.random()*120),deepSleep:Math.round(40+Math.random()*20),remSleep:Math.round(70+Math.random()*25),lightSleep:Math.round(180+Math.random()*60),sleepLatency:Math.round(10+Math.random()*15),sleepEfficiency:.78+Math.random()*.12,bedtime:`${n}:${Math.floor(Math.random()*60).toString().padStart(2,"0")}`,wakeTime:`${7+Math.floor(Math.random()*2)}:${Math.floor(Math.random()*60).toString().padStart(2,"0")}`,hrv:Math.round(35+Math.random()*10),restingHr:Math.round(65+Math.random()*8),respiratoryRate:14+Math.random()*1.5,bodyTemp:Math.random()*.4-.2,steps:Math.round(4e3+Math.random()*6e3),activeCalories:Math.round(200+Math.random()*200),moderateMinutes:Math.round(15+Math.random()*25),vigorousMinutes:Math.round(5+Math.random()*15),zone2Minutes:Math.round(10+Math.random()*20),trainingLoad:Math.round(30+Math.random()*30),caffeineCutoff:`${12+Math.floor(Math.random()*6)}:${Math.floor(Math.random()*60).toString().padStart(2,"0")}`,alcoholUnits:o?Math.floor(Math.random()*3):0,eatingWindowStart:"08:00",eatingWindowEnd:"21:00",bedroomTemp:20+Math.random()*3,workoutTime:Math.random()>.5?`${17+Math.floor(Math.random()*4)}:${Math.floor(Math.random()*60).toString().padStart(2,"0")}`:null,workoutType:Math.random()>.5?["yoga","running","gym"][Math.floor(Math.random()*3)]:null,mood:Math.round(4+Math.random()*2),energy:Math.round(4+Math.random()*2),focus:Math.round(4+Math.random()*2),stress:Math.round(3+Math.random()*2)};t.push(c)}return t}const ln=on(),cn=[],Bs=[{id:"emma-protocol-sleep-foundation",personaId:"emma",name:"Sleep Foundation Protocol",description:"Build consistent sleep habits for better quality",category:"sleep",status:"suggested",outcome:"sleep_score",baseline:{value:71,unit:"score"},actions:[{id:"action-consistent-bedtime",label:"In bed by 10:30 PM",category:"sleep",isActive:!1,impact:6,actionType:"cutoff",time:"10:30 PM",linkedInsightId:"emma-insight-001"},{id:"action-caffeine-cutoff",label:"No caffeine after 2:00 PM",category:"sleep",isActive:!1,impact:3,actionType:"cutoff",time:"2:00 PM",linkedInsightId:"emma-insight-003"},{id:"action-screen-free",label:"Screen-free hour before bed",category:"sleep",isActive:!1,impact:5,actionType:"duration",linkedInsightId:"emma-insight-004"},{id:"action-sleep-7hrs",label:"7+ hours in bed",category:"sleep",isActive:!1,impact:7,actionType:"target",linkedInsightId:"emma-insight-005"}],states:[{id:"state-weekend",label:"Weekend",isActive:!1}],triggers:[{if:["state-weekend"],then:["action-consistent-bedtime"],reason:"Maintain consistent bedtime even on weekends"}],simulator:{deltas:{"action-consistent-bedtime":6,"action-caffeine-cutoff":3,"action-screen-free":5,"action-sleep-7hrs":7}},evidenceLevel:75,difficulty:2},{id:"emma-protocol-energy",personaId:"emma",name:"Daily Energy Protocol",description:"Boost energy through movement and recovery",category:"activity",status:"suggested",outcome:"energy_score",baseline:{value:5.2,unit:"score"},actions:[{id:"action-morning-movement",label:"20 min morning activity",category:"activity",isActive:!1,impact:1.5,actionType:"duration",linkedInsightId:"emma-insight-006"},{id:"action-8k-steps",label:"8,000+ steps daily",category:"activity",isActive:!1,impact:1.2,actionType:"target",linkedInsightId:"emma-insight-002"},{id:"action-sleep-quality",label:"7+ hours quality sleep",category:"sleep",isActive:!1,impact:.8,actionType:"target",linkedInsightId:"emma-insight-005"}],states:[],triggers:[],simulator:{deltas:{"action-morning-movement":1.5,"action-8k-steps":1.2,"action-sleep-quality":.8}},evidenceLevel:72,difficulty:2},{id:"emma-protocol-recovery",personaId:"emma",name:"HRV Improvement Protocol",description:"Improve heart rate variability through sleep optimization",category:"recovery",status:"suggested",outcome:"hrv",baseline:{value:38,unit:"ms"},actions:[{id:"action-sleep-duration",label:"7-8 hours sleep nightly",category:"sleep",isActive:!1,impact:5,actionType:"target",linkedInsightId:"emma-insight-005"},{id:"action-bedtime-consistency",label:"Consistent bedtime (within 30 min)",category:"sleep",isActive:!1,impact:4,actionType:"duration",linkedInsightId:"emma-insight-001"},{id:"action-morning-walk",label:"15-20 min morning walk",category:"activity",isActive:!1,impact:3,actionType:"duration",linkedInsightId:"emma-insight-006"}],states:[],triggers:[],simulator:{deltas:{"action-sleep-duration":5,"action-bedtime-consistency":4,"action-morning-walk":3}},evidenceLevel:78,difficulty:2}],dn={personaId:"emma",date:new Date().toISOString().split("T")[0],greeting:"Good morning, Emma! We're still learning your patterns—here are some science-backed suggestions.",priorities:{high:[{id:"plan-001",text:"Try going to bed at 10:30 PM tonight",explanation:"Bedtime consistency is one of the highest-impact sleep factors",evidenceWeight:"35% your data, 65% population research",status:"pending"}],moderate:[{id:"plan-002",text:"Aim for 8,000+ steps today",explanation:"Movement helps with energy and sleep quality",evidenceWeight:"28% your data, 72% population research",status:"pending"},{id:"plan-003",text:"Cut caffeine after 2 PM",explanation:"This is the population average—we'll find your threshold soon",evidenceWeight:"18% your data, 82% population research",status:"pending"}],maintain:[{id:"plan-004",text:"Keep wearing your Apple Watch to bed",explanation:"More data = more personalized insights in 2-3 weeks",evidenceWeight:"Data collection",status:"pending"}]},eveningCheckIn:{completed:[],pending:[],prediction:{sleepScore:73,deepSleep:48,sleepLatency:12,confidence:.55}}},J={id:"oron",name:"Oron A.",avatar:"/serif-demo/OrenA.jpeg",persona:"Triathlete optimizing iron status & endurance performance",age:43,archetype:"The Iron-Depleted Endurance Athlete",narrative:"Elite-level triathlete with exceptional VO2peak (52 ml/min/kg) but critically low iron status threatening performance. 9+ years of GPS workout data reveal training patterns driving iron depletion.",daysOfData:4012,devices:["bloodwork","gpx","medix-cpet","apple-watch","autosleep"],deviceConnections:[{deviceId:"bloodwork",isActive:!0,firstConnected:"2023-03-10",lastRefreshed:"2025-11-22T00:00:00Z"},{deviceId:"gpx",isActive:!0,firstConnected:"2016-10-09",lastRefreshed:"2026-01-31T00:00:00Z"},{deviceId:"medix-cpet",isActive:!0,firstConnected:"2025-12-03",lastRefreshed:"2025-12-10T00:00:00Z"},{deviceId:"apple-watch",isActive:!0,firstConnected:"2019-06-25",lastRefreshed:"2026-02-07T00:00:00Z"},{deviceId:"autosleep",isActive:!1,firstConnected:"2019-12-11",lastRefreshed:"2023-05-24T00:00:00Z"}],hasBloodwork:!0,labDraws:6,thresholds:{caffeineCutoff:"14:00",workoutEndTime:"19:00",bedroomTempCeiling:22,eatingWindowHours:10,minSleepHours:7,maxAlcoholUnits:1},currentMetrics:{sleepScore:0,deepSleepMin:54,remSleepMin:91,sleepLatencyMin:0,hrv:32,restingHr:52,fastingGlucose:96,weight:72.8,trainingLoad:"low"},loads:[{id:"training-load",label:"Training Load",kind:"load",value:35,trend:"falling",trendPositive:!1,status:"moderate",unit:"TRIMP",detail:"CTL 11.2, ACWR 0.69 — below habitual (30d Apple Health + GPX)"},{id:"travel-load",label:"Travel Load",kind:"load",value:0,trend:"stable",status:"low",unit:"jet lag score",detail:"No recent travel — jet lag score 0 (30d derived)"},{id:"sleep-debt",label:"Sleep Debt",kind:"load",value:20,trend:"stable",status:"low",unit:"hrs",detail:"Avg 7.3 hrs/night vs 7.5 target — minimal accumulated deficit"},{id:"iron-depletion",label:"Iron Depletion Risk",kind:"marker",value:85,trend:"stable",status:"critical",unit:"%",detail:"Iron 37 mcg/dL (ref 50-180), saturation 9% (11/22/2025)"},{id:"ferritin-stores",label:"Ferritin Stores",kind:"marker",value:46,trend:"rising",trendPositive:!0,status:"moderate",unit:"%",detail:"Ferritin 46 ng/mL (was 24 in 11/2024, target >50) (11/22/2025)"},{id:"inflammation",label:"Inflammation",kind:"marker",value:10,trend:"stable",status:"low",unit:"%",detail:"hsCRP 0.3 mg/L — excellent (11/22/2025)"},{id:"omega3-status",label:"Omega-3 Status",kind:"marker",value:65,trend:"falling",trendPositive:!1,status:"moderate",unit:"%",detail:"DHA 2.2% (low), AA/EPA ratio 30.9 (was 24.5) (11/22/2025)"}],tags:["triathlete","iron-deficiency","endurance","high-vo2","real-data"]},Fs=[{id:"oron_insight_28",personaId:"oron",category:"sleep",variableType:"outcome",title:"Travel Disrupts Sleep Efficiency",headline:"Jet-lag and travel fatigue measurably reduce how well you sleep",summary:"Any jet lag degrades sleep efficiency, with a linear decline from zero up to ~0.6 on the jet lag score. Past that threshold, the drop steepens sharply as circadian misalignment compounds.",recommendation:"Zero jet lag is optimal. Below 0.6 there is a linear decline; above 0.6 the effect steepens.",explanation:"Jet lag disrupts circadian rhythm, delaying melatonin onset and reducing sleep efficiency. The relationship is monotonically negative: no jet lag is always best. Below the 0.6 threshold, each increment costs ~3% efficiency; above it, the drop accelerates to ~8% per unit.",causalParams:{source:"travel_load",target:"sleep_efficiency_pct",curveType:"plateau_down",theta:{value:.57,unit:"jet lag score",low:.56,high:.58,displayValue:"0.6 jet lag score"},betaBelow:{value:-2.87,unit:"%",description:"-2.87 %/per 0.2 load (linear decline)"},betaAbove:{value:-29.991,unit:"%",description:"-29.99 %/per 0.2 load (sharp)"},observations:1181,completePct:100,changepointProb:.98,sizeCategory:"large",currentValue:0,currentStatus:"below_threshold",posteriorSamples:{theta:[.5701,.5746,.5701,.5701,.5746,.5746,.5701,.5746,.5746,.5837,.5701,.5746,.5746,.5701,.5746,.5701,.5746,.5701,.5746,.5701,.5837,.5746,.5791,.5746,.5611,.5701,.5746,.5746,.5701,.5701,.5656,.5701,.5701,.5701,.5701,.5791,.5701,.5791,.5746,.5746,.5701,.5701,.5611,.5701,.5746,.5746,.5701,.5701,.5701,.5791,.5701,.5746,.5746,.5701,.5701,.5701,.5701,.5746,.5701,.5611,.5746,.5746,.5701,.5746,.5701,.5791,.5701,.5746,.5746,.5746,.5746,.5701,.5701,.5746,.5746,.5701,.5701,.5701,.5746,.5701,.5701,.5701,.5656,.5837,.5701,.5656,.5746,.5746,.5701,.5701,.5746,.5837,.5791,.5701,.5746,.5746,.5701,.5746,.5746,.5746,.5701,.5701,.5701,.5701,.5746,.5701,.5701,.5791,.5746,.5656,.5701,.5701,.5701,.5701,.5701,.5656,.5746,.5656,.5701,.5746,.5837,.5746,.5791,.5746,.5701,.5701,.5656,.5746],betaBelow:[-2.14,-3.52,-1.87,-2.91,-3.68,-4.21,-2.53,-3.89,-2.07,-2.63,-3.15,-2.48,-3.97,-3.01,-4.82,-3.74,-2.22,-2.18,-1.95,-4.35,-1.98,-3.63,-2.31,-2.05,-4.12,-3.38,-2.42,-4.36,-4.58,-3.52,-4.59,-3.44,-4.31,-3.35,-4.07,-2.56,-2.15,-2.02,-4.01,-2.04,-3.61,-2.89,-4.72,-2.41,-2.03,-4.47,-4.63,-3.4,-2.83,-4.85,-2.47,-1.92,-2.8,-3.43,-3.83,-3.27,-3.28,-4.57,-2.94,-4.22,-2.58,-1.96,-2.35,-2.73,-2.88,-2.03,-3.56,-2.32,-2.91,-2.66,-3.38,-4.65,-1.79,-2.02,-4.43,-3.57,-1.78,-4.39,-2.96,-1.97,-2.98,-2.43,-2.82,-2.78,-2.74,-3.93,-1.98,-1.82,-4.49,-2.15,-3.65,-2.94,-1.91,-3.33,-2.01,-2.45,-1.97,-4.69,-2.85,-5.28,-2.14,-4.28,-3.82,-2.04,-2.36,-2.45,-4.15,-2.56,-4.61,-2.43,-4.38,-2.17,-1.86,-3.43,-2.81,-3.55,-3.62,-1.85,-1.97,-3.4,-4.18,-2.19,-2.99,-1.96,-2.79,-3.66,-3.94,-2.81],betaAbove:[-20.2974,-30.1574,-17.8887,-27.7301,-35.4558,-27.7146,-36.7362,-59.1393,-14.2668,-27.772,-26.4918,-14.1202,-30.1965,-36.4888,-54.7957,-37.0711,-23.0494,-23.4176,-21.1259,-39.0822,-34.2098,-29.8246,-25.4315,-33.8819,-43.585,-33.6308,-38.7802,-40.7552,-41.5085,-27.343,-40.091,-36.5955,-35.9612,-41.6021,-44.5709,-26.9047,-27.9765,-31.7682,-47.2473,-17.6252,-19.3168,-28.5583,-47.3863,-17.2931,-12.3846,-43.7451,-43.1035,-42.4235,-27.7785,-38.6668,-23.1353,-17.6079,-29.2601,-22.8276,-41.3569,-27.9985,-28.9423,-38.0236,-27.0464,-39.2486,-13.5881,-23.93,-18.6747,-33.7716,-28.2988,-29.2283,-35.3936,-24.9074,-27.3241,-30.7465,-39.9402,-44.5072,-10.3514,-23.7375,-41.5074,-29.4403,-29.5854,-34.4958,-31.0834,-22.569,-31.6012,-24.7703,-22.8943,-20.1807,-15.3145,-32.2846,-20.219,-11.6878,-39.3452,-22.7325,-49.2995,-29.7246,-15.0382,-44.8133,-21.8945,-18.3359,-26.6372,-43.7031,-22.5169,-48.9329,-35.1702,-53.2365,-32.0782,-25.4277,-21.9997,-13.5069,-53.869,-37.2882,-44.7241,-28.8785,-29.769,-23.3797,-19.7188,-32.8752,-42.8228,-26.3338,-33.7144,-13.9541,-20.1002,-55.2692,-49.5355,-17.367,-40.5995,-20.7568,-37.0026,-33.6211,-25.3619,-41.4686],alpha:[93.2622,95.5127,89.0431,90.9835,92.7221,96.4461,93.2368,96.8302,92.5174,93.309,94.1343,93.3716,97.6863,94.0252,100.6428,96.183,91.7108,92.1395,92.1023,97.8079,92.2385,96.13,91.4278,92.3549,97.4167,95.4759,93.0082,97.9014,98.8314,95.5903,98.8481,95.7065,98.3955,95.2849,97.0272,93.4891,92.3962,92.7449,97.0363,92.7911,96.2914,94.1734,99.9556,93.477,92.8978,98.067,98.4543,95.1878,93.7401,99.8713,93.628,92.0467,94.371,95.3883,96.944,94.4263,95.3194,98.8576,94.5743,97.4726,93.5352,92.4443,90.9878,93.8534,94.4945,92.6092,95.8477,91.3501,94.3917,93.6862,95.3378,98.899,88.7221,92.3021,98.2741,95.6207,89.2434,98.2315,94.7495,92.1446,94.5752,93.2058,94.2298,93.9942,93.213,96.8686,92.1295,89.2422,98.468,92.6235,95.7806,94.5499,92.1124,95.3793,92.6566,92.937,92.2426,98.7547,93.8469,103.0279,92.7622,97.497,96.7404,92.0603,90.9048,93.2888,97.7034,93.4241,98.8214,92.9196,98.6709,91.7789,90.4259,95.8956,93.9762,95.6074,96.2785,90.4106,91.4659,95.925,97.2203,91.3982,95.121,91.9929,93.9664,96.4336,97.1279,94.5048]}},cause:{behavior:"Travel Load",threshold:.57,unit:"jet lag score",direction:"above"},populationThreshold:{value:.57,label:"Population Prior",variance:"Prior source: Dunican et al. 2023; Fowler et al. MSSE 2017; Oura/NUS SLEEP 2025"},outcome:{metric:"Sleep Efficiency",effect:"29.99 %",direction:"negative"},certainty:.88,evidenceWeight:.99,evidence:{personalDays:1181,personalWeight:.99,populationWeight:.01,stability:.98},dataSources:["autosleep","derived"],comparison:{before:{value:0,label:"Current (no jet lag)"},after:{value:.6,label:"Threshold (steep drop begins)"}},whyNow:"Current jet lag score is 0 (optimal). The threshold at 0.6 marks where degradation steepens.",actionable:!0,suggestedAction:"Zero jet lag is optimal. Below 0.6 there is a linear decline; above 0.6 the effect steepens.",priority:1,status:"new",showWork:'Piecewise-linear model: sleep_efficiency_pct ~ f(travel_load) with changepoint at theta. Theta = 0.6 jet lag score. Below theta: -2.87 per unit (linear degradation from zero — no jet lag is optimal). Above theta: -29.991 per unit (steep drop). Prior-corrected: beta_below prior tightened to N(-3.0, 1.0) to prevent v_max artifact where observational confounding made 0.6 appear "optimal." Fitted on 1181 data points (effective N = 393). Evidence split: 99% personal / 1% population. Prior source: Dunican et al. 2023; Fowler et al. MSSE 2017; Oura/NUS SLEEP 2025 (evidence tier: observational).'},{id:"oron_insight_67",personaId:"oron",category:"sleep",variableType:"outcome",title:"Travel Cuts Deep Sleep",headline:"High travel loads reduce the restorative deep-sleep phase",summary:"Travel stress compresses slow-wave sleep, the phase responsible for tissue repair and growth-hormone release. Deep sleep declines linearly with any jet lag, steepening past 0.6.",recommendation:"Zero jet lag is optimal. Below 0.6 there is a linear decline; above 0.6 the SWS loss steepens.",explanation:"Jet lag disrupts slow-wave sleep architecture via circadian misalignment. No jet lag is always best for deep sleep.",causalParams:{source:"travel_load",target:"deep_sleep_min",curveType:"plateau_down",theta:{value:.57,unit:"jet lag score",low:.57,high:.57,displayValue:"0.6 jet lag score"},betaBelow:{value:-1.92,unit:"min",description:"-1.92 min/per 0.2 load (linear decline)"},betaAbove:{value:-58.612,unit:"min",description:"-58.61 min/per 0.2 load (steep)"},observations:1136,completePct:100,changepointProb:.83,sizeCategory:"large",currentValue:0,currentStatus:"below_threshold",posteriorSamples:{theta:[.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701,.5701],betaBelow:[-2.41,-2.32,-2.3,-1.15,-2.18,-.85,-1.34,-2.25,-1.67,-1.02,-1.91,-1.54,-1.48,-1.75,-1.24,-2.29,-1.05,-1.05,-2.68,-1.2,-1.72,-2.12,-2.63,-1.98,-1.93,-1.88,-1.71,-.92,-2.01,-1.72,-.62,-2.03,-.78,-1.73,-1.99,-1.54,-1.5,-1.42,-2.13,-1.96,-2.65,-1.24,-1.55,-1.74,-.57,-1.84,-1.87,-2.51,-.68,-2.12,-2.26,-2.48,-2.69,-1.86,-.88,-1.86,-2.16,-1.81,-1.67,-1.58,-2.08,-1.95,-1.74,-2.03,-.85,-2.95,-1.06,-2.08,-2.1,-1.7,-.77,-1.5,-1.3,-1.4,-1.54,-2.28,-1.76,-1.98,-1.22,-2.39,-2.53,-2.25,-.9,-1.97,-1.2,-1.7,-2.42,-1.84,-1.7,-1.96,-1.67,-1.66,-1.39,-1.34,-.78,-1.09,-1.78,-2.11,-2.52,-1.03,-1.07,-2.35,-1.27,-1.64,-2.83,-1.67,-2.4,-1.91,-2.1,-2.15,-2.01,-1.75,-2.53,-1.13,-.64,-1.06,-1.44,-2.97,-1.83,-1.48,-1.74,-3.15,-1.3,-2.47,-1.69,-2.55,-2.03,-2.01],betaAbove:[-150.4919,1.7687,-130.2091,27.287,-98.3469,-29.3943,-28.3334,-55.3791,-65.5666,-77.2991,-26.3507,-71.8663,-24.2203,-53.3909,33.2826,-95.3224,-20.7707,-47.6815,-176.8615,-80.9594,-29.7053,-118.7751,-124.8875,-68.9142,-124.7689,-114.882,-57.312,70.4714,-55.8729,-15.0579,85.383,-31.5547,44.8246,-114.5256,-75.8672,-128.1858,-23.9705,-81.2682,-80.2057,-115.1967,-188.8038,-24.4579,-34.9266,-57.2334,-12.1055,-59.6905,-67.3739,-120.5506,33.0798,-93.8667,-50.9869,-166.7717,-103.7987,-67.7537,47.0807,15.4219,-116.0701,-89.2428,-38.6219,-85.8704,-3.7777,-53.8881,-93.1838,-126.6725,8.2791,-81.2363,-93.7659,-150.9094,-63.7257,-93.5403,-36.8804,-23.5835,-7.2702,21.8514,-13.3622,-116.4968,-69.9409,-50.6789,-35.9081,-69.4335,-161.551,-135.8358,54.1377,-100.7075,-39.8595,-30.177,-95.9958,-25.4906,-44.1992,-89.571,43.0586,-74.0362,4.4258,-26.3966,20.3429,-13.6663,-110.8435,-83.1057,-93.8456,-75.8094,-57.8341,-133.4383,44.0952,-82.9897,-152.5169,38.2831,-110.9971,-62.9275,-73.7356,-30.7724,-99.2565,-9.4244,-96.4214,-14.3516,21.0461,-12.4893,-81.7012,-120.4936,-72.0292,-80.9009,13.7971,-79.4853,-45.8042,-160.8392,-51.3944,-111.7221,-79.7039,-28.2712],alpha:[130.7719,131.2075,130.6672,103.2967,124.2982,95.0814,105.4459,127.3421,112.7125,100.4864,119.9257,110.6494,107.5769,113.8121,104.7096,130.2203,99.28,100.4003,140.6026,102.6065,114.0071,122.969,144.3624,122.8318,121.364,119.4058,112.8023,99.8953,123.0554,112.8156,81.9915,120.6535,92.5226,114.7598,118.6014,110.4759,107.709,106.4809,125.313,121.7303,143.6989,102.7804,110.2783,114.803,85.7783,117.9202,119.4045,139.3986,86.5525,124.7053,127.5247,137.532,141.9616,116.7278,93.5556,118.4076,125.439,117.5187,112.5508,110.6008,121.2308,120.0721,112.9124,121.9425,95.542,151.2998,99.4146,120.21,123.1008,114.2461,90.7459,110.5437,103.3954,106.6204,110.6583,129.089,115.3731,121.2521,103.7516,129.5211,135.1832,128.2662,99.313,121.7667,103.6221,111.2372,131.5223,116.2268,112.1068,117.7346,113.5625,111.4889,106.7883,103.6591,94.6454,100.5836,115.3312,124.9013,139.6091,100.6899,100.0048,127.4375,103.6898,111.1725,147.222,110.389,129.9531,118.878,123.5104,126.8037,121.8894,114.6031,134.7107,102.0242,91.0019,100.9197,107.6932,153.4504,120.2855,107.2119,114.2624,156.9338,108.0752,134.9437,113.2909,136.2265,122.727,121.0005]}},cause:{behavior:"Travel Load",threshold:.57,unit:"jet lag score",direction:"above"},populationThreshold:{value:.57,label:"Population Prior",variance:"Prior source: Dunican et al. 2023; jet lag SWS disruption"},outcome:{metric:"Deep Sleep (min)",effect:"58.61 min",direction:"negative"},certainty:.67,evidenceWeight:.32,evidence:{personalDays:1136,personalWeight:.32,populationWeight:.68,stability:.83},dataSources:["autosleep","derived"],comparison:{before:{value:0,label:"Current (no jet lag)"},after:{value:.6,label:"Threshold (steep SWS loss begins)"}},whyNow:"Current jet lag score is 0 (optimal). The threshold at 0.6 marks where deep sleep loss steepens.",actionable:!0,suggestedAction:"Zero jet lag is optimal. Below 0.6 there is a linear decline; above 0.6 the SWS loss steepens.",priority:1,status:"new",showWork:"Piecewise-linear model: deep_sleep_min ~ f(travel_load) with changepoint at theta. Theta = 0.6 jet lag score. Below theta: -1.92 min per unit (linear degradation — no jet lag is optimal). Above theta: -58.612 per unit (steep SWS loss). Prior-corrected: beta_below sigma tightened (1.5→0.8) to prevent v_max artifact. Fitted on 1136 data points (effective N = 378). Evidence split: 32% personal / 68% population. Prior source: Dunican et al. 2023; jet lag SWS disruption (evidence tier: observational)."},{id:"oron_insight_10",personaId:"oron",category:"recovery",variableType:"load",title:"Training Spikes Elevate Resting Heart Rate",headline:"Sudden increases in training load raise resting HR for days",summary:"Resting heart rate drops as ACWR increases toward 1.8, then levels off. The autonomic nervous system adapts to gradual load increases but sharp spikes elevate sympathetic tone.",recommendation:"Keep ACWR below 1.8 to protect resting heart rate.",explanation:"Chronic overreaching elevates baseline sympathetic tone and resting heart rate. Most of the effect occurs below 1.8 ratio (-4.34 bpm per unit), with diminishing returns above.",causalParams:{source:"acwr",target:"resting_hr_7d_mean",curveType:"v_min",theta:{value:1.8,unit:"ratio",low:1.62,high:1.97,displayValue:"1.8 ratio"},betaBelow:{value:-4.338,unit:"bpm",description:"-4.34 bpm/per 0.1 ACWR (strong)"},betaAbove:{value:.486,unit:"bpm",description:"+0.49 bpm/per 0.1 ACWR (diminishing)"},observations:2400,completePct:100,changepointProb:.73,sizeCategory:"large",currentValue:.93,currentStatus:"below_threshold",posteriorSamples:{theta:[1.7432,1.7673,1.8879,1.7613,1.7492,1.9,1.7191,1.7794,1.8397,1.8819,1.7312,1.894,1.8518,1.8819,1.6407,1.5623,1.7613,1.8276,1.9,1.7613,1.8698,1.8759,1.7131,1.8156,1.8578,1.894,1.8819,1.8518,1.9,1.7492,1.8819,1.8819,1.8578,1.8518,1.8035,1.6467,1.8578,1.9,1.6286,1.8759,1.8698,1.7553,1.7854,1.6407,1.7372,1.6528,1.7432,1.7372,1.8035,1.8518,1.7432,1.8035,1.8337,1.8879,1.707,1.9,1.9,1.8216,1.8035,1.8819,1.7794,1.7191,1.8759,1.707,1.8638,1.8759,1.6106,1.8879,1.8698,1.8759,1.8457,1.8578,1.7372,1.8578,1.7191,1.8879,1.8518,1.7613,1.8156,1.8819,1.6226,1.7734,1.7191,1.8879,1.7131,1.8095,1.894,1.707,1.7553,1.8698,1.8457,1.7673,1.6528,1.894,1.8337,1.6106,1.7794,1.7432,1.7492,1.8397,1.7673,1.8698,1.9,1.8759,1.8216,1.8759,1.5925,1.8216,1.8457,1.8819,1.7312,1.6709,1.7975,1.8397,1.8276,1.6528,1.8578,1.8518,1.6407,1.7492,1.894,1.8578,1.7854,1.7975,1.894,1.8638,1.7854,1.8759],betaBelow:[-4.39,-4.107,-4.2282,-4.6029,-4.5036,-4.5691,-4.3002,-4.2931,-4.3666,-4.31,-4.2821,-4.2126,-4.2887,-4.2939,-4.2682,-4.2959,-4.3963,-4.735,-4.4169,-4.2761,-4.3146,-4.4073,-4.3581,-4.381,-4.6346,-4.1549,-4.4959,-4.1221,-4.1564,-4.2528,-4.3408,-4.4158,-4.3772,-4.2749,-4.1831,-4.0822,-4.1996,-4.2374,-4.49,-4.3672,-4.3594,-4.2903,-4.4067,-4.4414,-4.5879,-4.4148,-4.3263,-4.2394,-4.5623,-4.4051,-4.5779,-4.1554,-4.4592,-4.2167,-4.2357,-4.4088,-4.377,-4.484,-4.7281,-4.3794,-4.299,-4.3942,-4.4022,-4.4235,-4.6183,-4.1426,-4.5241,-4.4011,-4.5192,-4.4611,-4.0127,-4.0889,-4.3562,-4.4074,-4.2922,-4.3142,-4.1635,-4.2697,-4.1296,-4.3624,-4.1968,-4.3275,-4.3369,-4.3058,-4.3063,-4.1009,-4.3343,-4.3437,-4.1986,-4.5251,-4.366,-4.4668,-4.2318,-4.214,-4.5069,-4.2097,-4.478,-4.3196,-4.0901,-4.3586,-4.572,-4.4741,-4.461,-4.143,-4.3418,-4.5187,-4.4594,-4.3177,-4.3063,-4.5053,-4.4475,-4.467,-4.4742,-4.399,-4.3513,-4.1585,-4.3021,-4.3812,-4.55,-4.323,-4.1382,-4.4689,-4.5202,-4.5056,-4.224,-4.2756,-4.4294,-4.2567],betaAbove:[-4.1747,.9248,1.0572,.7286,1.591,9.4336,5.0103,5.9079,.7807,5.3698,3.5819,-12.7224,3.9736,4.9142,3.3525,.3049,3.5616,3.103,2.2101,-.7158,.4303,-2.133,-.3238,.3656,.0059,-.7673,1.8335,-6.4601,-8.8186,.4364,-1.6415,3.2161,-2.4653,.6967,-2.0338,-2.8698,-5.8939,-2.5195,2.98,-.5873,-1.9048,-.8769,3.115,-3.9818,.7049,-1.506,-.0078,-6.187,-6.6605,3.1464,1.3024,2.4443,.576,10.9267,.3971,3.1072,3.0707,-.6867,4.5606,-2.3463,.663,-6.917,12.1139,-.943,-6.9214,1.4472,4.7239,-4.2426,6.8619,-3.0658,2.0394,-2.5657,.2161,1.0243,-.317,-2.2442,-4.8472,-4.0479,5.7189,-5.6104,-3.3449,1.9884,-4.3334,8.1174,3.4434,-3.7266,-.0327,3.5345,-2.7528,3.0776,-4.4193,-.1045,-1.829,-3.1486,-10.961,.6539,-.8637,-1.8227,7.1489,4.0542,3.9738,.6781,3.382,-.5207,-.6042,3.9832,1.3672,7.0945,-3.6045,-.1802,-4.0757,-4.9215,.4335,-2.7478,-.2228,-2.528,-7.4036,2.4153,-.7489,3.7692,-6.9606,3.8354,10.9145,13.1912,8.3519,.6278,2.0535,5.4249],alpha:[46.3067,46.4012,45.7589,45.699,45.8867,45.2147,46.3723,46.0582,45.7581,45.7492,46.4664,45.7565,45.7966,45.9084,46.7581,46.8801,46.2756,45.3452,45.5208,46.2309,45.7745,45.5156,46.3178,46.0273,45.3876,45.7419,45.2885,46.024,45.8713,46.3908,45.6867,45.6111,45.6452,45.917,46.2423,46.941,45.9534,45.6893,46.4379,45.5952,45.5024,46.284,46.0446,46.5649,45.9916,46.5792,46.3263,46.4036,45.7252,45.6813,45.9335,46.2722,45.7083,45.8577,46.5461,45.5441,45.4167,45.7393,45.4158,45.5505,46.07,46.2513,45.6494,46.3126,45.5148,46.0244,46.5409,45.5685,45.5016,45.5601,46.1424,46.104,46.2614,45.5672,46.3868,45.6658,46.0139,46.2555,46.2448,45.7299,46.8777,46.1142,46.4089,45.6886,46.4612,46.4727,45.6783,46.2901,46.4092,45.5733,45.9344,45.971,46.7431,45.9338,45.667,47.0429,45.9137,46.303,46.4993,45.7565,45.7384,45.4569,45.4341,45.9604,45.8942,45.4413,46.8318,45.8019,45.8365,45.3712,46.2271,46.532,45.8066,45.7871,45.9201,46.7911,45.8654,45.6742,46.4349,46.3437,45.7407,45.6009,45.6954,45.8905,45.6654,45.8173,45.9051,45.8074]}},cause:{behavior:"ACWR",threshold:1.8,unit:"ratio",direction:"below"},populationThreshold:{value:1.8,label:"Population Prior",variance:"Prior source: Hulin et al., BJSM 2016; Gabbett, BJSM 2016"},outcome:{metric:"Resting HR (7d avg)",effect:"4.34 bpm",direction:"negative"},certainty:.78,evidenceWeight:.28,evidence:{personalDays:2400,personalWeight:.28,populationWeight:.72,stability:.73},dataSources:["apple_health","gpx"],comparison:{before:{value:.9,label:"Current"},after:{value:1.8,label:"Threshold (ratio)"}},whyNow:"Current value (0.9) is below the threshold (1.8 ratio).",actionable:!0,suggestedAction:"Threshold identified at 1.8 ratio.",priority:2,status:"new",showWork:"Piecewise-linear model: resting_hr_7d_mean ~ f(acwr) with changepoint at theta. Theta = 1.8 ratio. Below theta: -4.338 per unit. Above theta: +0.486 per unit. Fitted on 2400 data points (effective N = 342). Evidence split: 28% personal / 72% population. Prior source: Hulin et al., BJSM 2016; Gabbett, BJSM 2016 (evidence tier: meta-analysis/RCT)."},{id:"oron_insight_45",personaId:"oron",category:"recovery",variableType:"marker",title:"Training Spikes Shift Immune Balance",headline:"Acute-to-chronic workload ratio drives NLR toward a pro-inflammatory state",summary:"When ACWR exceeds ~1.2, neutrophils rise relative to lymphocytes — a sign the innate immune system is mobilizing while adaptive immunity is suppressed, raising short-term infection risk.",recommendation:"Sweet spot near 1.2 ratio. Both too little and too much are suboptimal.",explanation:"Training stress shifts immune balance: neutrophilia + lymphopenia = elevated NLR. The effect intensifies above 1.2 ratio (+0.14 ratio per unit vs -0.04 below).",causalParams:{source:"acwr",target:"nlr",curveType:"v_min",theta:{value:1.18,unit:"ratio",low:.95,high:1.42,displayValue:"1.2 ratio"},betaBelow:{value:-.039,unit:"ratio",description:"-0.04 ratio/per 0.1 ACWR (stable)"},betaAbove:{value:.143,unit:"ratio",description:"+0.14 ratio/per 0.1 ACWR (sharp)"},observations:618,completePct:56.2,changepointProb:.99,sizeCategory:"large",currentValue:.93,currentStatus:"below_optimal",posteriorSamples:{theta:[1.2005,1.0377,1.3693,1.0377,1.098,1.1281,1.1643,1.1342,1.2729,1.0558,1.2487,1.2608,1.2608,1.1101,1.0437,1.2186,1.3935,1.2729,1.2186,1.1342,1.2608,1.2186,1.1402,1.0739,1.3814,1.1462,1.0317,1.1281,1.2789,1.5804,1.1824,1.1402,1.1402,1.2065,1.1764,.9412,1.2126,1.297,1.3271,1.2608,1.1523,1.1824,.9955,1.0317,1.098,1.092,1.1402,1.1101,1.2126,1.092,1.5744,1.0618,1.2065,1.2668,1.1704,1.1462,.9653,1.2849,1.104,1.0739,1.2246,1.1281,1.2367,1.2668,1.098,1.1402,1.0136,1.2367,1.1704,1.2729,1.3151,1.0497,1.2608,1.2608,1.098,1.1583,1.3271,1.2487,1.0739,1.2487,1.2729,1.2186,1.092,1.1101,.9653,1.0497,1.4116,1.1523,1.0558,1.1221,1.1704,1.2367,1.092,1.1704,1.2307,1.1764,1.098,1.1945,1.2065,1.1523,1.0799,1.0256,1.1101,1.2729,1.1884,1.2005,1.2005,1.1583,1.3211,1.0859,1.309,1.1583,1.1764,1.2487,1.0075,1.1523,1.1342,1.1704,1.1643,1.0497,1.297,1.1161,1.0136,1.2789,.9352,1.3151,1.5985,1.1221],betaBelow:[-.0157,-.0575,-.0169,-.0489,-.0267,-.0468,-.043,-.0361,-.0205,-.0555,-.0265,-.0218,-.0423,-.0639,-.0542,-.0327,-.0154,-.0196,-.0255,-.0511,-.0137,-.0313,-.0507,-.0642,-.0057,-.0361,-.0471,-.037,-.0156,-.0135,-.0408,-.0485,-.0486,-.0555,-.0411,-.0729,-.0467,-.0353,-.0308,-.0499,-.0411,-.0453,-.0645,-.0749,-.0498,-.0662,-.0541,-.0535,-.038,-.06,-.0203,-.0508,-.0184,-.0274,-.039,-.0491,-.0641,-.0537,-.0619,-.0589,-.0471,-.0514,-.012,-.0354,-.0649,-.0459,-.0522,-.0306,-.0434,-.0284,-.0281,-.0585,-.0395,-.0387,-.0469,-.0471,-.0156,-.0311,-.0655,-.0023,-.0348,-.0475,-.052,-.0438,-.072,-.0452,-.0164,-.0519,-.063,-.0513,-.0369,-.0356,-.0474,-.0476,-.0425,-.0596,-.0521,-.0354,-.0234,-.0548,-.0465,-.0529,-.0414,-.0142,-.0363,-.0202,-.0157,-.0427,-.0313,-.0584,-.0116,-.0171,-.0579,-.0199,-.0658,-.0586,-.0384,-.0388,-.0285,-.0644,-.0238,-.0508,-.039,-.024,-.0696,-.0288,-.0214,-.0359],betaAbove:[.157,.0815,.1338,.1274,.1331,.1774,.1226,.1058,.1548,.1064,.1579,.1688,.2231,.1578,.1219,.13,.2272,.192,.1177,.1289,.1887,.1505,.1472,.1512,.3277,.1596,.0847,.1135,.1234,.3584,.1166,.1024,.1251,.161,.1765,.0929,.1586,.1803,.2568,.2668,.1198,.1529,.1005,.1267,.1224,.1289,.1329,.1155,.1027,.1224,.2894,.0995,.1239,.1696,.1674,.1238,.0769,.1941,.1218,.0972,.1655,.1507,.1315,.1586,.1385,.1311,.0855,.1502,.1179,.2084,.1307,.1164,.133,.0916,.1246,.1686,.1359,.13,.1092,.1133,.1761,.1769,.1362,.1269,.0943,.1056,.2204,.1584,.1154,.1711,.1752,.1325,.1175,.1815,.2042,.1479,.1326,.1593,.16,.1148,.0883,.0863,.1492,.1051,.1668,.0893,.1487,.113,.1847,.1287,.1644,.0786,.13,.1924,.1021,.1188,.1783,.1546,.1612,.0966,.1918,.1203,.076,.1458,.0733,.1788,.3389,.1051],alpha:[1.4007,1.4027,1.4025,1.3932,1.3946,1.3952,1.3984,1.399,1.4003,1.3983,1.4054,1.401,1.3932,1.3857,1.3986,1.3984,1.4059,1.4058,1.3987,1.3943,1.4059,1.3963,1.3931,1.3902,1.4105,1.3984,1.3982,1.3975,1.4072,1.409,1.3984,1.3997,1.3867,1.3937,1.3912,1.3927,1.3932,1.4006,1.397,1.3896,1.4007,1.3971,1.3945,1.3917,1.3984,1.3929,1.3963,1.3939,1.4,1.393,1.3979,1.3966,1.4054,1.4,1.3945,1.3979,1.3963,1.391,1.3934,1.3966,1.3911,1.3914,1.4063,1.3981,1.3921,1.3972,1.3982,1.3974,1.3938,1.4032,1.3962,1.3892,1.3932,1.3999,1.4001,1.3961,1.4077,1.4053,1.3911,1.4126,1.3978,1.3926,1.3932,1.4003,1.3916,1.3987,1.4044,1.3902,1.3934,1.3978,1.3994,1.3974,1.3931,1.3951,1.3937,1.3942,1.3934,1.4029,1.4069,1.3978,1.4026,1.4018,1.3913,1.4042,1.3922,1.4058,1.409,1.398,1.3954,1.3926,1.4052,1.4006,1.39,1.4061,1.3948,1.3941,1.3965,1.3974,1.4009,1.3947,1.4021,1.3972,1.3989,1.3995,1.3929,1.4,1.4033,1.397]}},cause:{behavior:"ACWR",threshold:1.18,unit:"ratio",direction:"above"},populationThreshold:{value:1.18,label:"Population Prior",variance:"Prior source: Simpson et al. Exerc Immunol Rev 2020; stress neutrophilia"},outcome:{metric:"NLR",effect:"0.14 ratio",direction:"positive"},certainty:.58,evidenceWeight:.27,evidence:{personalDays:618,personalWeight:.27,populationWeight:.73,stability:.99},dataSources:["gpx","labs"],comparison:{before:{value:.9,label:"Current"},after:{value:1.2,label:"At optimal"}},whyNow:"Current value (0.9) is below the threshold (1.2 ratio).",actionable:!0,suggestedAction:"Sweet spot near 1.2 ratio. Both too little and too much are suboptimal.",priority:1,status:"new",showWork:"Piecewise-linear model: nlr ~ f(acwr) with changepoint at theta. Theta = 1.2 ratio. Below theta: -0.039 per unit. Above theta: +0.143 per unit. Fitted on 618 data points (effective N = 20). Evidence split: 27% personal / 73% population. Prior source: Simpson et al. Exerc Immunol Rev 2020; stress neutrophilia (evidence tier: observational)."},{id:"oron_insight_60",personaId:"oron",category:"metabolic",variableType:"marker",title:"Omega-3 Status Lowers Inflammation",headline:"Higher omega-3 index is linked to lower hsCRP",summary:"Omega-3 fatty acids (EPA + DHA) suppress pro-inflammatory cytokines and NF-κB signaling. A higher omega-3 index correlates with lower systemic inflammation as measured by hsCRP.",recommendation:"Omega-3 index above 2.7% shows diminishing returns on hsCRP.",explanation:"EPA/DHA compete with arachidonic acid, reducing pro-inflammatory eicosanoid production. Most of the effect occurs below 2.7 % (+0.20 mg/L per unit), with diminishing returns above.",causalParams:{source:"omega3_index_derived",target:"hscrp_smoothed",curveType:"plateau_up",theta:{value:2.72,unit:"%",low:2.69,high:2.75,displayValue:"2.7 %"},betaBelow:{value:.199,unit:"mg/L",description:"+0.20 mg/L/per 1% (strong)"},betaAbove:{value:-.003,unit:"mg/L",description:"-0.00 mg/L/per 1% (diminishing)"},observations:4,completePct:33.3,changepointProb:.68,sizeCategory:"large",currentValue:2.7,currentStatus:"below_threshold",posteriorSamples:{theta:[2.7002,2.7446,2.715,2.72,2.7052,2.7298,2.7002,2.715,2.7101,2.7052,2.7101,2.7249,2.7348,2.7052,2.7249,2.7249,2.7249,2.7101,2.7249,2.7002,2.72,2.7249,2.715,2.7002,2.7348,2.7002,2.7446,2.7101,2.715,2.7002,2.7446,2.7397,2.7052,2.7298,2.7397,2.7397,2.7249,2.72,2.7446,2.7002,2.7446,2.7052,2.72,2.7348,2.7101,2.715,2.7249,2.7002,2.7002,2.7397,2.72,2.7298,2.715,2.7446,2.72,2.7348,2.7002,2.7101,2.7101,2.7249,2.7446,2.7298,2.715,2.7397,2.7101,2.7348,2.7249,2.7249,2.7348,2.7446,2.7002,2.715,2.7002,2.7002,2.72,2.7002,2.72,2.7101,2.715,2.7446,2.7052,2.7298,2.7052,2.715,2.7052,2.7397,2.7397,2.7348,2.7298,2.7298,2.7446,2.715,2.7002,2.7002,2.7446,2.7348,2.715,2.7101,2.7249,2.7348,2.7101,2.7052,2.7052,2.7348,2.7397,2.715,2.7397,2.7052,2.72,2.72,2.7052,2.7446,2.7101,2.72,2.7446,2.7348,2.7052,2.7397,2.7002,2.7348,2.7052,2.7446,2.7397,2.72,2.7101,2.715,2.7249,2.72],betaBelow:[.096,.3985,.089,.0914,.3375,.0587,.2998,.485,.1879,.2209,-.1317,.3147,.1069,.0555,.3155,.0995,.1472,.4586,.2346,.529,.2105,.3359,.3642,.1876,.2002,.162,.162,.4817,.6291,.4601,.4021,-.0569,.5008,.0402,.0023,.0124,.2596,.1751,.4088,.215,.5407,.1803,.4623,.4578,.0416,.3664,.1931,.301,.4322,.3078,.0181,.0553,.2396,.25,.357,.1283,.0326,.086,.0543,.089,-.0228,.5545,.4089,.0613,.169,.1786,.0372,.0732,-.1001,.1974,.3123,.1672,.1287,.1527,-.0045,.2708,.3466,.1153,.1899,.1355,.1323,.2274,.3152,.2975,.173,.2459,.3185,.2597,.2744,.1899,.125,-.076,.2021,.1846,.3468,.0421,-.2352,.0465,.3449,.333,.2194,.1005,.1434,.2793,.1694,.2455,.3047,-.1024,.1572,-.1464,-.192,.0133,.1432,.2766,.0132,.2559,.2516,.2398,.5269,.4508,-.0269,.2671,.2041,.3018,.298,.1538,.0946,.1947],betaAbove:[-.0807,-.2582,.2039,.0292,.0821,.1294,-.25,-.0887,-.253,.2438,-.2339,-.0451,.0633,-.3048,.1457,.1013,-.0492,.0361,.0063,-.0884,.1888,-.0863,.1968,.0715,-.224,-.0085,.0054,-.1185,-.0733,-.0412,.1855,.1682,-.1136,-.0042,.2299,-.1918,.0113,.1404,-.293,.3461,-.1745,-.174,-.2145,.1765,-.1566,-.2164,-.2438,-.2856,-.0034,.0148,-.1034,.112,-.2881,-.0626,-.0832,-.0276,-.2082,.1848,-.1657,.0522,.0457,-.0218,.0674,-.0179,-.1139,.0265,-.2878,-.4354,-.0793,-.1926,-.0668,.0149,-.077,-.0151,.0287,-.0394,.0395,.1915,-.0437,-.0713,-.3066,.0103,-.1252,-.0256,-.1468,-.156,-.089,.0073,-.1335,.1327,-.1724,.08,.1667,.0709,.0077,.1322,.2297,.1535,-.1889,.2146,-.0263,-.0491,-.192,.0924,.0307,.358,-.0734,-.3146,-.1403,-.0882,-.0565,-.2749,.1903,-.2734,-.1182,-.1465,.2535,-.0849,.3413,.1748,.2021,-.167,.0954,-.0778,.1269,-.0198,-.0508,.1882],alpha:[.2583,.5281,.0473,.4314,.2662,.2931,.0496,.5173,.4229,.4315,.2822,.4454,.5529,.3951,.8421,.1722,.3899,.6105,.3585,.2747,.3922,.151,.0586,-.0416,.4752,.387,.2307,.1904,.1281,.2212,.6694,.418,.2127,.2511,.4035,-.009,.3198,.5246,.1656,.3787,.1474,.1529,.4369,.4751,.3857,.1652,.1443,.4429,.5566,.3373,.4421,.2519,.4838,.2521,.113,.2607,.5238,.2791,.3416,.3328,.3028,.3875,.1145,.3062,.2591,.4903,.4469,.3657,.684,.3431,.2917,.232,.0676,.5025,.4535,.0996,.3187,.4245,.2549,.1881,.2587,.1674,.3702,.3145,.478,.2143,.5631,.3237,.3606,.6683,.0941,.4574,.1501,.2595,.4535,.1997,.2162,.3694,.3589,.4055,.519,.4532,.5274,-.1021,.3313,.5902,.1656,.1971,.5353,.1564,.4099,.1087,.3858,.3868,.3295,.2447,.4692,.0563,.2976,.3824,.7045,.5487,.6471,.3731,.4532,.0742,.1186,.3056]}},cause:{behavior:"Omega-3 Index",threshold:2.72,unit:"%",direction:"below"},populationThreshold:{value:2.72,label:"Population Prior",variance:"Prior source: Calder, Br J Clin Pharmacol 2013; EPA/DHA anti-inflammatory"},outcome:{metric:"hsCRP",effect:"0.20 mg/L",direction:"positive"},certainty:.55,evidenceWeight:.05,evidence:{personalDays:4,personalWeight:.05,populationWeight:.95,stability:.68},dataSources:["labs"],comparison:{before:{value:2.7,label:"Current"},after:{value:2.7,label:"Threshold (%)"}},whyNow:"Current value (2.7) is below the threshold (2.7 %).",actionable:!0,suggestedAction:"Threshold identified at 2.7 %.",priority:2,status:"new",showWork:"Piecewise-linear model: hscrp_smoothed ~ f(omega3_index_derived) with changepoint at theta. Theta = 2.7 %. Below theta: +0.199 per unit. Above theta: -0.003 per unit. Fitted on 4 data points (effective N = 4). Evidence split: 5% personal / 95% population. Prior source: Calder, Br J Clin Pharmacol 2013; EPA/DHA anti-inflammatory (evidence tier: meta-analysis/RCT)."},{id:"oron_insight_55",personaId:"oron",category:"recovery",variableType:"marker",title:"Sleep Duration Influences Cortisol",headline:"More sleep is associated with healthier cortisol patterns",summary:"Short sleep disrupts the HPA axis, elevating evening cortisol and flattening the diurnal curve. Getting adequate sleep helps maintain the normal morning peak and evening trough.",recommendation:"More sleep linearly reduces cortisol — no threshold identified.",explanation:"Sleep restriction elevates next-morning cortisol via HPA axis dysregulation. Most of the effect occurs below 7.4 hours (-1.04 mcg/dL per unit), with diminishing returns above.",causalParams:{source:"sleep_duration_hrs",target:"cortisol_smoothed",curveType:"linear",theta:{value:0,unit:"hours",low:0,high:0,displayValue:"0"},betaBelow:{value:-1.041,unit:"mcg/dL",description:"-1.04 mcg/dL/per hr (strong)"},betaAbove:{value:-.049,unit:"mcg/dL",description:"-0.05 mcg/dL/per hr (diminishing)"},observations:452,completePct:41.1,changepointProb:.56,sizeCategory:"large",currentValue:6.89,currentStatus:"below_threshold",posteriorSamples:{theta:[7.4429,7.4232,7.4232,7.4429,7.4363,7.397,7.4101,7.4298,7.397,7.3905,7.397,7.4036,7.4363,7.4494,7.3905,7.397,7.4429,7.4036,7.4036,7.397,7.3905,7.4494,7.3905,7.4429,7.4036,7.4363,7.4101,7.4101,7.4232,7.3905,7.4494,7.3905,7.4363,7.4298,7.3905,7.4101,7.4167,7.4363,7.4167,7.397,7.4036,7.4298,7.4363,7.4298,7.3905,7.3905,7.3905,7.4167,7.4298,7.4363,7.4232,7.4429,7.397,7.4232,7.397,7.4101,7.4363,7.4494,7.4036,7.4363,7.4101,7.3905,7.4036,7.3905,7.4363,7.4298,7.4363,7.4298,7.4101,7.4429,7.4036,7.4494,7.4363,7.4036,7.4232,7.4298,7.4232,7.4429,7.4429,7.4036,7.3905,7.4494,7.4494,7.4036,7.4363,7.397,7.4167,7.397,7.4494,7.397,7.4101,7.4429,7.4298,7.4363,7.4429,7.4429,7.4101,7.4232,7.4429,7.4036,7.3905,7.4167,7.4232,7.3905,7.4363,7.4232,7.4101,7.4429,7.397,7.4494,7.397,7.397,7.4036,7.4429,7.4298,7.3905,7.4167,7.4167,7.4101,7.3905,7.4101,7.4298,7.4036,7.4494,7.4036,7.397,7.4167,7.4494],betaBelow:[-.2892,-.5907,.9596,-.5742,-1.9795,2.0189,-1.9298,1.3128,-.0648,-2.3788,-1.7862,-.8465,.449,-1.3453,-.6495,-3.6771,-1.1464,-.4883,-1.1379,-1.3751,-.4298,-1.7086,-1.8457,-1.2573,-1.1196,.0874,-.8053,1.5237,-1.9561,-3.8051,-2.91,-2.812,-1.3742,-.6864,-1.8702,-1.1717,-.2226,-.212,-.9602,-.0033,-1.4782,-.6322,.2918,-2.6772,-2.9355,-.5744,-.8495,.4833,-.7058,-3.4419,-1.4476,.4846,-2.8162,-1.5988,-1.1901,.3732,-.1998,-3.9357,.2515,-1.5187,1.5338,-3.5444,-1.0991,-.9715,-1.6277,-.8752,-4.7077,.147,-3.8656,-1.1206,.1327,-1.9772,-.3711,.0898,-.3136,-1.3021,-2.7881,-1.6001,-.9662,-1.8528,-1.3737,.1849,-2.4289,-1.0949,-2.0702,-.5703,-.8232,-2.9351,-.7664,-1.4749,-.7919,-.7927,-1.2431,-2.1235,-.9491,-1.5302,.6023,-2.2659,-2.8754,-.05,-1.0451,-.1228,-.1206,-2.9554,1.0054,-2.4426,-.845,-1.0737,-1.9412,-.5427,-1.2019,-.9007,.1994,-2.0395,-.5008,-.8014,-1.851,-.8185,1.5761,-.956,-.2664,-2.2549,-.2063,-.1572,-1.9272,-1.9906,-1.6301,-.8736],betaAbove:[-.5222,1.931,-1.095,-1.1308,1.452,2.2096,.4172,1.1616,-.1457,-.7505,-.7267,.0477,-.2148,-.6394,.0133,-.6476,1.2915,-1.4936,.4759,-.0729,-.7569,-1.1142,-.7338,.0795,-1.953,-.0788,1.8495,.4091,2.0235,-.2711,.3426,-.0225,-1.9109,1.5062,.5385,-2.1912,.9544,1.4211,-.589,.2313,1.0839,.3228,.2275,-1.0463,-.4486,.4564,2.2575,-.5013,-.0671,-.244,-.8016,-1.1949,.8148,.9068,1.2055,.731,-1.5709,1.8658,.5163,-.2236,.0491,-1.2767,.4788,1.9467,.2928,-.1363,-.5991,-1.1556,-.5227,-.8668,.4713,.1909,2.9195,.6851,-.9594,.7199,-1.7968,-.625,1.6004,.5454,2.4666,-1.9142,.4566,.0964,.9415,1.0267,-.6691,-.9938,.5982,1.0205,-1.4207,-.7021,-.9092,.6787,.7425,-.2368,-.6293,-.8034,-.0844,-.2447,-.7029,-.9666,-2.4733,.9611,2.1824,-.0427,-1.0855,1.9336,-.3868,-.3252,1.5173,1.414,.0521,-1.174,-2.1557,1.1962,-1.3276,-.405,-.6456,1.6762,-.9678,.6527,1.3032,.6572,.5666,1.4999,-2.5976,.2579],alpha:[12.8705,12.3508,9.8092,12.0124,14.866,11.6407,10.8289,11.6774,11.8763,13.4486,11.4814,12.1886,12.7331,12.5823,13.0254,13.6832,12.3352,14.7705,10.9393,9.9072,12.6347,11.8719,11.8837,10.5497,12.3636,12.2325,11.5871,13.4403,13.675,12.3081,14.6339,12.6269,11.6718,13.2871,11.2523,11.8136,12.0924,13.2266,8.7868,11.3177,14.7934,13.6685,12.4426,12.2724,12.1017,10.7449,10.4558,13.3159,10.8145,12.0282,13.7869,14.5049,11.7412,12.1804,11.6865,12.9037,10.8512,13.1926,12.5282,10.9919,14.1523,12.6814,14.6177,11.8343,11.1683,12.6526,13.0452,13.4408,11.2587,12.1133,11.6362,12.4105,13.2759,12.7147,12.012,10.3708,10.8774,11.25,14.3405,12.7032,12.5284,10.0145,12.6309,11.7284,13.8488,13.1248,10.8431,11.6028,12.9067,14.3192,11.4659,12.3048,11.5976,12.8607,13.5079,12.7784,11.703,14.4923,11.927,12.9175,13.1335,11.8172,11.7006,12.204,12.5944,12.4196,14.8513,12.5845,12.0229,11.5426,10.5722,12.3686,13.0918,9.2102,10.2875,11.9442,11.5224,11.4021,10.7022,12.1078,13.0165,10.4863,9.9135,13.9972,10.9593,12.5185,12.459,13.7163]}},cause:{behavior:"Sleep Duration (hrs)",threshold:7.42,unit:"hours",direction:"below"},populationThreshold:{value:7.42,label:"Population Prior",variance:"Prior source: Spiegel et al. Lancet 1999; sleep restriction → cortisol"},outcome:{metric:"Cortisol",effect:"1.04 mcg/dL",direction:"negative"},certainty:.53,evidenceWeight:.05,evidence:{personalDays:452,personalWeight:.05,populationWeight:.95,stability:.56},dataSources:["autosleep","labs"],comparison:{before:{value:6.9,label:"Current"},after:{value:7.4,label:"Threshold (hours)"}},whyNow:"Current value (6.9) is below the threshold (7.4 hours).",actionable:!0,suggestedAction:"Threshold identified at 7.4 hours.",priority:2,status:"new",showWork:"Piecewise-linear model: cortisol_smoothed ~ f(sleep_duration_hrs) with changepoint at theta. Theta = 7.4 hours. Below theta: -1.041 per unit. Above theta: -0.049 per unit. Fitted on 452 data points (effective N = 2). Evidence split: 5% personal / 95% population. Prior source: Spiegel et al. Lancet 1999; sleep restriction → cortisol (evidence tier: meta-analysis/RCT)."},{id:"oron_insight_13",personaId:"oron",category:"sleep",variableType:"outcome",title:"Late Workouts Reduce Sleep Efficiency",headline:"Exercising closer to bedtime makes it harder to sleep well",summary:"Evening exercise raises core body temperature and sympathetic tone, delaying sleep onset. Finishing workouts earlier gives the body time to cool down and shift into parasympathetic mode.",recommendation:"Finish exercise before 7:45 PM; sleep efficiency drops steeply after.",explanation:"Late workouts elevate core temperature and sympathetic tone, delaying sleep onset. The effect intensifies above 19.7 hour (-2.02 % per unit vs -0.06 below).",causalParams:{source:"last_workout_end_hour",target:"sleep_efficiency_pct",curveType:"plateau_down",theta:{value:19.74,unit:"hour",low:17.57,high:21.92,displayValue:"7:44 PM"},betaBelow:{value:-.063,unit:"%",description:"-0.06 %/per hr later (stable)"},betaAbove:{value:-2.023,unit:"%",description:"-2.02 %/per hr later (sharp)"},observations:1181,completePct:100,changepointProb:.39,sizeCategory:"medium",currentValue:15.67,currentStatus:"below_threshold",posteriorSamples:{theta:[20.505,18.703,20.0955,19.1126,21.406,17.4744,20.5869,18.8259,21.1193,19.0307,20.1774,19.5221,20.3412,20.3822,21.2832,20.505,20.6688,18.4982,19.7269,20.8736,17.8839,21.4879,18.9897,18.9487,18.8259,20.5869,20.9146,19.4402,19.5631,20.5869,21.1603,20.0136,19.2354,19.3173,18.0887,19.9317,20.8327,20.0955,19.7269,19.1945,21.2422,20.3822,19.5631,19.1945,20.4231,19.7678,18.5392,23.3719,19.1535,19.9726,19.0307,19.2354,19.1535,19.1945,18.7849,18.1296,19.3583,19.5221,19.5631,18.7849,20.8736,20.1774,19.8497,20.7098,20.2183,20.0136,19.9726,19.1535,19.6859,20.7098,17.8839,19.9726,20.0136,20.1774,18.5392,19.7269,18.4982,21.6518,20.7508,20.7098,21.3241,16.4095,21.0374,21.2832,19.1945,18.9078,20.7098,19.604,21.5289,19.4402,20.4231,18.3344,20.7098,18.3754,21.406,21.0374,19.0307,19.8497,18.2935,21.1603,20.3822,24.15,18.6621,21.406,20.7098,20.1364,19.8088,20.0955,17.5972,20.3003,18.1706,20.3003,19.7269,19.8907,19.0716,19.3583,20.9146,20.0545,21.1193,19.2764,20.9555,21.0374,21.0784,19.8497,21.2832,18.703,19.5221,20.9555],betaBelow:[-.029,-.1287,-.4243,-.0622,-.1983,.1048,-.0262,.1203,-.3537,-.0428,.0413,-.0755,.0151,-.0364,-.3267,-.0799,-.0915,-.2168,-.0657,-.0891,-.169,.0108,-.1968,-.231,-.2522,-.1765,-.2647,-.0772,-.2157,-.14,-.0817,-.1916,-.1212,-.0397,-.0866,-.1288,-.1052,-.0329,-.1239,-.1297,-.3179,-.0576,-.1227,-.0937,-.1202,.0162,-.0303,-1.6709,-.1066,-.2284,-.0531,-.2953,-.1396,.0162,-.1801,.1395,-.2367,-.0931,-.086,-.078,-.1415,-.1608,-.2413,.0247,-.0129,.0292,-.3184,-.2713,2e-4,-.1031,-.1906,-.2095,-.0771,-.1442,.1366,-.1234,-.06,-.0738,-.1398,-.2161,-.3367,-.1821,-.1436,-.343,-.2027,-.2433,-.1795,-.2703,-.2586,-.265,-.1408,-.2534,-.1153,-.0711,-.1354,-.0618,-.1666,-.0281,-.1384,.0546,-.1542,1.8965,.2422,-.0849,-.2102,-.2978,.0042,-.1186,-.2472,-.0386,-.2634,.0605,-.2757,-.278,-.0619,-.2826,-.1543,-.1521,-.2438,-.2929,-.2677,.0069,-.143,-.2956,-.2601,.0532,-.0678,-.3063],betaAbove:[-3.0009,-1.2387,1.987,-1.0053,-2.3494,-3.4805,-10.1346,-2.2636,-4.8298,-3.9861,-6.1368,-.5948,-5.2001,-2.9523,3.5538,-1.5265,.1432,-.1148,-4.1624,1.0664,-2.6366,-2.389,-2.551,1.5632,-1.7996,-2.0878,-3.6806,-.1876,.0248,-3.0352,-5.6731,1.2787,-3.0675,-5.2714,-1.4399,-3.4778,-7.8735,-5.7034,-1.4082,-2.8064,-2.3956,-3.2781,-2.467,-1.7628,.1763,-5.6936,-.1027,9.1588,-2.3388,2.4745,-5.099,-.3255,-.5733,-3.0874,-3.1212,-4.0894,-1.4855,-3.5452,-1.618,-.4233,3.3109,2.4414,-2.6335,-2.3128,-3.3009,-4.8322,-3.4687,-1.5676,-4.537,-.3749,-.7021,-2.982,-3.5676,-5.3473,-3.0361,-3.2403,-2.7134,-15.4377,-3.7633,-3.0707,7.2621,-1.4782,-1.2749,6.4208,-1.3659,1.1613,-3.1161,-2.1923,4.8162,-2.0647,-.9464,-.2172,-.9259,-2.3963,5.0756,-.5787,-.5173,-.9841,-3.1274,-7.0652,-6.3852,-5.2249,-1.2139,-3.2465,-.0189,1.8786,-3.9096,-1.5477,.4537,-3.4815,-.9799,-6.4275,-.8443,.0687,-3.9097,-1.1703,-1.9438,-.9204,-3.7593,-2.7194,1.5878,-4.4294,-.5171,2.0245,1.3777,-3.2633,-1.97,-.0234],alpha:[91.7317,89.6865,83.7626,91.0347,88.0476,93.7725,91.3509,94.0978,85.0011,91.3604,92.8082,90.7804,92.9157,91.4915,85.4949,90.1544,90.0857,88.1764,91.2057,90.3589,89.3456,92.1836,88.439,88.001,87.0138,88.6106,86.7608,90.686,88.4204,88.9699,90.6803,88.2028,89.6995,90.9923,90.7717,89.079,89.9795,91.187,89.5817,88.8103,85.066,91.2062,89.8212,90.2141,90.044,92.7118,91.9725,90.0644,89.9938,87.276,91.0099,86.4346,89.2074,92.8466,88.416,94.7048,87.8879,90.2162,90.5942,90.2726,89.0415,88.8958,87.246,92.6577,91.8696,92.6652,85.4188,87.2661,92.3454,90.0008,88.8379,87.9734,90.6206,89.5253,94.0764,90.0406,90.9169,90.8042,89.3771,87.6335,84.4621,89.8166,89.1142,84.8558,88.4613,87.454,88.4495,86.6772,86.2211,87.062,89.1102,87.3123,89.2949,90.6993,88.9718,90.9554,89.1023,91.823,89.7276,93.4548,88.9179,82.1895,96.0195,90.0763,87.5257,86.1217,92.1425,89.3901,87.9882,91.7392,87.222,93.8973,85.7548,87.0145,91.0032,86.79,89.0942,89.2712,87.4318,86.3023,86.3487,92.1458,89.0342,86.2086,86.3961,93.1284,90.8002,85.678]}},cause:{behavior:"Workout End Time",threshold:19.74,unit:"hour",direction:"above"},populationThreshold:{value:19.74,label:"Population Prior",variance:"Prior source: Stutz et al., Sports Med 2019; Frimpong et al., Sleep Med Rev 2021"},outcome:{metric:"Sleep Efficiency",effect:"2.02 %",direction:"negative"},certainty:.73,evidenceWeight:.34,evidence:{personalDays:1181,personalWeight:.34,populationWeight:.66,stability:.39},dataSources:["autosleep","gpx"],comparison:{before:{value:15.7,label:"Current"},after:{value:19.7,label:"Threshold (hour)"}},whyNow:"Current value (15.7) is below the threshold (19.7 hour).",actionable:!0,suggestedAction:"Threshold identified at 7:44 PM.",priority:4,status:"new",showWork:"Piecewise-linear model: sleep_efficiency_pct ~ f(last_workout_end_hour) with changepoint at theta. Theta = 19.7 hour. Below theta: -0.063 per unit. Above theta: -2.023 per unit. Fitted on 1181 data points (effective N = 393). Evidence split: 34% personal / 66% population. Prior source: Stutz et al., Sports Med 2019; Frimpong et al., Sleep Med Rev 2021 (evidence tier: meta-analysis/RCT)."},{id:"oron_insight_66",personaId:"oron",category:"recovery",variableType:"load",title:"Travel Shifts Immune Balance",headline:"Travel load pushes NLR toward a pro-inflammatory state",summary:"Circadian disruption from travel raises neutrophil counts relative to lymphocytes, signaling immune stress that mirrors the response to sleep deprivation.",recommendation:"Jet lag linearly increases immune stress — no safe threshold.",explanation:"Travel stress and circadian disruption shift immune balance toward neutrophilia. The effect intensifies above 0.5 jet lag score (+0.02 ratio per unit vs +0.00 below).",causalParams:{source:"travel_load",target:"nlr",curveType:"linear",theta:{value:0,unit:"jet lag score",low:0,high:0,displayValue:"0"},betaBelow:{value:.003,unit:"ratio",description:"+0.00 ratio/per 0.2 load (stable)"},betaAbove:{value:.019,unit:"ratio",description:"+0.02 ratio/per 0.2 load (sharp)"},observations:611,completePct:55.5,changepointProb:.32,sizeCategory:"medium",currentValue:0,currentStatus:"below_threshold",posteriorSamples:{theta:[.5249,.254,.5746,.5912,.5138,.1601,.6133,.746,.3093,.7736,.7349,.8178,.3977,.9616,.7128,.6354,.4972,.1711,.547,.3314,.6299,.8565,.7128,.7681,.5525,.8234,.6188,.4972,.3535,.6078,.3425,.2927,.5857,.4751,.6907,.6962,.453,.3701,.8123,.5138,.4254,.7128,.5691,.2817,.558,.6078,.6465,.6631,.5802,.453,.4972,.641,.5691,.641,.2595,.4254,.3314,.7294,.7736,.8731,.3756,.5193,.5912,.7183,.558,.5359,.7626,.4033,.3148,.2817,.7515,.3756,.7018,.7239,.6299,.359,.5636,.4364,.5802,.5028,.4862,.9063,.652,.7073,.6078,.453,.3756,.547,.2817,.4254,.4917,.6023,.4143,.851,.3646,.2761,.8731,.4309,.3369,.1987,.4033,.5691,.6465,.3977,.757,.453,.6741,.4972,.5691,.2927,.8565,.4364,.3701,.4917,.4807,.7847,.4143,.3093,.6465,.3646,.7515,.5249,.3369,.1987,.5193,.5691,.7239,.5802],betaBelow:[-.0073,.0931,.0264,.025,.0272,.0335,-.0282,.0156,-.0409,-1e-4,-.0283,.0058,.0599,-.0096,.005,-.0408,.0077,.1422,-.014,.0252,.0056,.0055,.0087,.0215,.01,-.014,.008,-.0075,.0361,.0112,.0229,.0194,-.0395,.0489,.0126,.0099,-.0297,-.0042,.0149,-.0111,.008,.009,-.0228,.0245,-.0185,.0069,.0282,-.0122,-.0455,.0209,-.0106,.0334,-.0205,.0137,.0658,.038,-.0316,.0213,.001,.0192,.0221,.0402,.0067,.0319,.0101,.0024,.007,.0213,-.0264,-.0403,.0175,.048,-.008,.003,.0175,-.0338,-.0345,-.0331,.0308,-.0389,.0232,.0228,-.006,-.0059,5e-4,-.0109,.0694,.0039,.0783,.0317,-.0144,-.0144,-.0191,-.0366,-.0618,-.0082,.038,-.0064,-.0478,.0594,-.0043,.0176,-.0062,-.0411,.0166,.0179,.0353,.0169,.0071,.024,-.0031,.0348,-.0325,-.0032,-.0348,-.0078,-.0689,.056,.0188,-.0794,.0115,.0265,.0088,-.0775,.0246,.0049,.0038,.021],betaAbove:[-.0096,-.006,-.0317,-.0567,-.0392,.0347,.0494,-.0367,.0559,.0086,.1476,.0747,-.0311,.1,.0626,.1925,.0162,-.0365,.0142,-.0216,.0305,.0154,.0774,-.0041,-.0191,.2012,-.0284,-.0109,-.0125,.0053,.0199,.0286,.0615,-.0284,.0549,-.0744,.0876,-2e-4,-.0197,.0095,-.0228,.0208,.0532,.0073,.101,.0245,-.0386,-.0249,.1207,.0026,.0273,-.0177,.0467,.019,-.0436,.0133,.0594,.0569,.1803,-.0426,-.0163,-.0429,.0568,-.1082,.0255,.0153,-.0305,.0064,.004,.0096,-.0086,.0076,.038,.0793,-4e-4,.0717,.0994,.0761,-.0627,.0286,-.0086,.0145,.0125,-.009,.0161,.0096,-.0152,.0046,-.0315,-.0209,-.0166,.0594,.0163,.1239,.0352,-.0016,.0265,.0404,.0731,-.0157,.001,-.0033,.044,.0486,-.0775,-.0112,-.1287,.0049,.006,.0077,-.0196,-.0025,.0598,.0262,.0521,.0029,.1063,.0053,-.031,.0533,.0791,-.0339,-.0295,.0353,-.0124,.0617,-.0053,.0252],alpha:[1.4116,1.4332,1.4278,1.4341,1.4251,1.4171,1.4013,1.4221,1.4067,1.4175,1.3941,1.4209,1.4364,1.4046,1.4188,1.3933,1.4208,1.4411,1.412,1.4258,1.4199,1.4217,1.4241,1.4298,1.4146,1.4042,1.4233,1.4151,1.4252,1.4276,1.4233,1.4215,1.398,1.4348,1.4222,1.4195,1.3982,1.4131,1.427,1.4096,1.42,1.4193,1.402,1.4215,1.405,1.4235,1.4334,1.4115,1.3913,1.429,1.4109,1.4349,1.4053,1.4169,1.4331,1.43,1.4055,1.4223,1.4087,1.4288,1.4215,1.4347,1.4162,1.4314,1.4157,1.4217,1.4169,1.4161,1.4031,1.4069,1.4282,1.4327,1.4133,1.4181,1.43,1.3988,1.3971,1.4016,1.4287,1.3996,1.4254,1.4289,1.4178,1.41,1.4172,1.4069,1.4385,1.4168,1.4364,1.4285,1.406,1.4034,1.4077,1.39,1.3948,1.4145,1.447,1.4095,1.3978,1.428,1.4141,1.4247,1.4123,1.4008,1.4272,1.4182,1.4328,1.4272,1.4198,1.4247,1.4111,1.4255,1.4012,1.4119,1.4011,1.4124,1.389,1.4337,1.4223,1.3885,1.4229,1.4317,1.4244,1.3996,1.4262,1.4178,1.4211,1.4292]}},cause:{behavior:"Travel Load",threshold:.54,unit:"jet lag score",direction:"above"},populationThreshold:{value:.54,label:"Population Prior",variance:"Prior source: Morris et al. PNAS 2016; circadian disruption immune shift"},outcome:{metric:"NLR",effect:"0.02 ratio",direction:"positive"},certainty:.73,evidenceWeight:.99,evidence:{personalDays:611,personalWeight:.99,populationWeight:.01,stability:.32},dataSources:["derived","labs"],comparison:{before:{value:0,label:"Current"},after:{value:.5,label:"Threshold (jet lag score)"}},whyNow:"Threshold identified at 0.5 jet lag score from available data.",actionable:!0,suggestedAction:"Threshold identified at 0.5 jet lag score.",priority:4,status:"new",showWork:"Piecewise-linear model: nlr ~ f(travel_load) with changepoint at theta. Theta = 0.5 jet lag score. Below theta: +0.003 per unit. Above theta: +0.019 per unit. Fitted on 611 data points (effective N = 87). Evidence split: 99% personal / 1% population. Prior source: Morris et al. PNAS 2016; circadian disruption immune shift (evidence tier: observational)."},{id:"oron_insight_16",personaId:"oron",category:"recovery",variableType:"outcome",title:"Sleep Duration Boosts Next-Day HRV",headline:"More sleep translates to higher heart-rate variability the following day",summary:"Adequate sleep restores parasympathetic tone, raising HRV. Each additional hour of sleep provides a measurable benefit up to ~7 hours, with diminishing returns beyond.",recommendation:"Aim for 7+ hours. Returns diminish past the threshold but more sleep does not hurt.",explanation:'Adequate sleep restores parasympathetic tone; insufficient sleep elevates sympathetic activity. Below ~7 hours, each extra hour adds ~0.12 ms HRV. Above 7 hours, benefits flatten to ~0.08 ms per hour (diminishing returns, not a decline). The prior reflects that observational "U-shapes" in sleep data are driven by reverse causation (illness → long sleep + low HRV), not a causal penalty for sleeping more.',causalParams:{source:"sleep_duration_hrs",target:"hrv_daily_mean",curveType:"plateau_up",theta:{value:6.98,unit:"hours",low:5.54,high:8.42,displayValue:"7.0 hours"},betaBelow:{value:.116,unit:"ms",description:"+0.12 ms/per hr"},betaAbove:{value:.078,unit:"ms",description:"+0.08 ms/per hr (diminishing)"},observations:2204,completePct:100,changepointProb:.51,sizeCategory:"small",currentValue:7.47,currentStatus:"above_threshold",posteriorSamples:{theta:[6.9156,7.7598,6.2884,7.6633,6.9879,6.9638,6.5055,5.8302,5.0342,6.1196,6.6261,6.9156,6.8432,6.4332,6.4573,5.2513,6.2884,8.1216,5.5889,7.0844,7.9528,6.3126,6.6261,7.6633,6.3849,6.192,6.602,6.2402,6.0955,6.8673,7.0603,7.591,6.1196,7.3739,6.9156,7.9528,7.3015,5.8543,6.4573,5.7578,7.6874,7.1085,7.205,5.7095,6.7226,6.8673,7.7116,7.6633,7.2291,7.3739,7.2291,7.1568,6.0472,6.6744,5.8543,6.1437,7.1568,6.0231,6.9397,6.795,5.7337,7.3015,5.9508,7.3015,6.3849,5.7095,8.2181,6.5296,6.1678,6.192,5.5166,7.2533,5.8784,6.2884,8.3387,6.7467,6.6503,6.8432,6.9638,6.5296,6.0955,7.4221,7.4945,5.8302,6.8673,6.5055,6.8915,7.0362,6.8915,6.7226,7.7598,6.6503,6.8191,4.9377,6.2161,7.2533,5.5407,4.8412,6.4814,7.0844,7.6151,6.3849,6.4332,7.4945,6.1437,8.1216,5.806,7.5427,7.0362,7.4221,6.2161,7.591,5.7095,7.9769,6.1678,6.3126,6.3126,8.1457,8.2422,6.1437,5.5889,6.9397,6.6985,7.5186,7.3015,7.808,6.8191,7.6392],betaBelow:[.1239,-5e-4,.3443,.2463,.0436,.0295,.1816,.2504,-.1142,.4082,.3816,.1401,.2245,.1636,.4269,.1347,.2775,.0132,-.1033,-.2549,.126,.144,-.1025,.1137,.3355,.3073,.4377,.1945,.4849,.1694,.0019,-.0346,-.0081,.0229,-.2675,-.1914,.192,.0875,.1365,.2052,.0236,.0221,.1557,.3693,.176,.0087,-.0213,-.1437,-.0285,-.0104,.0053,.1271,.1358,.0077,.0587,.1911,.0498,.1624,-.0057,-.0693,.0124,-.0742,-.1058,-.0444,.1532,-.054,.0593,.2223,.2555,.1287,-.2077,-.2092,.9049,.1245,.2006,.2003,.7476,.213,.4775,.0735,-.1618,.1385,-.0739,.1783,.245,.0212,.3008,.2311,.0709,.1171,-.1035,-.0676,.3032,-.2777,.5169,-.0824,.2222,.4867,.453,.0638,-.0831,.3241,.4143,-.1206,-.2121,-.1913,.2407,-.1751,.0138,.0559,-5e-4,-.0745,.5684,-.1247,-.0645,.2598,.1908,.1272,-.2733,.1047,.0443,.2082,.1404,.055,.0246,.168,.3275,.0851],betaAbove:[.0831,.0584,.0935,.0635,.0612,.0724,.0669,.1142,.0888,.054,.0717,.0702,.0614,.0679,.0527,.1135,.0522,.055,.0975,.1156,.0628,.0567,.074,.0674,.0585,.0645,.0614,.0707,.0573,.0658,.0553,.0742,.0845,.0787,.084,.0585,.0564,.0666,.0632,.0524,.0795,.0734,.0527,.059,.0545,.0607,.0635,.0531,.0516,.0543,.0675,.0626,.0602,.0713,.0742,.0496,.0617,.0745,.0587,.0556,.0792,.0731,.0732,.0814,.0635,.0746,.0669,.0526,.0733,.0621,.0619,.0607,.0625,.0852,.062,.0627,.0664,.0548,.0663,.0715,.0614,.0623,.0478,.0678,.056,.0611,.0519,.054,.0546,.0835,.0569,.0656,.0651,.0786,.0542,.0522,.0532,.0783,.0688,.0549,.0569,.074,.0477,.0634,.0737,.0641,.0571,.0705,.0636,.0654,.0734,.0555,.0699,.0801,.0858,.072,.0615,.0506,.0684,.0671,.0807,.063,.0772,.0579,.0695,.0627,.0555,.0711],alpha:[35.8695,35.5573,35.6097,35.4854,35.5682,35.0597,35.4497,35.4773,35.7383,36.0144,35.8882,35.3785,35.7143,35.546,35.921,35.4871,35.9588,35.4202,35.4911,35.2569,35.5947,35.8104,35.2803,35.6273,35.8403,35.6379,35.976,35.5702,35.9,35.6474,35.5427,35.2514,35.4481,35.4947,35.3882,35.1457,35.655,35.9049,35.4666,36.1508,35.2902,35.3608,35.8157,36.234,35.7921,35.6431,35.3942,35.4003,35.4839,35.2112,35.5081,35.2895,35.7037,35.4398,35.4564,36.066,35.577,35.8484,35.5395,35.9295,35.7393,35.1934,35.416,35.3773,36.0505,35.7426,35.3353,35.7122,35.5887,35.7704,35.8718,35.5118,36.5221,35.8551,35.7367,35.6528,35.7215,35.9981,35.6734,35.7036,35.8715,35.6957,35.5553,36.1439,35.6803,35.3533,35.6984,35.7207,35.6557,35.4382,35.206,35.25,35.5126,35.5307,35.6645,35.5246,36.1043,35.7526,35.6971,35.7051,35.596,35.6272,35.7417,35.0056,35.1915,35.2564,35.9542,35.3103,35.2727,35.518,35.5266,35.3372,35.9618,35.4076,35.129,35.4722,35.5529,35.4241,34.8672,35.6315,35.3765,35.6214,35.3564,35.5168,35.5969,35.6559,35.7037,35.6044]}},cause:{behavior:"Sleep Duration (hrs)",threshold:6.98,unit:"hours",direction:"above"},populationThreshold:{value:7,label:"Population Prior",variance:"Prior source: Zhang et al., Front Neurol 2025 (meta-analysis); Lastella et al. 2015. Tightened beta_above prior (σ=0.2) to resist confounded U-shape from reverse causation."},outcome:{metric:"HRV (daily)",effect:"0.08 ms",direction:"positive"},certainty:.96,evidenceWeight:.99,evidence:{personalDays:2204,personalWeight:.99,populationWeight:.01,stability:.51},dataSources:["apple_health","autosleep"],comparison:{before:{value:7.5,label:"Current"},after:{value:7,label:"Threshold"}},whyNow:"Current value (7.5) is above the threshold (7.0 hours) — in the diminishing-returns zone, but still beneficial.",actionable:!0,suggestedAction:"Aim for 7+ hours. Returns diminish past the threshold but more sleep does not hurt.",priority:6,status:"new",showWork:"Piecewise-linear model: hrv_daily_mean ~ f(sleep_duration_hrs) with changepoint at theta. Theta = 7.0 hours. Below theta: +0.116 per unit. Above theta: +0.078 per unit (prior-regularized: beta_above ~ N(0.5, 0.2), preventing confounded U-shape from reverse causation where illness causes both long sleep and low HRV). Fitted on 2204 data points (effective N = 734). Evidence split: 99% personal / 1% population. Prior source: Zhang et al., Front Neurol 2025 (meta-analysis); Lastella et al. 2015 (evidence tier: meta-analysis/RCT)."},{id:"oron_insight_12",personaId:"oron",category:"metabolic",variableType:"marker",title:"Ferritin Supports Aerobic Capacity",headline:"Higher ferritin stores are linked to better VO2peak values",summary:"Ferritin reflects iron availability for hemoglobin synthesis and mitochondrial enzymes. Below ~47 ng/mL, oxygen-carrying capacity declines, limiting aerobic performance.",recommendation:"Ferritin above 35.6 ng/mL still helps VO2peak but with diminishing returns.",explanation:"Iron stores limit oxygen transport capacity via hemoglobin synthesis.",causalParams:{source:"ferritin_smoothed",target:"vo2_peak_smoothed",curveType:"plateau_up",theta:{value:35.65,unit:"ng/mL",low:27.44,high:43.86,displayValue:"35.6 ng/mL"},betaBelow:{value:.23,unit:"ml/min/kg",description:"+0.23 ml/min/kg/per 10 ng/mL"},betaAbove:{value:.122,unit:"ml/min/kg",description:"+0.12 ml/min/kg/per 10 ng/mL"},observations:452,completePct:41.1,changepointProb:.5,sizeCategory:"medium",currentValue:46,currentStatus:"above_threshold",posteriorSamples:{theta:[36.5201,39.8035,40.0467,35.7905,33.4799,31.7774,41.0196,42.3573,32.507,36.3985,36.2769,29.8317,22.9,36.1553,30.5613,39.3171,34.9392,41.2628,33.6015,35.1824,37.0065,35.7905,33.8447,39.0739,37.2497,26.0618,31.4126,35.7905,34.696,37.8578,34.4528,39.3171,26.305,35.1824,39.4387,40.898,32.1422,25.2106,39.8035,31.291,39.6819,31.899,35.7905,41.0196,40.5332,34.0879,38.9523,35.7905,39.3171,35.1824,37.0065,41.9925,31.4126,32.507,39.3171,32.1422,32.1422,40.1683,25.0889,33.4799,29.8317,34.4528,37.493,34.2095,32.1422,32.507,32.9935,41.0196,35.304,25.697,34.696,30.3181,35.7905,35.6688,25.5754,37.6146,35.304,38.709,34.8176,40.1683,35.0608,36.0337,25.697,38.709,28.8588,34.8176,34.3312,39.9251,29.2236,36.6417,32.7503,34.8176,35.304,34.0879,32.3854,34.4528,37.493,35.304,32.9935,35.4256,34.0879,34.2095,34.5744,37.3714,35.9121,38.4658,37.493,32.7503,29.8317,36.7633,26.305,31.899,33.8447,32.3854,40.898,39.8035,36.0337,37.8578,31.4126,30.8045,37.3714,33.6015,33.9663,27.8859,33.2367,32.2638,41.1412,31.5342],betaBelow:[.226,.2113,.2205,.2229,.239,.1649,.2425,.2199,.2163,.2608,.2303,.2276,.6091,.2515,.2154,.229,.245,.2416,.2306,.2263,.2127,.2501,.2169,.2085,.2289,.1649,.2201,.2269,.2312,.2234,.2415,.2397,.251,.2387,.2191,.2263,.2502,.9464,.2301,.1722,.2174,.2046,.238,.2304,.2199,.2361,.2287,.2337,.2182,.2374,.2343,.2288,.2138,.2345,.2279,.2213,.2089,.2192,.8423,.2335,.2171,.2564,.2255,.237,.2063,.2654,.2081,.2102,.2258,.4076,.2387,.1949,.2221,.2274,.5363,.2077,.2466,.2129,.2291,.2238,.2477,.237,.4673,.2189,.2067,.2312,.2085,.2165,.1561,.2427,.229,.2406,.2378,.2417,.2155,.2089,.2306,.2302,.1961,.2389,.2328,.2114,.2584,.2192,.2332,.2233,.2202,.2339,.1918,.2256,.3156,.2316,.2313,.222,.2273,.226,.2385,.2263,.2137,.227,.2249,.209,.2161,.1682,.2395,.2092,.2147,.2286],betaAbove:[.1356,.0917,.0805,.1544,.1591,.1805,.0035,-.0179,.1741,.1049,.1328,.1776,-.6406,.1182,.1768,.0799,.1345,.0173,.1654,.1527,.1363,.1238,.1568,.1371,.1298,.1787,.1721,.1555,.1478,.126,.1414,.0945,.1817,.1481,.1043,.0412,.1559,.1794,.0847,.1836,.0934,.1692,.1365,.0349,.0678,.16,.1062,.1357,.1171,.1392,.1365,-.0194,.1782,.1701,.0941,.1726,.1759,.0655,.182,.1661,.1765,.1441,.1208,.154,.1731,.1597,.1871,.0831,.1506,.172,.1467,.1755,.1388,.1476,.1849,.144,.1331,.1229,.1473,.0839,.1473,.1268,.1789,.1205,.1867,.1525,.1575,.1042,.1901,.1252,.1626,.1369,.1467,.1589,.1608,.1664,.1117,.1707,.1806,.1304,.149,.1691,.1444,.1296,.1375,.1339,.12,.1699,.177,.1251,.1832,.1697,.156,.1709,.0203,.1001,.1332,.1154,.1684,.1846,.1394,.157,.1574,.1846,.1583,.1709,.0538,.1701],alpha:[63.4334,64.0709,64.1053,63.1945,62.8291,62.2781,64.512,64.5817,62.5099,63.5747,63.3967,61.9629,60,63.4448,62.1573,64.0314,63.2131,64.4973,62.6941,63.0806,63.4413,63.3819,62.8897,63.8346,63.6406,61.2259,62.2775,63.2375,63.054,63.6836,63.0454,64.0449,61.3434,63.1468,64.0096,64.3076,62.5886,61.1025,64.1528,62.0986,64.0074,62.4309,63.3582,64.4135,64.219,62.8522,63.9169,63.3074,63.891,63.2238,63.5471,64.5564,62.3156,62.5114,64.0069,62.4272,62.4478,64.1942,61.1066,62.7528,62.0288,63.0694,63.589,62.9644,62.3886,62.7105,62.4809,64.2095,63.1311,61.3087,63.0369,62.0738,63.2774,63.2311,61.0696,63.5325,63.2359,63.7856,63.1461,64.1046,63.1659,63.3679,61.1688,63.7861,61.6887,63.0825,62.871,64.0345,61.7039,63.5473,62.6756,63.1491,63.1817,62.9608,62.6331,62.8788,63.6954,63.073,62.5845,63.3319,62.9465,62.8032,63.0839,63.6259,63.3376,63.7089,63.6227,62.5571,61.9666,63.4815,61.2507,62.3859,62.8618,62.5036,64.38,64.0679,63.3981,63.6922,62.3316,62.1005,63.6465,62.7807,62.8431,61.5,62.7783,62.4373,64.3103,62.3501]}},cause:{behavior:"Ferritin",threshold:35.65,unit:"ng/mL",direction:"below"},populationThreshold:{value:35.65,label:"Population Prior",variance:"Prior source: DellaValle & Haas, MSSE 2014"},outcome:{metric:"VO2peak",effect:"0.23 ml/min/kg",direction:"positive"},certainty:.55,evidenceWeight:.15,evidence:{personalDays:452,personalWeight:.15,populationWeight:.85,stability:.5},dataSources:["labs"],comparison:{before:{value:46,label:"Current"},after:{value:35.6,label:"Threshold (ng/mL)"}},whyNow:"Current value (46.0) is above the threshold (35.6 ng/mL).",actionable:!0,suggestedAction:"Threshold identified at 35.6 ng/mL.",priority:4,status:"new",showWork:"Piecewise-linear model: vo2_peak_smoothed ~ f(ferritin_smoothed) with changepoint at theta. Theta = 35.6 ng/mL. Below theta: +0.230 per unit. Above theta: +0.122 per unit. Fitted on 452 data points (effective N = 20). Evidence split: 15% personal / 85% population. Prior source: DellaValle & Haas, MSSE 2014 (evidence tier: observational)."},{id:"oron_insight_21",personaId:"oron",category:"sleep",variableType:"outcome",title:"Active Energy Increases Deep Sleep",headline:"Higher daily energy expenditure drives more deep sleep at night",summary:"Physical activity increases adenosine accumulation and raises sleep pressure, resulting in more slow-wave sleep. The effect scales linearly with total active energy burned.",recommendation:"More active energy linearly increases deep sleep — no threshold.",explanation:"Physical activity increases slow-wave sleep need via adenosine accumulation and thermoregulation.",causalParams:{source:"active_energy_kcal",target:"deep_sleep_min",curveType:"linear",theta:{value:0,unit:"kcal",low:0,high:0,displayValue:"0"},betaBelow:{value:.004,unit:"min",description:"+0.00 min/per 100 kcal"},betaAbove:{value:.008,unit:"min",description:"+0.01 min/per 100 kcal"},observations:1136,completePct:100,changepointProb:.19,sizeCategory:"small",currentValue:1101.81,currentStatus:"above_threshold",posteriorSamples:{theta:[330.402,511.3065,737.4372,674.1206,506.7839,588.191,624.3719,805.2764,637.9397,380.1508,705.7789,529.397,574.6231,425.3769,253.5176,520.3518,633.4171,484.1709,411.809,475.1256,547.4874,307.7889,769.0955,416.3317,289.6985,751.005,294.2211,407.2864,384.6734,836.9347,615.3266,497.7387,190.201,362.0603,457.0352,597.2362,778.1407,420.8543,533.9196,375.6281,529.397,362.0603,719.3467,588.191,393.7186,538.4422,353.0151,533.9196,475.1256,674.1206,443.4673,466.0804,199.2462,488.6935,479.6482,552.0101,732.9146,769.0955,583.6683,362.0603,253.5176,425.3769,520.3518,524.8744,552.0101,719.3467,764.5729,556.5327,307.7889,248.995,538.4422,443.4673,416.3317,524.8744,475.1256,809.799,470.603,533.9196,529.397,710.3015,778.1407,235.4271,615.3266,176.6332,556.5327,366.5829,221.8593,457.0352,457.0352,258.0402,515.8291,239.9497,416.3317,493.2161,163.0653,619.8492,619.8492,732.9146,452.5126,230.9045,493.2161,371.1055,592.7136,343.9698,303.2663,298.7437,334.9246,760.0503,411.809,389.196,692.2111,524.8744,524.8744,267.0854,606.2814,294.2211,574.6231,402.7638,642.4623,294.2211,502.2613,289.6985,443.4673,484.1709,637.9397,610.804,307.7889,185.6784],betaBelow:[-.0168,.0048,-.0016,7e-4,-.0125,.0076,-.0066,-.0216,-.0103,-.0047,.0082,-.0148,.0173,-.0428,.0887,.0154,.0023,8e-4,-.0195,.0197,.0137,-.0144,.0124,.017,-.0761,-.0124,-.0487,.0203,.0202,.0127,.0112,.0023,-.1682,.0307,-.0046,.0213,.0027,-.0323,.0016,-.0023,.0025,.0574,.0108,-.006,.0243,.0345,-.003,.0123,.0271,-.0045,.0148,-.0078,.1135,.0401,.0231,-.0179,.0294,-4e-4,-.0201,.0533,.1186,.0465,-.0095,.0071,-.0203,.02,.0072,.0162,.0252,-.0539,-.007,.0194,.0128,-.0029,-.0119,.011,.0028,.0126,-.0272,9e-4,-4e-4,.0015,.0255,-.0962,.0095,-.0375,.2394,.0017,.0031,-.0179,.0348,-.0624,.0315,.0128,.1066,.0123,.0213,.0083,.0029,-.1491,-.0218,.0296,.0155,.042,.0938,.0534,-.0282,-.012,.0421,.0079,.0189,.0141,-.0019,.0254,-.0036,.0544,0,-.0077,-.0163,.0272,.016,-.0235,-.0433,.0115,-.0063,-5e-4,-.069,-.2043],betaAbove:[.0083,.0085,.0127,.0063,.0091,.0155,.007,.0155,.013,.0103,.0119,.0092,.011,.009,.0086,.0047,.0079,.0089,.0056,.0016,.0072,.0086,.0045,.0053,.0076,.0127,.0058,.0075,.0072,.0117,.0091,.0081,.0071,.0088,.008,.0024,.0065,.0129,.0081,.0071,.0091,.0095,.0088,.0073,.0057,.006,.011,.0057,.0047,.016,.0102,.0071,.0091,.0074,.0065,.0074,.0049,.0122,.0108,.006,.0084,.0087,.0067,.0069,.0121,.0041,.0078,.0109,.0059,.009,.0103,.0066,.005,.0118,.0154,.0042,.005,.0075,.0092,.0084,.0124,.0091,.0046,.0098,.0074,.0072,.004,.0097,.0099,.0022,.0041,.0075,.0017,.0071,.0091,.005,.0034,.0021,.0072,.0097,.0094,.0102,.0082,.0058,.0036,.0046,.0106,.0153,.0088,.0061,.0078,.0072,.0094,.0084,.0135,.0059,.017,.0034,.0121,.0083,.0013,.0037,.0073,.0135,.0112,.0131,.0085,.0048],alpha:[89.9926,92.598,91.0511,94.4711,93.929,93.5711,94.5524,88.1162,89.7769,92.5743,94.5443,91.7261,92.5854,91.7539,90.8234,93.4593,92.9639,90.9524,93.9007,94.4861,94.8527,92.3302,98.4288,94.6389,93.2536,91.9864,91.7509,93.818,93.9635,94.3532,94.8108,90.455,90.6401,89.721,91.8908,98.0257,94.7556,88.0466,91.8272,90.6584,90.2409,92.4646,94.5016,90.2785,93.012,95.8313,89.7882,94.0097,94.5533,89.7166,90.6006,92.7126,89.5043,96.3619,95.0739,91.7984,102.7832,91.7777,90.6056,91.4527,91.8093,94.7284,92.7626,93.0943,90.6116,100.2907,94.238,94.4587,93.1117,89.9139,92.9931,92.7403,93.2668,90.1039,88.3152,96.5686,93.8208,94.5292,88.5685,91.0985,92.5404,90.9846,98.2209,87.4911,93.0328,89.2562,93.4112,93.7546,91.7554,93.4178,97.598,92.8942,96.4545,92.7708,89.7008,94.0352,95.2126,97.0986,93.8183,89.8565,90.8213,92.4867,95.6738,92.8259,91.8825,91.6877,90.5417,89.4641,92.271,93.5896,95.0855,92.9849,92.6297,91.0372,90.9719,93.2334,88.8027,93.2698,87.5874,92.8112,96.5344,94.8998,88.8959,91.1794,92.5972,90.2247,89.2556,95.0777]}},cause:{behavior:"Active Energy (kcal)",threshold:503.38,unit:"kcal",direction:"above"},populationThreshold:{value:503.38,label:"Population Prior",variance:"Prior source: Kline, Am J Lifestyle Med 2014; Stutz et al., Sports Med 2019"},outcome:{metric:"Deep Sleep (min)",effect:"0.01 min",direction:"positive"},certainty:.79,evidenceWeight:.32,evidence:{personalDays:1136,personalWeight:.32,populationWeight:.68,stability:.19},dataSources:["apple_health","autosleep"],comparison:{before:{value:1101.8,label:"Current"},after:{value:503.4,label:"Threshold (kcal)"}},whyNow:"Current value (1101.8) is above the threshold (503.4 kcal).",actionable:!0,suggestedAction:"Threshold identified at 503.4 kcal.",priority:6,status:"new",showWork:"Piecewise-linear model: deep_sleep_min ~ f(active_energy_kcal) with changepoint at theta. Theta = 503.4 kcal. Below theta: +0.004 per unit. Above theta: +0.008 per unit. Fitted on 1136 data points (effective N = 378). Evidence split: 32% personal / 68% population. Prior source: Kline, Am J Lifestyle Med 2014; Stutz et al., Sports Med 2019 (evidence tier: meta-analysis/RCT)."},{id:"oron_insight_27",personaId:"oron",category:"recovery",variableType:"load",title:"Weekly Mileage Shapes HRV Baseline",headline:"Consistent weekly running volume improves your 7-day HRV trend",summary:"Chronic aerobic training enhances vagal tone and parasympathetic function. The benefit plateaus around 26 km/week — beyond that, additional volume yields diminishing HRV returns.",recommendation:"Sweet spot near 25.9 km/week. Both too little and too much are suboptimal.",explanation:"Moderate volume improves vagal tone; excessive volume suppresses it via overtraining. Most of the effect occurs below 25.9 km/week (+0.18 ms per unit), with diminishing returns above.",causalParams:{source:"daily_run_km",target:"hrv_7d_mean",curveType:"v_max",theta:{value:25.92,unit:"km/week",low:11.56,high:40.28,displayValue:"25.9 km/week"},betaBelow:{value:.177,unit:"ms",description:"+0.18 ms/per 10 km/wk (strong)"},betaAbove:{value:-.008,unit:"ms",description:"-0.01 ms/per 10 km/wk (diminishing)"},observations:2401,completePct:100,changepointProb:.47,sizeCategory:"small",currentValue:0,currentStatus:"below_optimal",posteriorSamples:{theta:[17.3635,22.5149,16.6766,15.6463,20.4543,25.9492,15.9897,21.1412,17.02,21.8281,21.4846,20.7978,20.4543,17.7069,24.9189,27.3229,29.0401,37.6258,23.2018,21.1412,29.0401,32.4744,22.1715,34.5349,35.5652,21.1412,23.5452,18.0503,13.5857,53.4236,20.7978,22.5149,26.9795,24.9189,21.4846,32.4744,25.2623,26.6361,31.1007,23.2018,22.1715,29.3835,20.1109,27.6664,30.0704,19.0806,18.3938,27.6664,27.6664,28.0098,34.1915,35.2218,41.747,24.5755,23.5452,20.7978,30.0704,19.7675,26.2926,31.4441,23.5452,27.3229,13.2423,34.5349,23.8886,30.7572,23.5452,25.6058,23.5452,21.8281,16.6766,19.0806,11.8686,24.2321,34.8784,17.7069,20.1109,18.7372,24.5755,25.2623,15.9897,23.2018,25.2623,31.1007,35.9087,24.9189,26.6361,21.4846,37.9692,28.6966,45.1813,38.9995,13.5857,21.8281,23.8886,13.5857,24.2321,10.4949,31.1007,19.7675,29.7269,17.02,23.8886,31.1007,43.4641,28.3532,36.2521,18.3938,30.7572,22.1715,27.3229,35.9087,14.9595,20.4543,17.7069,33.5047,26.9795,32.8178,24.5755,36.939,35.5652,25.2623,24.2321,18.3938,30.0704,20.7978,39.343,20.1109],betaBelow:[.2172,.1759,.2416,.2485,.2062,.1705,.24,.1888,.2439,.1948,.1833,.1905,.2145,.2352,.1671,.1644,.1556,.1271,.1933,.1899,.1467,.1493,.1876,.1442,.1337,.185,.1878,.2234,.253,.1017,.1902,.1953,.1487,.1653,.1813,.1364,.1708,.1708,.1576,.1998,.1787,.1622,.1937,.1651,.1529,.1999,.2059,.162,.162,.1637,.1341,.1443,.125,.1709,.1675,.1891,.1534,.211,.1777,.1516,.188,.1586,.2671,.145,.1726,.1463,.1731,.1728,.1754,.1828,.2204,.214,.2984,.191,.1358,.2332,.2145,.2175,.1778,.1614,.2329,.1745,.1767,.1478,.138,.1755,.1597,.2041,.1195,.1536,.1121,.115,.2707,.1848,.1793,.2288,.1668,.2849,.1594,.2071,.1451,.2642,.1716,.1532,.1213,.1543,.1313,.214,.1494,.1973,.1599,.1278,.2371,.2017,.2298,.1424,.1657,.14,.1702,.128,.1372,.1743,.1719,.2169,.162,.1957,.1255,.1948],betaAbove:[.023,.0236,.012,.0224,.0062,-.0065,.0162,.0113,-.0026,.0162,.0179,.004,-.004,.0114,.0017,.0045,-.0054,-.0284,-6e-4,.013,.0039,-.0338,.0084,-.0405,-.0116,.0151,-.0154,.0066,.0227,-.0984,.0114,-.0011,.0148,.0104,.0159,-.0264,9e-4,-.0144,-.0408,-.0065,.0186,-.0233,.0088,-.0069,-.0221,.0082,.022,.007,-.0228,-.0117,-.0295,-.0425,-.0898,-6e-4,.019,.0096,-.0168,.0139,-.0205,-.0072,-.0029,-.0223,.0224,-.0389,.0075,-.0403,-8e-4,-.0061,.003,.0074,.0273,.0107,.0282,-.013,-.0334,.0122,-.0011,.0121,.0022,.0096,.0107,.0101,-6e-4,-.0442,-.05,-5e-4,-.0014,-.0106,-.0224,-.0153,-.0655,-.0195,.0209,1e-4,-.0065,.0373,.0163,.0418,-.041,.0109,-.006,.0039,.0065,-.0273,-.0958,-.01,-.0404,.0182,-.0145,-.0106,-.002,-.0306,.0228,-.0031,.0091,-.0199,-.0026,-.0109,.0141,-.0063,-.0597,-.0086,-.0096,.0084,-.0155,.0163,-.0855,.0094],alpha:[36.6775,37.0275,36.9892,36.8614,37.1749,37.4599,36.7938,37.0308,37.0148,37.0887,36.9745,37.1592,37.4577,37.1143,37.253,37.6226,37.4815,37.9097,37.4581,36.9699,37.3137,38.0266,37.2054,37.9451,37.7525,37.0346,37.4736,37.0566,36.5621,38.6343,37.0685,37.3174,37.1624,37.344,36.9658,37.5241,37.294,37.5381,37.898,37.5592,36.9756,37.816,37.0042,37.5215,37.8032,36.8029,36.7928,37.5476,37.6044,37.5364,37.6821,38.1832,38.4406,37.3222,36.9949,36.9874,37.6908,37.2418,37.7867,37.8338,37.2493,37.4853,36.5913,38.0221,37.3318,37.706,37.2309,37.5399,37.2086,37.0478,36.6566,37.1871,36.5048,37.7227,37.8584,37.0869,37.4828,37.0583,37.2932,37.1093,36.8013,37.0745,37.4651,37.7988,38.138,37.4869,37.4464,37.4859,37.8074,37.4102,38.2703,37.8312,36.6923,37.1495,37.438,36.1681,37.1662,36.0678,37.8412,36.9549,37.3805,37.2877,37.0667,37.7557,38.4976,37.5244,37.8514,36.856,37.5253,37.5008,37.506,37.74,36.6542,37.157,37.0126,37.8443,37.4235,37.6955,37.1477,37.8296,37.9922,37.4343,37.2963,37.0033,37.8212,37.0834,38.0499,36.9393]}},cause:{behavior:"Daily Running (km)",threshold:25.92,unit:"km/week",direction:"below"},populationThreshold:{value:25.92,label:"Population Prior",variance:"Prior source: Plews et al., Sports Med 2013; Buchheit 2014; trained male CV narrowing"},outcome:{metric:"HRV (7d avg)",effect:"0.18 ms",direction:"positive"},certainty:.78,evidenceWeight:.28,evidence:{personalDays:2401,personalWeight:.28,populationWeight:.72,stability:.47},dataSources:["apple_health","gpx"],comparison:{before:{value:0,label:"Current"},after:{value:25.9,label:"At optimal"}},whyNow:"Threshold identified at 25.9 km/week from available data.",actionable:!0,suggestedAction:"Sweet spot near 25.9 km/week. Both too little and too much are suboptimal.",priority:6,status:"new",showWork:"Piecewise-linear model: hrv_7d_mean ~ f(daily_run_km) with changepoint at theta. Theta = 25.9 km/week. Below theta: +0.177 per unit. Above theta: -0.008 per unit. Fitted on 2401 data points (effective N = 343). Evidence split: 28% personal / 72% population. Prior source: Plews et al., Sports Med 2013; Buchheit 2014; trained male CV narrowing (evidence tier: meta-analysis/RCT)."},{id:"oron_insight_18",personaId:"oron",category:"recovery",variableType:"outcome",title:"Training Load Influences Next-Day HRV",headline:"Higher daily TRIMP is followed by changes in heart-rate variability",summary:"Acute training load shifts autonomic balance — moderate loads enhance parasympathetic rebound while very high loads can temporarily suppress HRV.",recommendation:"Optimal daily training load near 80 TRIMP for HRV.",explanation:"Acute training load drives autonomic nervous system fatigue measured via HRV depression. The effect intensifies above 80.2 TRIMP (-0.14 ms per unit vs +0.06 below).",causalParams:{source:"daily_trimp",target:"hrv_daily_mean",curveType:"v_max",theta:{value:80.2,unit:"TRIMP",low:77.99,high:82.41,displayValue:"80.2 TRIMP"},betaBelow:{value:.057,unit:"ms",description:"+0.06 ms/per 50 TRIMP"},betaAbove:{value:-.142,unit:"ms",description:"-0.14 ms/per 50 TRIMP"},observations:2391,completePct:100,changepointProb:.19,sizeCategory:"small",currentValue:0,currentStatus:"below_threshold",posteriorSamples:{theta:[79.3915,81.5122,81.9969,79.0886,79.3309,78.8462,79.028,78.9674,82.0575,82.0575,79.2703,80.5427,80.8457,80.8457,81.7545,80.6639,81.4516,79.6339,79.028,80.1186,81.8757,79.0886,79.9974,81.694,78.1797,81.6334,79.5733,79.0886,78.7856,79.3309,79.0886,80.4216,79.7551,78.4827,80.7851,78.725,80.5427,78.2403,79.2097,81.6334,80.1186,79.6339,78.9674,81.6334,79.0886,78.8462,81.9969,79.6945,81.0275,78.3009,79.9368,80.6033,81.4516,80.6639,80.6639,79.6339,78.725,80.8457,78.8462,80.7245,81.8757,80.7851,80.4216,80.361,80.6033,81.8757,81.9969,80.1186,78.8462,81.9363,78.8462,78.7856,80.5427,80.6639,81.6334,78.4827,79.5127,80.5427,80.6033,80.1186,80.9669,78.9674,80.6639,81.2092,79.4521,81.4516,81.2698,78.3009,78.2403,79.8157,80.361,79.6945,79.3915,79.028,79.0886,79.6945,78.3009,78.4221,80.7245,80.4216,81.8151,81.5122,80.1186,79.7551,79.6339,80.1186,78.4827,79.6339,80.9063,82.0575,79.2097,81.8757,78.9068,80.6639,81.7545,78.9674,80.9063,79.028,78.3615,79.3309,81.2092,81.8151,79.9368,78.3615,81.7545,80.2398,79.6945,78.725],betaBelow:[1.6746,-1.3948,10.1744,-3.7861,13.6412,3.5028,-2.7783,-.7564,21.7872,.2272,2.4252,-2.3048,3.6536,18.6722,1.8717,8.4135,4.8528,11.3561,1.5136,-9.4178,.2755,-9.0422,-1.8119,-.2195,-16.7738,-9.4858,-12.7061,13.0731,2.6612,-9.4357,-7.0721,-9.0798,-.7523,-6.7014,3.34,10.4686,-.213,-1.4444,-.3864,-9.4389,2.945,-9.7491,-3.1264,-1.191,-2.5673,-7.535,11.8691,-1.1568,-12.5604,.9609,6.2373,2.6448,-7e-4,4.7926,6.8915,2.2842,-3.8679,-13.2337,5.5437,-.7791,1.3522,-7.783,3.641,3.6923,10.9852,5.1144,1.332,-2.4271,-.8315,-.2413,13.2201,10.7942,8.1606,5.8481,7.7678,-8.2252,10.1753,4.248,4.447,-2.7333,8.7653,10.2082,.2561,-3.1561,-6.7957,3.2635,.3091,6.3957,-2.1022,-8.5885,-3.9086,-5.2831,-2.0583,5.0282,10.9547,11.0397,-5.3334,-1.5781,3.5473,3.0096,5.0956,8.3095,2.9586,-5.2029,5.3842,2.4132,1.7047,-1.8456,-2.3014,-4.3495,-3.6897,2.6081,14.4135,-12.9769,12.0838,-9.8393,-2.9436,-.404,3.6026,.3081,-4.1435,2.2061,-.3524,-14.5776,-10.1633,1.672,-3.3702,-2.0182],betaAbove:[4.7371,10.1764,3.2725,2.0042,-9.6477,9.43,-5.4142,8.2342,-7.607,3.2061,-6.0115,-.336,2.7366,-2.284,7.4199,-3.2056,2.7026,-5.3998,-10.2892,2.7465,-4.0435,7.3467,.9824,-15.2691,-6.8181,5.1686,.9128,-2.9045,-8.3766,.525,-7.9119,1.7281,-3.0548,8.0204,1.6431,-1.3879,4.7835,.6668,-7.7329,7.5379,-12.4483,.007,-1.2765,.7641,-1.0323,-12.1073,-1.2033,6.8617,-6.4411,5.4556,5.087,-5.5094,9.3865,5.8887,1.3102,.2788,1.1783,4.9877,-12.0701,-17.2115,4.9882,5.1256,.8933,3.0356,1.9146,-4.3817,-7.8479,-8.646,-8.309,4.5908,6.3752,-7.0041,-10.8958,10.6844,.8133,10.6904,9.3541,-12.8382,-7.0728,11.4441,7.2684,-7.2042,-3.4184,-1.1918,6.9367,2.8756,1.0654,-1.0072,-9.668,-.924,-7.2858,-1.3866,3.2824,8.477,-5.7036,-11.4028,-5.2438,-10.1937,-1.1566,1.5292,6.6217,-.6531,-4.5924,6.6287,-4.5876,-1.2868,-.8723,-2.5202,-4.1734,-6.9384,-4.175,-12.451,-11.7989,13.7569,1.3743,5.2131,-2.1495,7.4031,10.7889,-5.0417,5.7582,-9.5918,.7501,1.7905,7.6015,-.601,8.4415,-6.9389],alpha:[51.5397,39.0073,40.7937,45.3483,46.8795,42.9894,25.8504,38.1568,48.1997,50.0174,45.9347,36.6742,40.4182,39.0815,43.0692,38.3283,39.1021,39.2161,36.5445,39.2974,31.4522,36.9068,42.8648,43.5989,46.0467,50.5882,48.7297,43.8251,36.8111,48.495,39.4777,55.0349,45.2406,44.7106,27.8798,34.5757,45.6774,37.1985,31.0952,41.3132,40.7796,51.9471,47.6207,48.9696,43.0808,46.0997,54.1745,42.4522,33.5962,44.3298,40.7531,41.2272,41.7956,35.021,36.1522,34.3872,41.0524,50.3988,44.6694,42.8356,46.9932,46.3966,55.7006,37.2488,46.2035,29.6238,39.7765,30.7364,37.1515,43.1873,53.5834,54.761,45.4203,30.7251,42.6257,55.0867,48.2779,43.6442,36.5132,48.7835,31.887,39.9448,37.6646,35.7857,47.003,40.6286,54.0394,50.1083,44.5535,43.5916,54.8617,32.9451,48.9111,27.9001,31.1057,33.1082,38.7054,47.7471,52.6877,35.3813,38.8694,44.5801,33.6375,39.133,38.1376,33.8161,26.887,37.4425,31.1831,45.7552,42.3045,40.2685,31.8939,40.8818,42.5135,41.9736,49.3909,41.0267,36.4979,36.3315,42.0061,35.4872,48.8666,42.4969,43.6496,49.3588,52.5127,46.6559]}},cause:{behavior:"Training Load (TRIMP)",threshold:80.2,unit:"TRIMP",direction:"above"},populationThreshold:{value:80.2,label:"Population Prior",variance:"Prior source: Stanley et al., Sports Med 2013; Buchheit 2014; trained male CV narrowing"},outcome:{metric:"HRV (daily)",effect:"0.14 ms",direction:"negative"},certainty:.76,evidenceWeight:.86,evidence:{personalDays:2391,personalWeight:.86,populationWeight:.14,stability:.19},dataSources:["apple_health","gpx"],comparison:{before:{value:0,label:"Current"},after:{value:80.2,label:"Threshold (TRIMP)"}},whyNow:"Threshold identified at 80.2 TRIMP from available data.",actionable:!0,suggestedAction:"Threshold identified at 80.2 TRIMP.",priority:6,status:"new",showWork:"Piecewise-linear model: hrv_daily_mean ~ f(daily_trimp) with changepoint at theta. Theta = 80.2 TRIMP. Below theta: +0.057 per unit. Above theta: -0.142 per unit. Fitted on 2391 data points (effective N = 797). Evidence split: 86% personal / 14% population. Prior source: Stanley et al., Sports Med 2013; Buchheit 2014; trained male CV narrowing (evidence tier: meta-analysis/RCT)."},{id:"oron_insight_22",personaId:"oron",category:"sleep",variableType:"outcome",title:"Training Duration Improves Sleep Efficiency",headline:"Longer training sessions lead to better sleep quality",summary:"Extended training increases adenosine accumulation and promotes deeper, more consolidated sleep. The benefit peaks near 49 min, with diminishing or reversed returns past that.",recommendation:"Optimal training duration near 49 min for sleep quality.",explanation:"Moderate exercise promotes sleep onset and consolidation via thermoregulatory and adenosine pathways. The effect intensifies above 49.1 min (-0.10 % per unit vs +0.04 below).",causalParams:{source:"daily_duration_min",target:"sleep_efficiency_pct",curveType:"v_max",theta:{value:49.08,unit:"min",low:16.08,high:82.09,displayValue:"49.1 min"},betaBelow:{value:.036,unit:"%",description:"+0.04 %/per 30 min/day"},betaAbove:{value:-.104,unit:"%",description:"-0.10 %/per 30 min/day"},observations:1181,completePct:100,changepointProb:.19,sizeCategory:"small",currentValue:0,currentStatus:"below_threshold",posteriorSamples:{theta:[51.0965,56.2061,49.3933,25.974,43.0062,51.9481,28.5289,57.4835,83.4576,81.7544,56.6319,53.2255,83.4576,64.2964,53.2255,37.8966,82.606,48.9675,21.2902,83.8834,39.5998,43.8578,36.6191,38.3224,58.3352,55.7803,49.3933,82.1802,57.4835,31.5095,34.9159,48.5417,49.3933,37.0449,50.6707,83.0318,81.7544,55.3545,54.0771,40.4514,84.735,51.5223,31.9353,45.561,43.0062,57.9093,51.9481,45.1352,42.5804,28.5289,31.5095,29.3805,59.1868,81.7544,40.0256,42.1546,45.1352,47.2642,44.7094,22.5676,48.1159,83.8834,39.5998,80.9028,47.6901,40.0256,18.7354,84.3092,43.432,31.5095,33.6385,34.4901,36.6191,81.3286,40.0256,54.5029,82.606,53.2255,35.3417,25.1224,41.303,38.7482,40.0256,43.0062,38.3224,81.7544,28.1031,33.6385,54.9287,83.4576,35.3417,56.6319,31.5095,37.0449,42.1546,35.7675,37.4708,55.3545,83.4576,81.3286,36.1933,82.1802,52.3739,36.6191,36.6191,82.606,84.735,36.6191,56.6319,33.6385,41.7288,26.3998,36.1933,51.9481,41.303,35.7675,37.0449,30.6579,30.2321,53.6513,52.7997,54.9287,53.2255,43.432,81.3286,48.9675,50.6707,82.1802],betaBelow:[-.0234,-.0333,.0472,.0972,.0562,.0577,-.0253,-.0248,-1.9025,-19.2114,-.0234,.0216,-10.1625,-.0204,-.0641,-.0703,13.8425,.0464,.1252,5.3368,-.0185,.0959,-.0406,.0245,-.0212,-.0528,-.1037,-1.5314,-.0404,-.0392,.0169,-.0577,-.0426,.0287,-.0359,-6.3357,-3.9886,-.0249,-.0089,-.0429,-6.011,-.0687,-.1069,-.0345,-.0898,.0173,.046,.0221,-.0725,-.1635,.0016,.0164,-.0193,-16.9627,-.0401,-.0528,-.0103,.0297,-.0646,-.2206,.0121,-5.6283,-.0608,-14.8633,.0706,.148,-.2525,-6.3006,0,-.001,.043,-.0769,-.0896,-11.3506,.0517,.033,-3.2784,-.0507,.0141,.0532,-.0094,-.0236,.0335,-.0961,.0351,9.0236,-.1936,-.0581,.0127,-4.4393,-.0891,-.0453,-.0059,-.015,.0539,.056,-.0883,-.0211,-12.5858,-9.5487,-.0242,1.3171,-.0583,-.0182,-.0277,16.4933,-6.0006,-.041,.0357,-.0121,-.0744,-.0614,.0443,-.0451,-.0172,-.032,.0274,-.1323,-.1325,-.0146,-.0134,.007,-.0795,-.0144,-1.8867,-.0138,.0272,-8.5517],betaAbove:[.0016,.2144,-.0221,-.035,.0129,-.1815,.0809,.1311,-17.1776,-4.8753,.1708,.0567,-3.8881,.5183,.4344,.1847,5.321,-.0095,-.0463,4.4977,.2231,-.1739,-.0114,-.0748,.5687,.3999,.4924,-7.1836,.2832,.0821,-.0024,.1389,-.0404,.0038,.1791,-11.9179,7.8114,.2744,.1107,.0621,-.2996,.3471,.1701,.1463,.0967,.0672,-.2081,-.1607,.1199,-.0062,-.0694,-.0246,-.1742,-10.5455,.135,.1106,-.0095,.0287,.0059,.1753,-.1327,-4.1588,.0395,-9.9107,-.0757,-.2145,.1048,-15.8944,-.0206,-.0421,-.0126,.1021,.1592,15.3693,-.0886,.1623,-10.8673,.0878,-.014,-.0415,-.0092,.0038,-.1667,.1602,-.1704,.4634,.1457,-.0753,-.0129,7.5617,.1089,.188,-.023,.0877,-.0979,-.0857,.1283,.3265,-.1183,8.6979,-.0064,8.0946,.2803,-.0856,.0385,4.1284,-9.2742,-.0098,-.1301,.0743,.0817,-.0196,-.0919,.167,.0579,.0333,-.0142,.0727,.0988,.189,-.0158,-.0579,.2803,.0858,7.1247,.2476,.1248,9.2254],alpha:[91.0603,90.2852,94.4316,94.7214,94.3834,95.3222,91.4345,90.4176,100.7476,84.846,91.0276,92.9576,96.5504,91.1273,88.8912,89.1363,107.662,93.8012,94.5226,93.8621,91.1966,95.8865,90.5828,92.4516,90.8914,89.1729,86.6598,97.1367,89.797,91.138,92.6507,89.4815,90.0895,92.8202,90.6184,86.0263,90.3649,90.2976,91.3009,90.6042,94.6949,89.097,88.8547,90.5821,88.1945,92.6559,94.5378,93.1091,88.8813,87.8842,92.5301,92.5438,91.0248,81.5685,90.2572,89.9489,91.581,93.5849,89.2346,87.2033,92.79,91.3081,89.7277,94.2119,95.533,97.9485,87.5853,90.5286,92.3573,92.1687,93.9439,89.4013,88.8281,101.3899,93.4461,93.4813,103.8328,89.3407,92.8248,93.7205,91.6823,91.536,93.3852,88.2348,93.5112,89.9378,86.7402,90.2738,92.7797,98.8002,88.6839,90.0807,91.9922,91.5657,94.2174,94.0645,88.515,90.6194,93.5436,92.7368,91.2268,85.3056,89.3425,91.2685,91.2007,88.9507,92.8761,90.719,94.3222,91.8478,89.4545,90.6396,93.647,89.9022,91.5765,90.5858,92.9115,87.7184,88.1372,91.1963,91.2291,92.1776,88.3221,91.1166,89.6181,91.4843,93.6368,88.0134]}},cause:{behavior:"Training Duration (min)",threshold:49.08,unit:"min",direction:"above"},populationThreshold:{value:49.08,label:"Population Prior",variance:"Prior source: Kredlow et al., J Behav Med 2015; Stutz et al., Sports Med 2019"},outcome:{metric:"Sleep Efficiency",effect:"0.10 %",direction:"negative"},certainty:.69,evidenceWeight:.34,evidence:{personalDays:1181,personalWeight:.34,populationWeight:.66,stability:.19},dataSources:["autosleep"],comparison:{before:{value:0,label:"Current"},after:{value:49.1,label:"Threshold (min)"}},whyNow:"Threshold identified at 49.1 min from available data.",actionable:!0,suggestedAction:"Threshold identified at 49.1 min.",priority:6,status:"new",showWork:"Piecewise-linear model: sleep_efficiency_pct ~ f(daily_duration_min) with changepoint at theta. Theta = 49.1 min. Below theta: +0.036 per unit. Above theta: -0.104 per unit. Fitted on 1181 data points (effective N = 393). Evidence split: 34% personal / 66% population. Prior source: Kredlow et al., J Behav Med 2015; Stutz et al., Sports Med 2019 (evidence tier: meta-analysis/RCT)."},{id:"oron_insight_26",personaId:"oron",category:"sleep",variableType:"outcome",title:"Running Improves Sleep Efficiency",headline:"Higher daily running volume is linked to better sleep efficiency",summary:"Aerobic exercise increases sleep drive and promotes thermoregulatory cooling at night. Sleep efficiency peaks near 6.5 km/day, with diminishing or reversed returns past that.",recommendation:"Optimal daily running distance near 6.5 km for sleep quality.",explanation:"Aerobic running improves sleep quality via cardiovascular and thermoregulatory mechanisms. The effect intensifies above 6.5 km (-0.28 % per unit vs +0.06 below).",causalParams:{source:"daily_run_km",target:"sleep_efficiency_pct",curveType:"v_max",theta:{value:6.45,unit:"km",low:4.01,high:8.9,displayValue:"6.5 km"},betaBelow:{value:.06,unit:"%",description:"+0.06 %/per 2 km/day (stable)"},betaAbove:{value:-.281,unit:"%",description:"-0.28 %/per 2 km/day (sharp)"},observations:1181,completePct:100,changepointProb:.22,sizeCategory:"small",currentValue:0,currentStatus:"below_threshold",posteriorSamples:{theta:[4.9121,5.7313,7.4379,5.9361,7.2331,6.2091,7.1649,8.0523,5.4582,3.9563,6.0726,5.3899,7.3014,6.4139,6.0043,4.2977,5.9361,7.711,5.2534,5.9361,6.4822,8.8033,6.8918,7.8475,5.4582,5.8678,5.5265,6.3457,6.1409,8.2571,6.0043,5.7995,5.0486,6.5505,8.1206,7.9158,4.2294,6.2774,6.0726,5.3217,6.4139,6.2774,7.0283,6.8235,7.0283,8.0523,5.5265,8.1206,5.2534,7.711,5.4582,5.3217,4.3659,7.9158,6.3457,8.2571,5.7995,6.8235,3.8881,5.1851,5.7313,6.6187,6.4822,8.3937,7.5062,5.8678,5.1169,5.5265,7.4379,8.5302,6.2091,8.2571,5.9361,6.0726,7.9158,5.663,7.3697,7.8475,6.6187,4.7755,5.5947,7.5745,8.3254,4.4342,6.3457,8.3254,5.2534,8.1206,7.7793,6.8235,7.7793,6.2774,4.8438,5.0486,5.7995,6.5505,5.8678,8.3254,6.4822,5.3217,5.7313,4.639,5.8678,4.7755,5.9361,6.2091,7.0283,6.0043,5.7995,8.0523,7.1649,8.0523,7.3014,7.9841,6.9601,5.2534,7.5062,6.687,4.0246,6.3457,4.8438,6.687,6.1409,5.4582,7.5745,5.7313,7.3014,6.2091],betaBelow:[.0579,.3689,-.0401,.2784,.0395,-.2419,-.1522,.0194,.8342,-.7878,.437,-.5521,.2723,.5063,.2064,1.0871,.4079,.2865,-.0142,.6141,-.3627,.2188,-.0116,-.2384,.3872,-.2004,.119,.1388,-.0067,-.1453,.3825,.1874,.6507,.0447,.3389,-.4133,1.7368,.0646,.3136,-.4086,-.2129,.5683,.4712,.149,.2602,-.2488,.6972,.0063,.5046,.5217,.5849,.5226,1.3052,-.0717,-.3156,.3623,-.034,-.3715,1.3163,1.0342,.0273,.1259,.4987,.1202,.2664,.9862,-.2622,.7318,.3277,.4063,.4618,.2191,.1869,-.5359,-.0638,.2533,.279,.0557,.4572,.1732,-.2698,.0897,-.3567,-.122,.0317,.2566,-.0749,-.2852,.2869,.1084,.0608,.1973,-.1551,-.2318,-.386,-.4204,1.0875,.0069,-.0058,.4184,.0109,.4263,-.5238,-.4585,.3187,.5178,.242,-.3296,-.9083,-.1446,.2632,.3827,-.0787,-.3084,-.0635,.5961,-.0095,.4667,-.157,.1338,.5346,.0944,.1649,-.6098,.2711,-.5943,-.0397,-.085],betaAbove:[-.0702,-.5985,.0119,-.8205,.3333,.0325,-.6375,.5992,-1.209,.1188,-.6877,.4439,-.6745,-.9813,-.5208,-.9313,-.2407,-1.3792,-.2151,-1.3301,.8143,-1.3786,.1934,.205,-.749,.0284,-.4532,-.2866,.0578,-.2078,-.0706,-.027,-.5711,-.4816,-.5307,.1307,-1.1821,-.5883,-.6305,.602,-.521,-1.2357,-.5378,.2593,-.2947,.1724,-1.3418,.5715,-.8961,-2.1929,-.6014,-.9133,-1.266,.4732,.4062,-2.4864,-.0107,.6637,-.9621,-1.8368,-.0496,-.6848,-.6012,-.7909,-1.6331,-1.2359,.445,-.819,-.6688,-2.5821,-.8801,-.3069,-.436,.5489,-.2193,-.1163,-1.0246,-.0998,-.7696,-.3065,.11,-.1682,.3249,.0573,-.3375,-.8548,-.1411,.2474,-1.3712,-.2027,.1726,-.476,.3143,.3632,.2886,.4944,-1.673,-.0994,.0283,-1.1125,-.3077,-.3199,.7634,-.0335,-.4,-.8203,-.149,.0782,.8213,-.05,-.4074,-1.1264,-.122,-.1907,.1577,-1.1619,-.4931,-1.2988,.0257,-.5247,-.3785,-.6342,-.6588,.5698,.0057,.643,-.1855,-.2243],alpha:[92.3471,94.0823,92.0087,93.5782,92.222,90.9861,91.227,92.1352,96.8392,89.117,94.3134,89.3217,93.6429,95.8643,92.9175,96.7783,94.7996,94.3616,92.2079,96.5149,89.6644,93.9135,91.7381,90.538,94.3504,90.6739,92.6541,92.9437,91.9903,90.5695,94.7042,92.8515,95.1978,92.4388,94.635,88.6136,99.5296,92.1567,93.9478,90.2311,90.9864,95.5981,94.9422,93.0355,93.9475,90.0379,96.5313,91.9323,94.7854,95.9579,95.2352,94.6646,97.724,91.2859,90.0731,95.3149,92.157,89.7849,97.2997,97.4281,92.1811,92.7016,94.9045,93.2806,94.3986,98.0424,90.3674,95.6793,94.3361,95.935,95.1219,93.6196,93.222,88.6812,91.7241,93.1638,94.2946,92.7596,95.3906,92.7512,90.8158,92.8985,88.6662,91.5919,91.864,94.3045,91.8595,89.5242,93.968,92.655,92.56,93.3002,91.201,91.0221,89.7024,88.9511,98.8848,91.9899,92.0542,94.0061,92.3642,94.0364,88.9325,90.1011,93.3746,95.2896,93.2464,90.1453,87.1115,91.2376,93.8754,94.7409,91.5445,89.867,91.8493,95.566,92.3195,95.8053,91.5684,93.4245,94.8384,92.642,93.0511,88.6145,93.9057,88.4494,92.012,91.9768]}},cause:{behavior:"Daily Running (km)",threshold:6.45,unit:"km",direction:"above"},populationThreshold:{value:6.45,label:"Population Prior",variance:"Prior source: Kredlow et al., J Behav Med 2015; Youngstedt, Med Sci Sports Exerc 2005"},outcome:{metric:"Sleep Efficiency",effect:"0.28 %",direction:"negative"},certainty:.69,evidenceWeight:.34,evidence:{personalDays:1181,personalWeight:.34,populationWeight:.66,stability:.22},dataSources:["autosleep","gpx"],comparison:{before:{value:0,label:"Current"},after:{value:6.5,label:"Threshold (km)"}},whyNow:"Threshold identified at 6.5 km from available data.",actionable:!0,suggestedAction:"Threshold identified at 6.5 km.",priority:6,status:"new",showWork:"Piecewise-linear model: sleep_efficiency_pct ~ f(daily_run_km) with changepoint at theta. Theta = 6.5 km. Below theta: +0.060 per unit. Above theta: -0.281 per unit. Fitted on 1181 data points (effective N = 393). Evidence split: 34% personal / 66% population. Prior source: Kredlow et al., J Behav Med 2015; Youngstedt, Med Sci Sports Exerc 2005 (evidence tier: meta-analysis/RCT)."},{id:"oron_insight_23",personaId:"oron",category:"sleep",variableType:"outcome",title:"Training Duration Increases Deep Sleep",headline:"More training time means more slow-wave sleep",summary:"Physical training increases the homeostatic drive for slow-wave sleep. Deep sleep peaks near 68 min of training, with reversed returns past that point.",recommendation:"Optimal training duration near 68 min for deep sleep.",explanation:"Exercise increases slow-wave sleep need proportional to volume via adenosine accumulation.",causalParams:{source:"daily_duration_min",target:"deep_sleep_min",curveType:"v_max",theta:{value:67.96,unit:"min",low:45.88,high:90.04,displayValue:"68.0 min"},betaBelow:{value:.856,unit:"min",description:"+0.86 min/per 30 min/day"},betaAbove:{value:-.439,unit:"min",description:"-0.44 min/per 30 min/day"},observations:1136,completePct:100,changepointProb:.19,sizeCategory:"small",currentValue:0,currentStatus:"below_threshold",posteriorSamples:{theta:[59.6126,83.4576,60.0384,60.0384,82.1802,58.3352,60.4642,83.0318,84.3092,57.0577,83.4576,60.89,83.4576,59.6126,82.606,80.9028,62.1674,61.3158,60.0384,54.5029,60.4642,46.8384,82.1802,57.4835,83.0318,83.8834,60.0384,63.019,63.019,60.4642,60.4642,62.5932,82.1802,61.7416,82.606,59.1868,84.735,80.9028,83.4576,60.4642,83.0318,60.0384,61.3158,83.0318,82.606,83.8834,82.1802,59.6126,61.7416,62.1674,62.1674,60.4642,63.019,83.4576,61.3158,61.7416,59.1868,62.5932,58.761,83.0318,61.3158,56.2061,61.7416,80.9028,59.6126,81.7544,58.761,58.3352,60.89,60.89,60.0384,62.5932,56.6319,60.4642,83.8834,81.3286,60.4642,58.3352,56.2061,60.4642,83.4576,60.4642,83.8834,58.3352,83.4576,58.761,83.8834,61.3158,63.019,82.1802,83.8834,58.3352,82.606,81.7544,61.3158,60.0384,60.4642,62.5932,84.3092,83.4576,60.89,61.7416,62.1674,82.1802,59.6126,61.3158,60.89,62.5932,60.0384,61.7416,57.9093,58.761,83.8834,81.7544,61.3158,62.5932,80.9028,60.0384,55.3545,81.7544,60.89,60.0384,57.9093,84.735,60.0384,59.6126,58.3352,59.1868],betaBelow:[.0129,31.5091,-.0565,.1714,6.5618,.2858,-.0718,85.0025,10.7312,.1856,11.2208,-.0586,-9.4419,.1696,86.4816,8.2976,.0503,.1454,-.0133,-.0351,.1411,-.3326,-53.2491,.2571,15.0136,-41.3439,.0757,.1058,-.0107,-.1016,-.1263,.0757,-39.0507,.0933,-9.8082,-.2821,84.3376,31.2439,36.396,.1255,44.0849,-.1765,-.0144,58.193,3.0011,-64.3975,-47.1635,.0164,-.1655,.2166,.1629,-.0254,-.0122,39.4368,.3741,-.0335,-.0269,.211,.0783,-58.7974,-.1168,-.4833,-.0851,45.0734,-.1583,-23.6547,-.0687,.2574,.105,.1915,.3256,-.2212,-.0934,-.2661,16.8596,-33.0367,-.1702,-.1882,-.0846,-.0329,-22.0129,-.0652,-4.2982,-.1049,-78.4881,.1284,64.349,.0529,.3016,87.9795,-88.784,-.1333,9.0935,-52.3793,-.2251,.0345,-.1623,.0141,-28.3899,-.3052,.0073,.0801,-.1534,-42.5859,-.0575,.1524,.065,-.1684,.0942,.1177,.0813,-.0985,36.804,41.8581,.0056,.1086,20.1364,-.2534,-.1248,2.3499,.2546,.1264,-.1228,1.023,.0354,-.1765,-.0242,-.0402],betaAbove:[1.0262,71.2964,-2.2116,.2405,75.6091,-1.1155,.5789,-39.9475,-99.1405,.2217,-85.4395,-.1512,43.5791,.4018,-27.7936,-43.6018,1.3311,.8647,.4725,-.1319,-.1376,.2561,-23.2424,-3.2279,61.5377,-33.9522,-.2378,-.5824,-3.7939,-.153,4.3279,1.9618,-30.7128,-2.3971,-7.6681,1.9007,-39.2606,-51.5831,-17.1879,-.76,-5.2995,.2345,-2.3771,19.1859,29.9781,-9.7274,-19.439,1.5636,2.547,-2.9745,-.1001,1.4268,2.5025,35.2377,-5.3697,2.1541,-.3939,.7321,-.1684,-28.4255,1.0704,2.0136,.709,-29.5552,.2569,30.4373,.7741,-.3498,-3.5479,.2638,-1.3309,-.7305,1.7614,2.9387,11.6006,13.4485,-1.7927,.6434,-.1783,-.8412,-.0721,-2.2525,41.1272,.9511,98.5118,-2.196,41.1168,.4268,-.3511,7.4891,-21.3939,3.1627,-73.3251,-52.5401,-2.7949,-1.9523,-.0543,-4.1251,-31.3174,19.3635,-1.1401,-.6458,-4.5827,-106.1576,-1.5779,-2.0441,2.0525,-.4583,2.1906,-.7858,1.29,1.5097,-13.6478,-9.8726,-1.0329,2.0804,71.7954,1.7355,2.5213,54.883,-.3202,-4.6483,-.2083,35.4727,.3843,.095,-1.8658,.4743],alpha:[95.2072,184.4342,91.145,103.8742,178.8378,112.5232,89.1421,-18.7725,143.8342,105.1344,48.4651,92.5186,116.9891,105.3819,111.7116,99.7173,100.3844,104.8302,94.5791,94.2757,102.6315,75.8741,156.6939,109.3769,5.5531,158.5254,101.7259,102.8526,94.0407,87.7881,85.1043,100.8985,49.8872,99.585,125.6372,77.2492,105.1654,8.2045,135.7554,105.0735,194.6639,85.556,95.7471,79.4569,34.5459,4.6216,90.6856,97.0112,83.4207,108.0688,106.3584,95.2224,94.5981,92.1338,116.4233,93.5562,94.4796,109.704,99.364,90.9259,88.4275,67.9278,91.703,95.095,87.5876,116.8918,91.8466,109.8407,101.9433,108.0648,114.3721,82.4957,88.9591,78.1815,152.0795,185.0196,83.5556,85.3013,92.3641,95.5435,80.5935,92.5674,127.8985,86.8899,13.4669,103.638,116.7904,99.4039,116.2316,152.2804,80.7114,87.0506,120.8147,127.6603,82.8336,97.1384,84.5192,97.1341,122.4153,90.2921,96.0932,99.8185,87.2957,126.8102,93.9925,107.4006,97.1898,85.3767,99.4964,104.5153,97.5939,91.7467,41.0558,142.5327,93.9346,103.8559,131.2847,80.2076,89.9934,74.0402,109.3458,104.5594,89.2936,71.6041,98.2317,87.9419,93.8592,93.6289]}},cause:{behavior:"Training Duration (min)",threshold:67.96,unit:"min",direction:"below"},populationThreshold:{value:67.96,label:"Population Prior",variance:"Prior source: Kline, Am J Lifestyle Med 2014; Driver & Taylor, Sleep Med Rev 2000"},outcome:{metric:"Deep Sleep (min)",effect:"0.86 min",direction:"positive"},certainty:.62,evidenceWeight:.32,evidence:{personalDays:1136,personalWeight:.32,populationWeight:.68,stability:.19},dataSources:["autosleep"],comparison:{before:{value:0,label:"Current"},after:{value:68,label:"Threshold (min)"}},whyNow:"Threshold identified at 68.0 min from available data.",actionable:!0,suggestedAction:"Threshold identified at 68.0 min.",priority:6,status:"new",showWork:"Piecewise-linear model: deep_sleep_min ~ f(daily_duration_min) with changepoint at theta. Theta = 68.0 min. Below theta: +0.856 per unit. Above theta: -0.439 per unit. Fitted on 1136 data points (effective N = 378). Evidence split: 32% personal / 68% population. Prior source: Kline, Am J Lifestyle Med 2014; Driver & Taylor, Sleep Med Rev 2000 (evidence tier: meta-analysis/RCT)."},{id:"oron_insight_17",personaId:"oron",category:"recovery",variableType:"outcome",title:"Sleep Debt Raises Resting Heart Rate",headline:"Accumulated sleep debt drives up resting HR over days",summary:"Chronic sleep restriction shifts autonomic balance toward sympathetic dominance, raising resting heart rate. The effect is steepest below 4.2 hours of accumulated deficit, then plateaus.",recommendation:"Resting HR rises steeply with sleep debt; effect plateaus past 4.2 hours.",explanation:"Accumulated sleep deficit elevates sympathetic tone and baseline heart rate. Most of the effect occurs below 4.2 hours deficit (+0.05 bpm per unit), with diminishing returns above.",causalParams:{source:"sleep_debt_14d",target:"resting_hr",curveType:"plateau_up",theta:{value:4.16,unit:"hours deficit",low:-1.07,high:9.4,displayValue:"4.2 hours deficit"},betaBelow:{value:.051,unit:"bpm",description:"+0.05 bpm/per hr deficit"},betaAbove:{value:-.024,unit:"bpm",description:"-0.02 bpm/per hr deficit"},observations:1181,completePct:100,changepointProb:.26,sizeCategory:"small",posteriorSamples:{theta:[1.7889,2.4221,5.5879,2.6935,1.3367,7.1256,4.3216,9.3869,5.0452,3.8693,8.0302,9.0251,.8844,5.6784,.4322,6.1307,4.4121,3.9598,3.9598,3.1457,1.5176,5.6784,3.3266,4.4121,5.4975,2.5126,3.8693,9.3869,4.1407,9.8392,5.4975,5.0452,5.9497,7.397,5.6784,4.3216,2.603,2.8744,-.3819,1.8794,5.0452,3.1457,8.392,-3.0955,1.3367,.6131,9.4774,3.6884,4.5025,2.9648,4.593,1.5176,2.7839,3.9598,5.9497,7.0352,7.7588,2.1508,7.2161,5.0452,6.2211,7.3065,1.7889,2.2412,2.5126,2.7839,1.7889,.4322,9.5678,7.5779,2.2412,2.4221,5.8593,4.2312,5.3166,1.6985,5.4975,3.5075,7.0352,3.598,3.7789,9.1156,2.2412,6.8543,4.0503,5.2261,1.1558,3.3266,4.9548,.8844,6.5829,1.8794,3.4171,6.1307,-2.5528,9.1156,2.3317,2.2412,5.3166,6.7638,-1.3769,4.3216,3.4171,2.4221,3.6884,2.603,5.2261,2.603,-.6533,3.3266,6.2211,8.3015,3.9598,4.9548,8.9347,5.2261,3.3266,3.4171,7.8492,5.6784,9.6583,.794,7.1256,-1.2864,.9749,7.4874,7.1256,8.3015],betaBelow:[.0598,.0718,.0579,.0667,-.0259,.075,.0982,-.0162,.0185,.0205,.026,.0573,.0997,.0225,.0989,.115,.0869,.0866,.0422,.0769,.0435,-.0012,.0011,.0218,.0738,.0627,.0594,.0702,.038,.0845,.0602,.0726,.06,.0036,.0545,.0261,.0638,.0538,.0225,.0773,.0207,.0538,.046,.0822,.0373,.0905,.0394,.1107,.0616,.0972,.0907,.0773,.0037,.0229,.0461,.0422,.0302,.0539,.0032,.0297,.0714,.0808,.1474,.0443,.0769,.0994,.0925,.0264,.06,.0552,.0296,.0775,.0482,.0884,.008,.0971,.0316,.0352,.0317,.0732,.1131,.0619,.0831,.0621,.1185,.0836,.0725,.0847,.0219,.0231,.0246,.037,.0318,.0547,.0016,.0127,.0821,.0159,.0357,.0682,.0971,.0747,.0518,.0696,-.0414,.0607,.0552,-.0062,-.0025,.0414,.0488,.0227,.0695,.0269,.034,.0533,.0946,.0538,.1029,.0987,.0282,.0865,.0413,.0807,.0451,.0876,.0243,-.0092],betaAbove:[-.0103,.0271,.1438,.0174,.0263,-.248,.1858,.303,-.1732,.0439,-.1493,.1111,-.0054,-.2027,.0133,-.2322,-.0293,-.0343,.0231,-.0164,.0045,.091,.2667,-.0151,-.1599,-.0285,-.0137,-.243,-.0368,-.7814,-.1931,.0718,-.021,.2109,-.0798,.0558,.0289,-.0613,.0594,-.0525,.1752,-.0646,-.1121,.0208,.012,-.049,-.4653,-.1891,-.2397,-.0423,-.1822,-.0962,-.005,-.0563,-.1129,.1347,-.1746,.003,.2355,-.0922,-.1363,.0384,-.1416,.0028,.0596,-.0202,.0114,-.0462,.0935,-.2571,.0763,-.0652,-.116,.0164,.1004,.0411,.1802,-.098,.0082,-.0643,.1369,-.2045,.0084,-.0967,-.0218,.0012,.1031,.0343,.1589,-.0452,.1118,-.1332,.1443,-.1911,.0776,.1694,-.0403,-.0141,-.1014,.0264,.0081,-.2284,-.1197,-.1062,.0193,-.0597,-.0724,-.0356,-.0307,-.0628,.0248,.0657,-.0619,.0567,-.1219,.1015,-.2543,.017,-.2868,-.1973,.0516,.0043,-.2094,.0057,.0485,-.0111,.1578,-.0127],alpha:[54.101,53.9174,54.0741,54.1057,53.2016,54.6512,54.2468,53.5905,54.6064,53.5494,54.3874,54.1982,54.0401,54.6683,53.9817,54.7463,54.2428,54.5629,54.1312,54.2782,53.9629,53.245,52.8318,53.4562,54.5701,54.0931,54.4343,54.5207,53.6484,54.7197,54.6468,54.2221,54.2251,53.1316,53.9041,54.5239,54.3195,53.8789,53.9128,54.5462,53.5461,54.0182,54.4529,54.1493,53.7774,54.1403,54.4597,54.593,54.515,54.5574,54.616,54.3278,53.6882,53.7817,54.5598,54.0283,54.0597,54.0421,53.7345,54.0848,54.467,54.3114,54.687,54.0714,54.305,54.2676,53.9707,54.1777,54.5103,54.4795,53.572,54.3413,54.2368,53.6882,53.3544,54.3631,54.1971,53.457,54.1692,54.4725,54.221,54.5805,54.299,54.7808,54.4607,54.4712,53.9812,54.0918,53.7043,54.159,53.8218,53.8114,53.5573,54.4478,53.1245,53.6215,54.3055,53.8199,54.5854,54.2819,54.039,54.5364,54.4879,54.5231,53.9131,54.5714,53.949,53.8196,53.7312,53.857,54.1493,54.2281,54.2845,54.3203,54.157,54.1429,55.0223,53.9794,54.8246,54.7156,53.8686,54.245,54.0434,54.001,53.9941,54.943,54.0088,53.5513]}},cause:{behavior:"Sleep Debt (14d)",threshold:4.16,unit:"hours deficit",direction:"below"},populationThreshold:{value:4.16,label:"Population Prior",variance:"Prior source: Spiegel et al., Lancet 1999; PMC10543608 sleep restriction study"},outcome:{metric:"Resting HR",effect:"0.05 bpm",direction:"positive"},certainty:.78,evidenceWeight:.34,evidence:{personalDays:1181,personalWeight:.34,populationWeight:.66,stability:.26},dataSources:["apple_health","autosleep"],comparison:{before:{value:4.2,label:"Threshold (hours deficit)"},after:{value:.05,label:"Effect below"}},whyNow:"Threshold identified at 4.2 hours deficit from available data.",actionable:!0,suggestedAction:"Threshold identified at 4.2 hours deficit.",priority:7,status:"new",showWork:"Piecewise-linear model: resting_hr ~ f(sleep_debt_14d) with changepoint at theta. Theta = 4.2 hours deficit. Below theta: +0.051 per unit. Above theta: -0.024 per unit. Fitted on 1181 data points (effective N = 393). Evidence split: 34% personal / 66% population. Prior source: Spiegel et al., Lancet 1999; PMC10543608 sleep restriction study (evidence tier: meta-analysis/RCT)."},{id:"oron_insight_24",personaId:"oron",category:"sleep",variableType:"outcome",title:"Training Load Supports Sleep Efficiency",headline:"Moderate daily TRIMP is associated with better sleep efficiency",summary:"Very low training loads slightly reduce sleep efficiency, while moderate-to-high loads improve it. Sleep efficiency dips minimally at ~35 TRIMP before rising.",recommendation:"Aim for 35+ TRIMP per training day for best sleep efficiency.",explanation:"High-intensity training elevates sympathetic tone and core temperature, impairing sleep efficiency at high loads. The effect intensifies above 35.1 TRIMP (+0.27 % per unit vs -0.06 below).",causalParams:{source:"daily_trimp",target:"sleep_efficiency_pct",curveType:"v_min",theta:{value:35.15,unit:"TRIMP",low:14.41,high:55.89,displayValue:"35.1 TRIMP"},betaBelow:{value:-.061,unit:"%",description:"-0.06 %/per 50 TRIMP (stable)"},betaAbove:{value:.27,unit:"%",description:"+0.27 %/per 50 TRIMP (sharp)"},observations:1181,completePct:100,changepointProb:.2,sizeCategory:"small",currentValue:0,currentStatus:"below_threshold",posteriorSamples:{theta:[42.0422,41.0663,17.9699,42.0422,41.5542,16.8313,41.7169,40.4157,41.7169,17.8072,42.3675,41.2289,16.0181,13.253,40.4157,40.5783,40.5783,41.8795,42.0422,41.7169,41.8795,40.5783,41.5542,41.0663,42.2048,42.2048,40.741,42.2048,11.9518,41.8795,19.2711,16.0181,41.3916,42.3675,41.3916,41.5542,41.5542,41.3916,41.0663,18.1325,41.7169,40.4157,42.2048,40.9036,41.7169,14.7169,40.9036,40.741,15.8554,42.3675,13.9036,41.0663,42.3675,15.0422,42.3675,15.8554,21.3856,15.0422,41.7169,19.2711,41.5542,41.2289,41.0663,16.6687,20.4096,14.7169,19.5964,42.0422,41.8795,14.7169,40.741,26.9157,10.8133,41.2289,41.2289,42.2048,41.8795,40.9036,42.3675,15.6928,15.0422,42.2048,16.3434,40.9036,42.0422,41.7169,17.4819,14.7169,40.5783,41.0663,42.2048,42.3675,42.2048,13.741,40.741,40.4157,20.7349,41.5542,41.3916,42.2048,40.4157,25.2892,41.5542,41.0663,42.0422,42.0422,40.9036,17.3193,17.9699,41.3916,18.6205,41.8795,42.0422,40.4157,41.8795,41.3916,24.4759,41.7169,40.741,41.8795,42.2048,13.253,42.2048,41.2289,41.7169,42.2048,41.8795,40.5783],betaBelow:[11.254,5.4403,-.1328,.3164,-6.5727,-.1291,13.908,-15.2343,15.4093,-.0311,4.1508,-1.3349,-.0509,.1165,13.2264,-7.2836,-.959,.9428,-12.1911,-5.716,-7.5329,-4.3375,15.4263,13.1202,-6.0492,-10.4787,-11.4124,9.1025,-.0323,-5.1271,-.0499,.3385,-7.0041,5.3039,-6.511,6.6942,3.0319,-7.3814,-12.2361,-.2025,-4.2645,7.4166,-10.5113,11.4358,-6.0396,-.2346,-19.2077,12.2782,-.1789,2.6703,-.2101,-2.1454,-5.7163,-.1453,-16.6674,-.2128,-.1448,-.0309,-9.6415,-.1148,-13.0688,-9.1131,7.5059,.0407,-.1249,-.068,-.1563,-14.7202,-11.0715,-.1559,-.9638,-.1057,-.2305,-5.4177,-8.3754,.7056,12.1732,1.0709,10.1662,.1672,-.0553,9.929,-.2514,-.0281,-11.1969,-.7857,-.0247,-.0864,.0559,-4.3591,-4.4666,-1.8427,10.9232,-.1397,-9.6185,-3.3106,-.018,9.6993,-3.0328,-17.4621,-5.7194,-.0105,-10.6827,-.0619,-3.0948,12.1387,3.7712,.0057,.0322,2.9646,.0168,-19.8799,-6.2458,2.2937,-3.1574,2.3576,.135,-5.8951,18.0193,3.1877,-10.6343,.076,11.2049,13.7112,-8.4944,17.6189,-2.1223,12.1445],betaAbove:[-2.0858,14.0494,.1953,10.7449,1.3962,-.0112,8.0064,-15.6905,-2.1787,.2221,4.4297,1.8501,-.0488,-.0903,-10.7854,-7.8355,-10.1736,-6.8241,-4.7005,4.2461,5.2698,25.6947,-5.8558,-15.6741,-6.5457,-14.2495,2.9636,-2.5974,-.0793,-.668,.2381,-.4331,-8.2581,-8.145,10.2364,.1558,16.5832,1.8745,-8.6695,.1296,-4.4603,12.2343,-7.1371,-.9347,6.3454,.2615,5.6065,-8.4189,.22,-11.2225,.1763,25.1589,-18.0056,.1358,-4.7859,.1289,.184,.0018,4.0832,.1839,-8.6797,10.1518,3.0483,-.1846,.4594,.0163,.1515,1.3633,-.8408,.109,-11.9207,.467,.0732,2.1925,-21.9204,-.0503,-4.9096,-1.9828,5.5157,-.1641,.1328,-7.6461,.3208,-9.3866,19.3049,14.867,-.1093,-.015,5.3242,-6.4607,-8.773,5.3041,-11.7979,.2167,-7.0828,-1.6684,-.1452,-6.2945,7.9108,4.8979,-.939,.0903,9.0956,-7.1083,-.1186,16.3895,-23.6121,-.0312,-.0486,14.3368,-.1078,6.8091,13.015,-7.2172,1.742,-5.2856,-.1791,-5.7092,-2.6679,5.468,10.596,-.276,8.4017,-16.0994,-12.2238,-.1059,7.765,-2.1325],alpha:[91.4633,82.0455,89.5032,90.8343,99.2004,90.156,89.6184,88.858,92.8718,91.716,80.8573,86.0416,91.2959,93.8319,95.1574,103.5357,100.0514,109.598,90.0895,85.9223,101.1211,97.453,83.829,96.9278,75.0865,90.4286,96.9365,99.4751,91.9136,93.3887,91.4633,97.3185,78.7746,100.5704,89.6769,80.8858,100.7176,85.6835,84.4156,88.6983,74.3614,96.0613,91.4753,80.1381,103.5362,88.3016,92.9142,93.6515,89.2864,82.4611,88.9694,101.5443,97.7479,90.0095,92.723,89.0299,89.1147,91.1885,83.0383,89.4256,84.44,89.6892,89.6575,93.1255,89.1664,90.6288,89.4985,79.9461,122.9438,89.628,110.0962,89.432,89.9957,92.4814,101.9797,100.9135,102.7569,73.8555,85.6961,94.6322,91.3839,101.0502,88.0912,97.2449,89.4478,100.1011,91.4592,90.8635,91.4358,107.1558,87.323,88.4392,83.294,89.9561,72.555,79.103,91.5813,71.503,81.3605,92.8081,87.3407,91.6955,99.5156,84.1772,112.3304,83.3003,76.5432,92.3937,92.3348,90.7696,91.969,78.9698,92.3234,93.969,85.8146,95.9356,95.4174,100.5048,89.0772,89.3846,78.9983,93.2984,99.4727,99.8984,88.4252,90.7161,90.8149,92.7615]}},cause:{behavior:"Training Load (TRIMP)",threshold:35.15,unit:"TRIMP",direction:"above"},populationThreshold:{value:35.15,label:"Population Prior",variance:"Prior source: Killer et al., Eur J Appl Physiol 2017; Myllymäki et al., JSAMS 2011"},outcome:{metric:"Sleep Efficiency",effect:"0.27 %",direction:"positive"},certainty:.59,evidenceWeight:.34,evidence:{personalDays:1181,personalWeight:.34,populationWeight:.66,stability:.2},dataSources:["autosleep","gpx"],comparison:{before:{value:0,label:"Current"},after:{value:35.1,label:"Threshold (TRIMP)"}},whyNow:"Threshold identified at 35.1 TRIMP from available data.",actionable:!0,suggestedAction:"Threshold identified at 35.1 TRIMP.",priority:6,status:"new",showWork:"Piecewise-linear model: sleep_efficiency_pct ~ f(daily_trimp) with changepoint at theta. Theta = 35.1 TRIMP. Below theta: -0.061 per unit. Above theta: +0.270 per unit. Fitted on 1181 data points (effective N = 393). Evidence split: 34% personal / 66% population. Prior source: Killer et al., Eur J Appl Physiol 2017; Myllymäki et al., JSAMS 2011 (evidence tier: observational)."},{id:"oron_insight_25",personaId:"oron",category:"sleep",variableType:"outcome",title:"Training Load Drives Deep Sleep",headline:"Higher training load increases slow-wave sleep duration",summary:"Exercise-induced metabolic stress and elevated adenosine increase the proportion and duration of deep sleep.",recommendation:"Training load linearly increases deep sleep — no threshold.",explanation:"Training intensity drives deep sleep need but extreme loads suppress SWS via cortisol and sympathetic activation.",causalParams:{source:"daily_trimp",target:"deep_sleep_min",curveType:"linear",theta:{value:0,unit:"TRIMP",low:0,high:0,displayValue:"0"},betaBelow:{value:.195,unit:"min",description:"+0.20 min/per 50 TRIMP"},betaAbove:{value:.156,unit:"min",description:"+0.16 min/per 50 TRIMP"},observations:1136,completePct:100,changepointProb:.18,sizeCategory:"small",currentValue:0,currentStatus:"below_threshold",posteriorSamples:{theta:[30.1687,29.8434,42.3675,29.8434,41.3916,41.3916,41.5542,41.0663,40.4157,40.5783,42.3675,41.8795,40.741,30.494,41.8795,29.5181,41.3916,42.3675,40.741,30.006,42.0422,30.9819,41.7169,41.8795,30.9819,41.0663,30.8193,40.5783,40.741,41.5542,30.6566,41.8795,41.8795,42.2048,30.1687,30.8193,30.6566,41.8795,41.8795,41.0663,40.741,30.494,30.9819,30.1687,30.006,41.7169,31.1446,41.2289,41.5542,41.7169,42.3675,40.9036,40.9036,30.9819,41.3916,31.3072,42.3675,42.0422,30.6566,42.3675,42.2048,40.9036,40.4157,42.2048,40.5783,41.7169,41.5542,30.9819,41.2289,41.8795,42.3675,42.2048,42.0422,30.006,40.9036,41.0663,41.3916,41.7169,41.2289,41.2289,42.2048,30.8193,30.6566,41.5542,41.3916,42.0422,41.7169,40.9036,40.4157,30.494,41.3916,30.8193,41.3916,41.5542,42.0422,30.494,30.6566,30.3313,42.0422,31.1446,42.3675,41.5542,30.8193,40.4157,41.0663,41.3916,30.006,42.0422,42.2048,30.3313,30.6566,42.0422,41.0663,30.3313,29.8434,41.8795,31.3072,40.5783,30.3313,30.8193,30.8193,31.3072,40.5783,41.0663,41.8795,30.3313,41.5542,30.8193],betaBelow:[.035,-.1578,6.1639,.0475,-40.8456,24.8156,66.3246,-32.72,19.6565,11.3756,1.0409,-13.2887,-24.7093,-.2072,-31.4494,.1827,42.2115,11.9202,39.811,-.1089,8.6321,-.0052,-8.5832,52.2859,.2066,-24.2949,.0682,-23.2238,3.0465,-86.0977,-.051,16.5796,-58.1899,17.2227,.013,-.2245,.3499,-24.3269,-24.0231,-102.602,74.1173,-.425,.3741,-.3653,-.1415,25.4827,.3005,44.163,27.7826,65.2612,56.9427,-28.8354,-26.9168,-.3263,30.2707,.2664,55.0922,-21.8862,-.3194,-49.9395,36.3712,55.0227,-85.6227,-36.9635,101.9643,-122.3356,-39.1341,.0578,30.0295,-39.8539,63.0019,-79.7335,-6.4037,-.1105,-17.2914,-93.7517,-118.7321,-27.5925,5.5088,-32.5261,37.9955,-.1693,-.0249,-17.4306,-12.132,-51.2075,23.6619,-15.8646,-22.4485,.6081,19.6095,-.5465,48.5168,27.9762,-2.5174,.0144,-.2248,-.3584,5.6026,.5851,-6.1525,-33.4178,.0739,36.9098,-44.5987,-12.8251,.4331,-6.9931,-3.5009,-.0991,.0945,-15.6958,98.4525,.1948,-.0089,39.708,-.0473,-26.9505,-.463,.2387,.175,-.2349,9.5542,-78.539,46.6262,-.045,-14.852,.2436],betaAbove:[-.5643,2.7937,-19.9963,4.1135,-39.6506,12.8974,-42.2151,-50.9244,48.4424,-5.7668,-6.9749,88.2186,-89.9296,-3.7562,-75.0485,-2.0073,-49.3591,-41.7695,23.4311,-.1209,13.3791,.5997,64.0199,-9.6443,6.6923,47.1054,-3.5162,12.881,19.4993,.3957,-4.0294,5.9859,88.075,66.3701,-.442,.2994,-4.2174,-3.5596,37.1262,-16.8494,4.3351,-3.4105,-3.4992,-6.2645,.1803,-85.9732,-1.55,68.249,22.063,-18.2032,27.7752,2.0122,17.8819,7.0291,27.4081,1.5422,-8.3444,-20.6762,.2535,-44.645,-40.9473,-79.4424,25.7635,22.3986,-27.939,-81.0313,-51.4874,-.9667,-1.2121,2.9298,-47.4577,-15.6422,-31.5665,-2.0415,15.7998,-81.1936,66.0458,-73.1456,8.1512,68.5192,-17.4411,-.5946,.8948,-96.07,-47.0417,.3329,-23.2186,26.4406,16.4527,-4.33,-29.1625,-.0214,5.4885,-50.4129,-8.0655,-2.4531,1.828,3.3055,-11.4546,-.8898,-55.2485,-43.684,-1.3909,10.9292,41.8839,-76.9597,-2.7268,76.6814,-23.2156,-3.5635,1.3545,-11.7118,-83.4371,3.9282,-4.4595,46.6712,1.2634,-28.9587,3.9716,6.4932,-.3578,-3.8063,69.4506,2.86,33.9629,-1.089,15.0851,-2.8628],alpha:[96.6336,88.0831,93.6576,98.2006,128.6868,-10.6431,67.2559,111.4266,132.4637,41.0433,113.2778,87.8253,84.3564,89.9952,159.1923,97.2168,-14.2824,35.2432,128.8616,92.6683,113.2353,95.7745,91.69,36.4116,103.1123,93.1734,97.5992,143.0672,34.2317,42.0701,92.5239,60.0158,96.9522,78.5407,95.9622,89.1234,104.3593,71.5684,83.2258,83.4734,116.3707,84.4399,106.7027,87.2635,90.8903,124.6737,102.6746,42.5455,170.1998,157.8092,123.3773,78.9352,125.5799,85.9796,108.0783,104.5812,173.6771,151.9641,84.9667,85.7287,57.8377,68.7635,96.468,91.4063,125.0438,127.507,142.2368,99.7864,117.6505,96.3891,96.0956,172.6174,85.2218,92.0207,142.7569,26.0895,67.0402,96.4151,195.9621,123.4517,59.8735,90.1001,95.5499,96.8155,178.2327,108.6645,193.4529,90.8227,96.6625,114.8267,67.3758,77.5992,113.7948,106.6208,146.8288,95.9296,87.0293,82.7573,71.7665,112.6346,79.6531,113.1856,99.2268,76.1861,164.0053,98.0417,109.3461,84.9445,133.3123,96.2447,98.2412,107.2017,123.235,102.2923,94.9133,120.634,93.6443,71.1943,82.9862,101.1808,101.4113,89.6527,131.4133,16.2527,145.4051,94.6801,139.0193,101.7739]}},cause:{behavior:"Training Load (TRIMP)",threshold:37.24,unit:"TRIMP",direction:"below"},populationThreshold:{value:37.24,label:"Population Prior",variance:"Prior source: Killer et al., Eur J Appl Physiol 2017; Vitale et al., IJSPP 2019"},outcome:{metric:"Deep Sleep (min)",effect:"0.20 min",direction:"positive"},certainty:.56,evidenceWeight:.32,evidence:{personalDays:1136,personalWeight:.32,populationWeight:.68,stability:.18},dataSources:["autosleep","gpx"],comparison:{before:{value:0,label:"Current"},after:{value:37.2,label:"Threshold (TRIMP)"}},whyNow:"Threshold identified at 37.2 TRIMP from available data.",actionable:!0,suggestedAction:"Threshold identified at 37.2 TRIMP.",priority:6,status:"new",showWork:"Piecewise-linear model: deep_sleep_min ~ f(daily_trimp) with changepoint at theta. Theta = 37.2 TRIMP. Below theta: +0.195 per unit. Above theta: +0.156 per unit. Fitted on 1136 data points (effective N = 378). Evidence split: 32% personal / 68% population. Prior source: Killer et al., Eur J Appl Physiol 2017; Vitale et al., IJSPP 2019 (evidence tier: observational)."},{id:"oron_insight_1",personaId:"oron",category:"metabolic",variableType:"marker",title:"Running Volume Depletes Iron",headline:"High running mileage draws down serum iron levels",summary:"Foot-strike hemolysis, GI ischemia, and sweat losses all increase with running volume, progressively depleting serum iron stores. The effect accelerates sharply past ~177 km/month.",recommendation:"Iron drops modestly with running but accelerates sharply past 177 km/month.",explanation:"Foot-strike hemolysis destroys red blood cells; iron lost via hemolysis, sweat, and GI ischemia. The effect intensifies above 177.2 km/month (-0.30 mcg/dL per unit vs -0.05 below).",causalParams:{source:"daily_run_km",target:"iron_total_smoothed",curveType:"plateau_down",theta:{value:177.17,unit:"km/month",low:141.29,high:213.05,displayValue:"177.2 km/month"},betaBelow:{value:-.053,unit:"mcg/dL",description:"-0.05 mcg/dL/per 40 km/mo (stable)"},betaAbove:{value:-.298,unit:"mcg/dL",description:"-0.30 mcg/dL/per 40 km/mo (sharp)"},observations:452,completePct:41.1,changepointProb:.23,sizeCategory:"small",currentValue:56.37,currentStatus:"below_threshold",posteriorSamples:{theta:[186.3697,201.2391,154.2829,166.022,171.5002,178.5436,200.4565,193.4131,189.5001,198.8913,187.1523,196.5435,184.0219,188.7175,169.1524,199.6739,191.8479,201.2391,166.8046,171.5002,187.1523,203.5869,198.1087,194.1957,194.1957,169.1524,170.7176,187.1523,175.4132,185.5871,150.3699,201.2391,166.8046,167.5872,196.5435,198.1087,195.7609,155.8482,199.6739,195.7609,171.5002,171.5002,162.109,160.5438,191.0653,164.4568,184.0219,177.761,141.7613,204.3695,172.2828,158.196,201.2391,165.2394,218.4564,192.6305,191.8479,191.8479,185.5871,166.8046,146.4569,154.2829,160.5438,202.8043,132.3701,173.0654,184.0219,191.0653,205.1521,184.0219,193.4131,204.3695,173.848,133.1527,190.2827,158.196,156.6308,165.2394,175.4132,159.7612,170.7176,162.8916,197.3261,167.5872,186.3697,178.5436,178.5436,176.1958,202.0217,185.5871,167.5872,161.3264,165.2394,169.1524,173.0654,199.6739,185.5871,159.7612,150.3699,162.109,156.6308,185.5871,171.5002,170.7176,179.3262,188.7175,192.6305,198.8913,191.8479,187.9349,182.4567,172.2828,202.8043,186.3697,163.6742,165.2394,180.8915,193.4131,179.3262,156.6308,204.3695,178.5436,166.022,198.8913,202.8043,179.3262,162.8916,180.1088],betaBelow:[-.109,-.0936,.0219,-.054,-.0398,-.1025,-.1336,-.1135,-.0988,-.1089,-.128,-.12,-.1096,-.118,-.0752,-.1155,-.1148,-.098,-.0458,-.0964,-.105,-.0952,-.1296,-.1256,-.0798,-.0626,-.0714,-.1234,-.0873,-.0995,.0192,-.0986,-.0367,-.0847,-.1096,-.1106,-.1278,.0157,-.0914,-.1118,-.0658,-.0303,-.0551,-.0279,-.1078,-.0569,-.1237,-.1074,.0626,-.1209,-.0749,.0085,-.1239,-.0464,8.5635,-.1223,-.109,-.1137,-.1028,-.0854,.0372,.0031,-.0449,-.1213,.0518,-.0799,-.0793,-.0988,-.1177,-.1271,-.115,-.1067,-.1193,.1209,-.0917,.0057,.02,-.0678,-.0748,-.0443,-.0704,-.0576,-.1102,-.0427,-.0987,-.0927,-.0736,-.0942,-.1071,-.0991,-.0365,-.0461,-.0112,-.0539,-.081,-.1073,-.0903,-.0191,.0557,-.0209,-.0052,-.0864,-.0554,-.0512,-.0678,-.0934,-.095,-.0893,-.1085,-.1166,-.0853,-.0821,-.1075,-.096,-.0138,-.0415,-.0838,-.1035,-.0965,.0019,-.086,-.0642,-.0198,-.1122,-.1048,-.0971,-.0243,-.0694],betaAbove:[-.0884,-.2449,-.3136,-.3315,-.3713,-.2323,.1153,-.3378,-.4378,-.6098,-.2286,.302,-.2551,-.7194,-.3562,-.5728,.1005,-.7751,-.4112,-.3368,-.5015,.0182,.4375,.2135,-.5305,-.3046,-.2594,-.1719,-.4375,-.5705,-.323,-.4311,-.3522,-.2718,-.3639,-.7582,-.6633,-.338,-.4746,-.1939,-.4021,-.2753,-.3027,-.3485,-.3054,-.4051,-.1345,-.3204,-.2626,-.141,-.3184,-.3974,.264,-.3686,11.2401,.0997,-.0789,-.3197,-.4138,-.3364,-.2834,-.3374,-.3728,-.3489,-.1826,-.3821,-.3695,-.7364,.1192,-.4078,-.1724,-.8199,-.2665,-.2271,-.2473,-.3529,-.3414,-.2882,-.429,-.3462,-.2931,-.307,-.184,-.3511,-.1722,-.4427,-.365,-.3482,.4114,-.2649,-.3633,-.258,-.3569,-.372,-.2166,-1.184,-.1943,-.3314,-.3375,-.3214,-.3425,-.0437,-.3281,-.4029,-.3711,-.0043,-.009,-.7054,-.4072,-.3999,-.3609,-.3758,-1.0323,-.1616,-.4138,-.3665,-.3684,-.5548,-.3862,-.3005,-1.2744,-.3897,-.4471,-.9212,.157,-.3261,-.409,-.6569],alpha:[42.6646,41.7093,50.7763,47.2688,47.248,43.677,39.1351,41.296,42.7064,41.4019,41.2844,41.0654,43.0403,41.7721,46.1004,40.5841,41.5324,41.8375,47.5799,44.5741,43.3702,42.0005,39.8572,40.7654,43.5629,46.486,46.393,42.3298,45.2794,43.2917,50.9972,41.8688,48.6981,45.6757,40.9548,41.2619,40.4779,50.5711,42.4234,41.1758,46.632,47.9013,47.9712,48.7833,41.9778,47.7329,42.4935,43.6629,51.8461,39.7797,46.0576,50.8989,40.2759,48.0508,43.0535,41.5595,41.8652,41.5234,42.688,46.7895,51.1337,50.1242,48.4088,39.6701,51.9011,45.5193,44.5733,42.4086,39.6322,42.6469,41.7858,41.053,43.8197,52.2437,43.4075,50.0826,50.3444,46.5085,45.9522,48.3539,46.0873,47.1262,41.7741,47.43,43.6512,44.2376,44.8695,44.089,41.1211,42.5282,48.1858,47.83,48.7412,47.0188,45.5156,40.5751,43.2147,48.936,52.1271,48.2488,49.9442,43.7557,46.2014,47.5472,45.5108,42.9058,42.7172,42.9961,42.3005,42.308,44.6874,46.1223,41.0979,43.0337,49.3404,47.7413,44.3109,41.9818,43.9264,49.5614,42.0544,45.4527,49.4566,40.8115,41.4298,43.7536,49.0129,45.8698]}},cause:{behavior:"Daily Running (km)",threshold:177.17,unit:"km/month",direction:"above"},populationThreshold:{value:177.17,label:"Population Prior",variance:"Prior source: Sim et al., Sports Med 2019"},outcome:{metric:"Serum Iron",effect:"0.30 mcg/dL",direction:"negative"},certainty:.55,evidenceWeight:.05,evidence:{personalDays:452,personalWeight:.05,populationWeight:.95,stability:.23},dataSources:["gpx","labs"],comparison:{before:{value:56.4,label:"Current"},after:{value:177.2,label:"Threshold (km/month)"}},whyNow:"Current value (56.4) is below the threshold (177.2 km/month).",actionable:!0,suggestedAction:"Threshold identified at 177.2 km/month.",priority:6,status:"new",showWork:"Piecewise-linear model: iron_total_smoothed ~ f(daily_run_km) with changepoint at theta. Theta = 177.2 km/month. Below theta: -0.053 per unit. Above theta: -0.298 per unit. Fitted on 452 data points (effective N = 2). Evidence split: 5% personal / 95% population. Prior source: Sim et al., Sports Med 2019 (evidence tier: meta-analysis/RCT)."}],at=[{date:"2025-11-22",fastingGlucose:96,hba1c:5.2,insulin:5.1,totalCholesterol:125,ldl:68,hdl:43,triglycerides:62,hsCrp:.3,testosterone:348,cortisol:11.1,tsh:2.82,vitaminD:47,ferritin:46,iron:37,tibc:397,ironSaturationPct:9.3,apob:61,epa:.5,dha:2.2,aaEpaRatio:30.9},{date:"2025-03-15",fastingGlucose:77,hba1c:5,insulin:2,totalCholesterol:114,ldl:58,hdl:44,triglycerides:42,hsCrp:.3,epa:.5,dha:2.2,aaEpaRatio:24.5},{date:"2024-11-13",fastingGlucose:93,hba1c:5.1,insulin:2.6,totalCholesterol:136,ldl:67,hdl:57,triglycerides:52,hsCrp:.4,cortisol:15.1,tsh:4.44,vitaminD:47,ferritin:24,iron:63,tibc:436,ironSaturationPct:14.4,apob:72},{date:"2024-11-12",testosterone:327},{date:"2024-05-31",fastingGlucose:78,hba1c:5.1,insulin:2.8,totalCholesterol:142,ldl:81,hdl:48,triglycerides:57,hsCrp:.1},{date:"2023-11-01",testosterone:444,epa:.3,dha:1.1}],mn=[],$s=[{id:"oron-iron-repletion",personaId:"oron",name:"Iron Repletion Protocol",title:"Replete Iron Stores While Maintaining Fitness",description:"Reduce running volume temporarily, add iron supplementation, retest in 8 weeks",category:"metabolic",outcome:"Iron >50 mcg/dL, Ferritin >50 ng/mL, Iron Saturation >20%",status:"suggested",baseline:{value:37,unit:"mcg/dL"},actions:[{id:"reduce-run-volume",label:"Reduce weekly running to <35 km",category:"activity",isActive:!0,impact:8,actionType:"target",linkedInsightId:"oron-weekly_run_km-iron_total"},{id:"iron-supplement",label:"Iron supplementation (physician-guided)",category:"nutrition",isActive:!0,impact:9,actionType:"target"},{id:"vitamin-c",label:"Take vitamin C with iron for absorption",category:"nutrition",isActive:!0,impact:4,actionType:"target"},{id:"retest-8wk",label:"Retest iron panel in 8 weeks",category:"metabolic",isActive:!0,impact:7,actionType:"target"}],states:[{id:"iron-depleted",label:"Iron Depleted",isActive:!0},{id:"repleting",label:"Actively Repleting",isActive:!1}],triggers:[{if:["iron-depleted"],then:["reduce-run-volume","iron-supplement"],reason:"Iron at 37 mcg/dL requires active intervention"}],personalizedTiming:"8-12 weeks to normalize iron stores",expectedImpact:"Iron >50 mcg/dL, improved O2 delivery, better endurance",difficulty:3,evidenceLevel:85,progress:15,simulator:{deltas:{iron_total:25,ferritin:30,iron_saturation_pct:12}}},{id:"oron-omega3-optimize",personaId:"oron",name:"Omega-3 Optimization",title:"Optimize Omega-3 Index & Reduce AA/EPA Ratio",description:"Supplement EPA/DHA to improve omega-3 index and reduce inflammatory ratio",category:"nutrition",outcome:"Omega-3 Index >5%, AA/EPA ratio <10",status:"suggested",baseline:{value:24.5,unit:"AA/EPA ratio"},actions:[{id:"epa-dha-supplement",label:"EPA/DHA 2-3g daily",category:"nutrition",isActive:!0,impact:8,actionType:"target"},{id:"fatty-fish",label:"Fatty fish 3x/week",category:"nutrition",isActive:!0,impact:5,actionType:"target"}],states:[{id:"low-omega3",label:"Low Omega-3",isActive:!0}],triggers:[{if:["low-omega3"],then:["epa-dha-supplement","fatty-fish"],reason:"AA/EPA ratio 24.5 indicates pro-inflammatory balance"}],personalizedTiming:"4-8 weeks to see meaningful ratio change",expectedImpact:"Reduced inflammation, improved recovery, better endothelial function",difficulty:2,evidenceLevel:80,progress:0,simulator:{deltas:{aa_epa_ratio:-15,epa:1.5,dha:2}}},{id:"oron-zone2-maintain",personaId:"oron",name:"Zone 2 Maintenance",title:"Maintain Zone 2 Volume for Lipid Health",description:"Keep Zone 2 training at 150+ min/week for triglycerides and HDL",category:"cardio",outcome:"TG <60 mg/dL, HDL >50 mg/dL",status:"active",baseline:{value:42,unit:"mg/dL TG"},actions:[{id:"zone2-run",label:"Zone 2 run 3x/week (45-60 min)",category:"activity",isActive:!0,impact:7,actionType:"duration",startTime:"06:00",endTime:"07:00"},{id:"zone2-bike",label:"Zone 2 bike 2x/week (60 min)",category:"activity",isActive:!0,impact:6,actionType:"duration",startTime:"06:00",endTime:"07:00"}],states:[{id:"zone2-consistent",label:"Consistent Zone 2",isActive:!0}],triggers:[{if:["zone2-consistent"],then:["zone2-run","zone2-bike"],reason:"Maintaining Zone 2 volume for metabolic health"}],personalizedTiming:"Ongoing — benefits maintained with consistency",expectedImpact:"TG stays <60, HDL moves toward 50+",difficulty:2,evidenceLevel:82,progress:65,simulator:{deltas:{triglycerides:-8,hdl:4}}}],un={personaId:"oron",date:new Date().toISOString().split("T")[0],greeting:"Good morning, Oron. Your iron status remains critical at 37 mcg/dL. Today's focus: manage training volume while supporting iron repletion.",priorities:{high:[],moderate:[{id:"plan-oron-weekly_run_km-iron_total",text:"Reduce running volume below 40 km/week or supplement iron (consult physician for IV iron given severity)",explanation:"Foot-strike hemolysis destroys red blood cells during high-volume running. Your iron dropped from 63 to 37 mcg/dL (ref: 50-180), which is critically low. At your current weekly volume, you are losing iron faster than oral supplements can replace it.",evidenceWeight:"6% personal, 94% population"},{id:"plan-oron-weekly_zone2_min-triglycerides",text:"Maintain 146+ min/week of Zone 2 training to sustain low triglycerides",explanation:"Regular Zone 2 exercise activates lipoprotein lipase, clearing triglycerides. Your TG at 42 mg/dL is excellent (<150 optimal, <100 ideal).",evidenceWeight:"12% personal, 88% population"}],maintain:[{id:"plan-oron-weekly_training_hrs-testosterone",text:"Keep total training below 12 hours/week; prioritize recovery weeks",explanation:"Overtraining suppresses the HPG axis, lowering testosterone. Your levels (327-444 ng/dL) are lower-normal for age 43. High training volume without adequate recovery exacerbates this.",evidenceWeight:"9% personal, 91% population"},{id:"plan-oron-weekly_run_km-ferritin",text:"Target ferritin >50 ng/mL. Keep running below 36 km/week while repleting stores",explanation:"Ferritin reflects total body iron stores. Yours hit a critical low of 24 ng/mL (ref: 38-380) and has improved to 46 — still below the 50+ ng/mL target for athletes.",evidenceWeight:"6% personal, 94% population"},{id:"plan-oron-weekly_zone2_min-hdl",text:"Target 146+ min/week Zone 2 to raise HDL above 50 mg/dL",explanation:"HDL at 44 mg/dL is adequate but not protective (>50 preferred for men). Consistent Zone 2 training is the most effective non-pharmacological HDL booster.",evidenceWeight:"12% personal, 88% population"}]}},hn=[{id:"travel-bright-light",loadId:"travel-load",action:"Morning bright light exposure 30 min",effect:{magnitude:.1,direction:"decrease",unit:"score/day"},timeConstant:"days",category:"recovery",evidenceSource:"Eastman & Burgess 2009, circadian phase advance protocol",isActive:!0},{id:"travel-melatonin",loadId:"travel-load",action:"Melatonin 0.5 mg at local bedtime minus 30 min",effect:{magnitude:.08,direction:"decrease",unit:"score/day"},timeConstant:"days",category:"sleep",evidenceSource:"Herxheimer & Petrie 2002, Cochrane systematic review",isActive:!0},{id:"travel-meal-timing",loadId:"travel-load",action:"Align meals to destination timezone",effect:{magnitude:.05,direction:"decrease",unit:"score/day"},timeConstant:"days",category:"nutrition",evidenceSource:"Wehrens et al. 2017, peripheral clock entrainment via meal timing",isActive:!0},{id:"travel-avoid-exercise",loadId:"travel-load",action:"Avoid intense exercise first 24 h after arrival",effect:{magnitude:.1,direction:"decrease",unit:"spike prevented"},timeConstant:"immediate",category:"training",evidenceSource:"Reilly et al. 2007, exercise timing and jet lag recovery",isActive:!0}],pn=[{id:"iron-supplement",loadId:"iron-depletion",action:"Iron bisglycinate 25 mg + vitamin C daily",effect:{magnitude:.5,direction:"increase",unit:"% TSAT/week"},timeConstant:"weeks",category:"nutrition",evidenceSource:"Stoffel et al. 2020, alternate-day iron supplementation in athletes",isActive:!0},{id:"iron-absorption",loadId:"iron-depletion",action:"Avoid calcium/coffee within 2 h of iron dose",effect:{magnitude:30,direction:"decrease",unit:"% absorption penalty removed"},timeConstant:"days",category:"nutrition",evidenceSource:"Hallberg et al. 1991, inhibitors of non-heme iron absorption",isActive:!0},{id:"iron-reduce-running",loadId:"iron-depletion",action:"Reduce running volume to <35 km/week",effect:{magnitude:1,direction:"decrease",unit:"hemolysis loss reduced"},timeConstant:"weeks",category:"training",evidenceSource:"Telford et al. 2003, foot-strike hemolysis in runners",isActive:!0},{id:"iron-iv-infusion",loadId:"iron-depletion",action:"IV iron infusion (ferric carboxymaltose)",effect:{magnitude:20,direction:"increase",unit:"% TSAT (15-25% range)"},timeConstant:"immediate",category:"medical",evidenceSource:"Burden et al. 2015, IV iron in iron-deficient athletes",prerequisites:["medical clearance","hematologist referral"],isActive:!1}],gn=[{id:"acwr-gradual-increase",loadId:"training-load",action:"Increase weekly training volume by 10%/week",effect:{magnitude:.05,direction:"increase",unit:"ACWR ratio/week"},timeConstant:"weeks",category:"training",evidenceSource:"Gabbett 2016, training-injury prevention paradox",isActive:!0},{id:"acwr-polarized",loadId:"training-load",action:"80/20 polarized training distribution",effect:{magnitude:1,direction:"decrease",unit:"keeps in 0.8-1.3 window"},timeConstant:"weeks",category:"training",evidenceSource:"Stoggl & Sperlich 2015, polarized training in endurance athletes",isActive:!0},{id:"acwr-hard-session",loadId:"training-load",action:"Add one higher-intensity session per week",effect:{magnitude:.1,direction:"increase",unit:"ATL boost"},timeConstant:"days",category:"training",evidenceSource:"Seiler 2010, high-intensity interval training for endurance",isActive:!0}],xn=[{id:"omega3-supplement",loadId:"omega3-status",action:"EPA/DHA supplement 2-3 g daily",effect:{magnitude:2,direction:"decrease",unit:"AA/EPA ratio/month"},timeConstant:"months",category:"nutrition",evidenceSource:"Calder 2015, marine omega-3 fatty acids and inflammation",isActive:!0},{id:"omega3-fatty-fish",loadId:"omega3-status",action:"Fatty fish 3x/week (salmon, mackerel, sardines)",effect:{magnitude:1,direction:"decrease",unit:"AA/EPA ratio/month"},timeConstant:"months",category:"nutrition",evidenceSource:"Mozaffarian & Rimm 2006, fish intake and cardiovascular risk",isActive:!0},{id:"omega3-reduce-omega6",loadId:"omega3-status",action:"Reduce omega-6 seed oils (soybean, sunflower, corn)",effect:{magnitude:.5,direction:"decrease",unit:"AA/EPA ratio/month"},timeConstant:"months",category:"nutrition",evidenceSource:"Simopoulos 2002, omega-6/omega-3 ratio and chronic disease",isActive:!0}],zs={"travel-load":hn,"iron-depletion":pn,"training-load":gn,"omega3-status":xn},wt=[{id:"campaign-iron-recovery",personaId:"oron",loadId:"iron-depletion",name:"Iron Recovery",status:"active",currentValue:9,goalValue:22,currentUnit:"% TSAT",estimatedDurationWeeks:12,startDate:"2025-12-01",currentWeek:10,activePhaseId:"iron-phase-3",phases:[{id:"iron-phase-1",name:"Foundation",weekRange:[1,2],goal:"Start iron supplement protocol and reduce running-induced hemolysis",dailyActions:[{id:"iron-p1-supplement",leverId:"iron-supplement",action:"Iron bisglycinate 25 mg + vitamin C on empty stomach",frequency:"daily",timing:"06:15 — 30 min before breakfast",category:"nutrition",detail:"Take on empty stomach for maximum absorption"},{id:"iron-p1-absorption",leverId:"iron-absorption",action:"No coffee or calcium within 2 h of iron dose",frequency:"daily",timing:"Morning",category:"nutrition",detail:"Caffeine cutoff before iron is OK; coffee after 08:15"},{id:"iron-p1-volume",leverId:"iron-reduce-running",action:"Cap running at <30 km/week",frequency:"weekly",category:"training",detail:"Substitute bike sessions for iron-sparing aerobic work"}],constraints:["No runs >10 km during this phase","Prefer cycling for aerobic sessions"],expectedLoadValue:11},{id:"iron-phase-2",name:"Build",weekRange:[3,8],goal:"Maintain supplement and gradually raise volume to 35 km while TSAT rises",dailyActions:[{id:"iron-p2-supplement",leverId:"iron-supplement",action:"Iron bisglycinate 25 mg + vitamin C daily",frequency:"daily",timing:"06:15",category:"nutrition"},{id:"iron-p2-absorption",leverId:"iron-absorption",action:"Maintain absorption protocol",frequency:"daily",category:"nutrition"},{id:"iron-p2-volume",leverId:"iron-reduce-running",action:"Gradually increase running to 35 km/week (10%/week)",frequency:"weekly",category:"training",detail:"Add ~2-3 km/week as iron status improves"},{id:"iron-p2-fish",leverId:"omega3-fatty-fish",action:"Iron-rich foods 3x/week (red meat, lentils)",frequency:"weekly",category:"nutrition",detail:"Dietary iron in addition to supplement"}],constraints:["If TSAT drops below 10% at week 6 checkpoint, consult hematologist for IV iron"],expectedLoadValue:16},{id:"iron-phase-3",name:"Verify",weekRange:[9,12],goal:"Confirm stability and resume normal volume if TSAT >20%",dailyActions:[{id:"iron-p3-supplement",leverId:"iron-supplement",action:"Continue iron supplement (may reduce to alternate-day if TSAT >20%)",frequency:"daily",timing:"06:15",category:"nutrition"},{id:"iron-p3-volume",leverId:"iron-reduce-running",action:"Resume normal running volume if TSAT >20%",frequency:"weekly",category:"training",detail:"If TSAT still below 20%, maintain 35 km cap"}],constraints:["Lab retest at week 12 required before removing volume cap"],expectedLoadValue:22}],checkpoints:[{id:"iron-cp-1",weekNumber:2,type:"lab-retest",description:"Early check — confirm iron supplement is being absorbed",metric:"TSAT",targetValue:11,action:"Draw iron panel + ferritin via Quest Labs"},{id:"iron-cp-2",weekNumber:6,type:"lab-retest",description:"Mid-campaign check — TSAT should be rising steadily",metric:"TSAT",targetValue:16,action:"Draw iron panel + ferritin + CBC. If TSAT <12%, escalate to hematologist."},{id:"iron-cp-3",weekNumber:12,type:"lab-retest",description:"Final verification — confirm recovery and stability",metric:"TSAT",targetValue:22,action:"Draw full iron panel. If TSAT >20%, transition to maintenance protocol."}],trajectory:[{weekNumber:0,expectedValue:9,rangeLow:8,rangeHigh:10,label:"Baseline"},{weekNumber:2,expectedValue:11,rangeLow:9,rangeHigh:13,label:"Foundation"},{weekNumber:4,expectedValue:13,rangeLow:10,rangeHigh:16},{weekNumber:6,expectedValue:16,rangeLow:12,rangeHigh:19,label:"Mid-check"},{weekNumber:8,expectedValue:18,rangeLow:14,rangeHigh:22},{weekNumber:10,expectedValue:20,rangeLow:16,rangeHigh:24,label:"Current"},{weekNumber:12,expectedValue:22,rangeLow:18,rangeHigh:26,label:"Goal"}],confidence:"high",reasoning:"Iron bisglycinate at 25 mg/day with vitamin C has shown 0.5% TSAT/week improvement in athletes (Stoffel et al. 2020). Combined with running volume reduction to limit foot-strike hemolysis, trajectory projects TSAT from 9% to 22% over 12 weeks. Confidence is high due to well-established supplementation evidence and Oron's rising ferritin trend (24 → 46 ng/mL over past year).",sourceInsightIds:["oron_insight_1","oron_insight_12"]},{id:"campaign-training-ramp",personaId:"oron",loadId:"training-load",name:"Training Ramp-Up",status:"active",currentValue:.69,goalValue:1,currentUnit:"ACWR ratio",estimatedDurationWeeks:4,startDate:"2026-02-01",currentWeek:1,activePhaseId:"training-phase-1",phases:[{id:"training-phase-1",name:"Reactivation",weekRange:[1,2],goal:"3 easy sessions/week with 10% volume increase",dailyActions:[{id:"training-p1-easy",leverId:"acwr-gradual-increase",action:"3 easy Zone 2 sessions per week",frequency:"weekly",category:"training",detail:"Mix of run (2x) and bike (1x), 40-60 min each"},{id:"training-p1-polarized",leverId:"acwr-polarized",action:"Keep all sessions in Zone 1-2",frequency:"daily",category:"training",detail:"No intensity work until week 3"}],constraints:["No sessions above Zone 2","Maximum 10% volume increase per week"],expectedLoadValue:.85},{id:"training-phase-2",name:"Build",weekRange:[3,4],goal:"Add one moderate session, approach 0.8-1.0 ACWR",dailyActions:[{id:"training-p2-moderate",leverId:"acwr-hard-session",action:"Add 1 moderate-intensity session per week",frequency:"weekly",category:"training",detail:"Tempo run or Zone 3 intervals, 30-40 min"},{id:"training-p2-easy",leverId:"acwr-gradual-increase",action:"Continue 3 easy sessions + 1 moderate",frequency:"weekly",category:"training",detail:"4 sessions total, building toward habitual load"},{id:"training-p2-polarized",leverId:"acwr-polarized",action:"Maintain 80/20 distribution (3 easy : 1 moderate)",frequency:"weekly",category:"training"}],constraints:["ACWR must not exceed 1.2","Monitor NLR if available"],expectedLoadValue:1}],checkpoints:[{id:"training-cp-1",weekNumber:2,type:"metric-review",description:"Review ACWR trend and HRV response after 2 weeks of easy training",metric:"ACWR",targetValue:.85,action:"Check ACWR from Apple Watch + GPX data. If HRV drops >15%, reduce volume."}],trajectory:[{weekNumber:0,expectedValue:.69,rangeLow:.65,rangeHigh:.73,label:"Baseline"},{weekNumber:1,expectedValue:.77,rangeLow:.72,rangeHigh:.82,label:"Current"},{weekNumber:2,expectedValue:.85,rangeLow:.78,rangeHigh:.92,label:"Check"},{weekNumber:3,expectedValue:.93,rangeLow:.85,rangeHigh:1},{weekNumber:4,expectedValue:1,rangeLow:.9,rangeHigh:1.1,label:"Goal"}],confidence:"high",reasoning:"ACWR at 0.69 indicates under-training relative to habitual load. Gradual 10%/week volume increase is the established safe ramp rate (Gabbett 2016). With current CTL at 11.2, adding 3 easy sessions/week moves ACWR toward 0.85 within 2 weeks. Adding a moderate session in week 3-4 should bring ACWR to 1.0. NLR insight caps upper bound at 1.2.",sourceInsightIds:["oron_insight_10","oron_insight_40"]},{id:"campaign-omega3-rebalance",personaId:"oron",loadId:"omega3-status",name:"Omega-3 Rebalance",status:"planned",currentValue:30.9,goalValue:10,currentUnit:"AA/EPA ratio",estimatedDurationWeeks:8,phases:[{id:"omega3-phase-1",name:"Supplement",weekRange:[1,4],goal:"Start EPA/DHA supplementation and increase dietary omega-3",dailyActions:[{id:"omega3-p1-supplement",leverId:"omega3-supplement",action:"EPA/DHA 2 g daily with dinner",frequency:"daily",timing:"With evening meal for fat-soluble absorption",category:"nutrition",detail:"Look for >60% EPA formulation"},{id:"omega3-p1-fish",leverId:"omega3-fatty-fish",action:"Fatty fish 2x/week (salmon, mackerel, sardines)",frequency:"weekly",category:"nutrition",detail:"Replace 2 dinners per week with fatty fish"}],constraints:["Monitor for fish oil GI side effects","Take with food to reduce reflux"],expectedLoadValue:22},{id:"omega3-phase-2",name:"Optimize",weekRange:[5,8],goal:"Increase dose if tolerated and add omega-6 reduction",dailyActions:[{id:"omega3-p2-supplement",leverId:"omega3-supplement",action:"Increase EPA/DHA to 3 g daily if tolerated",frequency:"daily",timing:"Split 2 g dinner + 1 g lunch",category:"nutrition"},{id:"omega3-p2-fish",leverId:"omega3-fatty-fish",action:"Fatty fish 3x/week",frequency:"weekly",category:"nutrition"},{id:"omega3-p2-reduce-omega6",leverId:"omega3-reduce-omega6",action:"Replace seed oils with olive oil / avocado oil",frequency:"daily",category:"nutrition",detail:"Audit cooking oils, salad dressings, packaged foods"}],constraints:["If GI issues persist at 3 g, revert to 2 g"],expectedLoadValue:10}],checkpoints:[{id:"omega3-cp-1",weekNumber:8,type:"lab-retest",description:"Retest omega-3 panel to verify AA/EPA ratio improvement",metric:"AA/EPA ratio",targetValue:10,action:"Draw omega-3 panel via Quest Labs. Target AA/EPA <15 is good, <10 is optimal."}],trajectory:[{weekNumber:0,expectedValue:30.9,rangeLow:28,rangeHigh:34,label:"Baseline"},{weekNumber:2,expectedValue:27,rangeLow:24,rangeHigh:30},{weekNumber:4,expectedValue:22,rangeLow:18,rangeHigh:26,label:"Phase 2"},{weekNumber:6,expectedValue:16,rangeLow:12,rangeHigh:20},{weekNumber:8,expectedValue:10,rangeLow:7,rangeHigh:15,label:"Goal"}],confidence:"medium",reasoning:"AA/EPA ratio at 30.9 is significantly elevated (was 24.5 previously). EPA/DHA supplementation at 2-3 g/day typically reduces AA/EPA ratio by 2-3 points/month (Calder 2015). Combined with dietary omega-3 increase and omega-6 reduction, 8-week trajectory projects ratio from 30.9 to ~10. Confidence is medium because individual response to omega-3 supplementation varies and the ratio is currently quite high.",sourceInsightIds:[]}],ba=[Rs,As,Es,Vs,J],Gs=[...Ps,...Is,...Ws,...Os,...Fs],bn=[...Ds,...Ls,...Hs,...Bs,...$s],fn={rajan:{persona:Rs,insights:Ps,metrics:qr,labs:Kr,protocols:Ds,dailyPlan:Xr},sarah:{persona:As,insights:Is,metrics:Jr,labs:en,protocols:Ls,dailyPlan:tn},marcus:{persona:Es,insights:Ws,metrics:sn,labs:rn,protocols:Hs,dailyPlan:nn},emma:{persona:Vs,insights:Os,metrics:ln,labs:cn,protocols:Bs,dailyPlan:dn},oron:{persona:J,insights:Fs,metrics:mn,labs:at,protocols:$s,dailyPlan:un,campaigns:wt}};ba.map(t=>({id:t.id,name:t.name,archetype:t.archetype,avatar:t.avatar,tags:t.tags}));function fa(){return ba}function yn(t){return ba.find(a=>a.id===t)}function Us(t){return Gs.filter(a=>a.personaId===t)}function Yt(t){return fn[t]?.metrics??[]}function Ft(){const{activePersonaId:t,setActivePersona:a}=Be(),s=g.useMemo(()=>fa(),[]),i=g.useMemo(()=>yn(t)??null,[t]),r=g.useCallback(p=>{a(p)},[a]),n=g.useCallback(()=>{const b=(s.findIndex(y=>y.id===t)+1)%s.length;a(s[b].id)},[t,s,a]),o=g.useCallback(()=>{const p=s.findIndex(y=>y.id===t),b=p===0?s.length-1:p-1;a(s[b].id)},[t,s,a]),c=g.useCallback(()=>Yt(t),[t]),l=g.useCallback(p=>Yt(t).slice(-p),[t]),d=g.useCallback(()=>{const p=Yt(t);return p.length>0?p[p.length-1]:null},[t]),u=g.useCallback(()=>i?i.dataContext?.daysOfData??i.daysOfData:0,[i]),m=g.useCallback(()=>i?i.dataContext?.evidenceWeight??.7:0,[i]),h=g.useCallback(()=>i?(i.dataContext?.daysOfData??i.daysOfData)<14:!0,[i]);return{activePersona:i,activePersonaId:t,personas:s,setPersona:r,nextPersona:n,previousPersona:o,getMetrics:c,getRecentMetrics:l,getLatestMetric:d,getDaysOfData:u,getEvidenceWeight:m,isNewUser:h}}function vn(t,a){return t.filter(s=>s.certainty>=a)}function wn(t,a){return a.length===0?t:t.filter(s=>a.includes(s.category))}function jn(t,a){return t.filter(s=>s.actionable)}function Nn(t,a){return a.length===0?t:t.filter(s=>a.includes(s.status))}function _n(t,a){return t.filter(s=>(s.priority||0)>=a)}function kn(t,a){return a.length===0?t:t.filter(s=>a.includes(s.variableType))}function Cn(t,a){let s=[...t];if(a.minCertainty!==void 0&&(s=vn(s,a.minCertainty)),a.variableTypes&&a.variableTypes.length>0&&(s=kn(s,a.variableTypes)),a.categories&&a.categories.length>0&&(s=wn(s,a.categories)),a.actionableOnly&&(s=jn(s)),a.statuses&&a.statuses.length>0&&(s=Nn(s,a.statuses)),a.minPriority!==void 0&&(s=_n(s,a.minPriority)),a.searchQuery){const i=a.searchQuery.toLowerCase();s=s.filter(r=>r.title.toLowerCase().includes(i)||r.summary?.toLowerCase().includes(i)||r.narrative?.toLowerCase().includes(i))}return s}function Sn(t,a,s="desc"){return[...t].sort((r,n)=>{let o=0;switch(a){case"certainty":o=r.certainty-n.certainty;break;case"priority":o=(r.priority||0)-(n.priority||0);break;case"date":o=new Date(r.discoveredAt??"").getTime()-new Date(n.discoveredAt??"").getTime();break;case"category":o=r.category.localeCompare(n.category);break}return s==="desc"?-o:o})}function Ha(t){return t.reduce((a,s)=>{const i=s.category;return a[i]||(a[i]=[]),a[i].push(s),a},{})}function Tn(t={}){const{activePersonaId:a}=Be(),{certaintyThreshold:s}=lt(),i=t.initialMinCertainty??s/100,[r,n]=g.useState(i),[o,c]=g.useState(t.initialVariableTypes??[]),[l,d]=g.useState(t.initialCategories??[]),[u,m]=g.useState(!1),[h,p]=g.useState(""),[b,y]=g.useState(t.initialSort??"certainty"),[w,v]=g.useState(t.initialSortDirection??"desc"),_=g.useMemo(()=>Us(a),[a]),f=g.useCallback(C=>{c(P=>P.includes(C)?P.filter(E=>E!==C):[...P,C])},[]),j=g.useCallback(C=>{d(P=>P.includes(C)?P.filter(E=>E!==C):[...P,C])},[]),N=g.useCallback(()=>{n(i),c([]),d([]),m(!1),p(""),y("certainty"),v("desc")},[i]),S=g.useMemo(()=>({minCertainty:r,variableTypes:o.length>0?o:void 0,categories:l.length>0?l:void 0,actionableOnly:u,searchQuery:h||void 0}),[r,o,l,u,h]),R=g.useMemo(()=>{const C=Cn(_,S);return Sn(C,b,w)},[_,S,b,w]),L=g.useMemo(()=>Ha(R),[R]),I=g.useMemo(()=>{const C=Ha(_);return Object.entries(C).map(([P,E])=>({category:P,count:E.length,avgCertainty:E.reduce((H,ae)=>H+ae.certainty,0)/E.length}))},[_]),T=g.useCallback(C=>_.find(P=>P.id===C),[_]);return{insights:R,allInsights:_,minCertainty:r,setMinCertainty:n,variableTypes:o,setVariableTypes:c,toggleVariableType:f,categories:l,setCategories:d,toggleCategory:j,actionableOnly:u,setActionableOnly:m,searchQuery:h,setSearchQuery:p,sortBy:b,setSortBy:y,sortDirection:w,setSortDirection:v,insightsByCategory:L,totalCount:_.length,filteredCount:R.length,categoryStats:I,resetFilters:N,getInsightById:T}}function Mn(){const{activePersonaId:t}=Be();return g.useMemo(()=>{const s=Us(t),i=new Map;return s.forEach(r=>{const n=i.get(r.category)||{count:0,totalCertainty:0,highPriorityCount:0};i.set(r.category,{count:n.count+1,totalCertainty:n.totalCertainty+r.certainty,highPriorityCount:n.highPriorityCount+((r.priority||0)>=3?1:0)})}),Array.from(i.entries()).map(([r,n])=>({category:r,count:n.count,avgCertainty:n.totalCertainty/n.count,highPriorityCount:n.highPriorityCount}))},[t])}function St(t){return new Promise(a=>setTimeout(a,t))}async function*Rn(t){const a=t.reduce((i,r)=>i+r.duration,0);let s=0;for(const i of t){const n=i.duration/10;for(let o=0;o<10;o++)await St(n),s+=n,yield{progress:s/a*100,stage:i.name,isComplete:!1}}yield{progress:100,stage:"Complete",isComplete:!0}}const Va=[{name:"Connecting to device...",duration:300},{name:"Authenticating...",duration:200},{name:"Fetching new data...",duration:600},{name:"Processing metrics...",duration:400},{name:"Updating insights...",duration:500},{name:"Finalizing...",duration:200}],Pn=[{id:"insights",name:"Insights as a Service",description:"Causal insights that show each user what drives their progress toward any health outcome.",pricePerUser:3,priceAtScale:1.5,scaleThreshold:2e3,isActive:!0,enabled:!0,features:["Certainty scoring","Causal chains","Personal thresholds"]},{id:"protocols",name:"Protocols as a Service",description:"Daily personalized lifestyle plans that adapt to each user's context and health goals.",pricePerUser:2,priceAtScale:1,scaleThreshold:2e3,isActive:!0,enabled:!0,features:["What-If simulator","Daily plans","Adaptive triggers"]},{id:"life-lens",name:"Monthly Life Lens™",description:"Your monthly health wrapped. Discover your archetype.",pricePerUser:1,priceAtScale:.5,scaleThreshold:2e3,isActive:!1,enabled:!1,features:["Archetype analysis","Monthly trends","Shareable reports"]},{id:"social",name:"Social Dashboard",description:"Anonymized and team-based cohort percentile comparisons & leaderboards.",pricePerUser:1,priceAtScale:.5,scaleThreshold:2e3,isActive:!1,enabled:!1,features:["Team comparisons","Leaderboards","Privacy controls"]},{id:"coach",name:"Coach Dashboard & Digest",description:"Complete session prep for coaches based on each client's causal profile.",pricePerUser:1,priceAtScale:.5,scaleThreshold:2e3,isActive:!0,enabled:!0,features:["Session prep","Client roster","Weekly digest"]}],Dn=[{id:"apple-watch",name:"Apple Watch",icon:"/assets/devices/apple-watch.svg",metrics:["Heart Rate","HRV (SDNN)","Resting HR","Steps","SpO2","Sleep Stages","Active Calories"],dataTypes:["heart_rate","hrv","steps","activity","sleep","spo2"]},{id:"bloodwork",name:"Bloodwork (Quest Labs)",icon:"/assets/devices/bloodwork.svg",metrics:["Iron Panel","Lipids","Hormones","Inflammation","Metabolic","CBC"],dataTypes:["labs","biomarkers"]},{id:"gpx",name:"GPX Workouts",icon:"/assets/devices/gpx.svg",metrics:["TRIMP","Distance","HR Zones","Elevation","Pace","ACWR"],dataTypes:["training","activity","gps"]},{id:"medix-cpet",name:"Medix CPET",icon:"/assets/devices/medix.svg",metrics:["VO2peak","VT1","VT2","Respiratory Exchange","Max HR"],dataTypes:["cardiopulmonary","exercise_testing"]},{id:"autosleep",name:"AutoSleep",icon:"/assets/devices/autosleep.svg",metrics:["Sleep Quality","Deep Sleep","Efficiency","HRV (night)","Readiness"],dataTypes:["sleep","hrv","recovery"]}],Ys=At((t,a)=>({modules:Pn,devices:Dn,userCount:350,pricing:{starter:1.5,growth:2.5,enterprise:"Custom"},toggleModule:s=>t(i=>({modules:i.modules.map(r=>r.id===s?{...r,isActive:!r.isActive,enabled:!r.enabled}:r)})),setUserCount:s=>t({userCount:s}),setModulePrice:(s,i)=>t(r=>({modules:r.modules.map(n=>n.id===s?{...n,pricePerUser:i}:n)})),updateDevice:(s,i)=>t(r=>({devices:r.devices.map(n=>n.id===s?{...n,...i}:n)})),getActiveModules:()=>a().modules.filter(s=>s.isActive),getTotalPrice:()=>{const{modules:s,userCount:i}=a();return s.filter(r=>r.isActive).reduce((r,n)=>{const o=i>=n.scaleThreshold?n.priceAtScale:n.pricePerUser;return r+o*i},0)},getPricePerUser:()=>{const{modules:s,userCount:i}=a();return s.filter(r=>r.isActive).reduce((r,n)=>{const o=i>=n.scaleThreshold?n.priceAtScale:n.pricePerUser;return r+o},0)}}));function ya(){const{syncStatus:t,setSyncStatus:a,chaosMode:s,addToast:i}=lt(),{devices:r}=Ys(),[n,o]=g.useState(()=>r.map(f=>({deviceId:f.id,deviceName:f.name,status:"idle",lastSync:new Date(Date.now()-Math.random()*36e5),progress:null,error:null}))),[c,l]=g.useState(new Date),[d,u]=g.useState(null),m=g.useRef(new Set),h=n.some(f=>f.status==="syncing"),p=g.useCallback((f,j)=>{o(N=>N.map(S=>S.deviceId===f?{...S,...j}:S))},[]),b=g.useCallback(f=>n.find(j=>j.deviceId===f),[n]),y=g.useCallback(async f=>{const j=r.find(N=>N.id===f);if(j){m.current.delete(f),p(f,{status:"syncing",progress:{progress:0,stage:"Connecting...",isComplete:!1},error:null});try{const N=[...Va];s&&Math.random()<.2&&N.push({name:"Retrying connection...",duration:1e3});let S=N.reduce((L,I)=>L+I.duration,0),R=0;for(const L of N){if(m.current.has(f)){p(f,{status:"idle",progress:null});return}if(s&&Math.random()<.1)throw new Error("Connection lost (chaos mode)");const I=5,T=L.duration/I;for(let C=0;C<I;C++)await St(T),R+=T,p(f,{progress:{progress:R/S*100,stage:L.name,isComplete:!1}})}p(f,{status:"success",lastSync:new Date,progress:{progress:100,stage:"Complete",isComplete:!0}}),await St(1500),p(f,{status:"idle",progress:null})}catch(N){p(f,{status:"error",error:N instanceof Error?N.message:"Sync failed",progress:null}),i({title:`Failed to sync ${j.name}`,type:"error"})}}},[r,s,p,i]),w=g.useCallback(f=>{m.current.add(f)},[]),v=g.useCallback(async()=>{a("syncing"),await Promise.all(r.map(f=>y(f.id))),l(new Date),a("idle"),i({title:"All devices synced successfully",type:"success"})},[r,y,a,i]),_=g.useCallback(async()=>{a("syncing");const f=Rn(Va);u(f);try{for await(const j of f)if(j.isComplete)break;l(new Date),a("idle"),i({title:"Sync completed",type:"success"})}catch{a("error"),i({title:"Sync failed",type:"error"})}finally{u(null)}},[a,i]);return{isSyncing:t==="syncing",isAnyDeviceSyncing:h,lastGlobalSync:c,deviceStates:n,getDeviceState:b,syncDevice:y,syncAllDevices:v,cancelSync:w,simulateSync:_,simulateSyncProgress:d}}function An(){const[t,a]=g.useState("Just now"),{deviceStates:s}=ya(),i=s.reduce((r,n)=>n.lastSync?r?n.lastSync>r?n.lastSync:r:n.lastSync:r,null);return g.useEffect(()=>{const r=()=>{if(!i){a("Never");return}const o=Date.now()-i.getTime(),c=Math.floor(o/6e4),l=Math.floor(c/60);c<1?a("Just now"):c<60?a(`${c}m ago`):l<24?a(`${l}h ago`):a("Over a day ago")};r();const n=setInterval(r,3e4);return()=>clearInterval(n)},[i]),t}const In={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>t*(2-t),easeInOutQuad:t=>t<.5?2*t*t:-1+(4-2*t)*t,easeOutCubic:t=>--t*t*t+1,easeInOutCubic:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,easeOutElastic:t=>{const a=2*Math.PI/3;return t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t*10-.75)*a)+1},easeOutBounce:t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375};function Zs(t,a={}){const{duration:s=500,easing:i="easeOutCubic",delay:r=0,onComplete:n}=a,[o,c]=g.useState(t),l=g.useRef(),d=g.useRef(),u=g.useRef(t),m=typeof i=="function"?i:In[i];return g.useEffect(()=>{l.current&&cancelAnimationFrame(l.current);const h=u.current,p=t;if(h===p)return;const b=setTimeout(()=>{d.current=void 0;const y=w=>{d.current||(d.current=w);const v=w-d.current,_=Math.min(v/s,1),f=m(_),j=h+(p-h)*f;c(j),u.current=j,_<1?l.current=requestAnimationFrame(y):(c(p),u.current=p,n?.())};l.current=requestAnimationFrame(y)},r);return()=>{clearTimeout(b),l.current&&cancelAnimationFrame(l.current)}},[t,s,r,m,n]),o}const Ln=JSON.parse('[{"title":"Running Volume -> Iron","source":"daily_run_km","target":"iron_total_smoothed","curve":"plateau_down","theta":153.21,"theta_unit":"km/month","theta_ci":"[132.37, 174.05]","bb":-0.05,"ba":-0.203,"bb_desc":"-0.05 mcg/dL/per 40 km/mo (stable)","ba_desc":"-0.20 mcg/dL/per 40 km/mo (sharp)","effect_unit":"mcg/dL","eff_n":2,"raw_n":452,"personal_pct":6},{"title":"Running Volume -> Ferritin","source":"daily_run_km","target":"ferritin_smoothed","curve":"linear","theta":176.24,"theta_unit":"km/month","theta_ci":"[158.18, 194.3]","bb":-0.083,"ba":-0.447,"bb_desc":"-0.08 ng/mL/per 40 km/mo (stable)","ba_desc":"-0.45 ng/mL/per 40 km/mo (sharp)","effect_unit":"ng/mL","eff_n":2,"raw_n":452,"personal_pct":6},{"title":"Running Volume -> Hemoglobin","source":"daily_run_km","target":"hemoglobin_smoothed","curve":"plateau_down","theta":182.03,"theta_unit":"km/month","theta_ci":"[149.5, 214.55]","bb":-0.003,"ba":-0.035,"bb_desc":"-0.00 g/dL/per 40 km/mo (stable)","ba_desc":"-0.04 g/dL/per 40 km/mo (sharp)","effect_unit":"g/dL","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"Training Hours -> Testosterone","source":"daily_duration_min","target":"testosterone_smoothed","curve":"v_max","theta":1353.57,"theta_unit":"min/month","theta_ci":"[-5.22, 2712.36]","bb":0.009,"ba":-0.063,"bb_desc":"+0.01 ng/dL/per 4 hrs/mo (stable)","ba_desc":"-0.06 ng/dL/per 4 hrs/mo (sharp)","effect_unit":"ng/dL","eff_n":3,"raw_n":830,"personal_pct":6},{"title":"Training Hours -> Cortisol","source":"daily_duration_min","target":"cortisol_smoothed","curve":"v_min","theta":1327.04,"theta_unit":"min/month","theta_ci":"[-96.7, 2750.78]","bb":-0.002,"ba":0.008,"bb_desc":"-0.00 mcg/dL/per 4 hrs/mo (stable)","ba_desc":"+0.01 mcg/dL/per 4 hrs/mo (sharp)","effect_unit":"mcg/dL","eff_n":2,"raw_n":451,"personal_pct":6},{"title":"Zone 2 Volume -> Triglycerides","source":"daily_zone2_min","target":"triglycerides_smoothed","curve":"linear","theta":121.88,"theta_unit":"min/month","theta_ci":"[-133.69, 377.45]","bb":-0.013,"ba":-0.25,"bb_desc":"-0.01 mg/dL/per 120 min/mo (stable)","ba_desc":"-0.25 mg/dL/per 120 min/mo (sharp)","effect_unit":"mg/dL","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"Zone 2 Volume -> HDL","source":"daily_zone2_min","target":"hdl_smoothed","curve":"linear","theta":121.88,"theta_unit":"min/month","theta_ci":"[-113.32, 357.08]","bb":0.04,"ba":0.05,"bb_desc":"+0.04 mg/dL/per 120 min/mo","ba_desc":"+0.05 mg/dL/per 120 min/mo","effect_unit":"mg/dL","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"Zone 2 Volume -> LDL","source":"daily_zone2_min","target":"ldl_smoothed","curve":"linear","theta":121.88,"theta_unit":"min/month","theta_ci":"[-124.5, 368.26]","bb":-0.01,"ba":-0.075,"bb_desc":"-0.01 mg/dL/per 120 min/mo (stable)","ba_desc":"-0.08 mg/dL/per 120 min/mo (sharp)","effect_unit":"mg/dL","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"ACWR -> Inflammation","source":"acwr","target":"hscrp_smoothed","curve":"v_min","theta":1.3,"theta_unit":"ratio","theta_ci":"[0.92, 1.67]","bb":-0.019,"ba":0.1,"bb_desc":"-0.02 mg/L/per 0.1 ACWR (stable)","ba_desc":"+0.10 mg/L/per 0.1 ACWR (sharp)","effect_unit":"mg/L","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"ACWR -> Resting HR Trend","source":"acwr","target":"resting_hr_7d_mean","curve":"v_min","theta":1.48,"theta_unit":"ratio","theta_ci":"[1.43, 1.53]","bb":-0.717,"ba":2.118,"bb_desc":"-0.72 bpm/per 0.1 ACWR","ba_desc":"+2.12 bpm/per 0.1 ACWR","effect_unit":"bpm","eff_n":342,"raw_n":2400,"personal_pct":100},{"title":"Training Consistency -> VO2peak","source":"training_consistency","target":"vo2_peak_smoothed","curve":"plateau_up","theta":0.68,"theta_unit":"fraction","theta_ci":"[0.65, 0.71]","bb":11.285,"ba":1.024,"bb_desc":"+11.29 ml/min/kg/per 0.1 (strong)","ba_desc":"+1.02 ml/min/kg/per 0.1 (diminishing)","effect_unit":"ml/min/kg","eff_n":20,"raw_n":1718,"personal_pct":27},{"title":"Ferritin -> VO2peak","source":"ferritin_smoothed","target":"vo2_peak_smoothed","curve":"plateau_up","theta":36.18,"theta_unit":"ng/mL","theta_ci":"[33.7, 38.66]","bb":0.245,"ba":0.126,"bb_desc":"+0.24 ml/min/kg/per 10 ng/mL","ba_desc":"+0.13 ml/min/kg/per 10 ng/mL","effect_unit":"ml/min/kg","eff_n":20,"raw_n":452,"personal_pct":27},{"title":"Workout Time -> Sleep Efficiency","source":"last_workout_end_hour","target":"sleep_efficiency_pct","curve":"plateau_down","theta":20.09,"theta_unit":"hour","theta_ci":"[17.36, 22.82]","bb":-0.015,"ba":-2.192,"bb_desc":"-0.01 %/per hr later (stable)","ba_desc":"-2.19 %/per hr later (sharp)","effect_unit":"%","eff_n":393,"raw_n":1181,"personal_pct":100},{"title":"Bedtime -> Sleep Quality","source":"bedtime_hour","target":"sleep_quality_score","curve":"v_max","theta":22.34,"theta_unit":"hour","theta_ci":"[20.44, 24.23]","bb":0.339,"ba":-2.587,"bb_desc":"+0.34 min quality/per hr later (stable)","ba_desc":"-2.59 min quality/per hr later (sharp)","effect_unit":"min quality","eff_n":393,"raw_n":1181,"personal_pct":100},{"title":"Bedtime -> Deep Sleep","source":"bedtime_hour","target":"deep_sleep_min","curve":"v_max","theta":22.14,"theta_unit":"hour","theta_ci":"[20.36, 23.92]","bb":0.338,"ba":-2.644,"bb_desc":"+0.34 min/per hr later (stable)","ba_desc":"-2.64 min/per hr later (sharp)","effect_unit":"min","eff_n":378,"raw_n":1136,"personal_pct":100},{"title":"Sleep Duration -> Next-Day HRV","source":"sleep_duration_hrs","target":"hrv_daily_mean","curve":"linear","theta":7.08,"theta_unit":"hours","theta_ci":"[5.54, 8.61]","bb":0.413,"ba":0.223,"bb_desc":"+0.41 ms/per hr","ba_desc":"+0.22 ms/per hr","effect_unit":"ms","eff_n":745,"raw_n":2235,"personal_pct":100},{"title":"Sleep Debt -> Resting HR","source":"sleep_debt_14d","target":"resting_hr","curve":"linear","theta":6.05,"theta_unit":"hours deficit","theta_ci":"[-1.42, 13.53]","bb":0.046,"ba":0.187,"bb_desc":"+0.05 bpm/per hr deficit (stable)","ba_desc":"+0.19 bpm/per hr deficit (sharp)","effect_unit":"bpm","eff_n":393,"raw_n":1181,"personal_pct":100},{"title":"Daily Training Load -> Next-Day HRV","source":"daily_trimp","target":"hrv_daily_mean","curve":"v_max","theta":85.97,"theta_unit":"TRIMP","theta_ci":"[-11.95, 183.88]","bb":0.003,"ba":-0.06,"bb_desc":"+0.00 ms/per 50 TRIMP (stable)","ba_desc":"-0.06 ms/per 50 TRIMP (sharp)","effect_unit":"ms","eff_n":797,"raw_n":2391,"personal_pct":100},{"title":"Daily Training Load -> Next-Day Resting HR","source":"daily_trimp","target":"resting_hr","curve":"plateau_up","theta":85.97,"theta_unit":"TRIMP","theta_ci":"[-11.95, 183.88]","bb":0.002,"ba":0.015,"bb_desc":"+0.00 bpm/per 50 TRIMP (stable)","ba_desc":"+0.01 bpm/per 50 TRIMP (sharp)","effect_unit":"bpm","eff_n":790,"raw_n":2371,"personal_pct":100},{"title":"Daily Steps -> Sleep Efficiency","source":"steps","target":"sleep_efficiency_pct","curve":"linear","theta":10391.66,"theta_unit":"steps","theta_ci":"[6025.25, 14758.07]","bb":0,"ba":0,"bb_desc":"+0.00 %/per 2000 steps","ba_desc":"-0.00 %/per 2000 steps","effect_unit":"%","eff_n":393,"raw_n":1181,"personal_pct":100},{"title":"Active Energy -> Deep Sleep","source":"active_energy_kcal","target":"deep_sleep_min","curve":"linear","theta":482.43,"theta_unit":"kcal","theta_ci":"[188.56, 776.31]","bb":0.005,"ba":0.008,"bb_desc":"+0.01 min/per 100 kcal","ba_desc":"+0.01 min/per 100 kcal","effect_unit":"min","eff_n":378,"raw_n":1136,"personal_pct":100},{"title":"Weekly Volume -> HRV Baseline","source":"daily_run_km","target":"hrv_7d_mean","curve":"plateau_up","theta":21.17,"theta_unit":"km/week","theta_ci":"[19.5, 22.84]","bb":0.198,"ba":0.002,"bb_desc":"+0.20 ms/per 10 km/wk (strong)","ba_desc":"+0.00 ms/per 10 km/wk (diminishing)","effect_unit":"ms","eff_n":343,"raw_n":2401,"personal_pct":100},{"title":"Travel Load -> Sleep Efficiency","source":"travel_load","target":"sleep_efficiency_pct","curve":"plateau_down","theta":0.48,"theta_unit":"jet lag score","theta_ci":"[0.2, 0.76]","bb":-1.491,"ba":-8.631,"bb_desc":"-1.49 %/per 0.2 load (stable)","ba_desc":"-8.63 %/per 0.2 load (sharp)","effect_unit":"%","eff_n":393,"raw_n":1181,"personal_pct":100},{"title":"Travel Load -> Daily HRV","source":"travel_load","target":"hrv_daily_mean","curve":"linear","theta":0.57,"theta_unit":"jet lag score","theta_ci":"[0.55, 0.59]","bb":-0.2,"ba":-2.34,"bb_desc":"-0.20 ms/per 0.2 load (stable)","ba_desc":"-2.34 ms/per 0.2 load (sharp)","effect_unit":"ms","eff_n":794,"raw_n":2384,"personal_pct":100},{"title":"Travel Load -> Resting HR","source":"travel_load","target":"resting_hr","curve":"linear","theta":0.55,"theta_unit":"jet lag score","theta_ci":"[0.11, 1.0]","bb":0.213,"ba":1.088,"bb_desc":"+0.21 bpm/per 0.2 load (stable)","ba_desc":"+1.09 bpm/per 0.2 load (sharp)","effect_unit":"bpm","eff_n":788,"raw_n":2364,"personal_pct":100},{"title":"Training Volume -> Body Fat","source":"daily_duration_min","target":"body_fat_pct","curve":"linear","theta":1385.56,"theta_unit":"min/month","theta_ci":"[-69.24, 2840.36]","bb":0,"ba":-0.001,"bb_desc":"-0.00 %/per 10 hrs/mo (stable)","ba_desc":"-0.00 %/per 10 hrs/mo (sharp)","effect_unit":"%","eff_n":20,"raw_n":160,"personal_pct":27},{"title":"Daily Activity -> Body Mass","source":"steps","target":"body_mass_kg","curve":"linear","theta":11582.85,"theta_unit":"steps","theta_ci":"[7928.4, 15237.3]","bb":-0.001,"ba":0,"bb_desc":"-0.00 kg/per 2000 steps (strong)","ba_desc":"-0.00 kg/per 2000 steps (diminishing)","effect_unit":"kg","eff_n":20,"raw_n":171,"personal_pct":27},{"title":"Running Volume -> RBC","source":"daily_run_km","target":"rbc_smoothed","curve":"linear","theta":157.8,"theta_unit":"km/month","theta_ci":"[100.5, 215.11]","bb":-0.001,"ba":-0.005,"bb_desc":"-0.00 M/uL/per 40 km/mo (stable)","ba_desc":"-0.00 M/uL/per 40 km/mo (sharp)","effect_unit":"M/uL","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"Running Volume -> MCV","source":"daily_run_km","target":"mcv_smoothed","curve":"linear","theta":189.41,"theta_unit":"km/month","theta_ci":"[146.2, 232.62]","bb":0.009,"ba":-0.067,"bb_desc":"+0.01 fL/per 40 km/mo (stable)","ba_desc":"-0.07 fL/per 40 km/mo (sharp)","effect_unit":"fL","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"Running Volume -> RDW","source":"daily_run_km","target":"rdw_smoothed","curve":"linear","theta":155.86,"theta_unit":"km/month","theta_ci":"[78.52, 233.21]","bb":-0.001,"ba":-0.002,"bb_desc":"-0.00 %/per 40 km/mo","ba_desc":"-0.00 %/per 40 km/mo (sharp)","effect_unit":"%","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"Training Hours -> AST","source":"daily_duration_min","target":"ast_smoothed","curve":"linear","theta":1353.57,"theta_unit":"min/month","theta_ci":"[-449.44, 3156.58]","bb":0,"ba":0.008,"bb_desc":"+0.00 U/L/per 4 hrs/mo (stable)","ba_desc":"+0.01 U/L/per 4 hrs/mo (sharp)","effect_unit":"U/L","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"Training Hours -> ALT","source":"daily_duration_min","target":"alt_smoothed","curve":"linear","theta":1353.57,"theta_unit":"min/month","theta_ci":"[-414.63, 3121.77]","bb":0.001,"ba":0.004,"bb_desc":"+0.00 U/L/per 4 hrs/mo (stable)","ba_desc":"+0.00 U/L/per 4 hrs/mo (sharp)","effect_unit":"U/L","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"Zone 2 Volume -> ApoB","source":"daily_zone2_min","target":"apob_smoothed","curve":"linear","theta":600,"theta_unit":"min/month","theta_ci":"[364.8, 835.2]","bb":-0.125,"ba":-0.037,"bb_desc":"-0.12 mg/dL/per 120 min/mo (strong)","ba_desc":"-0.04 mg/dL/per 120 min/mo","effect_unit":"mg/dL","eff_n":2,"raw_n":452,"personal_pct":6},{"title":"Zone 2 Volume -> Non-HDL Cholesterol","source":"daily_zone2_min","target":"non_hdl_cholesterol_smoothed","curve":"linear","theta":121.88,"theta_unit":"min/month","theta_ci":"[-126.1, 369.86]","bb":-0.011,"ba":-0.125,"bb_desc":"-0.01 mg/dL/per 120 min/mo (stable)","ba_desc":"-0.12 mg/dL/per 120 min/mo (sharp)","effect_unit":"mg/dL","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"Zone 2 Volume -> Total Cholesterol","source":"daily_zone2_min","target":"total_cholesterol_smoothed","curve":"linear","theta":121.88,"theta_unit":"min/month","theta_ci":"[-122.36, 366.12]","bb":-0.015,"ba":-0.075,"bb_desc":"-0.01 mg/dL/per 120 min/mo (stable)","ba_desc":"-0.07 mg/dL/per 120 min/mo (sharp)","effect_unit":"mg/dL","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"Training Hours -> Glucose","source":"daily_duration_min","target":"glucose_smoothed","curve":"linear","theta":1353.57,"theta_unit":"min/month","theta_ci":"[74.17, 2632.97]","bb":-0.004,"ba":-0.001,"bb_desc":"-0.00 mg/dL/per 4 hrs/mo (strong)","ba_desc":"-0.00 mg/dL/per 4 hrs/mo","effect_unit":"mg/dL","eff_n":4,"raw_n":617,"personal_pct":7},{"title":"Training Hours -> Insulin","source":"daily_duration_min","target":"insulin_smoothed","curve":"linear","theta":1353.57,"theta_unit":"min/month","theta_ci":"[-32.86, 2740.0]","bb":-0.001,"ba":-0.001,"bb_desc":"-0.00 uIU/mL/per 4 hrs/mo","ba_desc":"-0.00 uIU/mL/per 4 hrs/mo","effect_unit":"uIU/mL","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"Training Hours -> Uric Acid","source":"daily_duration_min","target":"uric_acid_smoothed","curve":"linear","theta":1327.04,"theta_unit":"min/month","theta_ci":"[-601.29, 3255.37]","bb":0,"ba":-0.001,"bb_desc":"-0.00 mg/dL/per 4 hrs/mo","ba_desc":"-0.00 mg/dL/per 4 hrs/mo","effect_unit":"mg/dL","eff_n":2,"raw_n":452,"personal_pct":6},{"title":"ACWR -> White Blood Cells","source":"acwr","target":"wbc_smoothed","curve":"v_max","theta":1.31,"theta_unit":"ratio","theta_ci":"[0.92, 1.7]","bb":0.02,"ba":-0.05,"bb_desc":"+0.02 K/uL/per 0.1 ACWR","ba_desc":"-0.05 K/uL/per 0.1 ACWR","effect_unit":"K/uL","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"ACWR -> Neutrophil-Lymphocyte Ratio","source":"acwr","target":"nlr","curve":"v_min","theta":1.26,"theta_unit":"ratio","theta_ci":"[0.92, 1.6]","bb":-0.02,"ba":0.104,"bb_desc":"-0.02 ratio/per 0.1 ACWR (stable)","ba_desc":"+0.10 ratio/per 0.1 ACWR (sharp)","effect_unit":"ratio","eff_n":20,"raw_n":618,"personal_pct":27},{"title":"Running Volume -> Zinc","source":"daily_run_km","target":"zinc_smoothed","curve":"linear","theta":189.31,"theta_unit":"km/month","theta_ci":"[161.86, 216.77]","bb":-0.026,"ba":-0.327,"bb_desc":"-0.03 mcg/dL/per 40 km/mo (stable)","ba_desc":"-0.33 mcg/dL/per 40 km/mo (sharp)","effect_unit":"mcg/dL","eff_n":3,"raw_n":830,"personal_pct":6},{"title":"Running Volume -> Magnesium","source":"daily_run_km","target":"magnesium_rbc_smoothed","curve":"linear","theta":181.47,"theta_unit":"km/month","theta_ci":"[150.05, 212.89]","bb":-0.001,"ba":-0.011,"bb_desc":"-0.00 mg/dL/per 40 km/mo (stable)","ba_desc":"-0.01 mg/dL/per 40 km/mo (sharp)","effect_unit":"mg/dL","eff_n":2,"raw_n":452,"personal_pct":6},{"title":"Training Hours -> DHEA-S","source":"daily_duration_min","target":"dhea_s_smoothed","curve":"v_max","theta":1353.57,"theta_unit":"min/month","theta_ci":"[-376.87, 3084.01]","bb":0.011,"ba":-0.021,"bb_desc":"+0.01 mcg/dL/per 4 hrs/mo","ba_desc":"-0.02 mcg/dL/per 4 hrs/mo","effect_unit":"mcg/dL","eff_n":3,"raw_n":830,"personal_pct":6},{"title":"Training Hours -> SHBG","source":"daily_duration_min","target":"shbg_smoothed","curve":"linear","theta":1353.57,"theta_unit":"min/month","theta_ci":"[-22.44, 2729.58]","bb":0,"ba":0.006,"bb_desc":"+0.00 nmol/L/per 4 hrs/mo (stable)","ba_desc":"+0.01 nmol/L/per 4 hrs/mo (sharp)","effect_unit":"nmol/L","eff_n":1,"raw_n":830,"personal_pct":5},{"title":"Training Hours -> Homocysteine","source":"daily_duration_min","target":"homocysteine_smoothed","curve":"linear","theta":1353.57,"theta_unit":"min/month","theta_ci":"[-467.3, 3174.44]","bb":0,"ba":-0.001,"bb_desc":"-0.00 umol/L/per 4 hrs/mo","ba_desc":"-0.00 umol/L/per 4 hrs/mo (sharp)","effect_unit":"umol/L","eff_n":3,"raw_n":830,"personal_pct":6},{"title":"Training Hours -> Creatinine","source":"daily_duration_min","target":"creatinine_smoothed","curve":"linear","theta":1353.57,"theta_unit":"min/month","theta_ci":"[-797.61, 3504.75]","bb":0,"ba":0,"bb_desc":"+0.00 mg/dL/per 4 hrs/mo (stable)","ba_desc":"+0.00 mg/dL/per 4 hrs/mo (sharp)","effect_unit":"mg/dL","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"Training Hours -> Estradiol","source":"daily_duration_min","target":"estradiol_smoothed","curve":"linear","theta":1353.57,"theta_unit":"min/month","theta_ci":"[-851.58, 3558.72]","bb":0,"ba":-0.004,"bb_desc":"+0.00 pg/mL/per 4 hrs/mo (stable)","ba_desc":"-0.00 pg/mL/per 4 hrs/mo (sharp)","effect_unit":"pg/mL","eff_n":3,"raw_n":830,"personal_pct":6},{"title":"Training Hours -> Platelet Count","source":"daily_duration_min","target":"platelets_smoothed","curve":"linear","theta":1353.57,"theta_unit":"min/month","theta_ci":"[-816.14, 3523.28]","bb":0.004,"ba":0.021,"bb_desc":"+0.00 K/uL/per 4 hrs/mo (stable)","ba_desc":"+0.02 K/uL/per 4 hrs/mo (sharp)","effect_unit":"K/uL","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"Training Hours -> Albumin","source":"daily_duration_min","target":"albumin_smoothed","curve":"linear","theta":1353.57,"theta_unit":"min/month","theta_ci":"[-776.59, 3483.73]","bb":0,"ba":0,"bb_desc":"+0.00 g/dL/per 4 hrs/mo","ba_desc":"+0.00 g/dL/per 4 hrs/mo","effect_unit":"g/dL","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"Sleep Duration -> Cortisol","source":"sleep_duration_hrs","target":"cortisol_smoothed","curve":"linear","theta":7,"theta_unit":"hours","theta_ci":"[5.04, 8.96]","bb":-1,"ba":-0.2,"bb_desc":"-1.00 mcg/dL/per hr (strong)","ba_desc":"-0.20 mcg/dL/per hr (diminishing)","effect_unit":"mcg/dL","eff_n":2,"raw_n":452,"personal_pct":6},{"title":"Sleep Duration -> Testosterone","source":"sleep_duration_hrs","target":"testosterone_smoothed","curve":"linear","theta":7,"theta_unit":"hours","theta_ci":"[5.04, 8.96]","bb":15,"ba":3,"bb_desc":"+15.00 ng/dL/per hr (strong)","ba_desc":"+3.00 ng/dL/per hr (diminishing)","effect_unit":"ng/dL","eff_n":3,"raw_n":830,"personal_pct":6},{"title":"Sleep Duration -> Glucose","source":"sleep_duration_hrs","target":"glucose_smoothed","curve":"linear","theta":7,"theta_unit":"hours","theta_ci":"[5.04, 8.96]","bb":-2,"ba":-0.3,"bb_desc":"-2.00 mg/dL/per hr (strong)","ba_desc":"-0.30 mg/dL/per hr (diminishing)","effect_unit":"mg/dL","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"Sleep Duration -> WBC","source":"sleep_duration_hrs","target":"wbc_smoothed","curve":"linear","theta":7,"theta_unit":"hours","theta_ci":"[5.04, 8.96]","bb":0.03,"ba":0.05,"bb_desc":"+0.03 K/uL/per hr","ba_desc":"+0.05 K/uL/per hr","effect_unit":"K/uL","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"Omega-3 Index -> hsCRP","source":"omega3_index_derived","target":"hscrp_smoothed","curve":"linear","theta":2.79,"theta_unit":"%","theta_ci":"[0.24, 5.34]","bb":-0.024,"ba":-0.01,"bb_desc":"-0.02 mg/L/per 1%","ba_desc":"-0.01 mg/L/per 1%","effect_unit":"mg/L","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"Homocysteine -> hsCRP","source":"homocysteine_smoothed","target":"hscrp_smoothed","curve":"linear","theta":8.93,"theta_unit":"umol/L","theta_ci":"[1.38, 16.48]","bb":0.004,"ba":0.02,"bb_desc":"+0.00 mg/L/per umol/L (stable)","ba_desc":"+0.02 mg/L/per umol/L (sharp)","effect_unit":"mg/L","eff_n":4,"raw_n":618,"personal_pct":7},{"title":"Dietary Protein -> Body Fat","source":"dietary_protein_g","target":"body_fat_pct","curve":"linear","theta":50.51,"theta_unit":"g","theta_ci":"[20.51, 80.52]","bb":0,"ba":-0.005,"bb_desc":"+0.00 %/per 10 g/day (stable)","ba_desc":"-0.01 %/per 10 g/day (sharp)","effect_unit":"%","eff_n":20,"raw_n":28,"personal_pct":27},{"title":"Dietary Energy -> Body Mass","source":"dietary_energy_kcal","target":"body_mass_kg","curve":"linear","theta":1498.75,"theta_unit":"kcal","theta_ci":"[555.37, 2442.12]","bb":0,"ba":0.002,"bb_desc":"+0.00 kg/per 100 kcal/day (stable)","ba_desc":"+0.00 kg/per 100 kcal/day (sharp)","effect_unit":"kg","eff_n":20,"raw_n":29,"personal_pct":27},{"title":"Travel Load -> NLR","source":"travel_load","target":"nlr","curve":"linear","theta":0.55,"theta_unit":"jet lag score","theta_ci":"[0.11, 0.99]","bb":0.011,"ba":0.06,"bb_desc":"+0.01 ratio/per 0.2 load (stable)","ba_desc":"+0.06 ratio/per 0.2 load (sharp)","effect_unit":"ratio","eff_n":87,"raw_n":611,"personal_pct":100},{"title":"Travel Load -> Deep Sleep","source":"travel_load","target":"deep_sleep_min","curve":"linear","theta":0.5,"theta_unit":"jet lag score","theta_ci":"[0.21, 0.8]","bb":-1.946,"ba":-4.962,"bb_desc":"-1.95 min/per 0.2 load","ba_desc":"-4.96 min/per 0.2 load","effect_unit":"min","eff_n":378,"raw_n":1136,"personal_pct":100}]'),qs={running_volume:{id:"running_volume",label:"Running Volume",columns:["daily_run_km","run_distance_km","distance_walking_running_km"],unit:"km",compleCategory:"C"},training_duration:{id:"training_duration",label:"Training Duration",columns:["daily_duration_min","workout_duration_min","ah_workout_duration_min","exercise_time_min"],unit:"min",compleCategory:"C"},zone2_volume:{id:"zone2_volume",label:"Zone 2 Volume",columns:["daily_zone2_min","zone2_minutes"],unit:"min",compleCategory:"C"},total_distance:{id:"total_distance",label:"Total Distance",columns:["daily_distance_km","distance_walking_running_km"],unit:"km",compleCategory:"C"},active_energy:{id:"active_energy",label:"Active Energy",columns:["active_energy_kcal","ah_workout_energy_kcal"],unit:"kcal",compleCategory:"C"},daily_steps:{id:"daily_steps",label:"Daily Steps",columns:["steps"],unit:"steps",compleCategory:"C"},training_load:{id:"training_load",label:"Training Load (TRIMP)",columns:["daily_trimp"],unit:"TRIMP",compleCategory:"C"},workout_end_time:{id:"workout_end_time",label:"Workout End Time",columns:["last_workout_end_hour","latest_workout_hour"],unit:"hour",compleCategory:"C"},bedtime:{id:"bedtime",label:"Bedtime",columns:["bedtime_hour"],unit:"hour",compleCategory:"C"},acwr:{id:"acwr",label:"ACWR",columns:["acwr"],unit:"ratio",compleCategory:"L"},training_consistency:{id:"training_consistency",label:"Training Consistency",columns:["training_consistency","training_consistency_90d"],unit:"fraction",compleCategory:"L"},sleep_debt:{id:"sleep_debt",label:"Sleep Debt",columns:["sleep_debt_14d"],unit:"hours deficit",compleCategory:"L"},sleep_duration:{id:"sleep_duration",label:"Sleep Duration",columns:["sleep_duration_hrs"],unit:"hours",compleCategory:"C"},travel_load:{id:"travel_load",label:"Travel/Jet Lag Load",columns:["travel_load"],unit:"jet lag score",compleCategory:"L"},dietary_protein:{id:"dietary_protein",label:"Dietary Protein",columns:["dietary_protein_g"],unit:"g",compleCategory:"C"},dietary_energy:{id:"dietary_energy",label:"Dietary Energy",columns:["dietary_energy_kcal"],unit:"kcal",compleCategory:"C"},iron_sat_level:{id:"iron_sat_level",label:"Iron Saturation",columns:["iron_saturation_pct_smoothed","iron_saturation_pct_computed_smoothed"],unit:"%",compleCategory:"M"},vitamin_d_level:{id:"vitamin_d_level",label:"Vitamin D Level",columns:["vitamin_d_smoothed","vitamin_d_raw"],unit:"ng/mL",compleCategory:"M"},omega3_level:{id:"omega3_level",label:"Omega-3 Index",columns:["omega3_index_derived","omega3_index_smoothed"],unit:"%",compleCategory:"M"},b12_level:{id:"b12_level",label:"B12 Level",columns:["b12_smoothed","b12_raw"],unit:"pg/mL",compleCategory:"M"},homocysteine_level:{id:"homocysteine_level",label:"Homocysteine Level",columns:["homocysteine_smoothed","homocysteine_raw"],unit:"umol/L",compleCategory:"M"},ferritin_level:{id:"ferritin_level",label:"Ferritin Level",columns:["ferritin_smoothed","ferritin_raw"],unit:"ng/mL",compleCategory:"M"}},Ks={iron_total:{id:"iron_total",label:"Serum Iron",columns:["iron_total_smoothed","iron_total_raw"],unit:"mcg/dL",compleCategory:"M",biologicalTimescale:"slow"},ferritin:{id:"ferritin",label:"Ferritin",columns:["ferritin_smoothed","ferritin_raw"],unit:"ng/mL",compleCategory:"M",biologicalTimescale:"slow"},hemoglobin:{id:"hemoglobin",label:"Hemoglobin",columns:["hemoglobin_smoothed","hemoglobin_raw"],unit:"g/dL",compleCategory:"M",biologicalTimescale:"slow"},testosterone:{id:"testosterone",label:"Testosterone",columns:["testosterone_smoothed","testosterone_raw"],unit:"ng/dL",compleCategory:"M",biologicalTimescale:"slow"},cortisol:{id:"cortisol",label:"Cortisol",columns:["cortisol_smoothed","cortisol_raw"],unit:"mcg/dL",compleCategory:"M",biologicalTimescale:"slow"},triglycerides:{id:"triglycerides",label:"Triglycerides",columns:["triglycerides_smoothed","triglycerides_raw"],unit:"mg/dL",compleCategory:"M",biologicalTimescale:"slow"},hdl:{id:"hdl",label:"HDL Cholesterol",columns:["hdl_smoothed","hdl_raw"],unit:"mg/dL",compleCategory:"M",biologicalTimescale:"slow"},ldl:{id:"ldl",label:"LDL Cholesterol",columns:["ldl_smoothed","ldl_raw"],unit:"mg/dL",compleCategory:"M",biologicalTimescale:"slow"},hscrp:{id:"hscrp",label:"hs-CRP",columns:["hscrp_smoothed","hscrp_raw"],unit:"mg/L",compleCategory:"M",biologicalTimescale:"medium"},vo2peak:{id:"vo2peak",label:"VO2peak",columns:["vo2_peak_smoothed","vo2max_apple"],unit:"ml/min/kg",compleCategory:"M",biologicalTimescale:"slow"},sleep_efficiency:{id:"sleep_efficiency",label:"Sleep Efficiency",columns:["sleep_efficiency_pct","sleep_efficiency_7d"],unit:"%",compleCategory:"O",biologicalTimescale:"fast"},sleep_quality:{id:"sleep_quality",label:"Sleep Quality",columns:["sleep_quality_score"],unit:"min quality",compleCategory:"O",biologicalTimescale:"fast"},deep_sleep:{id:"deep_sleep",label:"Deep Sleep",columns:["deep_sleep_min","ah_deep_sleep_min"],unit:"min",compleCategory:"O",biologicalTimescale:"fast"},sleep_duration_outcome:{id:"sleep_duration_outcome",label:"Sleep Duration",columns:["sleep_duration_hrs","ah_sleep_total_min"],unit:"hrs",compleCategory:"O",biologicalTimescale:"fast"},hrv_daily:{id:"hrv_daily",label:"Daily HRV",columns:["hrv_daily_mean","sleep_hrv_ms","hrv_ms"],unit:"ms",compleCategory:"O",biologicalTimescale:"fast"},hrv_baseline:{id:"hrv_baseline",label:"HRV 7-Day Baseline",columns:["hrv_7d_mean","sleep_hrv_7d"],unit:"ms",compleCategory:"O",biologicalTimescale:"medium"},resting_hr:{id:"resting_hr",label:"Resting Heart Rate",columns:["resting_hr","sleep_hr_bpm"],unit:"bpm",compleCategory:"O",biologicalTimescale:"fast"},resting_hr_trend:{id:"resting_hr_trend",label:"Resting HR 7-Day Avg",columns:["resting_hr_7d_mean","sleep_hr_7d"],unit:"bpm",compleCategory:"O",biologicalTimescale:"medium"},body_fat:{id:"body_fat",label:"Body Fat %",columns:["body_fat_pct"],unit:"%",compleCategory:"M",biologicalTimescale:"slow"},body_mass:{id:"body_mass",label:"Body Mass",columns:["body_mass_kg"],unit:"kg",compleCategory:"M",biologicalTimescale:"slow"},vitamin_d:{id:"vitamin_d",label:"Vitamin D",columns:["vitamin_d_smoothed","vitamin_d_raw"],unit:"ng/mL",compleCategory:"M",biologicalTimescale:"slow"},wbc:{id:"wbc",label:"White Blood Cells",columns:["wbc_smoothed","wbc_raw"],unit:"K/uL",compleCategory:"M",biologicalTimescale:"slow"},rbc:{id:"rbc",label:"Red Blood Cells",columns:["rbc_smoothed","rbc_raw"],unit:"M/uL",compleCategory:"M",biologicalTimescale:"slow"},platelets:{id:"platelets",label:"Platelet Count",columns:["platelets_smoothed","platelets_raw"],unit:"K/uL",compleCategory:"M",biologicalTimescale:"slow"},mcv:{id:"mcv",label:"Mean Corpuscular Volume",columns:["mcv_smoothed","mcv_raw"],unit:"fL",compleCategory:"M",biologicalTimescale:"slow"},rdw:{id:"rdw",label:"Red Cell Distribution Width",columns:["rdw_smoothed","rdw_raw"],unit:"%",compleCategory:"M",biologicalTimescale:"slow"},nlr:{id:"nlr",label:"Neutrophil-to-Lymphocyte Ratio",columns:["nlr"],unit:"ratio",compleCategory:"M",biologicalTimescale:"slow"},apob:{id:"apob",label:"Apolipoprotein B",columns:["apob_smoothed","apob_raw"],unit:"mg/dL",compleCategory:"M",biologicalTimescale:"slow"},ldl_particle_number:{id:"ldl_particle_number",label:"LDL Particle Number",columns:["ldl_particle_number_smoothed","ldl_particle_number_raw"],unit:"nmol/L",compleCategory:"M",biologicalTimescale:"slow"},non_hdl_cholesterol:{id:"non_hdl_cholesterol",label:"Non-HDL Cholesterol",columns:["non_hdl_cholesterol_smoothed","non_hdl_cholesterol_raw"],unit:"mg/dL",compleCategory:"M",biologicalTimescale:"slow"},total_cholesterol:{id:"total_cholesterol",label:"Total Cholesterol",columns:["total_cholesterol_smoothed","total_cholesterol_raw"],unit:"mg/dL",compleCategory:"M",biologicalTimescale:"slow"},glucose:{id:"glucose",label:"Fasting Glucose",columns:["glucose_smoothed","glucose_raw"],unit:"mg/dL",compleCategory:"M",biologicalTimescale:"slow"},hba1c:{id:"hba1c",label:"HbA1c",columns:["hba1c_smoothed","hba1c_raw"],unit:"%",compleCategory:"M",biologicalTimescale:"slow"},insulin:{id:"insulin",label:"Insulin",columns:["insulin_smoothed","insulin_raw"],unit:"uIU/mL",compleCategory:"M",biologicalTimescale:"slow"},uric_acid:{id:"uric_acid",label:"Uric Acid",columns:["uric_acid_smoothed","uric_acid_raw"],unit:"mg/dL",compleCategory:"M",biologicalTimescale:"slow"},homocysteine:{id:"homocysteine",label:"Homocysteine",columns:["homocysteine_smoothed","homocysteine_raw"],unit:"umol/L",compleCategory:"M",biologicalTimescale:"slow"},b12:{id:"b12",label:"Vitamin B12",columns:["b12_smoothed","b12_raw"],unit:"pg/mL",compleCategory:"M",biologicalTimescale:"slow"},folate:{id:"folate",label:"Folate",columns:["folate_smoothed","folate_raw"],unit:"ng/mL",compleCategory:"M",biologicalTimescale:"slow"},zinc:{id:"zinc",label:"Zinc",columns:["zinc_smoothed","zinc_raw"],unit:"mcg/dL",compleCategory:"M",biologicalTimescale:"slow"},magnesium:{id:"magnesium",label:"Magnesium (RBC)",columns:["magnesium_rbc_smoothed","magnesium_rbc_raw"],unit:"mg/dL",compleCategory:"M",biologicalTimescale:"slow"},omega3_index:{id:"omega3_index",label:"Omega-3 Index",columns:["omega3_index_derived","omega3_index_smoothed"],unit:"%",compleCategory:"M",biologicalTimescale:"slow"},creatinine:{id:"creatinine",label:"Creatinine",columns:["creatinine_smoothed","creatinine_raw"],unit:"mg/dL",compleCategory:"M",biologicalTimescale:"slow"},ast:{id:"ast",label:"AST",columns:["ast_smoothed","ast_raw"],unit:"U/L",compleCategory:"M",biologicalTimescale:"slow"},alt:{id:"alt",label:"ALT",columns:["alt_smoothed","alt_raw"],unit:"U/L",compleCategory:"M",biologicalTimescale:"slow"},albumin:{id:"albumin",label:"Albumin",columns:["albumin_smoothed","albumin_raw"],unit:"g/dL",compleCategory:"M",biologicalTimescale:"slow"},dhea_s:{id:"dhea_s",label:"DHEA-S",columns:["dhea_s_smoothed","dhea_s_raw"],unit:"mcg/dL",compleCategory:"M",biologicalTimescale:"slow"},shbg:{id:"shbg",label:"Sex Hormone Binding Globulin",columns:["shbg_smoothed","shbg_raw"],unit:"nmol/L",compleCategory:"M",biologicalTimescale:"slow"},estradiol:{id:"estradiol",label:"Estradiol",columns:["estradiol_smoothed","estradiol_raw"],unit:"pg/mL",compleCategory:"M",biologicalTimescale:"slow"},free_t_ratio:{id:"free_t_ratio",label:"Free T / Total T Ratio",columns:["free_t_ratio"],unit:"ratio",compleCategory:"M",biologicalTimescale:"slow"}},Tt=[{id:"run_vol_iron",name:"Running Volume -> Iron",doseFamily:"running_volume",responseFamily:"iron_total",category:"metabolic",mechanism:"Foot-strike hemolysis destroys red blood cells; iron lost via hemolysis, sweat, and GI ischemia"},{id:"run_vol_ferritin",name:"Running Volume -> Ferritin",doseFamily:"running_volume",responseFamily:"ferritin",category:"metabolic",mechanism:"Chronic endurance running depletes iron stores through multiple loss pathways"},{id:"run_vol_hemoglobin",name:"Running Volume -> Hemoglobin",doseFamily:"running_volume",responseFamily:"hemoglobin",category:"metabolic",mechanism:"Iron depletion impairs hemoglobin synthesis; chronic running can cause sports anemia"},{id:"training_hrs_testosterone",name:"Training Hours -> Testosterone",doseFamily:"training_duration",responseFamily:"testosterone",category:"metabolic",mechanism:"Overtraining suppresses the hypothalamic-pituitary-gonadal axis"},{id:"training_hrs_cortisol",name:"Training Hours -> Cortisol",doseFamily:"training_duration",responseFamily:"cortisol",category:"metabolic",mechanism:"Chronic training stress elevates baseline cortisol via HPA axis activation"},{id:"zone2_triglycerides",name:"Zone 2 Volume -> Triglycerides",doseFamily:"zone2_volume",responseFamily:"triglycerides",category:"cardio",mechanism:"Aerobic exercise increases lipoprotein lipase activity, clearing triglycerides"},{id:"zone2_hdl",name:"Zone 2 Volume -> HDL",doseFamily:"zone2_volume",responseFamily:"hdl",category:"cardio",mechanism:"Regular aerobic exercise upregulates HDL production and reverse cholesterol transport"},{id:"zone2_ldl",name:"Zone 2 Volume -> LDL",doseFamily:"zone2_volume",responseFamily:"ldl",category:"cardio",mechanism:"Aerobic exercise can modestly reduce LDL and shift particle size"},{id:"acwr_hscrp",name:"ACWR -> Inflammation",doseFamily:"acwr",responseFamily:"hscrp",category:"recovery",mechanism:"Acute overreaching triggers systemic inflammation via muscle damage and oxidative stress"},{id:"acwr_resting_hr",name:"ACWR -> Resting HR Trend",doseFamily:"acwr",responseFamily:"resting_hr_trend",category:"recovery",mechanism:"Chronic overreaching elevates baseline sympathetic tone and resting heart rate"},{id:"consistency_vo2",name:"Training Consistency -> VO2peak",doseFamily:"training_consistency",responseFamily:"vo2peak",category:"cardio",mechanism:"Consistent aerobic training drives mitochondrial biogenesis and cardiac remodeling"},{id:"ferritin_vo2",name:"Ferritin -> VO2peak",doseFamily:"ferritin_level",responseFamily:"vo2peak",category:"metabolic",mechanism:"Iron stores limit oxygen transport capacity via hemoglobin synthesis"},{id:"workout_time_sleep_eff",name:"Workout Time -> Sleep Efficiency",doseFamily:"workout_end_time",responseFamily:"sleep_efficiency",category:"sleep",mechanism:"Late workouts elevate core temperature and sympathetic tone, delaying sleep onset"},{id:"bedtime_sleep_quality",name:"Bedtime -> Sleep Quality",doseFamily:"bedtime",responseFamily:"sleep_quality",category:"sleep",mechanism:"Later bedtimes misalign with circadian melatonin onset, reducing sleep architecture quality"},{id:"bedtime_deep_sleep",name:"Bedtime -> Deep Sleep",doseFamily:"bedtime",responseFamily:"deep_sleep",category:"sleep",mechanism:"Earlier bedtime captures more slow-wave sleep in the first half of the night"},{id:"sleep_dur_hrv",name:"Sleep Duration -> Next-Day HRV",doseFamily:"sleep_duration",responseFamily:"hrv_daily",category:"recovery",mechanism:"Adequate sleep restores parasympathetic tone; insufficient sleep elevates sympathetic activity"},{id:"sleep_debt_resting_hr",name:"Sleep Debt -> Resting HR",doseFamily:"sleep_debt",responseFamily:"resting_hr",category:"recovery",mechanism:"Accumulated sleep deficit elevates sympathetic tone and baseline heart rate"},{id:"trimp_hrv",name:"Daily Training Load -> Next-Day HRV",doseFamily:"training_load",responseFamily:"hrv_daily",category:"recovery",mechanism:"Acute training load drives autonomic nervous system fatigue measured via HRV depression"},{id:"trimp_resting_hr",name:"Daily Training Load -> Next-Day Resting HR",doseFamily:"training_load",responseFamily:"resting_hr",category:"recovery",mechanism:"Acute training elevates next-day resting HR via sympathetic activation and cardiac fatigue"},{id:"steps_sleep_eff",name:"Daily Steps -> Sleep Efficiency",doseFamily:"daily_steps",responseFamily:"sleep_efficiency",category:"sleep",mechanism:"Moderate daily activity promotes sleep; excessive activity may impair it via overarousal"},{id:"energy_deep_sleep",name:"Active Energy -> Deep Sleep",doseFamily:"active_energy",responseFamily:"deep_sleep",category:"sleep",mechanism:"Physical activity increases slow-wave sleep need via adenosine accumulation and thermoregulation"},{id:"weekly_km_hrv",name:"Weekly Volume -> HRV Baseline",doseFamily:"running_volume",responseFamily:"hrv_baseline",category:"recovery",mechanism:"Moderate volume improves vagal tone; excessive volume suppresses it via overtraining"},{id:"travel_sleep_eff",name:"Travel Load -> Sleep Efficiency",doseFamily:"travel_load",responseFamily:"sleep_efficiency",category:"sleep",mechanism:"Jet lag disrupts circadian rhythm, delaying melatonin onset and reducing sleep efficiency"},{id:"travel_hrv",name:"Travel Load -> Daily HRV",doseFamily:"travel_load",responseFamily:"hrv_daily",category:"recovery",mechanism:"Travel stress and circadian misalignment suppress parasympathetic tone measured via HRV"},{id:"travel_rhr",name:"Travel Load -> Resting HR",doseFamily:"travel_load",responseFamily:"resting_hr",category:"recovery",mechanism:"Circadian disruption and travel fatigue elevate sympathetic tone and resting heart rate"},{id:"training_vol_body_fat",name:"Training Volume -> Body Fat",doseFamily:"training_duration",responseFamily:"body_fat",category:"metabolic",mechanism:"Higher training volume increases energy expenditure and fat oxidation"},{id:"steps_body_mass",name:"Daily Activity -> Body Mass",doseFamily:"daily_steps",responseFamily:"body_mass",category:"metabolic",mechanism:"Higher daily activity creates energy deficit supporting weight management"},{id:"run_vol_rbc",name:"Running Volume -> RBC",doseFamily:"running_volume",responseFamily:"rbc",category:"metabolic",mechanism:"Endurance running causes plasma volume expansion, diluting red cell concentration"},{id:"run_vol_mcv",name:"Running Volume -> MCV",doseFamily:"running_volume",responseFamily:"mcv",category:"metabolic",mechanism:"Iron depletion from chronic running leads to microcytic red cells (low MCV)"},{id:"run_vol_rdw",name:"Running Volume -> RDW",doseFamily:"running_volume",responseFamily:"rdw",category:"metabolic",mechanism:"Mixed cell populations from iron depletion increase red cell size variation"},{id:"training_hrs_ast",name:"Training Hours -> AST",doseFamily:"training_duration",responseFamily:"ast",category:"metabolic",mechanism:"Skeletal muscle damage during exercise releases AST into bloodstream"},{id:"training_hrs_alt",name:"Training Hours -> ALT",doseFamily:"training_duration",responseFamily:"alt",category:"metabolic",mechanism:"Exercise-induced hepatic stress and muscle damage elevate ALT"},{id:"zone2_apob",name:"Zone 2 Volume -> ApoB",doseFamily:"zone2_volume",responseFamily:"apob",category:"cardio",mechanism:"Aerobic exercise reduces atherogenic particle count via increased LDL receptor activity"},{id:"zone2_non_hdl",name:"Zone 2 Volume -> Non-HDL Cholesterol",doseFamily:"zone2_volume",responseFamily:"non_hdl_cholesterol",category:"cardio",mechanism:"Aerobic exercise reduces atherogenic lipoproteins (LDL + VLDL + IDL)"},{id:"zone2_total_chol",name:"Zone 2 Volume -> Total Cholesterol",doseFamily:"zone2_volume",responseFamily:"total_cholesterol",category:"cardio",mechanism:"Aerobic exercise net effect on total cholesterol (HDL up, LDL down)"},{id:"training_hrs_glucose",name:"Training Hours -> Glucose",doseFamily:"training_duration",responseFamily:"glucose",category:"metabolic",mechanism:"Exercise upregulates GLUT4 transporters, improving glucose disposal"},{id:"training_hrs_hba1c",name:"Training Hours -> HbA1c",doseFamily:"training_duration",responseFamily:"hba1c",category:"metabolic",mechanism:"Chronic exercise improves long-term glycemic control through insulin sensitization"},{id:"training_hrs_insulin",name:"Training Hours -> Insulin",doseFamily:"training_duration",responseFamily:"insulin",category:"metabolic",mechanism:"Regular exercise improves insulin sensitivity, lowering fasting insulin levels"},{id:"training_hrs_uric_acid",name:"Training Hours -> Uric Acid",doseFamily:"training_duration",responseFamily:"uric_acid",category:"metabolic",mechanism:"Exercise modulates purine metabolism; moderate exercise may lower uric acid"},{id:"acwr_wbc",name:"ACWR -> White Blood Cells",doseFamily:"acwr",responseFamily:"wbc",category:"recovery",mechanism:"Acute overreaching triggers open-window immunosuppression with transient leukopenia"},{id:"acwr_nlr",name:"ACWR -> Neutrophil-Lymphocyte Ratio",doseFamily:"acwr",responseFamily:"nlr",category:"recovery",mechanism:"Training stress shifts immune balance: neutrophilia + lymphopenia = elevated NLR"},{id:"run_vol_zinc",name:"Running Volume -> Zinc",doseFamily:"running_volume",responseFamily:"zinc",category:"metabolic",mechanism:"Zinc lost through sweat during endurance exercise; heavy training depletes stores"},{id:"run_vol_magnesium",name:"Running Volume -> Magnesium",doseFamily:"running_volume",responseFamily:"magnesium",category:"metabolic",mechanism:"Magnesium lost through sweat and increased renal excretion during exercise"},{id:"training_hrs_dhea",name:"Training Hours -> DHEA-S",doseFamily:"training_duration",responseFamily:"dhea_s",category:"metabolic",mechanism:"Moderate exercise stimulates adrenal DHEA production; overtraining may deplete it"},{id:"training_hrs_shbg",name:"Training Hours -> SHBG",doseFamily:"training_duration",responseFamily:"shbg",category:"metabolic",mechanism:"Exercise increases SHBG production, affecting free testosterone availability"},{id:"training_hrs_homocysteine",name:"Training Hours -> Homocysteine",doseFamily:"training_duration",responseFamily:"homocysteine",category:"metabolic",mechanism:"Exercise increases B6/B12/folate demand for methylation; may lower homocysteine"},{id:"training_hrs_creatinine",name:"Training Hours -> Creatinine",doseFamily:"training_duration",responseFamily:"creatinine",category:"metabolic",mechanism:"Higher muscle mass and exercise increase creatine turnover and serum creatinine"},{id:"training_hrs_estradiol",name:"Training Hours -> Estradiol",doseFamily:"training_duration",responseFamily:"estradiol",category:"metabolic",mechanism:"Exercise affects aromatase activity and adipose tissue estrogen production"},{id:"training_hrs_platelets",name:"Training Hours -> Platelet Count",doseFamily:"training_duration",responseFamily:"platelets",category:"metabolic",mechanism:"Acute exercise induces thrombocytosis; chronic training may modulate baseline count"},{id:"training_hrs_albumin",name:"Training Hours -> Albumin",doseFamily:"training_duration",responseFamily:"albumin",category:"metabolic",mechanism:"Exercise-induced plasma volume expansion can dilute serum albumin"},{id:"sleep_dur_cortisol",name:"Sleep Duration -> Cortisol",doseFamily:"sleep_duration",responseFamily:"cortisol",category:"recovery",mechanism:"Sleep restriction elevates next-morning cortisol via HPA axis dysregulation"},{id:"sleep_dur_testosterone",name:"Sleep Duration -> Testosterone",doseFamily:"sleep_duration",responseFamily:"testosterone",category:"recovery",mechanism:"Testosterone is primarily produced during sleep; restriction suppresses production"},{id:"sleep_dur_glucose",name:"Sleep Duration -> Glucose",doseFamily:"sleep_duration",responseFamily:"glucose",category:"recovery",mechanism:"Chronic sleep restriction impairs insulin sensitivity and glucose tolerance"},{id:"sleep_dur_wbc",name:"Sleep Duration -> WBC",doseFamily:"sleep_duration",responseFamily:"wbc",category:"recovery",mechanism:"Adequate sleep supports immune cell production and healthy WBC counts"},{id:"iron_sat_hemoglobin",name:"Iron Saturation -> Hemoglobin",doseFamily:"iron_sat_level",responseFamily:"hemoglobin",category:"metabolic",mechanism:"Iron saturation determines iron availability for hemoglobin synthesis"},{id:"vitamin_d_testosterone",name:"Vitamin D -> Testosterone",doseFamily:"vitamin_d_level",responseFamily:"testosterone",category:"metabolic",mechanism:"Vitamin D receptors in Leydig cells; deficiency is associated with lower testosterone"},{id:"omega3_hscrp",name:"Omega-3 Index -> hsCRP",doseFamily:"omega3_level",responseFamily:"hscrp",category:"metabolic",mechanism:"EPA/DHA compete with arachidonic acid, reducing pro-inflammatory eicosanoid production"},{id:"ferritin_rbc",name:"Ferritin -> RBC",doseFamily:"ferritin_level",responseFamily:"rbc",category:"metabolic",mechanism:"Iron stores support erythropoiesis; depletion impairs red blood cell production"},{id:"ferritin_hemoglobin",name:"Ferritin -> Hemoglobin",doseFamily:"ferritin_level",responseFamily:"hemoglobin",category:"metabolic",mechanism:"Low ferritin limits iron availability for hemoglobin synthesis"},{id:"b12_homocysteine",name:"B12 -> Homocysteine",doseFamily:"b12_level",responseFamily:"homocysteine",category:"metabolic",mechanism:"B12 is a cofactor for methionine synthase which clears homocysteine"},{id:"homocysteine_hscrp",name:"Homocysteine -> hsCRP",doseFamily:"homocysteine_level",responseFamily:"hscrp",category:"metabolic",mechanism:"Elevated homocysteine promotes endothelial dysfunction and vascular inflammation"},{id:"protein_body_fat",name:"Dietary Protein -> Body Fat",doseFamily:"dietary_protein",responseFamily:"body_fat",category:"metabolic",mechanism:"Higher protein intake increases thermic effect and satiety, supporting fat loss"},{id:"energy_body_mass",name:"Dietary Energy -> Body Mass",doseFamily:"dietary_energy",responseFamily:"body_mass",category:"metabolic",mechanism:"Chronic energy surplus/deficit drives body mass changes via energy balance"},{id:"travel_nlr",name:"Travel Load -> NLR",doseFamily:"travel_load",responseFamily:"nlr",category:"recovery",mechanism:"Travel stress and circadian disruption shift immune balance toward neutrophilia"},{id:"travel_deep_sleep",name:"Travel Load -> Deep Sleep",doseFamily:"travel_load",responseFamily:"deep_sleep",category:"sleep",mechanism:"Jet lag disrupts slow-wave sleep architecture via circadian misalignment"}],Xs=["sweat_iron_loss","gi_iron_loss","lipoprotein_lipase","reverse_cholesterol_transport","core_temperature","energy_expenditure","leptin","insulin_sensitivity"],Qs={"apple-watch":["steps","active_energy_kcal","resting_hr","resting_hr_7d_mean","hrv_daily_mean","hrv_7d_mean","vo2max_apple","body_mass_kg","body_fat_pct","distance_walking_running_km","ah_workout_duration_min","ah_workout_energy_kcal","dietary_protein_g","dietary_energy_kcal"],autosleep:["sleep_duration_hrs","sleep_efficiency_pct","sleep_quality_score","deep_sleep_min","ah_deep_sleep_min","bedtime_hour","sleep_hr_bpm","sleep_hrv_ms","sleep_hrv_7d","sleep_hr_7d","sleep_debt_14d"],gpx:["daily_run_km","run_distance_km","daily_distance_km","daily_duration_min","daily_zone2_min","zone2_minutes","daily_trimp","acwr","training_consistency","training_consistency_90d","monotony","last_workout_end_hour","latest_workout_hour","daily_high_intensity_min"],bloodwork:["iron_total_smoothed","iron_total_raw","ferritin_smoothed","ferritin_raw","hemoglobin_smoothed","hemoglobin_raw","testosterone_smoothed","testosterone_raw","cortisol_smoothed","cortisol_raw","triglycerides_smoothed","triglycerides_raw","hdl_smoothed","hdl_raw","ldl_smoothed","ldl_raw","hscrp_smoothed","hscrp_raw","vitamin_d_smoothed","vitamin_d_raw","wbc_smoothed","wbc_raw","rbc_smoothed","rbc_raw","platelets_smoothed","platelets_raw","mcv_smoothed","mcv_raw","rdw_smoothed","rdw_raw","nlr","apob_smoothed","apob_raw","ldl_particle_number_smoothed","ldl_particle_number_raw","non_hdl_cholesterol_smoothed","non_hdl_cholesterol_raw","total_cholesterol_smoothed","total_cholesterol_raw","glucose_smoothed","glucose_raw","hba1c_smoothed","hba1c_raw","insulin_smoothed","insulin_raw","uric_acid_smoothed","uric_acid_raw","homocysteine_smoothed","homocysteine_raw","b12_smoothed","b12_raw","folate_smoothed","folate_raw","zinc_smoothed","zinc_raw","magnesium_rbc_smoothed","magnesium_rbc_raw","omega3_index_derived","omega3_index_smoothed","creatinine_smoothed","creatinine_raw","ast_smoothed","ast_raw","alt_smoothed","alt_raw","albumin_smoothed","albumin_raw","dhea_s_smoothed","dhea_s_raw","shbg_smoothed","shbg_raw","estradiol_smoothed","estradiol_raw","free_t_ratio","iron_saturation_pct_smoothed","iron_saturation_pct_computed_smoothed"],"medix-cpet":["vo2_peak_smoothed"],derived:["travel_load","season","location","is_weekend","day_of_week","year","month"]},En=[{id:"cgm",name:"Continuous Glucose Monitor",icon:"Activity",category:"Metabolic",description:"Real-time interstitial glucose every 1-5 minutes, enabling glucose variability metrics, time-in-range, and meal response curves.",exampleProducts:["Dexcom G7","Abbott Libre 3","Levels"],newDoseFamilies:[],newResponseFamilies:["glucose","hba1c"],newColumns:["cgm_mean_glucose","cgm_glucose_variability_cv","cgm_time_in_range_pct","cgm_time_above_140","cgm_time_above_180","cgm_dawn_effect"],frequency:"Continuous (288+ readings/day)",keyEdgeNarratives:[{edgeTitle:"Training Hours → Glucose",type:"boost",narrative:"Currently eff_n=4 from quarterly labs. CGM would provide daily glucose, boosting personal evidence from 7% to near 100% — revealing whether Oron's training volume actually improves his glycemic control."},{edgeTitle:"Training Hours → Insulin",type:"boost",narrative:"Insulin sensitivity is a latent confounder in Oron's metabolic pathway. Daily glucose variability from CGM would serve as a proxy, helping disentangle the training → insulin_sensitivity → glucose chain."},{edgeTitle:"Sleep Duration → Glucose",type:"boost",narrative:"Oron's sleep-glucose edge is prior-dominated (eff_n=4). CGM would capture overnight glucose dips and dawn effects, directly testing whether his 7+ hour sleep target actually lowers fasting glucose."}]},{id:"nutrition",name:"Nutrition Tracker",icon:"Apple",category:"Nutrition",description:"Dedicated daily macro/micronutrient tracking improves dietary data consistency and adds carbs, fat, fiber, and sodium columns beyond what Apple Health provides.",exampleProducts:["Cronometer","MacroFactor","MyFitnessPal"],newDoseFamilies:[],newResponseFamilies:[],newColumns:["dietary_carbs_g","dietary_fat_g","dietary_fiber_g","dietary_sodium_mg"],frequency:"Daily logging",keyEdgeNarratives:[{edgeTitle:"Dietary Protein → Body Fat",type:"boost",narrative:"Currently only 28 raw observations. Consistent daily logging would dramatically increase eff_n, testing whether Oron's protein intake above ~50g/day actually drives the body fat reduction the literature predicts."},{edgeTitle:"Dietary Energy → Body Mass",type:"boost",narrative:"With 29 raw data points, this edge is 73% population prior. Daily caloric tracking would personalize the energy balance curve — does Oron's 75.9kg frame respond to energy surplus the way the Hall et al. Lancet model predicts?"}]},{id:"blood_pressure",name:"Blood Pressure Monitor",icon:"Heart",category:"Cardiovascular",description:"Daily systolic/diastolic and MAP readings to link training load, sleep, and sodium to vascular health.",exampleProducts:["Withings BPM Connect","Omron Evolv","QardioArm"],newDoseFamilies:[],newResponseFamilies:[],newColumns:["systolic_bp","diastolic_bp","mean_arterial_pressure","pulse_pressure"],frequency:"Daily (AM/PM)",keyEdgeNarratives:[{edgeTitle:"ACWR → Resting HR Trend",type:"boost",narrative:"Oron's strongest edge (eff_n=342, 100% personal). Adding daily BP would reveal whether the ACWR → HR elevation also drives blood pressure spikes — a cardiovascular risk signal not currently captured."},{edgeTitle:"Travel → Resting HR",type:"boost",narrative:"Travel elevates Oron's resting HR by +1.09 bpm per 0.2 jet-lag load. BP data would show whether this sympathetic activation also raises blood pressure, distinguishing benign HR elevation from vascular stress."},{edgeTitle:"Sleep Debt → Resting HR",type:"boost",narrative:"Sleep debt raises Oron's HR by +0.19 bpm per hour of deficit. Daily BP would test whether this HR signal propagates to hypertensive risk — critical for a 43-year-old endurance athlete."}]},{id:"body_temperature",name:"Body Temperature Sensor",icon:"Thermometer",category:"Recovery",description:"Continuous skin or core temperature enables circadian tracking, illness detection, and recovery monitoring.",exampleProducts:["Oura Ring","WHOOP 4.0","TempDrop"],newDoseFamilies:[],newResponseFamilies:[],newColumns:["skin_temp_deviation","core_temp_est","nocturnal_temp_min"],frequency:"Continuous overnight",keyEdgeNarratives:[{edgeTitle:"Workout Time → Sleep Efficiency",type:"boost",narrative:"Oron's data shows workouts after 8:09 PM drop sleep efficiency by -2.19%/hr. Core temperature is the latent mediator — temperature data would directly test whether post-exercise thermoregulation is the mechanism, not just correlational timing."},{edgeTitle:"Bedtime → Deep Sleep",type:"boost",narrative:"Deep sleep drops -2.64 min per hour of late bedtime. Nocturnal temperature minimum timing would reveal whether circadian temperature rhythm — not bedtime per se — is the true driver of deep sleep architecture."},{edgeTitle:"core_temperature (confounder)",type:"confounder",narrative:"Resolves the core_temperature latent node in the DAG. Currently unobservable, it sits on the training_load → core_temp → sleep_quality causal chain. Direct measurement eliminates this confounding pathway."}]},{id:"mood_stress",name:"Mood / Stress Tracker",icon:"Brain",category:"Subjective",description:"Daily subjective ratings for mood, stress, energy, and motivation. Resolves confounders like perceived stress → cortisol.",exampleProducts:["Daylio","How We Feel","Bearable"],newDoseFamilies:[],newResponseFamilies:[],newColumns:["mood_score","stress_score","energy_score","motivation_score","perceived_exertion_rpe"],frequency:"Daily self-report",keyEdgeNarratives:[{edgeTitle:"Training Hours → Testosterone",type:"boost",narrative:"Oron's testosterone edge (eff_n=3) is 94% population prior. Perceived stress data would help disentangle the cortisol → testosterone suppression pathway — is overtraining or psychological stress driving the inverted-U curve at θ=1354 min/month?"},{edgeTitle:"Training Hours → Cortisol",type:"boost",narrative:"Cortisol rises above the training threshold (v_min curve). RPE and stress ratings would reveal whether cortisol spikes come from training load itself or from life stress confounding the dose-response relationship."},{edgeTitle:"energy_expenditure (confounder)",type:"confounder",narrative:"Resolves the energy_expenditure latent node. RPE data serves as a proxy for total energy expenditure, helping separate the training → energy_expenditure → body_fat pathway from dietary effects."}]},{id:"monthly_labs",name:"Monthly Lab Testing",icon:"TestTube",category:"Biomarkers",description:"Increasing blood draw frequency from quarterly to monthly dramatically boosts eff_n for all marker-based edges, improving personal evidence weight.",exampleProducts:["Quest Direct","InsideTracker","Function Health"],newDoseFamilies:[],newResponseFamilies:[],newColumns:[],frequency:"Monthly blood draws",keyEdgeNarratives:[{edgeTitle:"Running Volume → Iron",type:"boost",narrative:"The most critical edge for Oron — iron depletion from running — currently has eff_n=2 (6% personal). Monthly draws would push eff_n above 30, crossing the sigmoid inflection point where personal data overtakes the Sim et al. 2019 population prior."},{edgeTitle:"Running Volume → Ferritin",type:"boost",narrative:"Ferritin is Oron's primary iron status marker, but at eff_n=2 the posterior is 94% literature. Monthly testing would reveal his personal ferritin depletion rate — critical for calibrating iron supplementation around high-mileage training blocks."},{edgeTitle:"Training Hours → Testosterone",type:"boost",narrative:"The inverted-U testosterone curve (θ=1354 min/month) is almost entirely population prior. Monthly testosterone draws would test whether Oron's specific HPA axis responds to overtraining the way Hackney et al. predict."}]},{id:"dedicated_hrv",name:"Dedicated HRV Monitor",icon:"HeartPulse",category:"Recovery",description:"Chest-strap or finger-clip HRV with higher accuracy than wrist-based sensors, enabling RMSSD, pNN50, and frequency-domain metrics.",exampleProducts:["Polar H10","Elite HRV","Corsense"],newDoseFamilies:[],newResponseFamilies:["hrv_daily","hrv_baseline"],newColumns:["hrv_rmssd_morning","hrv_pnn50","hrv_lf_hf_ratio"],frequency:"Daily 2-min morning reading",keyEdgeNarratives:[{edgeTitle:"TRIMP → Next-Day HRV",type:"boost",narrative:"Oron's strongest recovery edge (eff_n=797). Chest-strap RMSSD would improve measurement accuracy, potentially revealing the v_max curve's true shape — HRV peaks at θ=86 TRIMP then drops -0.06 ms per 50 TRIMP above that."},{edgeTitle:"Weekly Volume → HRV Baseline",type:"boost",narrative:"Running volume boosts HRV baseline up to 21 km/week, then plateaus. Higher-accuracy HRV data would sharpen the plateau_up curve, helping Oron identify whether additional weekly mileage still provides vagal tone benefit."},{edgeTitle:"Sleep Duration → HRV",type:"boost",narrative:"Currently eff_n=745 with wrist-based HRV. A dedicated monitor would reduce measurement noise on this linear edge (+0.41 ms per hour of sleep), giving more precise sleep optimization targets."}]},{id:"genetic_data",name:"Genetic Data",icon:"Dna",category:"Genomics",description:"SNP data enables Mendelian randomization and gene-environment interaction analysis. Resolves confounders for iron metabolism, vitamin D, and lipid pathways.",exampleProducts:["23andMe","AncestryDNA + Promethease","SelfDecode"],newDoseFamilies:[],newResponseFamilies:[],newColumns:["iron_absorption_prs","vitd_metabolism_prs","ldl_receptor_prs","caffeine_metabolism_cyp1a2","apoe_genotype"],frequency:"One-time test",keyEdgeNarratives:[{edgeTitle:"Running Volume → Iron (via iron_absorption_prs)",type:"confounder",narrative:"Oron's iron depletion may partly reflect genetic iron absorption efficiency. An iron absorption PRS would enable Mendelian randomization — separating how much iron loss comes from running hemolysis vs. how much is constitutional poor absorption."},{edgeTitle:"Zone 2 → LDL (via ldl_receptor_prs)",type:"confounder",narrative:"Oron's LDL response to zone 2 exercise (β=-0.075 mg/dL per 120 min/mo) is mostly prior-driven. An LDL receptor PRS would reveal whether his genetic lipid metabolism explains the weak personal signal, resolving the lipoprotein_lipase confounder."},{edgeTitle:"insulin_sensitivity (confounder)",type:"confounder",narrative:"Resolves the insulin_sensitivity latent node. Genetic data provides time-invariant instruments for HOMA-IR, disentangling the training → insulin_sensitivity → glucose chain without needing repeated fasting insulin measurements."}]},{id:"respiratory_rate",name:"Respiratory Rate Monitor",icon:"Wind",category:"Recovery",description:"Nocturnal respiratory rate is an early marker of overtraining, illness onset, and autonomic stress.",exampleProducts:["WHOOP","Oura Gen3","Garmin (select models)"],newDoseFamilies:[],newResponseFamilies:[],newColumns:["respiratory_rate_sleep","respiratory_rate_variability"],frequency:"Continuous overnight",keyEdgeNarratives:[{edgeTitle:"TRIMP → Next-Day HRV",type:"boost",narrative:"Respiratory rate is an independent autonomic stress marker. Combined with HRV, it would disambiguate whether post-training HRV suppression (the v_max curve at θ=86 TRIMP) reflects cardiac autonomic fatigue or respiratory compensation."},{edgeTitle:"Travel → Sleep Efficiency",type:"boost",narrative:"Oron's travel → sleep efficiency edge is strong (β=-8.63%/per 0.2 jet-lag load above θ=0.48). Nocturnal respiratory rate changes during travel would reveal whether the disruption is primarily circadian or stress-mediated."}]}];function va(){const t=new Set;for(const a of Object.values(Qs))for(const s of a)t.add(s);return t}function ta(t,a){const s=qs[t];return s?s.columns.some(i=>a.has(i)):!1}function aa(t,a){const s=Ks[t];return s?s.columns.some(i=>a.has(i)):!1}function Js(t){const a=[],s=[];for(const i of Tt){const r=ta(i.doseFamily,t),n=aa(i.responseFamily,t),o={mechanism:i,testable:r&&n,hasDoseData:r,hasResponseData:n,missingDoseFamilies:r?[]:[i.doseFamily],missingResponseFamilies:n?[]:[i.responseFamily]};o.testable?a.push(o):s.push(o)}return{testable:a,untestable:s}}function Wn(t,a,s){const i=new Set(a);for(const v of t.newColumns)i.add(v);for(const v of t.newDoseFamilies){const _=qs[v];_&&_.columns.forEach(f=>i.add(f))}for(const v of t.newResponseFamilies){const _=Ks[v];_&&_.columns.forEach(f=>i.add(f))}const r=new Set(Tt.filter(v=>ta(v.doseFamily,a)&&aa(v.responseFamily,a)).map(v=>v.id)),o=Tt.filter(v=>ta(v.doseFamily,i)&&aa(v.responseFamily,i)).filter(v=>!r.has(v.id)),c=o.length,l=Math.min(40,c*15),d=[];for(const v of Xs)t.newColumns.some(f=>{const j=f.toLowerCase(),N=v.toLowerCase().replace(/_/g,"");return j.includes(N)||N.includes(j.replace(/_/g,""))})&&d.push(v);t.id==="body_temperature"&&(d.includes("core_temperature")||d.push("core_temperature")),t.id==="mood_stress"&&(d.includes("energy_expenditure")||d.push("energy_expenditure")),t.id==="genetic_data"&&(d.includes("insulin_sensitivity")||d.push("insulin_sensitivity"),d.includes("lipoprotein_lipase")||d.push("lipoprotein_lipase"));const u=d.length,m=Math.min(30,u*15),h=[];if(t.id==="monthly_labs")for(const v of s)v.eff_n<20&&h.push(v.title);if(t.id==="dedicated_hrv")for(const v of s)(v.target.includes("hrv")||v.source.includes("hrv"))&&h.push(v.title);if(t.id==="cgm")for(const v of s)(v.target.includes("glucose")||v.source.includes("glucose")||v.target.includes("insulin")||v.target.includes("hba1c"))&&h.push(v.title);if(t.id==="nutrition")for(const v of s)(v.source.includes("dietary")||v.source.includes("protein"))&&h.push(v.title);if(t.id==="blood_pressure")for(const v of s)(v.target.includes("resting_hr")||v.target.includes("hr_7d")||v.title.toLowerCase().includes("cardio"))&&h.push(v.title);if(t.id==="mood_stress")for(const v of s)(v.target.includes("cortisol")||v.target.includes("testosterone")||v.title.toLowerCase().includes("sleep"))&&h.push(v.title);if(t.id==="respiratory_rate")for(const v of s)(v.target.includes("hrv")||v.target.includes("sleep"))&&h.push(v.title);if(t.id==="body_temperature")for(const v of s)(v.target.includes("sleep")||v.title.toLowerCase().includes("sleep"))&&h.push(v.title);const p=h.length,b=Math.min(30,p*5),y=Math.min(100,l+m+b);let w;return y>=70?w="transformative":y>=45?w="high":y>=20?w="moderate":w="low",{candidateId:t.id,composite:y,newEdgesUnlocked:c,newEdgePoints:l,confoundersResolved:u,confounderPoints:m,signalBoostEdges:p,signalBoostPoints:b,tier:w,unlockedMechanisms:o,resolvedLatentNodes:d,boostedEdgeTitles:h}}function Hn(t,a){const s=En.map(i=>({candidate:i,score:Wn(i,t,a)}));return s.sort((i,r)=>r.score.composite-i.score.composite),s}const Vn=[{id:"apple-watch",name:"Apple Watch",icon:"Watch",category:"Wearable",deviceKey:"apple-watch"},{id:"autosleep",name:"AutoSleep",icon:"Moon",category:"Sleep",deviceKey:"autosleep"},{id:"gpx",name:"GPX / Training Logs",icon:"Map",category:"Training",deviceKey:"gpx"},{id:"bloodwork",name:"Quest / Bloodwork",icon:"TestTube2",category:"Biomarkers",deviceKey:"bloodwork"},{id:"medix-cpet",name:"MEDIX CPET",icon:"Stethoscope",category:"Clinical",deviceKey:"medix-cpet"}];function On(t){return va(),Vn.map(a=>{const s=Qs[a.deviceKey]??[],i=new Set(s);let r=0,n=0,o=0,c=0;for(const l of t){const d=i.has(l.source),u=i.has(l.target);(d||u)&&(r++,n+=l.personal_pct,o+=l.eff_n,c++)}return{id:a.id,name:a.name,icon:a.icon,category:a.category,edgesParticipating:r,totalEdges:t.length,columns:s,avgPersonalPct:c>0?Math.round(n/c):0,avgEffN:c>0?Math.round(o/c):0}})}function Bn(t){const a=va(),{testable:s,untestable:i}=Js(a),r=Tt.length,n=Math.round(s.length/r*100),o=t.length>0?Math.round(t.reduce((c,l)=>c+l.personal_pct,0)/t.length):0;return{totalMechanisms:r,testableCount:s.length,untestableCount:i.length,testedPct:n,avgPersonalWeight:o,latentNodeCount:Xs.length,fittedEdgeCount:t.length}}function Fn(){const t=Ln,a=g.useMemo(()=>va(),[]),{testable:s,untestable:i}=g.useMemo(()=>Js(a),[a]),r=g.useMemo(()=>Hn(a,t),[a,t]),n=g.useMemo(()=>On(t),[t]),o=g.useMemo(()=>Bn(t),[t]);return{edgeResults:t,existingSources:n,rankedCandidates:r,testableEdges:s,untestableEdges:i,...o}}const $n={default:"bg-white border border-slate-200 shadow-sm",outlined:"bg-white border border-slate-200",elevated:"bg-white border border-slate-100 shadow-md",ghost:"bg-slate-50/50 border border-slate-100"},zn={none:"",sm:"p-4",md:"p-5",lg:"p-6"},Gn={cyan:"border-l-serif-cyan bg-gradient-to-r from-primary-50/30 to-transparent",pink:"border-l-serif-pink bg-gradient-to-r from-accent-50/30 to-transparent",lavender:"border-l-serif-lavender bg-gradient-to-r from-secondary-50/30 to-transparent",muted:"border-l-serif-blue bg-gradient-to-r from-muted-50/30 to-transparent",success:"border-l-emerald-400 bg-gradient-to-r from-emerald-50/30 to-transparent",warning:"border-l-amber-400 bg-gradient-to-r from-amber-50/30 to-transparent"},k=g.forwardRef(({className:t,variant:a="default",padding:s="md",interactive:i=!1,accent:r,accentLabel:n,children:o,...c},l)=>e.jsxs("div",{ref:l,className:x("rounded-xl",$n[a],zn[s],r&&"border-l-[3px]",r&&Gn[r],i&&"cursor-pointer transition-all duration-200 hover:shadow-lg hover:border-slate-300",t),...c,children:[r&&n&&e.jsx("p",{className:"text-[10px] font-medium text-slate-500 uppercase tracking-wider mb-3",children:n}),o]}));k.displayName="Card";const Un=g.forwardRef(({className:t,title:a,subtitle:s,action:i,children:r,...n},o)=>e.jsxs("div",{ref:o,className:x("flex items-start justify-between mb-4",t),...n,children:[a||s?e.jsxs("div",{children:[a&&e.jsx("h3",{className:"text-base font-semibold text-slate-800 tracking-tight",children:a}),s&&e.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:s})]}):r,i&&e.jsx("div",{className:"ml-4 flex-shrink-0",children:i})]}));Un.displayName="CardHeader";const Yn=g.forwardRef(({className:t,children:a,...s},i)=>e.jsx("div",{ref:i,className:x("",t),...s,children:a}));Yn.displayName="CardContent";const Zn=g.forwardRef(({className:t,children:a,...s},i)=>e.jsx("div",{ref:i,className:x("mt-4 pt-4 border-t border-slate-100 flex items-center justify-between",t),...s,children:a}));Zn.displayName="CardFooter";const Me=g.forwardRef(({label:t,value:a,unit:s,trend:i,trendValue:r,icon:n,className:o,...c},l)=>{const d={up:"text-emerald-600 bg-emerald-50",down:"text-rose-600 bg-rose-50",stable:"text-slate-600 bg-slate-50"},u={up:"↑",down:"↓",stable:"→"};return e.jsx(k,{ref:l,className:x("",o),...c,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] font-medium text-slate-500 uppercase tracking-wider",children:t}),e.jsxs("div",{className:"flex items-baseline mt-2",children:[e.jsx("span",{className:"text-2xl font-semibold text-slate-800",children:a}),s&&e.jsx("span",{className:"ml-1.5 text-sm text-slate-400",children:s})]}),i&&r&&e.jsxs("p",{className:x("inline-flex items-center text-xs font-medium mt-2 px-2 py-0.5 rounded-full",d[i]),children:[u[i]," ",r]})]}),n&&e.jsx("div",{className:"p-2.5 bg-primary-50 text-primary-500 rounded-lg",children:n})]})})});Me.displayName="MetricCard";const ei={primary:"bg-primary-500 text-white border border-primary-500 hover:bg-primary-600 hover:border-primary-600 active:bg-primary-700 disabled:bg-slate-200 disabled:border-slate-200 disabled:text-slate-400 shadow-sm hover:shadow",secondary:"bg-white text-slate-700 border border-slate-200 hover:bg-slate-50 hover:border-slate-300 active:bg-slate-100 disabled:bg-slate-50 disabled:text-slate-400 disabled:border-slate-200 shadow-sm",outline:"bg-transparent text-primary-600 border border-primary-200 hover:bg-primary-50 hover:border-primary-300 active:bg-primary-100 disabled:text-slate-400 disabled:border-slate-200",ghost:"bg-transparent text-slate-600 border border-transparent hover:bg-slate-50 hover:text-slate-800 active:bg-slate-100 disabled:text-slate-400",danger:"bg-rose-500 text-white border border-rose-500 hover:bg-rose-600 hover:border-rose-600 active:bg-rose-700 disabled:bg-rose-200 disabled:border-rose-200 shadow-sm",success:"bg-emerald-500 text-white border border-emerald-500 hover:bg-emerald-600 hover:border-emerald-600 active:bg-emerald-700 disabled:bg-emerald-200 disabled:border-emerald-200 shadow-sm"},qn={xs:"px-2.5 py-1 text-xs",sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"},Xe={xs:"w-3 h-3",sm:"w-3.5 h-3.5",md:"w-4 h-4",lg:"w-5 h-5"},V=g.forwardRef(({className:t,variant:a="primary",size:s="md",loading:i=!1,leftIcon:r,rightIcon:n,fullWidth:o=!1,disabled:c,children:l,...d},u)=>{const m=c||i;return e.jsxs("button",{ref:u,className:x("inline-flex items-center justify-center","font-medium","rounded-lg","transition-all duration-200",ne,ei[a],qn[s],o&&"w-full",m&&"cursor-not-allowed",t),disabled:m,...d,children:[i?e.jsx(fs,{className:x("animate-spin",Xe[s],l&&"mr-2")}):r&&e.jsx("span",{className:x(Xe[s],"mr-2"),children:r}),l,!i&&n&&e.jsx("span",{className:x(Xe[s],"ml-2"),children:n})]})});V.displayName="Button";const Kn={xs:"p-1",sm:"p-1.5",md:"p-2",lg:"p-2.5"},Xn=g.forwardRef(({className:t,variant:a="ghost",size:s="md",loading:i=!1,icon:r,disabled:n,...o},c)=>{const l=n||i;return e.jsx("button",{ref:c,className:x("inline-flex items-center justify-center","rounded-lg","transition-all duration-200",ne,ei[a],Kn[s],l&&"cursor-not-allowed",t),disabled:l,...o,children:i?e.jsx(fs,{className:x("animate-spin",Xe[s])}):e.jsx("span",{className:Xe[s],children:r})})});Xn.displayName="IconButton";const Qn=g.forwardRef(({className:t,attached:a=!1,children:s,...i},r)=>e.jsx("div",{ref:r,className:x("inline-flex",a&&"[&>button]:rounded-none [&>button:first-child]:rounded-l-lg [&>button:last-child]:rounded-r-lg [&>button:not(:last-child)]:border-r-0",!a&&"gap-2",t),...i,children:s}));Qn.displayName="ButtonGroup";const Jn={sm:{track:"w-8 h-4",thumb:"w-3 h-3",translate:"translate-x-4"},md:{track:"w-11 h-6",thumb:"w-5 h-5",translate:"translate-x-5"},lg:{track:"w-14 h-7",thumb:"w-6 h-6",translate:"translate-x-7"}},se=g.forwardRef(({className:t,label:a,description:s,size:i="md",checked:r,onChange:n,onToggle:o,disabled:c,id:l,...d},u)=>{const m=p=>{n?.(p),o?.(p.target.checked)},h=Jn[i];return e.jsxs("label",{htmlFor:l,className:x("inline-flex items-center gap-3",c?"cursor-not-allowed opacity-50":"cursor-pointer",t),children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:u,type:"checkbox",id:l,checked:r,onChange:m,disabled:c,className:"sr-only peer",...d}),e.jsx("div",{className:x("rounded-full bg-gray-200",q.colors,"peer-checked:bg-primary-600","peer-disabled:bg-gray-100",ne,"peer-focus-visible:ring-2 peer-focus-visible:ring-primary-500 peer-focus-visible:ring-offset-2",h.track)}),e.jsx("div",{className:x("absolute top-0.5 left-0.5 bg-white rounded-full shadow",q.transform,"peer-checked:"+h.translate,h.thumb)})]}),(a||s)&&e.jsxs("div",{className:"flex flex-col",children:[a&&e.jsx("span",{className:x("font-medium text-gray-900",i==="sm"?"text-sm":"text-base"),children:a}),s&&e.jsx("span",{className:"text-sm text-gray-500",children:s})]})]})});se.displayName="Toggle";const ti={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"},eo=g.forwardRef(({className:t,label:a,description:s,size:i="md",indeterminate:r,disabled:n,id:o,...c},l)=>e.jsxs("label",{htmlFor:o,className:x("inline-flex items-start gap-3",n?"cursor-not-allowed opacity-50":"cursor-pointer",t),children:[e.jsxs("div",{className:"relative flex items-center justify-center",children:[e.jsx("input",{ref:l,type:"checkbox",id:o,disabled:n,className:x("appearance-none rounded border-2 border-gray-300","checked:bg-primary-600 checked:border-primary-600","indeterminate:bg-primary-600 indeterminate:border-primary-600",q.colors,ne,ti[i]),...c}),e.jsx("svg",{className:x("absolute pointer-events-none text-white","opacity-0","[input:checked~&]:opacity-100",i==="sm"?"w-3 h-3":i==="md"?"w-3.5 h-3.5":"w-4 h-4"),viewBox:"0 0 16 16",fill:"none",children:e.jsx("path",{d:"M4 8L7 11L12 5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]}),(a||s)&&e.jsxs("div",{className:"flex flex-col",children:[a&&e.jsx("span",{className:x("font-medium text-gray-900",i==="sm"?"text-sm":"text-base"),children:a}),s&&e.jsx("span",{className:"text-sm text-gray-500",children:s})]})]}));eo.displayName="Checkbox";const to=g.forwardRef(({className:t,label:a,size:s="md",disabled:i,id:r,...n},o)=>e.jsxs("label",{htmlFor:r,className:x("inline-flex items-center gap-3",i?"cursor-not-allowed opacity-50":"cursor-pointer",t),children:[e.jsxs("div",{className:"relative flex items-center justify-center",children:[e.jsx("input",{ref:o,type:"radio",id:r,disabled:i,className:x("appearance-none rounded-full border-2 border-gray-300","checked:border-primary-600",q.colors,ne,ti[s]),...n}),e.jsx("div",{className:x("absolute rounded-full bg-primary-600","scale-0 [input:checked~&]:scale-100",q.transform,s==="sm"?"w-2 h-2":s==="md"?"w-2.5 h-2.5":"w-3 h-3")})]}),a&&e.jsx("span",{className:x("font-medium text-gray-900",s==="sm"?"text-sm":"text-base"),children:a})]}));to.displayName="Radio";const ao=g.forwardRef(({className:t,name:a,value:s,onValueChange:i,orientation:r="vertical",children:n,...o},c)=>e.jsx("div",{ref:c,role:"radiogroup",className:x("flex",r==="vertical"?"flex-col gap-2":"flex-row gap-4",t),...o,children:n}));ao.displayName="RadioGroup";const ai={sm:"h-1",md:"h-2",lg:"h-3"},si={sm:"w-3 h-3",md:"w-4 h-4",lg:"w-5 h-5"},wa=g.forwardRef(({className:t,value:a,min:s=0,max:i=100,step:r=1,disabled:n=!1,showValue:o=!1,showLabels:c=!1,minLabel:l,maxLabel:d,formatValue:u=v=>String(v),onChange:m,onChangeEnd:h,size:p="md",variant:b="default",...y},w)=>{const v=g.useRef(null),[_,f]=g.useState(!1),j=(a-s)/(i-s)*100,N=g.useCallback(T=>{if(!v.current)return a;const C=v.current.getBoundingClientRect(),P=Math.max(0,Math.min(1,(T-C.left)/C.width)),E=s+P*(i-s),H=Math.round(E/r)*r;return Math.max(s,Math.min(i,H))},[s,i,r,a]),S=g.useCallback(T=>{if(n)return;T.preventDefault(),f(!0);const C=N(T.clientX);m?.(C)},[n,N,m]),R=g.useCallback(T=>{if(n)return;f(!0);const C=T.touches[0],P=N(C.clientX);m?.(P)},[n,N,m]);g.useEffect(()=>{if(!_)return;const T=E=>{const H=N(E.clientX);m?.(H)},C=E=>{const H=E.touches[0],ae=N(H.clientX);m?.(ae)},P=()=>{f(!1),h?.(a)};return document.addEventListener("mousemove",T),document.addEventListener("mouseup",P),document.addEventListener("touchmove",C),document.addEventListener("touchend",P),()=>{document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",P),document.removeEventListener("touchmove",C),document.removeEventListener("touchend",P)}},[_,N,m,h,a]);const L=g.useCallback(T=>{if(n)return;let C=a;switch(T.key){case"ArrowLeft":case"ArrowDown":C=Math.max(s,a-r);break;case"ArrowRight":case"ArrowUp":C=Math.min(i,a+r);break;case"Home":C=s;break;case"End":C=i;break;default:return}T.preventDefault(),m?.(C),h?.(C)},[n,a,s,i,r,m,h]);return e.jsxs("div",{ref:w,className:x("w-full",t),...y,children:[c&&e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[e.jsx("span",{children:l??s}),o&&e.jsx("span",{className:"font-medium text-gray-900",children:u(a)}),e.jsx("span",{children:d??i})]}),!c&&o&&e.jsx("div",{className:"text-center text-sm font-medium text-gray-900 mb-2",children:u(a)}),e.jsxs("div",{ref:v,className:x("relative w-full rounded-full cursor-pointer",b==="certainty"?"bg-gradient-to-r from-gray-300 via-amber-400 to-green-500":"bg-gray-200",ai[p],n&&"opacity-50 cursor-not-allowed"),onMouseDown:S,onTouchStart:R,children:[b==="default"&&e.jsx("div",{className:x("absolute top-0 left-0 h-full rounded-full bg-primary-600",q.fast),style:{width:`${j}%`}}),e.jsx("div",{className:x("absolute top-1/2 -translate-y-1/2 -translate-x-1/2","rounded-full bg-white border-2 border-primary-600 shadow",q.fast,ne,si[p],_&&"scale-110",n&&"border-gray-400"),style:{left:`${j}%`},role:"slider",tabIndex:n?-1:0,"aria-valuemin":s,"aria-valuemax":i,"aria-valuenow":a,"aria-disabled":n,onKeyDown:L})]})]})});wa.displayName="Slider";const ja=g.forwardRef(({showCertaintyLabel:t=!0,formatValue:a,...s},i)=>{const r=o=>o>=85?"Very High":o>=70?"High":o>=50?"Moderate":o>=30?"Low":"Exploratory",n=o=>t?`${o}% (${r(o)})`:`${o}%`;return e.jsxs("div",{ref:i,children:[e.jsx(wa,{min:0,max:100,step:5,variant:"certainty",showValue:!0,formatValue:a??n,...s}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[e.jsx("span",{children:"More insights"}),e.jsx("span",{children:"Higher confidence"})]})]})});ja.displayName="CertaintySlider";const so=g.forwardRef(({className:t,value:a,min:s=0,max:i=100,step:r=1,disabled:n=!1,showLabels:o=!1,formatValue:c=p=>String(p),onChange:l,onChangeEnd:d,size:u="md",...m},h)=>{const p=g.useRef(null),[b,y]=g.useState(null),w=a.map(f=>(f-s)/(i-s)*100),v=g.useCallback(f=>{if(!p.current)return a[0];const j=p.current.getBoundingClientRect(),N=Math.max(0,Math.min(1,(f-j.left)/j.width)),S=s+N*(i-s);return Math.round(S/r)*r},[s,i,r,a]),_=g.useCallback(f=>{if(n)return;const j=v(f.clientX),N=Math.abs(j-a[0]),S=Math.abs(j-a[1]),R=N<S?[j,a[1]]:[a[0],j];l?.(R)},[n,v,a,l]);return g.useEffect(()=>{if(b===null)return;const f=N=>{const S=v(N.clientX),R=b===0?[Math.min(S,a[1]-r),a[1]]:[a[0],Math.max(S,a[0]+r)];l?.(R)},j=()=>{y(null),d?.(a)};return document.addEventListener("mousemove",f),document.addEventListener("mouseup",j),()=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",j)}},[b,v,l,d,a,r]),e.jsxs("div",{ref:h,className:x("w-full",t),...m,children:[o&&e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[e.jsx("span",{children:c(a[0])}),e.jsx("span",{children:c(a[1])})]}),e.jsxs("div",{ref:p,className:x("relative w-full rounded-full bg-gray-200 cursor-pointer",ai[u],n&&"opacity-50 cursor-not-allowed"),onClick:_,children:[e.jsx("div",{className:"absolute top-0 h-full rounded-full bg-primary-600",style:{left:`${w[0]}%`,width:`${w[1]-w[0]}%`}}),[0,1].map(f=>e.jsx("div",{className:x("absolute top-1/2 -translate-y-1/2 -translate-x-1/2","rounded-full bg-white border-2 border-primary-600 shadow cursor-grab",q.fast,si[u],b===f&&"scale-110 cursor-grabbing"),style:{left:`${w[f]}%`},onMouseDown:j=>{j.stopPropagation(),n||y(f)}},f))]})]})});so.displayName="RangeSlider";const io={default:"bg-slate-100 text-slate-600 border border-slate-200",primary:"bg-primary-50 text-primary-600 border border-primary-100",success:"bg-emerald-50 text-emerald-600 border border-emerald-100",warning:"bg-amber-50 text-amber-600 border border-amber-100",danger:"bg-rose-50 text-rose-600 border border-rose-100",info:"bg-sky-50 text-sky-600 border border-sky-100",outline:"bg-transparent border border-slate-300 text-slate-600"},ct={sm:"px-2 py-0.5 text-[10px]",md:"px-2.5 py-1 text-xs",lg:"px-3 py-1.5 text-sm"},ro={default:"bg-slate-400",primary:"bg-primary-500",success:"bg-emerald-500",warning:"bg-amber-500",danger:"bg-rose-500",info:"bg-sky-500",outline:"bg-slate-400"},A=g.forwardRef(({className:t,variant:a="default",size:s="md",dot:i=!1,removable:r=!1,onRemove:n,children:o,...c},l)=>e.jsxs("span",{ref:l,className:x("inline-flex items-center font-medium","rounded-full",io[a],ct[s],t),...c,children:[i&&e.jsx("span",{className:x("w-1.5 h-1.5 rounded-full mr-1.5",ro[a])}),o,r&&e.jsx("button",{type:"button",onClick:d=>{d.stopPropagation(),n?.()},className:"ml-1.5 -mr-0.5 p-0.5 hover:bg-slate-200/50 rounded-full transition-colors",children:e.jsx(je,{className:"w-3 h-3"})})]}));A.displayName="Badge";const Oa={sleep:"bg-secondary-50 text-secondary-600 border border-secondary-100",metabolic:"bg-accent-50 text-accent-600 border border-accent-100",recovery:"bg-primary-50 text-primary-600 border border-primary-100",cognitive:"bg-secondary-100 text-secondary-700 border border-secondary-200",activity:"bg-primary-100 text-primary-700 border border-primary-200",stress:"bg-accent-100 text-accent-700 border border-accent-200",nutrition:"bg-primary-50 text-primary-600 border border-primary-100",cardio:"bg-accent-50 text-accent-600 border border-accent-100",mood:"bg-muted-50 text-muted-600 border border-muted-100"},sa=g.forwardRef(({category:t,className:a,size:s="sm",children:i,...r},n)=>e.jsx("span",{ref:n,className:x("inline-flex items-center font-medium capitalize","rounded-full",Oa[t]||Oa.sleep,ct[s],a),...r,children:i??t}));sa.displayName="CategoryBadge";const no={active:{color:"bg-emerald-50 text-emerald-600 border border-emerald-100",dot:!0},inactive:{color:"bg-slate-50 text-slate-500 border border-slate-200",dot:!1},pending:{color:"bg-amber-50 text-amber-600 border border-amber-100",dot:!0},completed:{color:"bg-primary-50 text-primary-600 border border-primary-100",dot:!1},suggested:{color:"bg-secondary-50 text-secondary-600 border border-secondary-100",dot:!0},paused:{color:"bg-slate-100 text-slate-500 border border-slate-200",dot:!0}},oo={active:"bg-emerald-500",inactive:"bg-slate-400",pending:"bg-amber-500 animate-pulse",completed:"bg-primary-500",suggested:"bg-secondary-500",paused:"bg-slate-400"},lo=g.forwardRef(({status:t,className:a,size:s="sm",children:i,...r},n)=>{const o=no[t];return e.jsxs("span",{ref:n,className:x("inline-flex items-center font-medium capitalize","rounded-full",o.color,ct[s],a),...r,children:[o.dot&&e.jsx("span",{className:x("w-1.5 h-1.5 rounded-full mr-1.5",oo[t])}),i??t]})});lo.displayName="StatusBadge";const ii=g.forwardRef(({certainty:t,className:a,size:s="sm",...i},r)=>{const n=t>1?t:t*100;let o="bg-slate-50 text-slate-500 border border-slate-200",c="";return n>=85?(o="bg-emerald-50 text-emerald-600 border border-emerald-100",c="Very High"):n>=70?(o="bg-primary-50 text-primary-600 border border-primary-100",c="High"):n>=50?(o="bg-sky-50 text-sky-600 border border-sky-100",c="Moderate"):n>=30?(o="bg-amber-50 text-amber-600 border border-amber-100",c="Low"):(o="bg-slate-50 text-slate-500 border border-slate-200",c="Exploratory"),e.jsxs("span",{ref:r,className:x("inline-flex items-center font-medium","rounded-full",o,ct[s],a),...i,children:[Math.round(n),"% ",c]})});ii.displayName="CertaintyBadge";const co=g.forwardRef(({trend:t,value:a,goodDirection:s="up",className:i,size:r="sm",...n},o)=>{const c=t===s||s==="stable"&&t==="stable";let l="bg-slate-50 text-slate-500 border border-slate-200";c?l="bg-emerald-50 text-emerald-600 border border-emerald-100":t!=="stable"&&(l="bg-rose-50 text-rose-600 border border-rose-100");const d={up:"↑",down:"↓",stable:"→"};return e.jsxs("span",{ref:o,className:x("inline-flex items-center font-medium","rounded-full",l,ct[r],i),...n,children:[d[t],a&&e.jsx("span",{className:"ml-1",children:a})]})});co.displayName="TrendBadge";const st=g.forwardRef(({content:t,children:a,position:s="top",delay:i=200,disabled:r=!1,className:n,maxWidth:o=200},c)=>{const[l,d]=g.useState(!1),[u,m]=g.useState({top:0,left:0}),h=g.useRef(null),p=g.useRef(null),b=g.useRef(),y=g.useCallback(()=>{if(!h.current||!p.current)return;const f=h.current.getBoundingClientRect(),j=p.current.getBoundingClientRect(),N=window.scrollY,S=window.scrollX;let R=0,L=0;const I=8;switch(s){case"top":R=f.top+N-j.height-I,L=f.left+S+f.width/2-j.width/2;break;case"bottom":R=f.bottom+N+I,L=f.left+S+f.width/2-j.width/2;break;case"left":R=f.top+N+f.height/2-j.height/2,L=f.left+S-j.width-I;break;case"right":R=f.top+N+f.height/2-j.height/2,L=f.right+S+I;break}const T=8;L=Math.max(T,Math.min(L,window.innerWidth-j.width-T)),R=Math.max(T,Math.min(R,window.innerHeight+N-j.height-T)),m({top:R,left:L})},[s]),w=g.useCallback(()=>{r||(b.current=setTimeout(()=>{d(!0)},i))},[r,i]),v=g.useCallback(()=>{b.current&&clearTimeout(b.current),d(!1)},[]);g.useEffect(()=>{l&&requestAnimationFrame(y)},[l,y]),g.useEffect(()=>()=>{b.current&&clearTimeout(b.current)},[]);const _={top:"bottom-0 left-1/2 -translate-x-1/2 translate-y-full border-t-gray-900 border-x-transparent border-b-transparent",bottom:"top-0 left-1/2 -translate-x-1/2 -translate-y-full border-b-gray-900 border-x-transparent border-t-transparent",left:"right-0 top-1/2 -translate-y-1/2 translate-x-full border-l-gray-900 border-y-transparent border-r-transparent",right:"left-0 top-1/2 -translate-y-1/2 -translate-x-full border-r-gray-900 border-y-transparent border-l-transparent"};return e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:h,onMouseEnter:w,onMouseLeave:v,onFocus:w,onBlur:v,className:"inline-block",children:a}),l&&it.createPortal(e.jsxs("div",{ref:p,className:x("fixed z-50 px-3 py-2 text-sm text-white bg-gray-900 rounded-lg shadow-lg",q.fast,"animate-in fade-in-0 zoom-in-95",n),style:{top:u.top,left:u.left,maxWidth:o},role:"tooltip",children:[t,e.jsx("span",{className:x("absolute w-0 h-0 border-4",_[s])})]}),document.body)]})});st.displayName="Tooltip";const jt=g.forwardRef(({content:t,iconSize:a=16,...s},i)=>e.jsx(st,{content:t,...s,children:e.jsx("button",{type:"button",className:"inline-flex items-center justify-center text-gray-400 hover:text-gray-600 transition-colors",children:e.jsxs("svg",{width:a,height:a,viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[e.jsx("circle",{cx:"8",cy:"8",r:"6.5"}),e.jsx("path",{d:"M8 11V8M8 5.5V5",strokeLinecap:"round"})]})})}));jt.displayName="InfoTooltip";const mo=g.forwardRef(({trigger:t,content:a,position:s="bottom",isOpen:i,onOpenChange:r,className:n},o)=>{const[c,l]=g.useState(!1),d=i!==void 0?i:c,u=g.useRef(null),m=g.useRef(null),[h,p]=g.useState({top:0,left:0}),b=g.useCallback(w=>{r?r(w):l(w)},[r]),y=g.useCallback(()=>{if(!u.current||!m.current)return;const w=u.current.getBoundingClientRect(),v=m.current.getBoundingClientRect(),_=window.scrollY,f=window.scrollX;let j=0,N=0;const S=8;switch(s){case"top":j=w.top+_-v.height-S,N=w.left+f+w.width/2-v.width/2;break;case"bottom":j=w.bottom+_+S,N=w.left+f+w.width/2-v.width/2;break;case"left":j=w.top+_+w.height/2-v.height/2,N=w.left+f-v.width-S;break;case"right":j=w.top+_+w.height/2-v.height/2,N=w.right+f+S;break}p({top:j,left:N})},[s]);return g.useEffect(()=>{d&&requestAnimationFrame(y)},[d,y]),g.useEffect(()=>{if(!d)return;const w=v=>{u.current&&!u.current.contains(v.target)&&m.current&&!m.current.contains(v.target)&&b(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[d,b]),g.useEffect(()=>{if(!d)return;const w=v=>{v.key==="Escape"&&b(!1)};return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[d,b]),e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:u,onClick:()=>b(!d),className:"inline-block",children:t}),d&&it.createPortal(e.jsx("div",{ref:m,className:x("fixed z-50 bg-white rounded-lg shadow-lg border border-gray-200",q.fast,"animate-in fade-in-0 zoom-in-95",n),style:{top:h.top,left:h.left},children:a}),document.body)]})});mo.displayName="Popover";const uo={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl",full:"max-w-4xl"},ri=g.forwardRef(({isOpen:t,onClose:a,title:s,description:i,children:r,size:n="md",closeOnOverlayClick:o=!0,closeOnEscape:c=!0,showCloseButton:l=!0,className:d,overlayClassName:u},m)=>{const h=g.useRef(null),p=g.useRef(null);g.useEffect(()=>{if(!t||!c)return;const y=w=>{w.key==="Escape"&&a()};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[t,c,a]),g.useEffect(()=>{t?(p.current=document.activeElement,h.current?.focus()):p.current&&p.current.focus()},[t]),g.useEffect(()=>{if(t){const y=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=y}}},[t]);const b=g.useCallback(y=>{o&&y.target===y.currentTarget&&a()},[o,a]);return it.createPortal(e.jsx(re,{children:t&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx(M.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:x("absolute inset-0 bg-black/50",u),onClick:b}),e.jsxs(M.div,{ref:h,initial:{opacity:0,scale:.95,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:10},transition:{duration:.2,ease:"easeOut"},className:x("relative w-full mx-4 bg-white rounded-xl shadow-xl","max-h-[90vh] overflow-hidden flex flex-col",ne,uo[n],d),tabIndex:-1,role:"dialog","aria-modal":"true","aria-labelledby":s?"modal-title":void 0,"aria-describedby":i?"modal-description":void 0,children:[(s||l)&&e.jsxs("div",{className:"flex items-start justify-between px-6 pt-6 pb-4",children:[e.jsxs("div",{children:[s&&e.jsx("h2",{id:"modal-title",className:"text-lg font-semibold text-gray-900",children:s}),i&&e.jsx("p",{id:"modal-description",className:"mt-1 text-sm text-gray-500",children:i})]}),l&&e.jsxs("button",{type:"button",onClick:a,className:x("p-1 -mr-1 text-gray-400 hover:text-gray-600 rounded-lg transition-colors",ne),children:[e.jsx(je,{className:"w-5 h-5"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto px-6 pb-6",children:r})]})]})}),document.body)});ri.displayName="Modal";const ni=g.forwardRef(({className:t,children:a,...s},i)=>e.jsx("div",{ref:i,className:x("flex items-center justify-end gap-3 pt-4 mt-4 border-t border-gray-100",t),...s,children:a}));ni.displayName="ModalFooter";const ho=g.forwardRef(({message:t,confirmLabel:a="Confirm",cancelLabel:s="Cancel",confirmVariant:i="primary",onConfirm:r,onClose:n,isLoading:o=!1,...c},l)=>{const d=i==="danger"?"bg-red-600 text-white hover:bg-red-700":"bg-primary-600 text-white hover:bg-primary-700";return e.jsxs(ri,{ref:l,size:"sm",onClose:n,...c,children:[e.jsx("p",{className:"text-gray-600",children:t}),e.jsxs(ni,{children:[e.jsx("button",{type:"button",onClick:n,disabled:o,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:s}),e.jsx("button",{type:"button",onClick:r,disabled:o,className:x("px-4 py-2 text-sm font-medium rounded-lg transition-colors disabled:opacity-50",d),children:o?"Loading...":a})]})]})});ho.displayName="ConfirmModal";const po=g.forwardRef(({isOpen:t,onClose:a,title:s,children:i,position:r="right",width:n="400px",closeOnOverlayClick:o=!0,closeOnEscape:c=!0,showCloseButton:l=!0,className:d,overlayClassName:u},m)=>{g.useEffect(()=>{if(!t||!c)return;const b=y=>{y.key==="Escape"&&a()};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[t,c,a]),g.useEffect(()=>{if(t){const b=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=b}}},[t]);const h=g.useCallback(b=>{o&&b.target===b.currentTarget&&a()},[o,a]),p=r==="left"?{x:"-100%"}:{x:"100%"};return it.createPortal(e.jsx(re,{children:t&&e.jsxs("div",{className:"fixed inset-0 z-50",children:[e.jsx(M.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:x("absolute inset-0 bg-black/50",u),onClick:h}),e.jsxs(M.div,{ref:m,initial:p,animate:{x:0},exit:p,transition:{duration:.3,ease:"easeOut"},className:x("absolute top-0 h-full bg-white shadow-xl flex flex-col",r==="left"?"left-0":"right-0",d),style:{width:n},children:[(s||l)&&e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[s&&e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:s}),l&&e.jsx("button",{type:"button",onClick:a,className:"p-1 text-gray-400 hover:text-gray-600 rounded-lg transition-colors",children:e.jsx(je,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:i})]})]})}),document.body)});po.displayName="Drawer";const oi=g.createContext(null);function Na(){const t=g.useContext(oi);if(!t)throw new Error("Tab components must be used within a Tabs component");return t}const li=g.forwardRef(({className:t,value:a,defaultValue:s,onValueChange:i,variant:r="default",children:n,...o},c)=>{const[l,d]=g.useState(s??""),u=a!==void 0?a:l,m=g.useCallback(h=>{a===void 0&&d(h),i?.(h)},[a,i]);return e.jsx(oi.Provider,{value:{activeTab:u,setActiveTab:m,variant:r},children:e.jsx("div",{ref:c,className:x("",t),...o,children:n})})});li.displayName="Tabs";const ci=g.forwardRef(({className:t,children:a,...s},i)=>{const{variant:r}=Na(),n={default:"border-b border-gray-200",pills:"bg-gray-100 p-1 rounded-lg",underline:"border-b border-gray-200"};return e.jsx("div",{ref:i,role:"tablist",className:x("flex",n[r],t),...s,children:a})});ci.displayName="TabList";const ia=g.forwardRef(({className:t,value:a,icon:s,children:i,disabled:r,...n},o)=>{const{activeTab:c,setActiveTab:l,variant:d}=Na(),u=c===a,m="relative inline-flex items-center justify-center font-medium transition-colors",h={default:x("px-4 py-2 text-sm -mb-px",u?"text-primary-600 border-b-2 border-primary-600":"text-gray-500 hover:text-gray-700 border-b-2 border-transparent"),pills:x("px-4 py-2 text-sm rounded-md",u?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"),underline:x("px-4 py-3 text-sm",u?"text-primary-600":"text-gray-500 hover:text-gray-700")};return e.jsxs("button",{ref:o,type:"button",role:"tab","aria-selected":u,"aria-controls":`panel-${a}`,disabled:r,onClick:()=>l(a),className:x(m,h[d],ne,r&&"opacity-50 cursor-not-allowed",t),...n,children:[s&&e.jsx("span",{className:"mr-2",children:s}),i,d==="underline"&&u&&e.jsx(M.div,{layoutId:"tab-underline",className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary-600",transition:{type:"spring",bounce:.2,duration:.6}})]})});ia.displayName="TabTrigger";const ra=g.forwardRef(({className:t,value:a,forceMount:s=!1,children:i,...r},n)=>{const{activeTab:o}=Na(),c=o===a;return!c&&!s?null:e.jsx("div",{ref:n,role:"tabpanel",id:`panel-${a}`,"aria-labelledby":`tab-${a}`,hidden:!c,className:x("mt-4",q.fast,!c&&"hidden",t),...r,children:i})});ra.displayName="TabContent";const go=g.forwardRef(({className:t,active:a=!1,variant:s="default",children:i,...r},n)=>{const o={default:x("px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors",a?"text-primary-600 border-primary-600":"text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300"),pill:x("px-4 py-2 text-sm font-medium rounded-full transition-colors",a?"bg-primary-100 text-primary-700":"text-gray-600 hover:bg-gray-100 hover:text-gray-900")};return e.jsx("button",{ref:n,type:"button",className:x(o[s],ne,t),...r,children:i})});go.displayName="TabButton";const di=g.forwardRef(({className:t,tabs:a,activeTab:s,onTabChange:i,variant:r="default",...n},o)=>{const c={default:"border-b border-gray-200",pills:"bg-gray-100 p-1 rounded-lg inline-flex",underline:"border-b border-gray-200"},l=d=>({default:x("px-4 py-2 text-sm font-medium -mb-px transition-colors",d?"text-primary-600 border-b-2 border-primary-600":"text-gray-500 hover:text-gray-700 border-b-2 border-transparent"),pills:x("px-4 py-2 text-sm font-medium rounded-md transition-colors",d?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"),underline:x("px-4 py-3 text-sm font-medium transition-colors",d?"text-primary-600 border-b-2 border-primary-600 -mb-px":"text-gray-500 hover:text-gray-700")});return e.jsx("div",{ref:o,className:x("flex",c[r],t),...n,children:a.map(d=>e.jsxs("button",{type:"button",onClick:()=>i(d.value),className:x("inline-flex items-center",l(s===d.value)[r],ne),children:[d.icon&&e.jsx("span",{className:"mr-2",children:d.icon}),d.label,d.count!==void 0&&e.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs rounded-full bg-gray-100 text-gray-600",children:d.count})]},d.value))})});di.displayName="TabGroup";const xo={sm:"h-1.5",md:"h-2.5",lg:"h-4"},Ba={default:"bg-primary-600",success:"bg-green-500",warning:"bg-amber-500",danger:"bg-red-500",gradient:"bg-gradient-to-r from-primary-500 to-primary-700"},mi=g.forwardRef(({className:t,value:a,max:s=100,size:i="md",variant:r="default",showLabel:n=!1,labelPosition:o="outside",animated:c=!0,striped:l=!1,indeterminate:d=!1,...u},m)=>{const h=Math.min(100,Math.max(0,a/s*100));return e.jsxs("div",{ref:m,className:x("w-full",t),...u,children:[n&&o==="outside"&&e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[Math.round(h),"%"]})]}),e.jsx("div",{className:x("w-full rounded-full bg-gray-200 overflow-hidden",xo[i]),role:"progressbar","aria-valuenow":a,"aria-valuemin":0,"aria-valuemax":s,children:d?e.jsx(M.div,{className:x("h-full rounded-full",Ba[r]),initial:{x:"-100%",width:"30%"},animate:{x:"400%"},transition:{repeat:1/0,duration:1.5,ease:"easeInOut"}}):e.jsx(M.div,{className:x("h-full rounded-full",Ba[r],l&&"bg-stripes",q.fast),initial:c?{width:0}:{width:`${h}%`},animate:{width:`${h}%`},transition:{duration:.5,ease:"easeOut"},children:n&&o==="inside"&&i==="lg"&&e.jsxs("span",{className:"flex items-center justify-center h-full text-xs text-white font-medium",children:[Math.round(h),"%"]})})})]})});mi.displayName="ProgressBar";const bo={default:"stroke-primary-600",success:"stroke-green-500",warning:"stroke-amber-500",danger:"stroke-red-500"},fo=g.forwardRef(({className:t,value:a,max:s=100,size:i=64,strokeWidth:r=6,variant:n="default",showLabel:o=!0,label:c,...l},d)=>{const u=Math.min(100,Math.max(0,a/s*100)),m=(i-r)/2,h=m*2*Math.PI,p=h-u/100*h;return e.jsxs("div",{ref:d,className:x("relative inline-flex items-center justify-center",t),...l,children:[e.jsxs("svg",{width:i,height:i,className:"-rotate-90",children:[e.jsx("circle",{cx:i/2,cy:i/2,r:m,fill:"none",stroke:"currentColor",strokeWidth:r,className:"text-gray-200"}),e.jsx(M.circle,{cx:i/2,cy:i/2,r:m,fill:"none",strokeWidth:r,strokeLinecap:"round",className:bo[n],initial:{strokeDashoffset:h},animate:{strokeDashoffset:p},transition:{duration:.5,ease:"easeOut"},style:{strokeDasharray:h}})]}),o&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:c!==void 0?c:e.jsxs("span",{className:"text-sm font-semibold text-gray-700",children:[Math.round(u),"%"]})})]})});fo.displayName="CircularProgress";const _a=g.forwardRef(({className:t,steps:a,size:s="md",showLabels:i=!0,...r},n)=>{const o={sm:"w-2 h-2",md:"w-3 h-3",lg:"w-4 h-4"},c={sm:"h-0.5",md:"h-1",lg:"h-1.5"};return e.jsxs("div",{ref:n,className:x("",t),...r,children:[e.jsx("div",{className:"flex items-center",children:a.map((l,d)=>e.jsxs("div",{className:"flex items-center flex-1 last:flex-none",children:[e.jsx("div",{className:x("rounded-full flex-shrink-0",o[s],l.completed?"bg-primary-600":l.active?"bg-primary-400 ring-4 ring-primary-100":"bg-gray-300")}),d<a.length-1&&e.jsx("div",{className:x("flex-1 mx-2 rounded-full",c[s],l.completed?"bg-primary-600":"bg-gray-200")})]},d))}),i&&e.jsx("div",{className:"flex mt-2",children:a.map((l,d)=>e.jsx("div",{className:x("flex-1 text-xs text-center last:text-right first:text-left",l.completed||l.active?"text-gray-700":"text-gray-400"),children:l.label},d))})]})});_a.displayName="SegmentedProgress";const yo=g.forwardRef(({className:t,progress:a,stage:s,isComplete:i,...r},n)=>e.jsxs("div",{ref:n,className:x("space-y-2",t),...r,children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:s}),e.jsxs("span",{className:"text-gray-900 font-medium",children:[Math.round(a),"%"]})]}),e.jsx(mi,{value:a,variant:i?"success":"default",animated:!0})]}));yo.displayName="SyncProgress";const O=g.forwardRef(({className:t,variant:a="default",animation:s="pulse",width:i,height:r,style:n,...o},c)=>{const l={default:"rounded-md",circular:"rounded-full",rectangular:"rounded-none"},d={pulse:"animate-pulse",wave:"animate-shimmer bg-gradient-to-r from-gray-200 via-gray-100 to-gray-200 bg-[length:200%_100%]",none:""};return e.jsx("div",{ref:c,className:x("bg-gray-200",l[a],d[s],t),style:{width:typeof i=="number"?`${i}px`:i,height:typeof r=="number"?`${r}px`:r,...n},...o})});O.displayName="Skeleton";const ka=g.forwardRef(({className:t,lines:a=3,lineHeight:s="1rem",lastLineWidth:i="60%",...r},n)=>e.jsx("div",{ref:n,className:x("space-y-2",t),children:Array.from({length:a}).map((o,c)=>e.jsx(O,{height:s,width:c===a-1?i:"100%",...r},c))}));ka.displayName="SkeletonText";const vo=g.forwardRef(({className:t,hasImage:a=!1,imageHeight:s="200px",hasHeader:i=!0,hasFooter:r=!1,...n},o)=>e.jsxs("div",{ref:o,className:x("bg-white border border-gray-200 rounded-lg overflow-hidden",t),...n,children:[a&&e.jsx(O,{height:s,variant:"rectangular"}),e.jsxs("div",{className:"p-4 space-y-3",children:[i&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(O,{variant:"circular",width:40,height:40}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(O,{height:"0.875rem",width:"60%"}),e.jsx(O,{height:"0.75rem",width:"40%"})]})]}),e.jsx(ka,{lines:2})]}),r&&e.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex justify-between",children:[e.jsx(O,{height:"2rem",width:"80px"}),e.jsx(O,{height:"2rem",width:"80px"})]})]}));vo.displayName="SkeletonCard";const wo={xs:24,sm:32,md:40,lg:48,xl:64},ui=g.forwardRef(({className:t,size:a="md",...s},i)=>{const r=wo[a];return e.jsx(O,{ref:i,variant:"circular",width:r,height:r,className:t,...s})});ui.displayName="SkeletonAvatar";const jo=g.forwardRef(({className:t,hasAvatar:a=!0,hasAction:s=!1,...i},r)=>e.jsxs("div",{ref:r,className:x("flex items-center gap-3 p-3",t),...i,children:[a&&e.jsx(ui,{size:"md"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(O,{height:"0.875rem",width:"70%"}),e.jsx(O,{height:"0.75rem",width:"50%"})]}),s&&e.jsx(O,{height:"2rem",width:"60px"})]}));jo.displayName="SkeletonListItem";const No=g.forwardRef(({className:t,rows:a=5,columns:s=4,...i},r)=>e.jsxs("div",{ref:r,className:x("",t),...i,children:[e.jsx("div",{className:"flex gap-4 pb-3 border-b border-gray-200",children:Array.from({length:s}).map((n,o)=>e.jsx(O,{height:"1rem",className:"flex-1"},o))}),Array.from({length:a}).map((n,o)=>e.jsx("div",{className:"flex gap-4 py-3 border-b border-gray-100 last:border-0",children:Array.from({length:s}).map((c,l)=>e.jsx(O,{height:"0.875rem",className:"flex-1",width:l===0?"80%":"100%"},l))},o))]}));No.displayName="SkeletonTable";const _o=g.forwardRef(({className:t,type:a="line",...s},i)=>e.jsxs("div",{ref:i,className:x("bg-gray-50 rounded-lg p-4",t),...s,children:[a==="line"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-12 space-y-6",children:Array.from({length:4}).map((r,n)=>e.jsx(O,{height:"0.75rem",width:"2rem"},n))}),e.jsx("div",{className:"flex-1 h-48 flex items-end justify-between gap-1",children:Array.from({length:12}).map((r,n)=>e.jsx(O,{className:"flex-1",height:`${30+Math.random()*70}%`},n))})]}),e.jsx("div",{className:"flex gap-2 pl-12",children:Array.from({length:6}).map((r,n)=>e.jsx(O,{height:"0.75rem",className:"flex-1"},n))})]}),a==="bar"&&e.jsx("div",{className:"h-48 flex items-end justify-around gap-2",children:Array.from({length:7}).map((r,n)=>e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2",children:[e.jsx(O,{className:"w-full",height:`${30+Math.random()*70}%`}),e.jsx(O,{height:"0.75rem",width:"2rem"})]},n))}),a==="pie"&&e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(O,{variant:"circular",width:180,height:180})})]}));_o.displayName="SkeletonChart";const ko=g.forwardRef(({className:t,...a},s)=>e.jsxs("div",{ref:s,className:x("bg-white border border-gray-200 rounded-lg p-4 space-y-3",t),...a,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{width:60,height:"1.25rem",className:"rounded-full"}),e.jsx(O,{width:80,height:"1.25rem",className:"rounded-full"})]}),e.jsx(O,{width:40,height:"1rem"})]}),e.jsx(O,{height:"1.25rem",width:"85%"}),e.jsx(ka,{lines:2,lineHeight:"0.875rem"}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(O,{height:"2rem",width:"100px",className:"rounded-md"}),e.jsx(O,{height:"2rem",width:"80px",className:"rounded-md"})]})]}));ko.displayName="SkeletonInsightCard";const hi={success:Ne,error:oe,warning:le,info:Lt},pi={success:"bg-green-50 border-green-200 text-green-800",error:"bg-red-50 border-red-200 text-red-800",warning:"bg-amber-50 border-amber-200 text-amber-800",info:"bg-blue-50 border-blue-200 text-blue-800"},gi={success:"text-green-500",error:"text-red-500",warning:"text-amber-500",info:"text-blue-500"},xi=g.forwardRef(({type:t,title:a,message:s,duration:i=5e3,onClose:r},n)=>{const o=hi[t],c=g.useCallback(()=>{r?.()},[r]);return g.useEffect(()=>{if(i>0){const l=setTimeout(c,i);return()=>clearTimeout(l)}},[i,c]),e.jsxs(M.div,{ref:n,initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},transition:{duration:.2},className:x("flex items-start gap-3 p-4 rounded-lg border shadow-lg max-w-sm",pi[t]),children:[e.jsx(o,{className:x("w-5 h-5 flex-shrink-0 mt-0.5",gi[t])}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:a}),s&&e.jsx("p",{className:"text-xs mt-1 opacity-80",children:s})]}),e.jsx("button",{type:"button",onClick:c,className:"flex-shrink-0 p-1 rounded hover:bg-black/10 transition-colors",children:e.jsx(je,{className:"w-4 h-4"})})]})});xi.displayName="Toast";const Co={"top-left":"top-4 left-4 items-start","top-right":"top-4 right-4 items-end","top-center":"top-4 left-1/2 -translate-x-1/2 items-center","bottom-left":"bottom-4 left-4 items-start","bottom-right":"bottom-4 right-4 items-end","bottom-center":"bottom-4 left-1/2 -translate-x-1/2 items-center"},bi=g.forwardRef(({position:t="bottom-right"},a)=>{const{toasts:s,removeToast:i}=lt();return it.createPortal(e.jsx("div",{ref:a,className:x("fixed z-[100] flex flex-col gap-2 pointer-events-none",Co[t]),children:e.jsx(re,{mode:"popLayout",children:s.map(r=>e.jsx("div",{className:"pointer-events-auto",children:e.jsx(xi,{...r,onClose:()=>i(r.id)})},r.id))})}),document.body)});bi.displayName="ToastContainer";const So=g.forwardRef(({className:t,type:a="info",message:s,action:i,dismissible:r=!0,onDismiss:n,...o},c)=>{const[l,d]=g.useState(!0),u=hi[a];if(!l)return null;const m=()=>{d(!1),n?.()};return e.jsx("div",{ref:c,className:x("px-4 py-3 border-b",pi[a],t),...o,children:e.jsxs("div",{className:"flex items-center gap-3 max-w-7xl mx-auto",children:[e.jsx(u,{className:x("w-5 h-5 flex-shrink-0",gi[a])}),e.jsx("p",{className:"flex-1 text-sm",children:s}),i&&e.jsx("button",{type:"button",onClick:i.onClick,className:"text-sm font-medium underline hover:no-underline",children:i.label}),r&&e.jsx("button",{type:"button",onClick:m,className:"p-1 rounded hover:bg-black/10 transition-colors",children:e.jsx(je,{className:"w-4 h-4"})})]})})});So.displayName="NotificationBanner";const To={light:{key:"text-purple-600",string:"text-green-600",number:"text-blue-600",boolean:"text-amber-600",null:"text-gray-400",bracket:"text-gray-500",line:"text-gray-300",bg:"bg-gray-50"},dark:{key:"text-purple-400",string:"text-green-400",number:"text-blue-400",boolean:"text-amber-400",null:"text-gray-500",bracket:"text-gray-400",line:"text-gray-600",bg:"bg-gray-900"}},na=({name:t,value:a,level:s,expandLevel:i,theme:r,isLast:n})=>{const[o,c]=g.useState(s<i),l=To[r],d=g.useCallback(()=>{c(m=>!m)},[]),u=s*16;if(a===null)return e.jsxs("div",{style:{paddingLeft:u},children:[t!==void 0&&e.jsxs("span",{className:l.key,children:['"',t,'"']}),t!==void 0&&e.jsx("span",{className:l.bracket,children:": "}),e.jsx("span",{className:l.null,children:"null"}),!n&&e.jsx("span",{className:l.bracket,children:","})]});if(typeof a=="string")return e.jsxs("div",{style:{paddingLeft:u},children:[t!==void 0&&e.jsxs("span",{className:l.key,children:['"',t,'"']}),t!==void 0&&e.jsx("span",{className:l.bracket,children:": "}),e.jsxs("span",{className:l.string,children:['"',a,'"']}),!n&&e.jsx("span",{className:l.bracket,children:","})]});if(typeof a=="number")return e.jsxs("div",{style:{paddingLeft:u},children:[t!==void 0&&e.jsxs("span",{className:l.key,children:['"',t,'"']}),t!==void 0&&e.jsx("span",{className:l.bracket,children:": "}),e.jsx("span",{className:l.number,children:a}),!n&&e.jsx("span",{className:l.bracket,children:","})]});if(typeof a=="boolean")return e.jsxs("div",{style:{paddingLeft:u},children:[t!==void 0&&e.jsxs("span",{className:l.key,children:['"',t,'"']}),t!==void 0&&e.jsx("span",{className:l.bracket,children:": "}),e.jsx("span",{className:l.boolean,children:a?"true":"false"}),!n&&e.jsx("span",{className:l.bracket,children:","})]});if(Array.isArray(a))return a.length,e.jsxs("div",{children:[e.jsxs("div",{style:{paddingLeft:u},className:"cursor-pointer hover:bg-black/5 -mx-2 px-2",onClick:d,children:[e.jsx("span",{className:"inline-flex items-center",children:o?e.jsx(ye,{className:"w-3 h-3 mr-1"}):e.jsx(U,{className:"w-3 h-3 mr-1"})}),t!==void 0&&e.jsxs("span",{className:l.key,children:['"',t,'"']}),t!==void 0&&e.jsx("span",{className:l.bracket,children:": "}),e.jsx("span",{className:l.bracket,children:"["}),!o&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-gray-400 text-xs mx-1",children:[a.length," item",a.length!==1?"s":""]}),e.jsx("span",{className:l.bracket,children:"]"}),!n&&e.jsx("span",{className:l.bracket,children:","})]})]}),o&&e.jsxs(e.Fragment,{children:[a.map((m,h)=>e.jsx(na,{value:m,level:s+1,expandLevel:i,theme:r,isLast:h===a.length-1},h)),e.jsxs("div",{style:{paddingLeft:u},children:[e.jsx("span",{className:l.bracket,children:"]"}),!n&&e.jsx("span",{className:l.bracket,children:","})]})]})]});if(typeof a=="object"){const m=Object.entries(a);return m.length,e.jsxs("div",{children:[e.jsxs("div",{style:{paddingLeft:u},className:"cursor-pointer hover:bg-black/5 -mx-2 px-2",onClick:d,children:[e.jsx("span",{className:"inline-flex items-center",children:o?e.jsx(ye,{className:"w-3 h-3 mr-1"}):e.jsx(U,{className:"w-3 h-3 mr-1"})}),t!==void 0&&e.jsxs("span",{className:l.key,children:['"',t,'"']}),t!==void 0&&e.jsx("span",{className:l.bracket,children:": "}),e.jsx("span",{className:l.bracket,children:"{"}),!o&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-gray-400 text-xs mx-1",children:[m.length," key",m.length!==1?"s":""]}),e.jsx("span",{className:l.bracket,children:"}"}),!n&&e.jsx("span",{className:l.bracket,children:","})]})]}),o&&e.jsxs(e.Fragment,{children:[m.map(([h,p],b)=>e.jsx(na,{name:h,value:p,level:s+1,expandLevel:i,theme:r,isLast:b===m.length-1},h)),e.jsxs("div",{style:{paddingLeft:u},children:[e.jsx("span",{className:l.bracket,children:"}"}),!n&&e.jsx("span",{className:l.bracket,children:","})]})]})]})}return null},$t=g.forwardRef(({className:t,data:a,initialExpanded:s=!0,expandLevel:i=2,theme:r="light",showCopy:n=!0,showLineNumbers:o=!1,...c},l)=>{const[d,u]=g.useState(!1),m=g.useCallback(async()=>{try{await navigator.clipboard.writeText(JSON.stringify(a,null,2)),u(!0),setTimeout(()=>u(!1),2e3)}catch(h){console.error("Failed to copy:",h)}},[a]);return e.jsxs("div",{ref:l,className:x("relative rounded-lg border overflow-hidden",r==="dark"?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200",t),...c,children:[n&&e.jsx("button",{type:"button",onClick:m,className:x("absolute top-2 right-2 p-1.5 rounded-md transition-colors",r==="dark"?"text-gray-400 hover:text-gray-200 hover:bg-gray-800":"text-gray-500 hover:text-gray-700 hover:bg-gray-200"),children:d?e.jsx(ie,{className:"w-4 h-4 text-green-500"}):e.jsx(rt,{className:"w-4 h-4"})}),e.jsx("div",{className:x("p-4 font-mono text-sm overflow-auto",r==="dark"?"text-gray-200":"text-gray-800"),children:e.jsx(na,{value:a,level:0,expandLevel:i,theme:r,isLast:!0})})]})});$t.displayName="JsonViewer";const Mo=g.forwardRef(({className:t,code:a,language:s="json",showCopy:i=!0,theme:r="light",...n},o)=>{const[c,l]=g.useState(!1),d=g.useCallback(async()=>{try{await navigator.clipboard.writeText(a),l(!0),setTimeout(()=>l(!1),2e3)}catch(u){console.error("Failed to copy:",u)}},[a]);return e.jsxs("div",{className:"relative",children:[i&&e.jsx("button",{type:"button",onClick:d,className:x("absolute top-2 right-2 p-1.5 rounded-md transition-colors",r==="dark"?"text-gray-400 hover:text-gray-200 hover:bg-gray-800":"text-gray-500 hover:text-gray-700 hover:bg-gray-200"),children:c?e.jsx(ie,{className:"w-4 h-4 text-green-500"}):e.jsx(rt,{className:"w-4 h-4"})}),e.jsx("pre",{ref:o,className:x("p-4 rounded-lg border font-mono text-sm overflow-auto",r==="dark"?"bg-gray-900 border-gray-700 text-gray-200":"bg-gray-50 border-gray-200 text-gray-800",t),...n,children:e.jsx("code",{children:a})})]})});Mo.displayName="CodeBlock";function fi({onPatientChange:t,className:a=""}){const s=fa(),i=Be(m=>m.activePersonaId),r=Be(m=>m.setActivePersona),[n,o]=g.useState(!1),c=s.find(m=>m.id===i)||s[0],l=m=>{r(m),o(!1),t?.(m)},d=n?"rotate-180":"",u=m=>m===i?"bg-primary-50":"";return e.jsxs("div",{className:"relative "+a,children:[e.jsxs("button",{onClick:()=>o(!n),className:"flex items-center gap-3 px-4 py-2 bg-white border border-gray-200 rounded-lg shadow-sm hover:border-primary-300 hover:shadow-md transition-all min-w-[200px]",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-primary-100 to-primary-200 flex items-center justify-center",children:e.jsx(Ct,{className:"w-4 h-4 text-primary-600"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Patient"}),e.jsx("p",{className:"font-medium text-gray-900 text-sm",children:c?.name||"Select"})]}),e.jsx(ye,{className:"w-4 h-4 text-gray-400 transition-transform "+d})]}),n&&e.jsx(M.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 overflow-hidden",children:s.map(m=>e.jsxs("button",{onClick:()=>l(m.id),className:"w-full flex items-center gap-3 px-3 py-2 hover:bg-gray-50 transition-colors text-left "+u(m.id),children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:e.jsx(Ct,{className:"w-3 h-3 text-gray-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 text-sm",children:m.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[m.daysOfData," days"]})]}),m.id===i&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-primary-500"})]},m.id))})]})}const yi=g.forwardRef(({className:t,...a},s)=>{const{guidedMode:i}=lt(),{activePersona:r,personas:n,setPersona:o}=Ft(),{isSyncing:c,simulateSync:l}=ya(),d=An();return e.jsxs("header",{ref:s,className:x("h-16 bg-white border-b border-slate-200 flex items-center justify-between px-6",t),...a,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative","data-tour":"persona-selector",children:[e.jsx("label",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wider block mb-1",children:"Viewing as"}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:r?.id||"",onChange:u=>o(u.target.value),className:x("appearance-none bg-white border border-slate-200 rounded-lg pl-3 pr-8 py-1.5","text-sm font-medium text-slate-700",q.colors,"hover:border-slate-300 focus:outline-none focus:ring-2 focus:ring-primary-100 focus:border-primary-300"),children:n.map(u=>e.jsxs("option",{value:u.id,children:[u.name," (",u.dataContext?.daysOfData??u.daysOfData,"d)"]},u.id))}),e.jsx(ye,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"})]})]}),r&&e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsxs("span",{className:"px-2.5 py-1 bg-slate-50 border border-slate-200 rounded-full font-medium text-slate-600",children:[r.dataContext?.daysOfData??r.daysOfData," Days"]}),e.jsxs("span",{className:"px-2.5 py-1 bg-primary-50 border border-primary-100 rounded-full font-medium text-primary-600",children:[Math.round((r.dataContext?.evidenceWeight??.7)*100),"% Personal"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[i&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-primary-50 text-primary-600 text-xs font-medium rounded-full",children:[e.jsx("span",{className:"w-2 h-2 bg-serif-cyan rounded-full animate-pulse"}),"Tour Active"]}),e.jsx(st,{content:`Last synced: ${d}`,children:e.jsxs("button",{onClick:l,disabled:c,className:x("flex items-center gap-2 px-3 py-1.5 border border-slate-200 rounded-lg text-xs font-medium text-slate-600",q.colors,"hover:bg-slate-50 hover:border-slate-300 disabled:opacity-50 disabled:cursor-not-allowed"),children:[e.jsx(et,{className:x("w-4 h-4",c&&"animate-spin")}),c?"Syncing...":"Sync"]})}),e.jsxs("button",{className:"relative p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-50 rounded-lg transition-colors",children:[e.jsx(dr,{className:"w-5 h-5"}),e.jsx("span",{className:"absolute top-1.5 right-1.5 w-2 h-2 bg-serif-pink rounded-full"})]}),e.jsx("div",{className:"w-8 h-8 bg-primary-100 flex items-center justify-center text-primary-600 text-sm font-semibold rounded-full",children:r?.name.charAt(0)||"U"})]})]})});yi.displayName="Header";const Ro=g.forwardRef(({className:t,tabs:a,activeTab:s,onTabChange:i,actions:r,...n},o)=>e.jsxs("div",{ref:o,className:x("bg-white border-b border-slate-200 px-6 flex items-center justify-between",t),...n,children:[a&&e.jsx("div",{className:"flex",children:a.map(c=>e.jsxs("button",{onClick:()=>i?.(c.value),className:x("px-4 py-3 text-sm font-medium border-b-2 -mb-px transition-colors",s===c.value?"text-primary-600 border-serif-cyan":"text-slate-500 border-transparent hover:text-slate-700 hover:border-slate-200"),children:[c.label,c.count!==void 0&&e.jsx("span",{className:x("ml-2 px-1.5 py-0.5 text-xs rounded-full",s===c.value?"bg-primary-100 text-primary-600":"bg-slate-100 text-slate-500"),children:c.count})]},c.value))}),r&&e.jsx("div",{className:"flex items-center gap-3",children:r})]}));Ro.displayName="SubHeader";const Po=g.forwardRef(({className:t,items:a,...s},i)=>e.jsx("nav",{ref:i,className:x("flex items-center text-sm",t),...s,children:a.map((r,n)=>e.jsxs("span",{className:"flex items-center",children:[n>0&&e.jsx("span",{className:"mx-2 text-slate-300",children:"/"}),r.href?e.jsx("a",{href:r.href,className:"text-slate-500 hover:text-slate-700 transition-colors",children:r.label}):e.jsx("span",{className:"text-slate-800 font-medium",children:r.label})]},n))}));Po.displayName="Breadcrumbs";const vi=g.forwardRef(({className:t,showSidebar:a=!0,showHeader:s=!0,children:i,...r},n)=>e.jsxs("div",{ref:n,className:x("min-h-screen bg-white flex",t),...r,children:[a&&e.jsx(Ms,{}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[s&&e.jsx(yi,{}),e.jsx("main",{className:"flex-1 overflow-auto bg-gray-100",children:i||e.jsx(tr,{})})]}),e.jsx(bi,{position:"bottom-right"})]}));vi.displayName="AppShell";const Do={sm:"max-w-2xl",md:"max-w-4xl",lg:"max-w-5xl",xl:"max-w-6xl","2xl":"max-w-7xl",full:"max-w-full"},Ao={none:"",sm:"p-4",md:"p-6",lg:"p-8"},Z=g.forwardRef(({className:t,title:a,subtitle:s,actions:i,maxWidth:r="2xl",padding:n="md",children:o,...c},l)=>e.jsxs("div",{ref:l,className:x("mx-auto w-full",Do[r],Ao[n],t),...c,children:[(a||i)&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[a&&e.jsx("h1",{className:"text-3xl font-black text-black uppercase tracking-tight",children:a}),s&&e.jsx("p",{className:"mt-2 text-sm font-medium text-gray-600 uppercase tracking-wider",children:s})]}),i&&e.jsx("div",{className:"flex items-center gap-3",children:i})]}),e.jsx("div",{className:"h-0.5 bg-black mt-4"})]}),o]}));Z.displayName="PageLayout";const F=g.forwardRef(({className:t,title:a,subtitle:s,actions:i,children:r,...n},o)=>e.jsxs("section",{ref:o,className:x("mb-8",t),...n,children:[(a||i)&&e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[a&&e.jsx("h2",{className:"text-xl font-black text-black uppercase tracking-tight",children:a}),s&&e.jsx("p",{className:"mt-1 text-xs font-bold text-gray-500 uppercase tracking-widest",children:s})]}),i&&e.jsx("div",{className:"flex items-center gap-2",children:i})]}),r]}));F.displayName="Section";const Io={1:"grid-cols-1",2:"grid-cols-1 md:grid-cols-2",3:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3",4:"grid-cols-1 md:grid-cols-2 lg:grid-cols-4",5:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5",6:"grid-cols-1 md:grid-cols-3 lg:grid-cols-6"},Lo={none:"",sm:"gap-3",md:"gap-4",lg:"gap-6"},$=g.forwardRef(({className:t,columns:a=3,gap:s="md",children:i,...r},n)=>e.jsx("div",{ref:n,className:x("grid",Io[a],Lo[s],t),...r,children:i}));$.displayName="Grid";const Eo=g.forwardRef(({className:t,sidebar:a,sidebarWidth:s="280px",sidebarPosition:i="left",children:r,...n},o)=>e.jsxs("div",{ref:o,className:x("flex gap-6",i==="right"&&"flex-row-reverse",t),...n,children:[e.jsx("aside",{className:"flex-shrink-0",style:{width:s},children:a}),e.jsx("div",{className:"flex-1 min-w-0",children:r})]}));Eo.displayName="SplitLayout";const Wo=g.forwardRef(({className:t,icon:a,title:s,description:i,action:r,...n},o)=>e.jsxs("div",{ref:o,className:x("flex flex-col items-center justify-center py-12 px-4 text-center","border-2 border-dashed border-gray-300",t),...n,children:[a&&e.jsx("div",{className:"mb-4 text-gray-400",children:a}),e.jsx("h3",{className:"text-lg font-black text-black uppercase tracking-tight mb-2",children:s}),i&&e.jsx("p",{className:"text-sm text-gray-500 mb-4 max-w-sm",children:i}),r]}));Wo.displayName="EmptyState";const wi={outcome:{id:"outcome",label:"Outcomes",shortLabel:"Outcomes",description:"Daily metrics you care about optimizing",color:"#10B981",bgColor:"bg-emerald-50",borderColor:"border-emerald-200",icon:"Target",domains:["sleep","recovery","mood","cognitive","activity","stress"]},load:{id:"load",label:"Loads",shortLabel:"Loads",description:"Accumulated state from recent choices",color:"#F59E0B",bgColor:"bg-amber-50",borderColor:"border-amber-200",icon:"TrendingUp",domains:["activity","recovery","stress","sleep"]},marker:{id:"marker",label:"Markers",shortLabel:"Markers",description:"Slow-changing biological markers",color:"#8B5CF6",bgColor:"bg-violet-50",borderColor:"border-violet-200",icon:"Activity",domains:["metabolic","cardio","nutrition"]}};function Fa(t){let a=[...Gs];if(t.personaId&&(a=a.filter(s=>s.personaId===t.personaId)),t.category){const s=Array.isArray(t.category)?t.category:[t.category];a=a.filter(i=>s.includes(i.category))}return t.minCertainty!==void 0&&(a=a.filter(s=>s.certainty>=t.minCertainty)),t.maxCertainty!==void 0&&(a=a.filter(s=>s.certainty<=t.maxCertainty)),t.hasHoldoutPreview!==void 0&&(a=a.filter(s=>t.hasHoldoutPreview?!!s.holdoutPreview:!s.holdoutPreview)),t.dataSources&&t.dataSources.length>0&&(a=a.filter(s=>t.dataSources.some(i=>s.dataSources.includes(i)))),a}function $a(t){return bn.filter(a=>a.personaId===t)}const za=[{primary:"rgb(var(--color-primary-500))",light:"rgb(var(--color-primary-100))",bg:"bg-primary-50",border:"border-primary-200",text:"text-primary-600"},{primary:"rgb(var(--color-secondary-500))",light:"rgb(var(--color-secondary-100))",bg:"bg-secondary-50",border:"border-secondary-200",text:"text-secondary-600"},{primary:"rgb(var(--color-accent-500))",light:"rgb(var(--color-accent-100))",bg:"bg-accent-50",border:"border-accent-200",text:"text-accent-600"},{primary:"#10B981",light:"#D1FAE5",bg:"bg-emerald-50",border:"border-emerald-200",text:"text-emerald-600"},{primary:"#6366F1",light:"#E0E7FF",bg:"bg-indigo-50",border:"border-indigo-200",text:"text-indigo-600"},{primary:"#8B5CF6",light:"#EDE9FE",bg:"bg-violet-50",border:"border-violet-200",text:"text-violet-600"}];function Ho(){const t=gs(),a=fa(),s=Be(m=>m.setActivePersona),i=a.map(m=>{const h=Fa({personaId:m.id,minCertainty:.6}),p=h.filter(b=>b.causalParams?.currentStatus&&b.causalParams.currentStatus!=="at_optimal");return{personaId:m.id,insights:h,outsideSafeguards:p}}),r=i.reduce((m,h)=>m+h.insights.length,0),n=i.reduce((m,h)=>m+h.outsideSafeguards.length,0),o=a.map(m=>{const h=$a(m.id);return{personaId:m.id,protocols:h,active:h.filter(p=>p.status==="active"),needsReview:h.filter(p=>p.status==="suggested"||!p.status)}}),c=o.reduce((m,h)=>m+h.needsReview.length,0);o.reduce((m,h)=>m+h.active.length,0);const l=i.filter(m=>m.outsideSafeguards.length>0).length,d=(m,h)=>{s(m),t(h)},u=[{icon:le,label:"Outside Safeguards",value:n,color:"text-amber-600",bgColor:"bg-amber-50",borderColor:"border-amber-100",urgent:n>0},{icon:De,label:"Total Insights",value:r,color:"text-primary-600",bgColor:"bg-primary-50",borderColor:"border-primary-100"},{icon:mr,label:"Protocols to Review",value:c,color:"text-rose-600",bgColor:"bg-rose-50",borderColor:"border-rose-100",urgent:c>0},{icon:fe,label:"Patients Deviating",value:l,subtitle:`of ${a.length}`,color:"text-secondary-600",bgColor:"bg-secondary-50",borderColor:"border-secondary-100"}];return e.jsxs(Z,{maxWidth:"2xl",padding:"lg",children:[e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold text-slate-800 mb-1",children:"Good morning, Dr. Hoon"}),e.jsxs("p",{className:"text-slate-500",children:["You have ",e.jsxs("span",{className:"font-medium text-primary-600",children:[a.length," patients"]})," with new insights today"]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2.5 bg-primary-50 border border-primary-100 rounded-xl",children:[e.jsx(Le,{className:"w-5 h-5 text-primary-500"}),e.jsx("span",{className:"text-sm font-medium text-primary-600",children:"All Patients Dashboard"})]})]})}),e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-8",children:e.jsx($,{columns:4,gap:"md",children:u.map((m,h)=>{const p=m.icon,b="urgent"in m&&m.urgent;return e.jsx(k,{className:`p-4 rounded-xl border transition-all ${b?"ring-1 ring-amber-200 bg-amber-50/30 border-amber-200":`bg-white/80 ${m.borderColor}`}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2.5 rounded-xl border ${m.bgColor} ${m.borderColor}`,children:e.jsx(p,{className:"w-5 h-5 "+m.color})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 font-medium",children:m.label}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("p",{className:`text-2xl font-semibold ${b?m.color:"text-slate-800"}`,children:m.value}),"subtitle"in m&&m.subtitle&&e.jsx("span",{className:"text-sm text-slate-400",children:m.subtitle})]})]})]})},h)})})}),e.jsxs(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsx("div",{className:"p-2.5 bg-primary-50 border border-primary-100 rounded-xl",children:e.jsx(Ct,{className:"w-5 h-5 text-primary-500"})}),e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Patient Overview"})]}),e.jsx($,{columns:2,gap:"lg",children:a.map((m,h)=>{const p=za[h%za.length],b=Fa({personaId:m.id,minCertainty:.6}),w=$a(m.id).filter(R=>R.status==="active"),v=b.filter(R=>R.causalParams?.currentStatus&&R.causalParams.currentStatus!=="at_optimal").slice(0,3),_=w.length>0,f=m.daysOfData<30||b.length<3,j=_?"Active Protocol":f?"Still Collecting Insights":"Ready for Protocol",N=()=>_?"bg-emerald-100 text-emerald-700":f?"bg-amber-100 text-amber-700":"bg-blue-100 text-blue-700",S=R=>R==="above_optimal"?e.jsx(fe,{className:"w-3 h-3 rotate-180"}):e.jsx(fe,{className:"w-3 h-3"});return e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*h},children:e.jsxs(k,{className:`p-5 rounded-xl hover:shadow-md transition-all border-2 ${p.border} ${p.bg}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center border ${p.border} ${p.bg}`,children:e.jsx(Ct,{className:`w-6 h-6 ${p.text}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-800",children:m.name}),e.jsx("p",{className:"text-sm text-slate-500",children:m.archetype})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-medium ${N()}`,children:j}),e.jsxs("span",{className:"text-xs text-slate-400",children:[m.daysOfData," days of data"]})]})]}),v.length>0?e.jsxs("div",{className:"mb-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(le,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Deviating from Trend"})]}),v.map(R=>{const L=R.causalParams?.currentStatus||"below_optimal",I=L==="above_optimal";return e.jsx("div",{className:"p-3 bg-amber-50/70 rounded-xl border border-amber-100",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:`p-1.5 rounded-lg ${I?"bg-rose-100 border border-rose-200":"bg-sky-100 border border-sky-200"}`,children:S(L)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-700 truncate",children:R.causalParams?.source?.replace(/_/g," ").replace(/\b\w/g,T=>T.toUpperCase())||R.title}),e.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:[I?"Above":"Below"," optimal threshold",R.causalParams?.theta?.displayValue&&e.jsxs("span",{className:"text-amber-600 font-medium",children:[" (",R.causalParams.theta.displayValue,")"]})]})]})]})},R.id)})]}):e.jsx("div",{className:"mb-4 p-3 bg-emerald-50/70 rounded-xl border border-emerald-100",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4 text-emerald-500"}),e.jsx("span",{className:"text-sm text-emerald-600 font-medium",children:"All metrics within optimal range"})]})}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-slate-500 mb-4 pb-4 border-b border-slate-100",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(De,{className:"w-3.5 h-3.5 text-primary-400"}),b.length," insights"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(_t,{className:"w-3.5 h-3.5 text-secondary-400"}),w.length," protocols"]}),v.length>0&&e.jsxs("span",{className:"flex items-center gap-1.5 text-amber-600",children:[e.jsx(le,{className:"w-3.5 h-3.5"}),v.length," alerts"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("button",{onClick:()=>d(m.id,"/insights"),className:`flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium rounded-xl transition-all border ${p.bg} ${p.border} ${p.text} hover:shadow-sm`,children:[e.jsx(De,{className:"w-4 h-4"}),"Insights"]}),e.jsxs("button",{onClick:()=>d(m.id,"/protocols"),className:`flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium rounded-xl transition-all border ${p.bg} ${p.border} ${p.text} hover:shadow-sm`,children:[e.jsx(_t,{className:"w-4 h-4"}),"Protocols"]}),e.jsxs("button",{onClick:()=>d(m.id,"/integration"),className:`flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium rounded-xl transition-all border ${p.bg} ${p.border} ${p.text} hover:shadow-sm`,children:[e.jsx(U,{className:"w-4 h-4"}),"Devices"]})]})]})},m.id)})})]})]})}const Vo={"apple-watch":ma,bloodwork:vs,gpx:ur,"medix-cpet":ys,autosleep:X},Ga=t=>t?new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"N/A",Oo=t=>t?new Date(t).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):"";function Bo(){const{activePersona:t}=Ft(),{devices:a}=Ys(),{deviceStates:s,syncDevice:i,syncAllDevices:r,isSyncing:n}=ya(),[o,c]=g.useState(null),l=m=>s.find(h=>h.deviceId===m),d=m=>t?.deviceConnections?.find(h=>h.deviceId===m),u=n?"animate-spin":"";return e.jsxs(Z,{title:"Data Integration",subtitle:"Connect your wearables and health data sources",actions:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(fi,{}),e.jsxs(V,{onClick:r,loading:n,children:[e.jsx(et,{className:"w-4 h-4 mr-2 "+u}),"Sync All Devices"]})]}),children:[e.jsx(F,{title:"Connected Devices",subtitle:t?"Data sources for "+t.name:"Data sources",children:e.jsx($,{columns:4,gap:"md","data-tour":"device-grid",children:a.map(m=>{l(m.id);const h=Vo[m.id]||ma,p=d(m.id),b=p?.isActive??!1,y=!!p,w=b?"bg-[#89ccf0]/20":y?"bg-gray-200":"bg-gray-100",v=b?"text-[#89ccf0]":y?"text-gray-500":"text-gray-300",_=b?"border-2 border-[#89ccf0]":"";return e.jsxs("div",{className:"relative",onMouseEnter:()=>c(m.id),onMouseLeave:()=>c(null),children:[e.jsxs(k,{className:"p-4 "+_,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg "+w,children:e.jsx(h,{className:"w-5 h-5 "+v})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:m.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[m.metrics?.length??0," metrics"]})]})]}),b?e.jsx("div",{className:"w-2 h-2 rounded-full bg-[#89ccf0] animate-pulse"}):y?e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400"}):null]}),e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[m.metrics?.slice(0,3).map(f=>e.jsx(A,{variant:"outline",size:"sm",children:f},f)),(m.metrics?.length??0)>3&&e.jsxs(A,{variant:"outline",size:"sm",children:["+",(m.metrics?.length??0)-3]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:b?e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-[#89ccf0] font-medium",children:"Connected"}),e.jsx(V,{size:"xs",variant:"ghost",onClick:()=>i(m.id),children:e.jsx(et,{className:"w-3 h-3"})})]}),e.jsx("span",{className:"text-xs text-gray-400",children:"Last synced: 4:30am"})]}):y?e.jsx("span",{className:"text-xs text-gray-500",children:"Previously connected"}):e.jsx(V,{size:"sm",variant:"outline",fullWidth:!0,children:"Connect"})})]}),o===m.id&&y&&e.jsx(M.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 z-50",children:e.jsxs("div",{className:"bg-navy-900 text-white px-3 py-2 rounded-lg shadow-lg text-xs whitespace-nowrap",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"First connected: "}),e.jsx("span",{children:Ga(p?.firstConnected)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Last refreshed: "}),e.jsxs("span",{children:[Ga(p?.lastRefreshed)," ",Oo(p?.lastRefreshed)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Status: "}),e.jsx("span",{className:b?"text-[#89ccf0]":"text-gray-400",children:b?"Active":"Inactive"})]})]}),e.jsx("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-full",children:e.jsx("div",{className:"border-8 border-transparent border-t-navy-900"})})]})})]},m.id)})})}),e.jsx(F,{title:"Data Pipeline Architecture",subtitle:"How Serif processes your health data",className:"mt-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(k,{className:"p-6 bg-gradient-to-r from-emerald-50 to-cyan-50 border-2 border-emerald-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"px-3 py-1 bg-emerald-500 text-white text-xs font-bold rounded-full",children:"FAST LOOP"}),e.jsx("span",{className:"text-sm text-emerald-700 font-medium",children:"Daily Inference Pipeline"}),e.jsx("span",{className:"text-xs text-emerald-600 ml-auto",children:"Runs every 24 hours"})]}),e.jsx("div",{className:"flex items-center justify-between gap-2 overflow-x-auto pb-2",children:[{name:"ETL",desc:"Extract & Transform",color:"bg-slate-100 border-slate-300"},{name:"COMPLE",desc:"Categorize Data",color:"bg-violet-100 border-violet-300"},{name:"Causal Structure",desc:"Build DAG",color:"bg-blue-100 border-blue-300"},{name:"BCEL Inference",desc:"Generate Insights",color:"bg-emerald-100 border-emerald-300"},{name:"Safeguards",desc:"Validate Safety",color:"bg-amber-100 border-amber-300"},{name:"Plan Publisher",desc:"Deliver to User",color:"bg-cyan-100 border-cyan-300"}].map((m,h,p)=>e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsxs("div",{className:`px-4 py-3 rounded-lg border-2 ${m.color} text-center min-w-[100px]`,children:[e.jsx("div",{className:"text-xs font-bold text-slate-800",children:m.name}),e.jsx("div",{className:"text-[10px] text-slate-500 mt-0.5",children:m.desc})]}),h<p.length-1&&e.jsx("span",{className:"text-emerald-400 text-lg font-bold",children:"→"})]},m.name))})]}),e.jsxs(k,{className:"p-6 bg-gradient-to-r from-violet-50 to-purple-50 border-2 border-violet-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"px-3 py-1 bg-violet-500 text-white text-xs font-bold rounded-full",children:"SLOW LOOP"}),e.jsx("span",{className:"text-sm text-violet-700 font-medium",children:"Weekly Learning Pipeline"}),e.jsx("span",{className:"text-xs text-violet-600 ml-auto",children:"Runs every 7 days"})]}),e.jsx("div",{className:"flex items-center justify-between gap-2 overflow-x-auto pb-2",children:[{name:"60-Day History",desc:"Aggregate Data",color:"bg-slate-100 border-slate-300"},{name:"Backdoor Features",desc:"Control Confounders",color:"bg-rose-100 border-rose-300"},{name:"BCEL Learn",desc:"Update Parameters",color:"bg-violet-100 border-violet-300"},{name:"Validation",desc:"Calibration Check",color:"bg-purple-100 border-purple-300"},{name:"Model Update",desc:"Deploy to Fast Loop",color:"bg-indigo-100 border-indigo-300"}].map((m,h,p)=>e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsxs("div",{className:`px-4 py-3 rounded-lg border-2 ${m.color} text-center min-w-[110px]`,children:[e.jsx("div",{className:"text-xs font-bold text-slate-800",children:m.name}),e.jsx("div",{className:"text-[10px] text-slate-500 mt-0.5",children:m.desc})]}),h<p.length-1&&e.jsx("span",{className:"text-violet-400 text-lg font-bold",children:"→"})]},m.name))})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs(k,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:"24h"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Insight Refresh"})]}),e.jsxs(k,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-violet-600",children:"7-10 days"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Individual Calibration"})]}),e.jsxs(k,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-cyan-600",children:"128"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Bayesian Worlds/Run"})]})]})]})}),e.jsx(F,{title:"Data Variables by Source",subtitle:"What each device contributes to the causal model",className:"mt-8",children:e.jsx($,{columns:3,gap:"md",children:[{source:"Apple Watch",icon:"⌚",desc:"Primary wearable — continuous physiological monitoring",color:{bg:"bg-cyan-50",border:"border-cyan-200",icon:"bg-cyan-100 text-cyan-700",badge:"bg-cyan-100 text-cyan-600"},variables:["Heart rate (continuous)","HRV — SDNN (ms)","Resting heart rate (bpm)","Steps (daily)","Active energy (kcal)","SpO2 (%)","Sleep stages (Core, Deep, REM)","Body mass (kg)","Walking HR avg"]},{source:"Bloodwork (Quest)",icon:"🩸",desc:"6 lab draws — metabolic, lipid, iron, and hormone panels",color:{bg:"bg-rose-50",border:"border-rose-200",icon:"bg-rose-100 text-rose-700",badge:"bg-rose-100 text-rose-600"},variables:["Fasting glucose","Insulin","Total cholesterol","LDL / HDL","Triglycerides","ApoB","hsCRP","Cortisol","Testosterone","TSH","Ferritin / Iron / TIBC","Vitamin D","EPA / DHA","AA:EPA ratio"]},{source:"GPX Workouts",icon:"📍",desc:"GPS training files — running, cycling, hiking since 2016",color:{bg:"bg-emerald-50",border:"border-emerald-200",icon:"bg-emerald-100 text-emerald-700",badge:"bg-emerald-100 text-emerald-600"},variables:["TRIMP (training impulse)","Distance (km)","Duration (min)","HR zone distribution","Zone 2 time","Elevation gain","Pace","ACWR (acute:chronic)","Weekly run volume (km)"]},{source:"Medix CPET",icon:"🫁",desc:"Cardiopulmonary exercise testing — Dec 2025",color:{bg:"bg-violet-50",border:"border-violet-200",icon:"bg-violet-100 text-violet-700",badge:"bg-violet-100 text-violet-600"},variables:["VO2peak (ml/min/kg)","VT1 (ventilatory threshold)","VT2 (respiratory compensation)","Max heart rate","Respiratory exchange ratio"]},{source:"AutoSleep (inactive)",icon:"🌙",desc:"Sleep tracking 2019–2023 — replaced by Apple native sleep",color:{bg:"bg-slate-50",border:"border-slate-200",icon:"bg-slate-100 text-slate-500",badge:"bg-slate-100 text-slate-500"},variables:["Sleep quality score","Deep sleep (min)","Sleep efficiency (%)","Nighttime HRV","Readiness score","Sleep latency"]},{source:"Derived / Computed",icon:"⚙️",desc:"Variables Serif computes from raw data",color:{bg:"bg-amber-50",border:"border-amber-200",icon:"bg-amber-100 text-amber-700",badge:"bg-amber-100 text-amber-600"},variables:["Travel load (jet lag score)","NLR (neutrophil:lymphocyte)","Sleep duration (hrs)","Non-HDL cholesterol","Iron saturation (%)","7d HRV trend","7d resting HR trend","CTL / ATL / ACWR"]}].map(m=>e.jsxs(k,{className:`p-4 ${m.color.bg} border ${m.color.border}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:`w-10 h-10 ${m.color.icon} rounded-lg flex items-center justify-center font-bold text-lg`,children:m.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:m.source}),e.jsx("p",{className:"text-xs text-gray-500",children:m.desc})]})]}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:m.variables.map(h=>e.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium ${m.color.badge}`,children:h},h))})]},m.source))})})]})}function Mt(t){"@babel/helpers - typeof";return Mt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},Mt(t)}function we(t){if(t===null||t===!0||t===!1)return NaN;var a=Number(t);return isNaN(a)?a:a<0?Math.ceil(a):Math.floor(a)}function Y(t,a){if(a.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+a.length+" present")}function me(t){Y(1,arguments);var a=Object.prototype.toString.call(t);return t instanceof Date||Mt(t)==="object"&&a==="[object Date]"?new Date(t.getTime()):typeof t=="number"||a==="[object Number]"?new Date(t):((typeof t=="string"||a==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function Fo(t,a){Y(2,arguments);var s=me(t).getTime(),i=we(a);return new Date(s+i)}var $o={};function zt(){return $o}function zo(t){var a=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return a.setUTCFullYear(t.getFullYear()),t.getTime()-a.getTime()}var ji=6e4,Ni=36e5;function Go(t){return Y(1,arguments),t instanceof Date||Mt(t)==="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Uo(t){if(Y(1,arguments),!Go(t)&&typeof t!="number")return!1;var a=me(t);return!isNaN(Number(a))}function Yo(t,a){Y(2,arguments);var s=we(a);return Fo(t,-s)}var Zo=864e5;function qo(t){Y(1,arguments);var a=me(t),s=a.getTime();a.setUTCMonth(0,1),a.setUTCHours(0,0,0,0);var i=a.getTime(),r=s-i;return Math.floor(r/Zo)+1}function Rt(t){Y(1,arguments);var a=1,s=me(t),i=s.getUTCDay(),r=(i<a?7:0)+i-a;return s.setUTCDate(s.getUTCDate()-r),s.setUTCHours(0,0,0,0),s}function _i(t){Y(1,arguments);var a=me(t),s=a.getUTCFullYear(),i=new Date(0);i.setUTCFullYear(s+1,0,4),i.setUTCHours(0,0,0,0);var r=Rt(i),n=new Date(0);n.setUTCFullYear(s,0,4),n.setUTCHours(0,0,0,0);var o=Rt(n);return a.getTime()>=r.getTime()?s+1:a.getTime()>=o.getTime()?s:s-1}function Ko(t){Y(1,arguments);var a=_i(t),s=new Date(0);s.setUTCFullYear(a,0,4),s.setUTCHours(0,0,0,0);var i=Rt(s);return i}var Xo=6048e5;function Qo(t){Y(1,arguments);var a=me(t),s=Rt(a).getTime()-Ko(a).getTime();return Math.round(s/Xo)+1}function Pt(t,a){var s,i,r,n,o,c,l,d;Y(1,arguments);var u=zt(),m=we((s=(i=(r=(n=a?.weekStartsOn)!==null&&n!==void 0?n:a==null||(o=a.locale)===null||o===void 0||(c=o.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&r!==void 0?r:u.weekStartsOn)!==null&&i!==void 0?i:(l=u.locale)===null||l===void 0||(d=l.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&s!==void 0?s:0);if(!(m>=0&&m<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=me(t),p=h.getUTCDay(),b=(p<m?7:0)+p-m;return h.setUTCDate(h.getUTCDate()-b),h.setUTCHours(0,0,0,0),h}function ki(t,a){var s,i,r,n,o,c,l,d;Y(1,arguments);var u=me(t),m=u.getUTCFullYear(),h=zt(),p=we((s=(i=(r=(n=a?.firstWeekContainsDate)!==null&&n!==void 0?n:a==null||(o=a.locale)===null||o===void 0||(c=o.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&r!==void 0?r:h.firstWeekContainsDate)!==null&&i!==void 0?i:(l=h.locale)===null||l===void 0||(d=l.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&s!==void 0?s:1);if(!(p>=1&&p<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var b=new Date(0);b.setUTCFullYear(m+1,0,p),b.setUTCHours(0,0,0,0);var y=Pt(b,a),w=new Date(0);w.setUTCFullYear(m,0,p),w.setUTCHours(0,0,0,0);var v=Pt(w,a);return u.getTime()>=y.getTime()?m+1:u.getTime()>=v.getTime()?m:m-1}function Jo(t,a){var s,i,r,n,o,c,l,d;Y(1,arguments);var u=zt(),m=we((s=(i=(r=(n=a?.firstWeekContainsDate)!==null&&n!==void 0?n:a==null||(o=a.locale)===null||o===void 0||(c=o.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&r!==void 0?r:u.firstWeekContainsDate)!==null&&i!==void 0?i:(l=u.locale)===null||l===void 0||(d=l.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&s!==void 0?s:1),h=ki(t,a),p=new Date(0);p.setUTCFullYear(h,0,m),p.setUTCHours(0,0,0,0);var b=Pt(p,a);return b}var el=6048e5;function tl(t,a){Y(1,arguments);var s=me(t),i=Pt(s,a).getTime()-Jo(s,a).getTime();return Math.round(i/el)+1}function W(t,a){for(var s=t<0?"-":"",i=Math.abs(t).toString();i.length<a;)i="0"+i;return s+i}var xe={y:function(a,s){var i=a.getUTCFullYear(),r=i>0?i:1-i;return W(s==="yy"?r%100:r,s.length)},M:function(a,s){var i=a.getUTCMonth();return s==="M"?String(i+1):W(i+1,2)},d:function(a,s){return W(a.getUTCDate(),s.length)},a:function(a,s){var i=a.getUTCHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return i.toUpperCase();case"aaa":return i;case"aaaaa":return i[0];default:return i==="am"?"a.m.":"p.m."}},h:function(a,s){return W(a.getUTCHours()%12||12,s.length)},H:function(a,s){return W(a.getUTCHours(),s.length)},m:function(a,s){return W(a.getUTCMinutes(),s.length)},s:function(a,s){return W(a.getUTCSeconds(),s.length)},S:function(a,s){var i=s.length,r=a.getUTCMilliseconds(),n=Math.floor(r*Math.pow(10,i-3));return W(n,s.length)}},Ee={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},al={G:function(a,s,i){var r=a.getUTCFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return i.era(r,{width:"abbreviated"});case"GGGGG":return i.era(r,{width:"narrow"});default:return i.era(r,{width:"wide"})}},y:function(a,s,i){if(s==="yo"){var r=a.getUTCFullYear(),n=r>0?r:1-r;return i.ordinalNumber(n,{unit:"year"})}return xe.y(a,s)},Y:function(a,s,i,r){var n=ki(a,r),o=n>0?n:1-n;if(s==="YY"){var c=o%100;return W(c,2)}return s==="Yo"?i.ordinalNumber(o,{unit:"year"}):W(o,s.length)},R:function(a,s){var i=_i(a);return W(i,s.length)},u:function(a,s){var i=a.getUTCFullYear();return W(i,s.length)},Q:function(a,s,i){var r=Math.ceil((a.getUTCMonth()+1)/3);switch(s){case"Q":return String(r);case"QQ":return W(r,2);case"Qo":return i.ordinalNumber(r,{unit:"quarter"});case"QQQ":return i.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return i.quarter(r,{width:"narrow",context:"formatting"});default:return i.quarter(r,{width:"wide",context:"formatting"})}},q:function(a,s,i){var r=Math.ceil((a.getUTCMonth()+1)/3);switch(s){case"q":return String(r);case"qq":return W(r,2);case"qo":return i.ordinalNumber(r,{unit:"quarter"});case"qqq":return i.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return i.quarter(r,{width:"narrow",context:"standalone"});default:return i.quarter(r,{width:"wide",context:"standalone"})}},M:function(a,s,i){var r=a.getUTCMonth();switch(s){case"M":case"MM":return xe.M(a,s);case"Mo":return i.ordinalNumber(r+1,{unit:"month"});case"MMM":return i.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return i.month(r,{width:"narrow",context:"formatting"});default:return i.month(r,{width:"wide",context:"formatting"})}},L:function(a,s,i){var r=a.getUTCMonth();switch(s){case"L":return String(r+1);case"LL":return W(r+1,2);case"Lo":return i.ordinalNumber(r+1,{unit:"month"});case"LLL":return i.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return i.month(r,{width:"narrow",context:"standalone"});default:return i.month(r,{width:"wide",context:"standalone"})}},w:function(a,s,i,r){var n=tl(a,r);return s==="wo"?i.ordinalNumber(n,{unit:"week"}):W(n,s.length)},I:function(a,s,i){var r=Qo(a);return s==="Io"?i.ordinalNumber(r,{unit:"week"}):W(r,s.length)},d:function(a,s,i){return s==="do"?i.ordinalNumber(a.getUTCDate(),{unit:"date"}):xe.d(a,s)},D:function(a,s,i){var r=qo(a);return s==="Do"?i.ordinalNumber(r,{unit:"dayOfYear"}):W(r,s.length)},E:function(a,s,i){var r=a.getUTCDay();switch(s){case"E":case"EE":case"EEE":return i.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return i.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(r,{width:"short",context:"formatting"});default:return i.day(r,{width:"wide",context:"formatting"})}},e:function(a,s,i,r){var n=a.getUTCDay(),o=(n-r.weekStartsOn+8)%7||7;switch(s){case"e":return String(o);case"ee":return W(o,2);case"eo":return i.ordinalNumber(o,{unit:"day"});case"eee":return i.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return i.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(n,{width:"short",context:"formatting"});default:return i.day(n,{width:"wide",context:"formatting"})}},c:function(a,s,i,r){var n=a.getUTCDay(),o=(n-r.weekStartsOn+8)%7||7;switch(s){case"c":return String(o);case"cc":return W(o,s.length);case"co":return i.ordinalNumber(o,{unit:"day"});case"ccc":return i.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return i.day(n,{width:"narrow",context:"standalone"});case"cccccc":return i.day(n,{width:"short",context:"standalone"});default:return i.day(n,{width:"wide",context:"standalone"})}},i:function(a,s,i){var r=a.getUTCDay(),n=r===0?7:r;switch(s){case"i":return String(n);case"ii":return W(n,s.length);case"io":return i.ordinalNumber(n,{unit:"day"});case"iii":return i.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return i.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return i.day(r,{width:"short",context:"formatting"});default:return i.day(r,{width:"wide",context:"formatting"})}},a:function(a,s,i){var r=a.getUTCHours(),n=r/12>=1?"pm":"am";switch(s){case"a":case"aa":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return i.dayPeriod(n,{width:"narrow",context:"formatting"});default:return i.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(a,s,i){var r=a.getUTCHours(),n;switch(r===12?n=Ee.noon:r===0?n=Ee.midnight:n=r/12>=1?"pm":"am",s){case"b":case"bb":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return i.dayPeriod(n,{width:"narrow",context:"formatting"});default:return i.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(a,s,i){var r=a.getUTCHours(),n;switch(r>=17?n=Ee.evening:r>=12?n=Ee.afternoon:r>=4?n=Ee.morning:n=Ee.night,s){case"B":case"BB":case"BBB":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return i.dayPeriod(n,{width:"narrow",context:"formatting"});default:return i.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(a,s,i){if(s==="ho"){var r=a.getUTCHours()%12;return r===0&&(r=12),i.ordinalNumber(r,{unit:"hour"})}return xe.h(a,s)},H:function(a,s,i){return s==="Ho"?i.ordinalNumber(a.getUTCHours(),{unit:"hour"}):xe.H(a,s)},K:function(a,s,i){var r=a.getUTCHours()%12;return s==="Ko"?i.ordinalNumber(r,{unit:"hour"}):W(r,s.length)},k:function(a,s,i){var r=a.getUTCHours();return r===0&&(r=24),s==="ko"?i.ordinalNumber(r,{unit:"hour"}):W(r,s.length)},m:function(a,s,i){return s==="mo"?i.ordinalNumber(a.getUTCMinutes(),{unit:"minute"}):xe.m(a,s)},s:function(a,s,i){return s==="so"?i.ordinalNumber(a.getUTCSeconds(),{unit:"second"}):xe.s(a,s)},S:function(a,s){return xe.S(a,s)},X:function(a,s,i,r){var n=r._originalDate||a,o=n.getTimezoneOffset();if(o===0)return"Z";switch(s){case"X":return Ya(o);case"XXXX":case"XX":return Re(o);default:return Re(o,":")}},x:function(a,s,i,r){var n=r._originalDate||a,o=n.getTimezoneOffset();switch(s){case"x":return Ya(o);case"xxxx":case"xx":return Re(o);default:return Re(o,":")}},O:function(a,s,i,r){var n=r._originalDate||a,o=n.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+Ua(o,":");default:return"GMT"+Re(o,":")}},z:function(a,s,i,r){var n=r._originalDate||a,o=n.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+Ua(o,":");default:return"GMT"+Re(o,":")}},t:function(a,s,i,r){var n=r._originalDate||a,o=Math.floor(n.getTime()/1e3);return W(o,s.length)},T:function(a,s,i,r){var n=r._originalDate||a,o=n.getTime();return W(o,s.length)}};function Ua(t,a){var s=t>0?"-":"+",i=Math.abs(t),r=Math.floor(i/60),n=i%60;if(n===0)return s+String(r);var o=a;return s+String(r)+o+W(n,2)}function Ya(t,a){if(t%60===0){var s=t>0?"-":"+";return s+W(Math.abs(t)/60,2)}return Re(t,a)}function Re(t,a){var s=a||"",i=t>0?"-":"+",r=Math.abs(t),n=W(Math.floor(r/60),2),o=W(r%60,2);return i+n+s+o}var Za=function(a,s){switch(a){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});default:return s.date({width:"full"})}},Ci=function(a,s){switch(a){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});default:return s.time({width:"full"})}},sl=function(a,s){var i=a.match(/(P+)(p+)?/)||[],r=i[1],n=i[2];if(!n)return Za(a,s);var o;switch(r){case"P":o=s.dateTime({width:"short"});break;case"PP":o=s.dateTime({width:"medium"});break;case"PPP":o=s.dateTime({width:"long"});break;default:o=s.dateTime({width:"full"});break}return o.replace("{{date}}",Za(r,s)).replace("{{time}}",Ci(n,s))},il={p:Ci,P:sl},rl=["D","DD"],nl=["YY","YYYY"];function ol(t){return rl.indexOf(t)!==-1}function ll(t){return nl.indexOf(t)!==-1}function qa(t,a,s){if(t==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(a,"`) for formatting years to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(a,"`) for formatting years to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(a,"`) for formatting days of the month to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(a,"`) for formatting days of the month to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var cl={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},dl=function(a,s,i){var r,n=cl[a];return typeof n=="string"?r=n:s===1?r=n.one:r=n.other.replace("{{count}}",s.toString()),i!=null&&i.addSuffix?i.comparison&&i.comparison>0?"in "+r:r+" ago":r};function Zt(t){return function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=a.width?String(a.width):t.defaultWidth,i=t.formats[s]||t.formats[t.defaultWidth];return i}}var ml={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},ul={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},hl={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},pl={date:Zt({formats:ml,defaultWidth:"full"}),time:Zt({formats:ul,defaultWidth:"full"}),dateTime:Zt({formats:hl,defaultWidth:"full"})},gl={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},xl=function(a,s,i,r){return gl[a]};function Ge(t){return function(a,s){var i=s!=null&&s.context?String(s.context):"standalone",r;if(i==="formatting"&&t.formattingValues){var n=t.defaultFormattingWidth||t.defaultWidth,o=s!=null&&s.width?String(s.width):n;r=t.formattingValues[o]||t.formattingValues[n]}else{var c=t.defaultWidth,l=s!=null&&s.width?String(s.width):t.defaultWidth;r=t.values[l]||t.values[c]}var d=t.argumentCallback?t.argumentCallback(a):a;return r[d]}}var bl={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},fl={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},yl={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},vl={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},wl={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},jl={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Nl=function(a,s){var i=Number(a),r=i%100;if(r>20||r<10)switch(r%10){case 1:return i+"st";case 2:return i+"nd";case 3:return i+"rd"}return i+"th"},_l={ordinalNumber:Nl,era:Ge({values:bl,defaultWidth:"wide"}),quarter:Ge({values:fl,defaultWidth:"wide",argumentCallback:function(a){return a-1}}),month:Ge({values:yl,defaultWidth:"wide"}),day:Ge({values:vl,defaultWidth:"wide"}),dayPeriod:Ge({values:wl,defaultWidth:"wide",formattingValues:jl,defaultFormattingWidth:"wide"})};function Ue(t){return function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=s.width,r=i&&t.matchPatterns[i]||t.matchPatterns[t.defaultMatchWidth],n=a.match(r);if(!n)return null;var o=n[0],c=i&&t.parsePatterns[i]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(c)?Cl(c,function(m){return m.test(o)}):kl(c,function(m){return m.test(o)}),d;d=t.valueCallback?t.valueCallback(l):l,d=s.valueCallback?s.valueCallback(d):d;var u=a.slice(o.length);return{value:d,rest:u}}}function kl(t,a){for(var s in t)if(t.hasOwnProperty(s)&&a(t[s]))return s}function Cl(t,a){for(var s=0;s<t.length;s++)if(a(t[s]))return s}function Sl(t){return function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=a.match(t.matchPattern);if(!i)return null;var r=i[0],n=a.match(t.parsePattern);if(!n)return null;var o=t.valueCallback?t.valueCallback(n[0]):n[0];o=s.valueCallback?s.valueCallback(o):o;var c=a.slice(r.length);return{value:o,rest:c}}}var Tl=/^(\d+)(th|st|nd|rd)?/i,Ml=/\d+/i,Rl={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Pl={any:[/^b/i,/^(a|c)/i]},Dl={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Al={any:[/1/i,/2/i,/3/i,/4/i]},Il={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Ll={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},El={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Wl={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Hl={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Vl={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Ol={ordinalNumber:Sl({matchPattern:Tl,parsePattern:Ml,valueCallback:function(a){return parseInt(a,10)}}),era:Ue({matchPatterns:Rl,defaultMatchWidth:"wide",parsePatterns:Pl,defaultParseWidth:"any"}),quarter:Ue({matchPatterns:Dl,defaultMatchWidth:"wide",parsePatterns:Al,defaultParseWidth:"any",valueCallback:function(a){return a+1}}),month:Ue({matchPatterns:Il,defaultMatchWidth:"wide",parsePatterns:Ll,defaultParseWidth:"any"}),day:Ue({matchPatterns:El,defaultMatchWidth:"wide",parsePatterns:Wl,defaultParseWidth:"any"}),dayPeriod:Ue({matchPatterns:Hl,defaultMatchWidth:"any",parsePatterns:Vl,defaultParseWidth:"any"})},Bl={code:"en-US",formatDistance:dl,formatLong:pl,formatRelative:xl,localize:_l,match:Ol,options:{weekStartsOn:0,firstWeekContainsDate:1}},Fl=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,$l=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,zl=/^'([^]*?)'?$/,Gl=/''/g,Ul=/[a-zA-Z]/;function Yl(t,a,s){var i,r,n,o,c,l,d,u,m,h,p,b,y,w;Y(2,arguments);var v=String(a),_=zt(),f=(i=(r=void 0)!==null&&r!==void 0?r:_.locale)!==null&&i!==void 0?i:Bl,j=we((n=(o=(c=(l=void 0)!==null&&l!==void 0?l:void 0)!==null&&c!==void 0?c:_.firstWeekContainsDate)!==null&&o!==void 0?o:(d=_.locale)===null||d===void 0||(u=d.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&n!==void 0?n:1);if(!(j>=1&&j<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var N=we((m=(h=(p=(b=void 0)!==null&&b!==void 0?b:void 0)!==null&&p!==void 0?p:_.weekStartsOn)!==null&&h!==void 0?h:(y=_.locale)===null||y===void 0||(w=y.options)===null||w===void 0?void 0:w.weekStartsOn)!==null&&m!==void 0?m:0);if(!(N>=0&&N<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!f.localize)throw new RangeError("locale must contain localize property");if(!f.formatLong)throw new RangeError("locale must contain formatLong property");var S=me(t);if(!Uo(S))throw new RangeError("Invalid time value");var R=zo(S),L=Yo(S,R),I={firstWeekContainsDate:j,weekStartsOn:N,locale:f,_originalDate:S},T=v.match($l).map(function(C){var P=C[0];if(P==="p"||P==="P"){var E=il[P];return E(C,f.formatLong)}return C}).join("").match(Fl).map(function(C){if(C==="''")return"'";var P=C[0];if(P==="'")return Zl(C);var E=al[P];if(E)return ll(C)&&qa(C,a,String(t)),ol(C)&&qa(C,a,String(t)),E(L,C,f.localize,I);if(P.match(Ul))throw new RangeError("Format string contains an unescaped latin alphabet character `"+P+"`");return C}).join("");return T}function Zl(t){var a=t.match(zl);return a?a[1].replace(Gl,"'"):t}function ql(t,a){var s;Y(1,arguments);var i=we((s=void 0)!==null&&s!==void 0?s:2);if(i!==2&&i!==1&&i!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof t=="string"||Object.prototype.toString.call(t)==="[object String]"))return new Date(NaN);var r=Jl(t),n;if(r.date){var o=ec(r.date,i);n=tc(o.restDateString,o.year)}if(!n||isNaN(n.getTime()))return new Date(NaN);var c=n.getTime(),l=0,d;if(r.time&&(l=ac(r.time),isNaN(l)))return new Date(NaN);if(r.timezone){if(d=sc(r.timezone),isNaN(d))return new Date(NaN)}else{var u=new Date(c+l),m=new Date(0);return m.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),m.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),m}return new Date(c+l+d)}var gt={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Kl=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Xl=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Ql=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Jl(t){var a={},s=t.split(gt.dateTimeDelimiter),i;if(s.length>2)return a;if(/:/.test(s[0])?i=s[0]:(a.date=s[0],i=s[1],gt.timeZoneDelimiter.test(a.date)&&(a.date=t.split(gt.timeZoneDelimiter)[0],i=t.substr(a.date.length,t.length))),i){var r=gt.timezone.exec(i);r?(a.time=i.replace(r[1],""),a.timezone=r[1]):a.time=i}return a}function ec(t,a){var s=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+a)+"})|(\\d{2}|[+-]\\d{"+(2+a)+"})$)"),i=t.match(s);if(!i)return{year:NaN,restDateString:""};var r=i[1]?parseInt(i[1]):null,n=i[2]?parseInt(i[2]):null;return{year:n===null?r:n*100,restDateString:t.slice((i[1]||i[2]).length)}}function tc(t,a){if(a===null)return new Date(NaN);var s=t.match(Kl);if(!s)return new Date(NaN);var i=!!s[4],r=Ye(s[1]),n=Ye(s[2])-1,o=Ye(s[3]),c=Ye(s[4]),l=Ye(s[5])-1;if(i)return lc(a,c,l)?ic(a,c,l):new Date(NaN);var d=new Date(0);return!nc(a,n,o)||!oc(a,r)?new Date(NaN):(d.setUTCFullYear(a,n,Math.max(r,o)),d)}function Ye(t){return t?parseInt(t):1}function ac(t){var a=t.match(Xl);if(!a)return NaN;var s=qt(a[1]),i=qt(a[2]),r=qt(a[3]);return cc(s,i,r)?s*Ni+i*ji+r*1e3:NaN}function qt(t){return t&&parseFloat(t.replace(",","."))||0}function sc(t){if(t==="Z")return 0;var a=t.match(Ql);if(!a)return 0;var s=a[1]==="+"?-1:1,i=parseInt(a[2]),r=a[3]&&parseInt(a[3])||0;return dc(i,r)?s*(i*Ni+r*ji):NaN}function ic(t,a,s){var i=new Date(0);i.setUTCFullYear(t,0,4);var r=i.getUTCDay()||7,n=(a-1)*7+s+1-r;return i.setUTCDate(i.getUTCDate()+n),i}var rc=[31,null,31,30,31,30,31,31,30,31,30,31];function Si(t){return t%400===0||t%4===0&&t%100!==0}function nc(t,a,s){return a>=0&&a<=11&&s>=1&&s<=(rc[a]||(Si(t)?29:28))}function oc(t,a){return a>=1&&a<=(Si(t)?366:365)}function lc(t,a,s){return a>=1&&a<=53&&s>=0&&s<=6}function cc(t,a,s){return t===24?a===0&&s===0:s>=0&&s<60&&a>=0&&a<60&&t>=0&&t<25}function dc(t,a){return a>=0&&a<=59}function Ca(t,a="MMM d, yyyy"){const s=typeof t=="string"?ql(t):t;return Yl(s,a)}function Ti(t){return Ca(t,"MMM d")}const mc=({active:t,payload:a,valueFormatter:s})=>{if(!t||!a||!a.length)return null;const i=a[0].payload,r=i.value;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-lg p-3 text-sm",children:[e.jsx("p",{className:"font-medium text-gray-900",children:s?s(r):r}),e.jsx("p",{className:"text-gray-500",children:Ca(i.date)}),i.event&&e.jsx("p",{className:"text-xs text-amber-600 mt-1",children:i.event})]})},uc=g.forwardRef(({className:t,data:a,height:s=200,color:i="#6366f1",showGrid:r=!0,showDots:n=!1,showArea:o=!1,showEvents:c=!0,referenceValue:l,referenceLabel:d,yAxisDomain:u=["auto","auto"],valueFormatter:m,dateFormatter:h=Ti,...p},b)=>{const y=g.useMemo(()=>a.map(_=>({..._,hasEvent:c&&!!_.event})),[a,c]),w=g.useMemo(()=>{const _=a.map(S=>S.value).filter(S=>!isNaN(S)),f=Math.min(..._),j=Math.max(..._),N=(j-f)*.1;return[u[0]==="auto"?Math.floor(f-N):u[0],u[1]==="auto"?Math.ceil(j+N):u[1]]},[a,u]),v=o?hr:ua;return e.jsx("div",{ref:b,className:x("w-full",t),...p,children:e.jsx(nt,{width:"100%",height:s,children:e.jsxs(v,{data:y,margin:{top:10,right:10,left:-20,bottom:0},children:[r&&e.jsx(Et,{strokeDasharray:"3 3",stroke:"#e5e7eb",vertical:!1}),e.jsx(Wt,{dataKey:"date",tickFormatter:h,stroke:"#9ca3af",fontSize:12,tickLine:!1,axisLine:{stroke:"#e5e7eb"}}),e.jsx(Ht,{domain:w,stroke:"#9ca3af",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:m}),e.jsx(Vt,{content:e.jsx(mc,{valueFormatter:m})}),l!==void 0&&e.jsx(Ve,{y:l,stroke:"#f59e0b",strokeDasharray:"4 4",label:{value:d||`Target: ${l}`,position:"right",fill:"#f59e0b",fontSize:11}}),o&&e.jsx(Pe,{type:"monotone",dataKey:"value",fill:i,fillOpacity:.1,stroke:"none"}),e.jsx(ha,{type:"monotone",dataKey:"value",stroke:i,strokeWidth:2,dot:n?{fill:i,r:3}:!1,activeDot:{fill:i,r:5,strokeWidth:2,stroke:"#fff"}}),c&&y.filter(_=>_.hasEvent).map((_,f)=>e.jsx(Ve,{x:_.date,stroke:"#f59e0b",strokeDasharray:"2 2",strokeOpacity:.5},f))]})})})});uc.displayName="MetricChart";const hc=g.forwardRef(({className:t,data:a,color:s="#6366f1",height:i=40,showRange:r=!1,...n},o)=>{const c=g.useMemo(()=>a.map((u,m)=>({index:m,value:u})),[a]),l=Math.min(...a),d=Math.max(...a);return e.jsxs("div",{ref:o,className:x("w-full",t),...n,children:[e.jsx(nt,{width:"100%",height:i,children:e.jsx(ua,{data:c,margin:{top:2,right:2,left:2,bottom:2},children:e.jsx(ha,{type:"monotone",dataKey:"value",stroke:s,strokeWidth:1.5,dot:!1})})}),r&&e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[e.jsx("span",{children:l}),e.jsx("span",{children:d})]})]})});hc.displayName="Sparkline";const pc=g.forwardRef(({className:t,data:a,metrics:s,height:i=250,...r},n)=>e.jsxs("div",{ref:n,className:x("w-full",t),...r,children:[e.jsx(nt,{width:"100%",height:i,children:e.jsxs(ua,{data:a,margin:{top:10,right:10,left:-20,bottom:0},children:[e.jsx(Et,{strokeDasharray:"3 3",stroke:"#e5e7eb",vertical:!1}),e.jsx(Wt,{dataKey:"date",tickFormatter:Ti,stroke:"#9ca3af",fontSize:12,tickLine:!1,axisLine:{stroke:"#e5e7eb"}}),e.jsx(Ht,{stroke:"#9ca3af",fontSize:12,tickLine:!1,axisLine:!1}),e.jsx(Vt,{content:({active:o,payload:c})=>!o||!c?null:e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:Ca(c[0]?.payload?.date)}),c.map(l=>{const d=s.find(u=>u.key===l.dataKey);return e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:l.color}}),e.jsxs("span",{className:"text-gray-600",children:[d?.label,":"]}),e.jsx("span",{className:"font-medium",children:l.value})]},l.dataKey)})]})}),s.map(o=>e.jsx(ha,{type:"monotone",dataKey:o.key,stroke:o.color,strokeWidth:2,dot:!1,activeDot:{r:4,strokeWidth:2,stroke:"#fff"}},o.key))]})}),e.jsx("div",{className:"flex justify-center gap-6 mt-4",children:s.map(o=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:o.color}}),e.jsx("span",{className:"text-gray-600",children:o.label})]},o.key))})]}));pc.displayName="MultiMetricChart";const Sa=t=>t>1?t:t*100,gc=t=>{const a=Sa(t);return a>=85?{label:"Very High",color:"green",description:"Strong personal evidence"}:a>=70?{label:"High",color:"primary",description:"Good personal evidence"}:a>=50?{label:"Moderate",color:"blue",description:"Mixed evidence"}:a>=30?{label:"Low",color:"amber",description:"Limited personal data"}:{label:"Exploratory",color:"gray",description:"Based mostly on population data"}},xc={green:{bg:"bg-green-500",text:"text-green-600",light:"bg-green-100",ring:"ring-green-500"},primary:{bg:"bg-primary-500",text:"text-primary-600",light:"bg-primary-100",ring:"ring-primary-500"},blue:{bg:"bg-blue-500",text:"text-blue-600",light:"bg-blue-100",ring:"ring-blue-500"},amber:{bg:"bg-amber-500",text:"text-amber-600",light:"bg-amber-100",ring:"ring-amber-500"},gray:{bg:"bg-gray-400",text:"text-gray-600",light:"bg-gray-100",ring:"ring-gray-400"}},bc={sm:{bar:"h-1.5",text:"text-xs",ring:32,stroke:3},md:{bar:"h-2",text:"text-sm",ring:48,stroke:4},lg:{bar:"h-3",text:"text-base",ring:64,stroke:5}},fc=g.forwardRef(({className:t,value:a,size:s="md",showLabel:i=!0,showTooltip:r=!0,animated:n=!0,variant:o="bar",...c},l)=>{const d=Sa(a),u=gc(d),m=xc[u.color],h=bc[s],p=Zs(d,{duration:n?500:0});if(o==="badge")return e.jsxs("div",{ref:l,className:x("inline-flex items-center gap-1.5",t),...c,children:[e.jsxs("span",{className:x("inline-flex items-center px-2 py-0.5 rounded-full font-medium",m.light,m.text,h.text),children:[Math.round(d),"%",i&&e.jsx("span",{className:"ml-1 opacity-75",children:u.label})]}),r&&e.jsx(jt,{content:u.description})]});if(o==="ring"){const b=h.ring,y=(b-h.stroke*2)/2,w=2*Math.PI*y,v=w-p/100*w;return e.jsxs("div",{ref:l,className:x("relative inline-flex",t),...c,children:[e.jsxs("svg",{width:b,height:b,className:"-rotate-90",children:[e.jsx("circle",{cx:b/2,cy:b/2,r:y,fill:"none",strokeWidth:h.stroke,className:"stroke-gray-200"}),e.jsx(M.circle,{cx:b/2,cy:b/2,r:y,fill:"none",strokeWidth:h.stroke,strokeLinecap:"round",className:m.ring.replace("ring-","stroke-"),initial:{strokeDashoffset:w},animate:{strokeDashoffset:v},transition:{duration:n?.5:0},style:{strokeDasharray:w}})]}),e.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:e.jsxs("span",{className:x("font-bold",m.text,h.text),children:[Math.round(p),"%"]})}),r&&e.jsx("div",{className:"absolute -top-1 -right-1",children:e.jsx(jt,{content:`${u.label}: ${u.description}`,iconSize:12})})]})}if(o==="arc"){const b=h.ring*1.5,y=b/2-h.stroke,w=-135,v=135,_=v-w,f=w+p/100*_,j=T=>{const C=T*Math.PI/180;return{x:b/2+y*Math.cos(C),y:b/2+y*Math.sin(C)}},N=j(w),S=j(v),R=j(f),L=`M ${N.x} ${N.y} A ${y} ${y} 0 1 1 ${S.x} ${S.y}`,I=`M ${N.x} ${N.y} A ${y} ${y} 0 ${p>50?1:0} 1 ${R.x} ${R.y}`;return e.jsxs("div",{ref:l,className:x("relative inline-flex flex-col items-center",t),...c,children:[e.jsxs("svg",{width:b,height:b*.7,children:[e.jsx("path",{d:L,fill:"none",strokeWidth:h.stroke,strokeLinecap:"round",className:"stroke-gray-200"}),e.jsx(M.path,{d:I,fill:"none",strokeWidth:h.stroke,strokeLinecap:"round",className:m.ring.replace("ring-","stroke-"),initial:{pathLength:0},animate:{pathLength:1},transition:{duration:n?.5:0}})]}),e.jsxs("div",{className:"absolute bottom-0 flex flex-col items-center",children:[e.jsxs("span",{className:x("font-bold",m.text,s==="lg"?"text-xl":"text-lg"),children:[Math.round(p),"%"]}),i&&e.jsx("span",{className:"text-xs text-gray-500",children:u.label})]})]})}return e.jsxs("div",{ref:l,className:x("w-full",t),...c,children:[i&&e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("span",{className:x("font-medium",m.text,h.text),children:[Math.round(d),"% ",u.label]}),r&&e.jsx(jt,{content:u.description})]}),e.jsx("div",{className:x("w-full rounded-full bg-gray-200 overflow-hidden",h.bar),children:e.jsx(M.div,{className:x("h-full rounded-full",m.bg),initial:{width:0},animate:{width:`${p}%`},transition:{duration:n?.5:0}})})]})});fc.displayName="CertaintyIndicator";const yc=g.forwardRef(({className:t,personalWeight:a,showLabels:s=!0,animated:i=!0,...r},n)=>{const o=Sa(a),c=Zs(o,{duration:i?500:0});return e.jsxs("div",{ref:n,className:x("w-full",t),"data-tour":"evidence-weight",...r,children:[s&&e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[e.jsxs("span",{children:["Your Data (",Math.round(c),"%)"]}),e.jsxs("span",{children:["Population (",Math.round(100-c),"%)"]})]}),e.jsxs("div",{className:"h-2 rounded-full bg-gray-200 overflow-hidden flex",children:[e.jsx(M.div,{className:"h-full bg-primary-500",initial:{width:0},animate:{width:`${c}%`},transition:{duration:i?.5:0}}),e.jsx("div",{className:"h-full bg-gray-300 flex-1"})]}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{className:"text-primary-600 font-medium",children:"Personal evidence"}),e.jsx("span",{className:"text-gray-500",children:"Population prior"})]})]})});yc.displayName="EvidenceWeight";function vc(t){const a={sleep_efficiency_pct:"Sleep Efficiency (%)",deep_sleep_min:"Deep Sleep (min)",resting_hr:"Resting HR (bpm)",resting_hr_7d_mean:"Resting HR 7d (bpm)",hrv_daily_mean:"HRV (ms)",hrv_7d_mean:"HRV 7d (ms)",nlr:"NLR",hscrp_smoothed:"hsCRP (mg/L)",cortisol_smoothed:"Cortisol",vo2_peak_smoothed:"VO2 Peak",iron_total_smoothed:"Iron"};return a[t]?a[t]:t.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase()).replace(/ Pct$/," (%)").replace(/ Min$/," (min)").replace(/ Hrs?$/," (hr)")}function wc(t){const a={travel_load:"Jet Lag Score",acwr:"ACWR",sleep_duration_hrs:"Sleep Duration (hr)",omega3_index_derived:"Omega-3 Index (%)",last_workout_end_hour:"Last Workout Hour",bedtime_hour:"Bedtime Hour",caffeine_mg:"Caffeine (mg)",training_load_7d:"Training Load 7d",alcohol_units:"Alcohol (units)"};return a[t]?a[t]:t.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase()).replace(/ Pct$/," (%)").replace(/ Hrs?$/," (hr)")}const jc={plateau_up:{name:"Saturating Benefit",shortName:"SAT-BEN",geometry:"Concave Ascending → Plateau",curvature:"concave",symmetry:"right-asymmetric",interpretation:"Benefits increase up to a threshold, then level off. More is not better past θ.",thresholdMeaning:"Point of diminishing returns - you've captured most of the benefit",recommendation:"Aim to reach θ, but don't stress about exceeding it",riskProfile:"safe",icon:"📈→",color:"#10B981",fill:"rgba(16, 185, 129, 0.15)"},plateau_down:{name:"Threshold Decay",shortName:"THR-DEC",geometry:"Plateau → Convex Descending",curvature:"convex",symmetry:"left-asymmetric",interpretation:"Outcome is stable until threshold, then declines rapidly. Stay below θ.",thresholdMeaning:"Critical tipping point - exceeding this triggers negative effects",recommendation:"Stay below θ with safety margin",riskProfile:"caution",icon:"→📉",color:"#EF4444",fill:"rgba(239, 68, 68, 0.15)"},v_min:{name:"Optimal Minimum",shortName:"OPT-MIN",geometry:"Convex Parabola (U-Shape)",curvature:"parabolic",symmetry:"symmetric",interpretation:`Both too little and too much are harmful. There's a "sweet spot" at θ.`,thresholdMeaning:"Goldilocks point - the optimal balance between extremes",recommendation:"Target θ precisely; deviation in either direction hurts",riskProfile:"optimize",icon:"∪",color:"#06B6D4",fill:"rgba(6, 182, 212, 0.15)"},v_max:{name:"Optimal Peak",shortName:"OPT-PK",geometry:"Concave Parabola (Inverted U)",curvature:"parabolic",symmetry:"symmetric",interpretation:"Maximum benefit at θ, with diminishing returns on either side.",thresholdMeaning:"Peak performance point - this is where you want to be",recommendation:"Aim for θ; both under and over are suboptimal",riskProfile:"optimize",icon:"∩",color:"#8B5CF6",fill:"rgba(139, 92, 246, 0.15)"},linear:{name:"Linear Dose-Response",shortName:"LIN-DR",geometry:"Linear Monotonic",curvature:"linear",symmetry:"symmetric",interpretation:"Effect scales proportionally with dose. No threshold effects.",thresholdMeaning:"Reference point only - effects are continuous across the range",recommendation:"More (or less) directly translates to proportional change",riskProfile:"safe",icon:"↗",color:"#6B7280",fill:"rgba(107, 114, 128, 0.15)"}};function Nc(t,a){return!a||a==="at_optimal"?{label:"At Optimal",severity:"good",advice:"Maintain current behavior"}:t==="plateau_up"?a==="below_optimal"?{label:"Below Saturation",severity:"moderate",advice:"Room to increase for more benefit"}:{label:"Above Saturation",severity:"good",advice:"At or past full benefit - no action needed"}:t==="plateau_down"?a==="below_optimal"?{label:"In Safe Zone",severity:"good",advice:"Well below threshold - maintain"}:{label:"Past Threshold",severity:"poor",advice:"Reduce to get back below θ"}:t==="v_min"||t==="v_max"?a==="below_optimal"?{label:"Below Optimal",severity:"moderate",advice:"Increase toward θ"}:{label:"Above Optimal",severity:"moderate",advice:"Decrease toward θ"}:a==="below_threshold"?{label:"Below θ",severity:"moderate",advice:"Below the threshold — effect differs above"}:a==="above_threshold"?{label:"Above θ",severity:"moderate",advice:"Above the threshold — effect differs below"}:{label:a==="below_optimal"?"Lower Range":"Higher Range",severity:"moderate",advice:"Adjust based on goals"}}const _c={plateau_up:{line:"#10B981",fill:"rgba(16, 185, 129, 0.1)",threshold:"#10B981"},plateau_down:{line:"#EF4444",fill:"rgba(239, 68, 68, 0.1)",threshold:"#EF4444"},v_min:{line:"#06B6D4",fill:"rgba(6, 182, 212, 0.1)",threshold:"#06B6D4"},v_max:{line:"#8B5CF6",fill:"rgba(139, 92, 246, 0.1)",threshold:"#8B5CF6"},linear:{line:"#6B7280",fill:"rgba(107, 114, 128, 0.1)",threshold:"#6B7280"}};function kc(t,a,s,i,r,n){const o=a-i*2,c=s-i*2,l=i,d=s-i,u=a-i,m=i,h=a/2;switch(t){case"plateau_up":return`M ${l} ${d}
              Q ${l+o*.3} ${d-c*.3} ${h} ${d-c*.8}
              L ${u} ${d-c*.8}`;case"plateau_down":return`M ${l} ${m+c*.2}
              L ${h} ${m+c*.2}
              Q ${h+o*.2} ${m+c*.3} ${u} ${d}`;case"v_min":return`M ${l} ${m+c*.2}
              Q ${l+o*.25} ${d-c*.1} ${h} ${d-c*.15}
              Q ${h+o*.25} ${d-c*.1} ${u} ${m+c*.2}`;case"v_max":return`M ${l} ${d-c*.2}
              Q ${l+o*.25} ${m+c*.1} ${h} ${m+c*.15}
              Q ${h+o*.25} ${m+c*.1} ${u} ${d-c*.2}`;default:{const p=r!==void 0&&n!==void 0?(r+n)/2:void 0;return p!==void 0&&p<0?`M ${l} ${m} L ${u} ${d}`:`M ${l} ${d} L ${u} ${m}`}}}function Ka(t,a,s,i,r,n){const o=s-i*2,c=s-i,l=i;switch(t){case"plateau_up":return a<.5?c-a*2*o*.8:c-o*.8;case"plateau_down":return a<.5?l+o*.2:l+o*.2+(a-.5)*2*o*.6;case"v_min":{const d=Math.abs(a-.5)*2;return c-o*.15-d*o*.65}case"v_max":{const d=Math.abs(a-.5)*2;return l+o*.15+d*o*.65}default:{const d=r!==void 0&&n!==void 0?(r+n)/2:void 0;return d!==void 0&&d<0?l+a*o:c-a*o}}}function Cc({params:t,width:a=280,height:s=200,showLabels:i=!0,showCurrentValue:r=!0,compact:n=!1,className:o}){const[c,l]=g.useState(!1),[d,u]=g.useState({x:0,y:0}),m=n?0:14,h=n?0:22,p=typeof a=="number"?a:340,b=s,y=n?15:24,w=p+m,v=b+h,_=$e=>{u({x:$e.clientX,y:$e.clientY})},f=240,j=200,N=12,S=typeof window<"u"&&d.x+N+f>window.innerWidth?d.x-f-N:d.x+N,R=typeof window<"u"&&d.y+N+j>window.innerHeight?d.y-j-N:d.y+N,L=_c[t.curveType],I=jc[t.curveType],T=Nc(t.curveType,t.currentStatus),C=vc(t.target),P=wc(t.source),E=t.betaBelow.value,H=t.betaAbove.value,ae=.5,ge=y+(p-y*2)*ae,mt=Ka(t.curveType,ae,b,y,E,H),ut=g.useMemo(()=>{if(t.currentValue===void 0)return null;const $e=t.theta.value,Da=$e*.6,Qi=(t.currentValue-($e-Da))/(Da*2);return Math.max(.05,Math.min(.95,Qi))},[t.currentValue,t.theta.value]),Ce=ut!==null?y+(p-y*2)*ut:null,ht=ut!==null?Ka(t.curveType,ut,b,y,E,H):null,Ra=kc(t.curveType,p,b,y,E,H),Pa={safe:{bg:"bg-emerald-500",text:"text-emerald-100"},caution:{bg:"bg-amber-500",text:"text-amber-100"},risk:{bg:"bg-rose-500",text:"text-rose-100"},optimize:{bg:"bg-violet-500",text:"text-violet-100"}},Xi={good:"text-emerald-400",moderate:"text-amber-400",poor:"text-rose-400"};return e.jsxs("div",{className:`relative ${o||""}`,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),onMouseMove:_,children:[e.jsxs("svg",{width:a==="100%"?"100%":w,height:v,viewBox:`0 0 ${w} ${v}`,preserveAspectRatio:"xMidYMid meet",className:"overflow-visible cursor-help",children:[e.jsx("defs",{children:e.jsx("pattern",{id:`grid-${t.source}`,width:"20",height:"20",patternUnits:"userSpaceOnUse",children:e.jsx("path",{d:"M 20 0 L 0 0 0 20",fill:"none",stroke:"#E5E7EB",strokeWidth:"0.5"})})}),i&&!n&&e.jsx("text",{x:10,y:b/2,textAnchor:"middle",dominantBaseline:"central",transform:`rotate(-90, 10, ${b/2})`,className:"fill-slate-500",style:{fontSize:"10px",fontWeight:600},children:C}),i&&!n&&e.jsx("text",{x:m+p/2,y:v-3,textAnchor:"middle",className:"fill-slate-500",style:{fontSize:"10px",fontWeight:600},children:P}),e.jsxs("g",{transform:`translate(${m}, 0)`,children:[e.jsx("rect",{x:y,y,width:p-y*2,height:b-y*2,fill:`url(#grid-${t.source})`}),e.jsx("line",{x1:y,y1:b-y,x2:p-y,y2:b-y,stroke:"#D1D5DB",strokeWidth:"1"}),e.jsx("line",{x1:y,y1:y,x2:y,y2:b-y,stroke:"#D1D5DB",strokeWidth:"1"}),e.jsx("path",{d:`${Ra} L ${p-y} ${b-y} L ${y} ${b-y} Z`,fill:L.fill}),e.jsx("path",{d:Ra,fill:"none",stroke:L.line,strokeWidth:"3",strokeLinecap:"round"}),t.curveType!=="linear"&&e.jsx("line",{x1:ge,y1:y,x2:ge,y2:b-y,stroke:L.threshold,strokeWidth:"1.5",strokeDasharray:"4 2"}),t.curveType!=="linear"&&e.jsxs(e.Fragment,{children:[e.jsx("circle",{cx:ge,cy:mt,r:"7",fill:L.threshold}),e.jsx("circle",{cx:ge,cy:mt,r:"3.5",fill:"white"})]}),!n&&t.curveType!=="linear"&&e.jsx("rect",{x:ge-15,y:b-y+5,width:30,height:4,rx:2,fill:L.threshold,opacity:.3}),r&&Ce!==null&&ht!==null&&e.jsxs(e.Fragment,{children:[e.jsx("line",{x1:Ce,y1:ht,x2:Ce,y2:b-y,stroke:"#F59E0B",strokeWidth:"1",strokeDasharray:"2 2"}),e.jsx("circle",{cx:Ce,cy:ht,r:"5",fill:"#F59E0B"}),e.jsx("circle",{cx:Ce,cy:ht,r:"2",fill:"white"})]}),i&&!n&&Ce!==null&&e.jsxs("text",{x:Ce,y:y-5,textAnchor:"middle",className:"fill-amber-600",style:{fontSize:"10px",fontWeight:700},children:["You: ",t.currentValue]}),i&&!n&&t.curveType!=="linear"&&e.jsxs("text",{x:ge,y:b-4,textAnchor:"middle",className:"fill-gray-600",style:{fontSize:"10px",fontWeight:700},children:["θ=",t.theta.displayValue]})]})]}),c&&!n&&e.jsxs("div",{className:"fixed z-[9999] bg-black text-white text-left border pointer-events-none shadow-lg",style:{left:S,top:R,width:f,maxHeight:j,borderColor:I.color},children:[e.jsxs("div",{className:"px-2 py-1 flex items-center justify-between",style:{backgroundColor:I.color},children:[e.jsxs("span",{className:"text-[11px] font-black uppercase tracking-tight truncate",children:[I.icon," ",I.name]}),e.jsx("span",{className:"text-[9px] font-mono opacity-80 ml-1 flex-shrink-0",children:I.shortName})]}),e.jsxs("div",{className:"p-2.5 space-y-2",children:[e.jsxs("div",{className:"text-[10px] text-gray-400",children:[e.jsx("span",{className:"capitalize",children:I.curvature}),e.jsx("span",{className:"mx-1",children:"·"}),e.jsx("span",{children:I.geometry})]}),e.jsx("p",{className:"text-[11px] text-gray-300 leading-relaxed",children:I.interpretation}),t.curveType!=="linear"&&e.jsxs("div",{className:"text-[10px] text-gray-400 pt-1 border-t border-white/10",children:[e.jsx("span",{className:"text-gray-500 uppercase tracking-wider text-[9px]",children:"At θ:"}),e.jsx("span",{className:"ml-1",children:I.thresholdMeaning})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-mono pt-1 border-t border-white/20",children:[t.curveType!=="linear"&&e.jsxs("span",{className:"text-white font-bold",children:["θ=",t.theta.displayValue]}),e.jsxs("span",{className:"text-gray-500",children:["n=",t.observations]}),e.jsx("span",{className:`ml-auto px-1 py-0.5 text-[9px] font-bold uppercase ${Pa[I.riskProfile].bg} ${Pa[I.riskProfile].text}`,children:I.riskProfile})]}),t.currentStatus&&e.jsxs("div",{className:"flex items-center gap-1 text-[10px]",children:[e.jsx("span",{className:`font-bold ${Xi[T.severity]}`,children:T.label}),t.currentValue!==void 0&&e.jsxs("span",{className:"text-gray-500",children:["(",t.currentValue,")"]})]})]})]})]})}function Sc({params:t,variant:a="full"}){const s=t.curveType==="v_min"||t.curveType==="v_max";if(a==="compact")return e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsxs("span",{className:"font-mono font-bold text-black",children:["θ=",t.theta.displayValue]}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsxs("span",{className:`font-mono font-bold ${t.betaAbove.value<0?"text-rose-600":"text-emerald-600"}`,children:["β=",t.betaAbove.description]})]});if(t.curveType==="linear"){const r=Math.abs(t.betaAbove.value)>=Math.abs(t.betaBelow.value)?t.betaAbove:t.betaBelow;return e.jsxs("div",{className:"p-3 border bg-slate-50 border-slate-200 rounded",children:[e.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Slope"}),e.jsx("div",{className:`font-mono font-black text-lg ${r.value>0?"text-emerald-600":"text-rose-600"}`,children:r.description})]})}return e.jsxs("div",{className:"grid grid-cols-2 gap-0",children:[e.jsxs("div",{className:`p-3 border border-r-0 ${s?"bg-sky-50 border-sky-200":"bg-emerald-50 border-emerald-200"}`,children:[e.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Below θ"}),e.jsx("div",{className:`font-mono font-black text-lg ${t.betaBelow.value>0?"text-emerald-600":"text-rose-600"}`,children:t.betaBelow.description})]}),e.jsxs("div",{className:`p-3 border ${s?"bg-violet-50 border-violet-200":"bg-rose-50 border-rose-200"}`,children:[e.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Above θ"}),e.jsx("div",{className:`font-mono font-black text-lg ${t.betaAbove.value>0?"text-emerald-600":"text-rose-600"}`,children:t.betaAbove.description})]})]})}const Xa=[{id:"apple-watch",label:"Apple Watch",sublabel:"HR, HRV, Steps, SpO2, Activity",color:"#10B981",type:"continuous",startDate:"2019-06-25",endDate:"2026-02-07",dataPointCount:2400},{id:"apple-sleep",label:"Apple Health Sleep",sublabel:"Core, Deep, REM Stages",color:"#34D399",type:"continuous",startDate:"2021-01-01",endDate:"2026-02-07",dataPointCount:1850},{id:"autosleep",label:"AutoSleep",sublabel:"Quality, Deep, Efficiency, HRV",color:"#3B82F6",type:"continuous",startDate:"2019-12-11",endDate:"2023-05-24",dataPointCount:1181},{id:"gpx",label:"GPX Workouts",sublabel:"TRIMP, Distance, Zones, Elevation",color:"#F59E0B",type:"density",startDate:"2016-10-09",endDate:"2026-01-31",dataPointCount:679,monthlyDensity:Tc()},{id:"labs",label:"Lab Draws",sublabel:"Iron, Lipids, Hormones, CBC",color:"#8B5CF6",type:"sparse",startDate:"2023-03-10",endDate:"2025-11-22",episodicDates:["2023-03-10","2023-11-01","2024-05-31","2024-11-13","2025-03-15","2025-11-22"],dataPointCount:6},{id:"cpet",label:"CPET",sublabel:"VO2peak, VT1, VT2",color:"#EC4899",type:"sparse",startDate:"2025-12-03",endDate:"2025-12-10",episodicDates:["2025-12-03"],dataPointCount:1},{id:"nutrition",label:"Nutrition",sublabel:"kcal, Protein, Carbs, Fat",color:"#94A3B8",type:"sparse",startDate:"2024-01-15",endDate:"2025-05-20",episodicDates:Mc(),dataPointCount:33}];function Tc(){const t=[];for(let a=2016;a<=2026;a++){const s=a===2016?10:1,i=a===2026?1:12;for(let r=s;r<=i;r++){const n=`${a}-${String(r).padStart(2,"0")}`;let o=0;a===2016?o=Math.round(2+Math.random()*3):a===2017?o=Math.round(3+Math.random()*5):a===2018?o=Math.round(5+Math.random()*6):a>=2019&&a<=2022?o=Math.round(8+Math.random()*10):a===2023?o=Math.round(6+Math.random()*8):a===2024?o=Math.round(5+Math.random()*7):a===2025?o=Math.round(3+Math.random()*5):o=Math.round(1+Math.random()*2),t.push({month:n,count:o})}}return t}function Mc(){const t=[];for(let a=15;a<=24;a++)t.push(`2024-01-${String(a).padStart(2,"0")}`);for(let a=5;a<=12;a++)t.push(`2024-03-${String(a).padStart(2,"0")}`);for(let a=10;a<=16;a++)t.push(`2024-08-${String(a).padStart(2,"0")}`);for(let a=1;a<=5;a++)t.push(`2025-02-${String(a).padStart(2,"0")}`);return t.push("2024-05-12","2024-11-03","2025-05-20"),t}function he(t,a,s,i){return(new Date(t).getTime()-a)/(s-a)*i}function Qa(t){return new Date(t).toLocaleDateString("en-US",{month:"short",year:"numeric"})}const be=32,Ja=6,G=170,Ze=50,We=8,xt=28,Qe=16,Rc=15;function Pc(){const[t,a]=g.useState(null),s=g.useMemo(()=>{const l=new Date("2015-02-01").getTime(),d=new Date("2026-03-01").getTime(),u=Xa.length,m=We+u*(be+Ja)+xt,h=[];for(let y=2016;y<=2026;y++)h.push({year:y,x:he(`${y}-01-01`,l,d,1)});const p=new Date().toISOString().slice(0,10),b=he(p,l,d,1);return{timelineStart:l,timelineEnd:d,chartHeight:m,years:h,todayX:b}},[]),{timelineStart:i,timelineEnd:r,chartHeight:n,years:o,todayX:c}=s;return e.jsx("div",{className:"w-full",children:e.jsxs("svg",{viewBox:`0 0 900 ${n}`,className:"w-full",style:{minHeight:`${n}px`},children:[e.jsx("rect",{x:0,y:0,width:900,height:n,fill:"white",rx:8}),o.map(({year:l,x:d})=>{const u=G+d*(900-G-Ze);return e.jsxs("g",{children:[e.jsx("line",{x1:u,y1:We,x2:u,y2:n-xt,stroke:"#E2E8F0",strokeWidth:1}),e.jsx("text",{x:u,y:n-xt+16,textAnchor:"middle",className:"fill-slate-400",fontSize:10,fontFamily:"system-ui, sans-serif",children:l})]},l)}),e.jsx("line",{x1:G+c*(900-G-Ze),y1:We-2,x2:G+c*(900-G-Ze),y2:n-xt,stroke:"#EF4444",strokeWidth:1.5,strokeDasharray:"4 3",opacity:.7}),e.jsx("text",{x:G+c*(900-G-Ze),y:We-4,textAnchor:"middle",fontSize:8,fontWeight:600,className:"fill-red-400",fontFamily:"system-ui, sans-serif",children:"TODAY"}),Xa.map((l,d)=>{const u=We+d*(be+Ja),m=u+(be-Qe)/2,h=900-G-Ze,p=t===l.id;return e.jsxs("g",{onMouseEnter:()=>a(l.id),onMouseLeave:()=>a(null),style:{cursor:"default"},children:[p&&e.jsx("rect",{x:0,y:u-2,width:900,height:be+4,fill:"#F8FAFC",rx:4}),e.jsx("text",{x:8,y:u+be/2-4,fontSize:11,fontWeight:600,className:"fill-slate-700",fontFamily:"system-ui, sans-serif",children:l.label}),e.jsx("text",{x:8,y:u+be/2+8,fontSize:8,className:"fill-slate-400",fontFamily:"system-ui, sans-serif",children:l.sublabel}),l.type==="continuous"&&e.jsx(Dc,{stream:l,barY:m,chartW:h,timelineStart:i,timelineEnd:r}),l.type==="density"&&l.monthlyDensity&&e.jsx(Ac,{stream:l,barY:m,chartW:h,timelineStart:i,timelineEnd:r}),l.type==="sparse"&&l.episodicDates&&e.jsx(Ic,{stream:l,centerY:u+be/2,chartW:h,timelineStart:i,timelineEnd:r}),e.jsx("text",{x:892,y:u+be/2+3,textAnchor:"end",fontSize:9,fontWeight:500,className:"fill-slate-400",fontFamily:"ui-monospace, monospace",children:l.dataPointCount.toLocaleString()})]},l.id)}),e.jsx("text",{x:892,y:We-4,textAnchor:"end",fontSize:8,fontWeight:600,className:"fill-slate-300",fontFamily:"system-ui, sans-serif",letterSpacing:.5,children:"POINTS"})]})})}function Dc({stream:t,barY:a,chartW:s,timelineStart:i,timelineEnd:r}){const n=G+he(t.startDate,i,r,s),o=G+he(t.endDate,i,r,s),c=Math.max(o-n,2);return e.jsxs("g",{children:[e.jsx("rect",{x:n,y:a,width:c,height:Qe,rx:4,fill:t.color,opacity:.8}),e.jsx("text",{x:n+4,y:a+Qe/2+3,fontSize:7,fontWeight:500,fill:"white",fontFamily:"ui-monospace, monospace",opacity:c>60?.9:0,children:Qa(t.startDate)}),c>120&&e.jsx("text",{x:o-4,y:a+Qe/2+3,textAnchor:"end",fontSize:7,fontWeight:500,fill:"white",fontFamily:"ui-monospace, monospace",opacity:.9,children:Qa(t.endDate)})]})}function Ac({stream:t,barY:a,chartW:s,timelineStart:i,timelineEnd:r}){return t.monthlyDensity?e.jsx("g",{children:t.monthlyDensity.map(({month:n,count:o})=>{const c=new Date(`${n}-01`),[l,d]=n.split("-").map(Number),u=d===12?new Date(`${l+1}-01-01`):new Date(`${l}-${String(d+1).padStart(2,"0")}-01`),m=G+he(c.toISOString().slice(0,10),i,r,s),h=G+he(u.toISOString().slice(0,10),i,r,s),p=Math.max(h-m,1),b=Math.min(o/Rc,1)*.85+.1;return e.jsx("rect",{x:m,y:a,width:p,height:Qe,fill:t.color,opacity:o===0?.05:b,rx:1},n)})}):null}function Ic({stream:t,centerY:a,chartW:s,timelineStart:i,timelineEnd:r}){if(!t.episodicDates)return null;const n=G+he(t.episodicDates[0],i,r,s),o=G+he(t.episodicDates[t.episodicDates.length-1],i,r,s),c=t.id==="nutrition"?3:5;return e.jsxs("g",{children:[t.episodicDates.length>1&&e.jsx("line",{x1:n,y1:a,x2:o,y2:a,stroke:t.color,strokeWidth:1,opacity:.3,strokeDasharray:"3 2"}),t.episodicDates.map((l,d)=>{const u=G+he(l,i,r,s);return t.id==="nutrition"?e.jsx("circle",{cx:u,cy:a,r:c,fill:t.color,opacity:.7},`${t.id}-${d}`):e.jsx("g",{children:e.jsx("polygon",{points:`${u},${a-c} ${u+c},${a} ${u},${a+c} ${u-c},${a}`,fill:t.color,stroke:"white",strokeWidth:1})},`${t.id}-${d}`)})]})}const Lc={sleep:"🌙",metabolic:"⚡",recovery:"💚",cognitive:"🧠",activity:"🏃",stress:"🧘",nutrition:"🥗",cardio:"❤️",mood:"😊"},Ec={sleep:"bg-secondary-50/40 border-secondary-100",metabolic:"bg-accent-50/40 border-accent-100",recovery:"bg-primary-50/40 border-primary-100",cognitive:"bg-secondary-50/30 border-secondary-100",activity:"bg-primary-50/30 border-primary-100",stress:"bg-accent-50/30 border-accent-100",nutrition:"bg-emerald-50/40 border-emerald-100",cardio:"bg-rose-50/40 border-rose-100",mood:"bg-amber-50/40 border-amber-100"},es={plateau_up:"↗",plateau_down:"↘",v_min:"∪",v_max:"∩",linear:"→"},ts=({insight:t,onClose:a})=>{const[s,i]=g.useState(!1),r=JSON.stringify(t,null,2),n=async()=>{await navigator.clipboard.writeText(r),i(!0),setTimeout(()=>i(!1),2e3)};return e.jsx(M.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/50 backdrop-blur-sm",onClick:a,children:e.jsxs(M.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.2},className:"w-full max-w-3xl max-h-[80vh] bg-white rounded-xl shadow-2xl overflow-hidden",onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-slate-200 bg-slate-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary-100 rounded-lg",children:e.jsx(kt,{className:"w-4 h-4 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Insight Data"}),e.jsx("p",{className:"text-xs text-slate-500",children:"JSON representation of this insight"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:n,className:x("flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-colors",s?"bg-emerald-50 text-emerald-600":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:[s?e.jsx(ie,{className:"w-3.5 h-3.5"}):e.jsx(rt,{className:"w-3.5 h-3.5"}),s?"Copied!":"Copy"]}),e.jsx("button",{onClick:a,className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(je,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"overflow-auto max-h-[calc(80vh-80px)]",children:e.jsx("pre",{className:"p-5 text-xs font-mono leading-relaxed text-slate-700 bg-slate-900 overflow-x-auto",children:e.jsx("code",{className:"language-json",children:r.split(`
`).map((o,c)=>e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"select-none text-slate-600 w-10 text-right pr-4 flex-shrink-0",children:c+1}),e.jsx("span",{className:"text-slate-200",children:o.replace(/(".*?")(:\s*)?(".*?"|[\d.]+|true|false|null)?/g,(l,d,u,m)=>{if(u&&m){const h="text-primary-400",p=m.startsWith('"')?"text-emerald-400":m==="true"||m==="false"?"text-amber-400":m==="null"?"text-slate-500":"text-violet-400";return`<span class="${h}">${d}</span>${u}<span class="${p}">${m}</span>`}else return u?`<span class="text-primary-400">${d}</span>${u}`:`<span class="${d.startsWith('"')?"text-emerald-400":"text-violet-400"}">${d}</span>`}).split(/<span|<\/span>/).map((l,d)=>{if(l.startsWith(' class="')){const u=l.match(/class="([^"]+)">(.*)/s);if(u)return e.jsx("span",{className:u[1],children:u[2]},d)}return l})})]},c))})})}),e.jsx("div",{className:"px-5 py-3 border-t border-slate-200 bg-slate-50",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500",children:[e.jsx("span",{children:"Format: JSON (JavaScript Object Notation)"}),e.jsxs("span",{children:[r.split(`
`).length," lines"]})]})})]})})},Ta=g.forwardRef(({className:t,insight:a,onAction:s,expanded:i,showEvidence:r=!0,interactive:n=!0,variant:o="default",...c},l)=>{const[d,u]=g.useState(!1),[m,h]=g.useState(!1),[p,b]=g.useState(!1),y=i!==void 0?i:d,w=()=>{i===void 0&&u(!d)},v=Lc[a.category]||"💡",_=!!a.causalParams,f=a.variableType==="load"||a.variableType==="marker",j=Ec[a.category]||"";return o==="compact"?e.jsxs(e.Fragment,{children:[e.jsx(k,{ref:l,className:x("p-4",j,n&&"cursor-pointer",t),onClick:n?()=>s?.("view"):void 0,...c,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-lg",children:v}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx(sa,{category:a.category,size:"sm"}),e.jsxs("span",{className:"text-xs font-medium text-primary-600",children:[Math.round(a.certainty*100),"%"]}),_&&e.jsx("span",{className:"text-[10px] text-slate-400",title:a.causalParams.curveType,children:es[a.causalParams.curveType]}),e.jsx("button",{onClick:N=>{N.stopPropagation(),h(!0)},className:"ml-auto p-1 text-slate-400 hover:text-primary-600 hover:bg-primary-50 rounded transition-colors",title:"View JSON",children:e.jsx(kt,{className:"w-3.5 h-3.5"})})]}),e.jsx("p",{className:"text-sm font-medium text-slate-800 line-clamp-2",children:a.title}),_&&a.causalParams.curveType!=="linear"&&e.jsxs("p",{className:"text-xs text-slate-500 mt-1.5 font-mono",children:["θ = ",a.causalParams.theta.displayValue]})]})]})}),e.jsx(re,{children:m&&e.jsx(ts,{insight:a,onClose:()=>h(!1)})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(k,{ref:l,className:x("overflow-hidden",j,t),padding:"none","data-tour":"insight-cards",...c,children:[e.jsxs("div",{className:"p-5 pb-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:v}),e.jsx(sa,{category:a.category}),_&&e.jsx("span",{className:"px-2 py-0.5 text-[10px] text-slate-500 bg-slate-100/80 rounded-full font-mono",title:`Curve type: ${a.causalParams.curveType}`,children:es[a.causalParams.curveType]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("button",{onClick:()=>h(!0),className:"p-1.5 text-slate-300 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",title:"View JSON",children:e.jsx(kt,{className:"w-3.5 h-3.5"})}),e.jsx(ii,{certainty:a.certainty})]})]}),e.jsx("h3",{className:"text-[15px] font-semibold text-slate-800 tracking-tight leading-snug mb-1",children:a.title}),e.jsx("p",{className:"text-sm text-slate-500 leading-relaxed",children:a.headline}),a.dataSources&&a.dataSources.length>0&&e.jsxs("div",{className:"mt-3 flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-[9px] font-medium text-slate-400 uppercase tracking-wider",children:"Data:"}),a.dataSources.map((N,S)=>{const L={oura:"bg-violet-100 text-violet-700 border-violet-200",dexcom:"bg-emerald-100 text-emerald-700 border-emerald-200","apple-watch":"bg-slate-100 text-slate-700 border-slate-200",fitbit:"bg-teal-100 text-teal-700 border-teal-200",bloodwork:"bg-rose-100 text-rose-700 border-rose-200","mito-app":"bg-amber-100 text-amber-700 border-amber-200",weather:"bg-sky-100 text-sky-700 border-sky-200",whoop:"bg-orange-100 text-orange-700 border-orange-200",levels:"bg-emerald-100 text-emerald-700 border-emerald-200"}[N.toLowerCase()]||"bg-slate-100 text-slate-600 border-slate-200",I=N.replace(/-/g," ").replace(/\b\w/g,T=>T.toUpperCase());return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 text-[10px] font-medium rounded-full border ${L}`,children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-current opacity-60"}),I]},S)}),a.dataSources.length>1&&e.jsx("span",{className:"text-[9px] text-primary-600 font-medium ml-1",children:"Multi-source insight"})]}),e.jsx("div",{className:"mt-4 p-4 bg-primary-50/40 rounded-lg border-l-[3px] border-l-serif-cyan",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(de,{className:"w-4 h-4 text-primary-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[13px] font-medium text-slate-800 leading-snug",children:a.recommendation}),e.jsx("p",{className:"text-xs text-slate-500 mt-1.5 leading-relaxed",children:a.explanation})]})]})}),a.showWork&&e.jsxs("div",{className:"mt-4 rounded-lg border border-amber-200 overflow-hidden",children:[e.jsxs("button",{onClick:()=>b(!p),className:"w-full flex items-center gap-3 p-3 bg-amber-50/70 hover:bg-amber-50 transition-colors text-left",children:[e.jsx("div",{className:"p-1.5 bg-amber-100 rounded",children:e.jsx(Ae,{className:"w-3.5 h-3.5 text-amber-600"})}),e.jsx("h4",{className:"flex-1 text-[10px] font-bold text-amber-700 uppercase tracking-wider",children:"Causal Analysis"}),e.jsxs("span",{className:"text-[9px] px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full font-medium",children:["n=",a.evidence.personalDays," days · ",Math.round(a.certainty*100),"% confidence"]}),p?e.jsx(Aa,{className:"w-3.5 h-3.5 text-amber-500"}):e.jsx(ye,{className:"w-3.5 h-3.5 text-amber-500"})]}),e.jsx(re,{children:p&&e.jsx(M.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:e.jsxs("div",{className:"px-4 pb-4 pt-2 bg-amber-50/40",children:[e.jsx("p",{className:"text-sm text-slate-700 leading-relaxed",children:a.showWork}),e.jsx("p",{className:"text-[10px] text-amber-600 mt-2 italic",children:"This insight uses causal inference (not just correlation) to control for confounding variables."})]})})})]}),_&&o==="detailed"&&e.jsxs("div",{className:"mt-5",children:[e.jsx("h4",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Dose-Response Curve"}),e.jsx("div",{className:"bg-slate-50/50 rounded-lg p-4",children:e.jsx(Cc,{params:a.causalParams,width:"100%",height:200,showCurrentValue:f})})]}),_&&e.jsxs("div",{className:"mt-5",children:[e.jsx("h4",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Effect Sizes (β)"}),e.jsx(Sc,{params:a.causalParams})]}),_&&a.causalParams.curveType!=="linear"&&a.causalParams.currentStatus&&f&&e.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wider",children:"Status:"}),e.jsxs("span",{className:x("px-2.5 py-1 text-xs font-medium rounded-full",a.causalParams.currentStatus==="at_optimal"&&"bg-emerald-50 text-emerald-600",(a.causalParams.currentStatus==="above_optimal"||a.causalParams.currentStatus==="above_threshold")&&"bg-amber-50 text-amber-600",(a.causalParams.currentStatus==="below_optimal"||a.causalParams.currentStatus==="below_threshold")&&"bg-primary-50 text-primary-600"),children:[a.causalParams.currentStatus==="at_optimal"&&"At optimal",(a.causalParams.currentStatus==="above_optimal"||a.causalParams.currentStatus==="above_threshold")&&"Above θ",(a.causalParams.currentStatus==="below_optimal"||a.causalParams.currentStatus==="below_threshold")&&"Below θ"]}),a.causalParams.currentValue!==void 0&&e.jsxs("span",{className:"text-xs font-mono text-slate-400",children:["(",a.causalParams.currentValue,")"]})]}),a.populationThreshold&&(!_||a.causalParams.curveType!=="linear")&&Math.abs(Number(a.populationThreshold.value)-Number(a.cause.threshold))>.01&&e.jsxs("div",{className:"mt-5 p-4 bg-gradient-to-r from-slate-50 to-primary-50/30 rounded-lg border border-primary-100",children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("span",{className:"text-[10px] font-bold text-primary-600 uppercase tracking-wider",children:"Your Threshold vs Population"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 text-center p-3 bg-white rounded-lg border border-slate-200",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-500",children:a.populationThreshold.value}),e.jsx("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider",children:a.populationThreshold.label})]}),e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("span",{className:"text-primary-500 text-lg",children:"→"})}),e.jsxs("div",{className:"flex-1 text-center p-3 bg-primary-50 rounded-lg border-2 border-primary-300",children:[e.jsx("div",{className:"text-lg font-bold text-primary-700",children:a.cause.threshold}),e.jsx("div",{className:"text-[10px] text-primary-600 uppercase tracking-wider font-medium",children:"Your Threshold"})]})]}),a.populationThreshold.variance&&e.jsx("div",{className:"mt-3 text-center",children:e.jsxs("span",{className:"inline-block px-3 py-1 bg-emerald-50 text-emerald-700 text-xs font-medium rounded-full border border-emerald-200",children:["✓ ",a.populationThreshold.variance]})})]}),a.comparison&&e.jsx("div",{className:"mt-5",children:e.jsxs("div",{className:"p-4 text-center rounded-lg bg-emerald-50 border border-emerald-200",children:[e.jsx("div",{className:"text-2xl font-semibold text-slate-800",children:a.comparison.after.value}),e.jsx("div",{className:"text-[10px] font-medium text-emerald-600 uppercase tracking-wider mt-1",children:a.comparison.after.label})]})})]}),e.jsx("div",{className:"px-5 pb-4",children:(()=>{const N=Math.min(99,Math.round(a.evidence.personalWeight*100)),S=Math.max(1,100-N);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wider",children:"Evidence Split"}),_&&e.jsxs("span",{className:"font-mono text-slate-400 text-[10px]",children:["n=",a.causalParams.observations]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex justify-between mb-1",children:e.jsxs("span",{className:"text-[10px] font-medium text-primary-600",children:["Personal ",N,"%"]})}),e.jsx("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-serif-cyan rounded-full transition-all duration-500",style:{width:`${N}%`}})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex justify-between mb-1",children:e.jsxs("span",{className:"text-[10px] font-medium text-slate-500",children:["Population ",S,"%"]})}),e.jsx("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-slate-300 rounded-full transition-all duration-500",style:{width:`${S}%`}})})]})]})]})})()}),r&&o==="detailed"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:w,className:x("w-full px-5 py-3 flex items-center justify-between text-[10px] font-medium uppercase tracking-wider","hover:bg-slate-50 border-t border-slate-100 text-slate-500",q.colors),children:[e.jsx("span",{children:"Show Work & Details"}),y?e.jsx(Aa,{className:"w-4 h-4"}):e.jsx(ye,{className:"w-4 h-4"})]}),e.jsx(re,{children:y&&e.jsx(M.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden","data-tour":"insight-evidence",children:e.jsxs("div",{className:"px-5 pb-5 space-y-4 border-t border-slate-100 pt-4 bg-slate-50/50",children:[a.whyNow&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wider mb-1.5",children:"Why Now?"}),e.jsx("p",{className:"text-sm text-slate-600",children:a.whyNow})]}),a.holdoutPreview&&e.jsxs("div",{className:"p-4 bg-secondary-50 rounded-lg border-l-[3px] border-l-serif-lavender",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ae,{className:"w-3.5 h-3.5 text-secondary-500"}),e.jsx("h4",{className:"text-[10px] font-medium text-secondary-600 uppercase tracking-wider",children:"Predicted Impact"})]}),e.jsxs("p",{className:"text-sm font-medium text-secondary-700",children:[a.holdoutPreview.expectedChange>0?"+":"",a.holdoutPreview.expectedChange," ",a.holdoutPreview.unit," in ",a.holdoutPreview.horizon]})]}),a.dataSources&&a.dataSources.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Data Sources"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:a.dataSources.map((N,S)=>e.jsx("span",{className:"px-2.5 py-1 bg-white border border-slate-200 text-xs text-slate-600 rounded-full",children:N.replace(/-/g," ")},S))})]}),a.causalChain&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Causal Path"}),e.jsx("div",{className:"flex items-center gap-1.5 text-sm flex-wrap",children:a.causalChain.map((N,S)=>e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"px-2.5 py-1 bg-white border border-slate-200 text-slate-700 rounded-lg text-xs",children:N}),S<a.causalChain.length-1&&e.jsx("span",{className:"text-slate-300",children:"→"})]},S))})]})]})})})]}),a.actionable&&e.jsxs("div",{className:"px-5 pb-5 flex items-center gap-2",children:[a.suggestedAction&&e.jsx(V,{size:"sm",variant:"primary",onClick:()=>s?.(a.suggestedAction),children:a.suggestedAction}),e.jsx(V,{size:"sm",variant:"ghost",onClick:()=>s?.("simulate"),children:"Simulate"})]})]}),e.jsx(re,{children:m&&e.jsx(ts,{insight:a,onClose:()=>h(!1)})})]})});Ta.displayName="InsightCard";const Mi=g.forwardRef(({className:t,insights:a,onInsightAction:s,emptyState:i,variant:r="default",...n},o)=>a.length===0&&i?e.jsx("div",{ref:o,className:t,...n,children:i}):e.jsx("div",{ref:o,className:x("grid gap-5",r==="compact"?"grid-cols-1 md:grid-cols-2":"grid-cols-1 lg:grid-cols-2",t),...n,children:a.map(c=>e.jsx(Ta,{insight:c,variant:r,onAction:l=>s?.(c.id,l)},c.id))}));Mi.displayName="InsightGrid";const Wc=[{value:30,label:"Exploratory",description:"Show all insights including low certainty"},{value:50,label:"Moderate",description:"Balanced between coverage and confidence"},{value:70,label:"High",description:"Only show confident insights"},{value:85,label:"Very High",description:"Only the most certain insights"}],Ri=g.forwardRef(({className:t,value:a,onChange:s,showDescription:i=!0,showPresets:r=!1,label:n="Certainty Threshold",...o},c)=>{const{certaintyThreshold:l,setCertaintyThreshold:d}=lt(),u=a!==void 0?a:l,m=s||d,h=g.useCallback(p=>p>=85?"Showing only insights with very high confidence. You may miss some useful patterns.":p>=70?"Showing insights where we have strong evidence from your personal data.":p>=50?"Balanced view showing insights with moderate to high certainty.":p>=30?"Showing more insights, including those based partly on population data.":"Showing all insights including exploratory patterns. Use with caution.",[]);return e.jsxs("div",{ref:c,className:x("",t),"data-tour":"certainty-slider",...o,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:n}),e.jsxs("span",{className:"text-sm font-semibold text-primary-600",children:[u,"%"]})]}),e.jsx(ja,{value:u,onChange:m,showCertaintyLabel:!1}),i&&e.jsx("p",{className:"mt-3 text-xs text-gray-500",children:h(u)}),r&&e.jsx("div",{className:"mt-4 grid grid-cols-2 gap-2",children:Wc.map(p=>e.jsxs("button",{onClick:()=>m(p.value),className:x("px-3 py-2 rounded-lg text-left text-sm transition-colors",u===p.value?"bg-primary-100 text-primary-700 border border-primary-200":"bg-gray-50 text-gray-600 border border-gray-200 hover:bg-gray-100"),children:[e.jsx("span",{className:"font-medium",children:p.label}),e.jsxs("span",{className:"text-xs text-gray-400 ml-1",children:[p.value,"%"]})]},p.value))})]})});Ri.displayName="CertaintyFilter";const Hc={outcome:e.jsx(de,{className:"w-4 h-4"}),load:e.jsx(ee,{className:"w-4 h-4"}),marker:e.jsx(z,{className:"w-4 h-4"})},Pi=g.forwardRef(({className:t,selectedTypes:a,onToggle:s,showCounts:i,...r},n)=>{const o=["outcome","load","marker"];return e.jsxs("div",{ref:n,className:x("",t),...r,children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-3 block",children:"Variable Type"}),e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Filter by what the insight affects"}),e.jsx("div",{className:"space-y-2",children:o.map(c=>{const l=wi[c],d=a.includes(c),u=i?.[c];return e.jsxs("button",{onClick:()=>s(c),className:x("w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-left text-sm transition-all border",d?x(l.bgColor,l.borderColor,"ring-1 ring-offset-1"):"bg-gray-50 border-gray-200 hover:bg-gray-100"),style:d?{"--tw-ring-color":l.color}:void 0,children:[e.jsx("span",{className:x("p-1.5 rounded-md",d?"bg-white/60":"bg-gray-100"),style:d?{color:l.color}:{color:"#6B7280"},children:Hc[c]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:x("font-medium",d?"text-gray-900":"text-gray-600"),children:l.label}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:l.description})]}),u!==void 0&&e.jsx("span",{className:x("px-2 py-0.5 text-xs rounded-full font-medium",d?"bg-white/60 text-gray-700":"bg-gray-200 text-gray-500"),children:u})]},c)})})]})});Pi.displayName="VariableTypeFilter";const Vc={sleep:{label:"Sleep",color:"bg-insight-sleep/10 text-insight-sleep",emoji:"😴"},metabolic:{label:"Metabolic",color:"bg-insight-metabolic/10 text-insight-metabolic",emoji:"🔥"},recovery:{label:"Recovery",color:"bg-insight-recovery/10 text-insight-recovery",emoji:"💪"},cognitive:{label:"Cognitive",color:"bg-insight-cognitive/10 text-insight-cognitive",emoji:"🧠"},activity:{label:"Activity",color:"bg-insight-activity/10 text-insight-activity",emoji:"🏃"},stress:{label:"Stress",color:"bg-insight-stress/10 text-insight-stress",emoji:"🧘"},nutrition:{label:"Nutrition",color:"bg-insight-nutrition/10 text-insight-nutrition",emoji:"🥗"}},Di=g.forwardRef(({className:t,categories:a,selectedCategories:s,onToggle:i,showCounts:r,...n},o)=>e.jsxs("div",{ref:o,className:x("",t),...n,children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-3 block",children:"Categories"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.map(c=>{const l=Vc[c]||{label:c,color:"bg-gray-100 text-gray-600",emoji:"📊"},d=s.includes(c),u=r?.[c];return e.jsxs("button",{onClick:()=>i(c),className:x("inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium transition-all",d?x(l.color,"ring-2 ring-offset-1"):"bg-gray-100 text-gray-500 hover:bg-gray-200"),children:[e.jsx("span",{children:l.emoji}),e.jsx("span",{children:l.label}),u!==void 0&&e.jsx("span",{className:x("ml-1 px-1.5 py-0.5 text-xs rounded-full",d?"bg-white/50":"bg-gray-200"),children:u})]},c)})})]}));Di.displayName="CategoryFilter";const Oc=g.forwardRef(({className:t,certaintyValue:a,onCertaintyChange:s,selectedVariableTypes:i=[],onVariableTypeToggle:r,variableTypeCounts:n,categories:o,selectedCategories:c,onCategoryToggle:l,categoryCounts:d,totalCount:u,filteredCount:m,onReset:h,...p},b)=>{const y=a!==50||c.length>0||i.length>0;return e.jsxs("div",{ref:b,className:x("space-y-6",t),...p,children:[r&&e.jsx(Pi,{selectedTypes:i,onToggle:r,showCounts:n}),e.jsx(Di,{categories:o,selectedCategories:c,onToggle:l,showCounts:d}),e.jsx(Ri,{value:a,onChange:s,showDescription:!0}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"text-gray-500",children:["Showing ",e.jsx("span",{className:"font-medium text-gray-900",children:m})," of ",u," insights"]}),y&&e.jsx("button",{onClick:h,className:"block mt-2 text-primary-600 hover:text-primary-700 font-medium",children:"Reset filters"})]})]})});Oc.displayName="InsightFiltersPanel";const Bc={critical:{emoji:"🔴",color:"#DC2626",bgColor:"#FEE2E2",label:"Action Required"},warning:{emoji:"🟠",color:"#EA580C",bgColor:"#FFEDD5",label:"Needs Attention"},watch:{emoji:"🟡",color:"#CA8A04",bgColor:"#FEF9C3",label:"Monitor"},optimal:{emoji:"🟢",color:"#16A34A",bgColor:"#DCFCE7",label:"On Track"}},as={rajan:[{id:"rajan-1",status:"warning",headline:"Sleep fragmentation spiking glucose",explanation:"Nights with >3 wake events correlate with +18 mg/dL fasting glucose next morning. This pattern is invisible in annual labs but shows pre-diabetic dynamics.",dataSources:["Oura Ring","Dexcom G7"],metric:{value:"+18",label:"mg/dL on poor sleep nights",trend:"up"}},{id:"rajan-2",status:"critical",headline:"HRV declining 15% over 90 days",explanation:"Resting HRV dropped from 52ms to 44ms despite no change in exercise. Often precedes burnout or immune dysfunction by 4-6 weeks.",dataSources:["Whoop","Apple Watch"],metric:{value:"44ms",label:"current vs 52ms baseline",trend:"down"}},{id:"rajan-3",status:"watch",headline:"Late meals blunting overnight recovery",explanation:"Eating after 8pm correlates with 23% lower deep sleep and elevated overnight heart rate. Recovery scores drop significantly.",dataSources:["Oura Ring","MyFitnessPal"],metric:{value:"-23%",label:"deep sleep on late meals",trend:"down"}},{id:"rajan-4",status:"optimal",headline:"Zone 2 training improving glucose control",explanation:"Days with 30+ min Zone 2 cardio show 12% tighter glucose variability. Current compliance: 4x/week.",dataSources:["Garmin","Dexcom G7"],metric:{value:"4x",label:"/week Zone 2 sessions",trend:"stable"}}],sarah:[{id:"sarah-1",status:"critical",headline:"Night shift recovery deficit accumulating",explanation:"Post-night-shift HRV takes 72+ hours to normalize vs 24 hours baseline. Sleep debt now at ~14 hours over 2 weeks.",dataSources:["Fitbit","Sleep Cycle"],metric:{value:"14h",label:"accumulated sleep debt",trend:"up"}},{id:"sarah-2",status:"warning",headline:"Cortisol pattern inverted on shift days",explanation:"Wearable stress markers peak at 3am (should be lowest). Associated with 2.3x higher afternoon fatigue scores.",dataSources:["Garmin","Daylio mood tracker"],metric:{value:"2.3x",label:"afternoon fatigue on shift days",trend:"up"}},{id:"sarah-3",status:"watch",headline:"Caffeine timing extending sleep latency",explanation:"Coffee after 2pm correlates with +35 min sleep onset time. Current pattern: 3pm average last caffeine.",dataSources:["Oura Ring","caffeine log"],metric:{value:"+35",label:"min to fall asleep",trend:"up"}},{id:"sarah-4",status:"optimal",headline:"Recovery days showing strong adaptation",explanation:"Off-shift recovery metrics (HRV, deep sleep) rebounding to baseline within 48h when properly scheduled.",dataSources:["Whoop","Oura Ring"],metric:{value:"48h",label:"to full recovery",trend:"stable"}}],marcus:[{id:"marcus-1",status:"warning",headline:"Morning glucose spikes despite medication",explanation:"Dawn phenomenon causing +45 mg/dL spike between 5-7am. Metformin timing may need adjustment. EHR A1C looks controlled but misses this pattern.",dataSources:["Freestyle Libre","medication log"],metric:{value:"+45",label:"mg/dL dawn spike",trend:"up"}},{id:"marcus-2",status:"watch",headline:"Step count declining seasonally",explanation:"Daily steps dropped from 8,200 to 5,100 over winter months. Correlates with +8 mmHg systolic BP and lower mood scores.",dataSources:["Fitbit","Withings BP cuff"],metric:{value:"5,100",label:"steps/day (was 8,200)",trend:"down"}},{id:"marcus-3",status:"optimal",headline:"Blood pressure well-controlled with activity",explanation:"Days with 7,000+ steps show 12 mmHg lower evening BP. Current BP averaging 128/78 on active days vs 140/85 sedentary.",dataSources:["Withings BP cuff","Apple Watch"],metric:{value:"128/78",label:"BP on active days",trend:"stable"}},{id:"marcus-4",status:"watch",headline:"Sleep efficiency dropping with nocturia",explanation:"3+ bathroom trips/night correlating with 62% sleep efficiency (target >85%). May indicate need for evening fluid/medication review.",dataSources:["Oura Ring","bathroom log"],metric:{value:"62%",label:"sleep efficiency",trend:"down"}}],emma:[{id:"emma-1",status:"warning",headline:"Overtraining pattern emerging",explanation:"HRV suppressed >20% below baseline for 12 consecutive days. Performance may decline within 1-2 weeks without deload.",dataSources:["Whoop","TrainingPeaks"],metric:{value:"12",label:"days HRV suppressed",trend:"up"}},{id:"emma-2",status:"critical",headline:"RED-S risk indicators present",explanation:"Low energy availability pattern: high training load + irregular eating + declining resting HR. Menstrual cycle tracking shows 45+ day gap.",dataSources:["Garmin","Clue app","MyFitnessPal"],metric:{value:"45+",label:"day cycle gap",trend:"up"}},{id:"emma-3",status:"watch",headline:"Sleep timing highly variable",explanation:"Bedtime varies by 3+ hours between weekdays and weekends. Social jet lag correlating with Monday performance dips.",dataSources:["Oura Ring","phone screen time"],metric:{value:"3h+",label:"bedtime variability",trend:"stable"}},{id:"emma-4",status:"optimal",headline:"Hydration tracking showing good compliance",explanation:"Urine SG averaging 1.012 (well-hydrated). Electrolyte intake adequate for training volume.",dataSources:["smart water bottle","training log"],metric:{value:"1.012",label:"avg urine SG",trend:"stable"}}],oron:[{id:"oron-longevity-1",status:"critical",headline:"Iron stores critically low despite supplementation",explanation:'Ferritin at 18 ng/mL — well below the 50+ target for endurance athletes. Foot-strike hemolysis from high running volume likely outpacing oral iron absorption. EHR shows "normal range" but misses athletic context.',dataSources:["Blood labs","Garmin","training log"],metric:{value:"18",label:"ng/mL ferritin",trend:"down"}},{id:"oron-longevity-2",status:"warning",headline:"Sleep fragmentation blunting testosterone recovery",explanation:"Nights with >2 wake events correlate with 12% lower morning testosterone. Current sleep efficiency 78% — below the 85% threshold for optimal hormonal recovery.",dataSources:["Oura Ring","blood labs"],metric:{value:"78%",label:"sleep efficiency",trend:"down"}},{id:"oron-longevity-3",status:"watch",headline:"Travel load elevating inflammatory markers",explanation:"CRP rises 0.4 mg/L within 48h of international travel. Jet lag disrupts circadian cortisol rhythm for 3+ days, compounding training stress.",dataSources:["Oura Ring","blood labs","travel log"],metric:{value:"+0.4",label:"mg/L CRP post-travel",trend:"up"}},{id:"oron-longevity-4",status:"optimal",headline:"Zone 2 volume driving metabolic efficiency",explanation:"Fat oxidation rate improving — 0.68 g/min at aerobic threshold, up from 0.52 three months ago. Glucose variability tightening on high-volume weeks.",dataSources:["Garmin","Supersapiens CGM"],metric:{value:"0.68",label:"g/min fat ox rate",trend:"up"}}]};function Fc(t){return as[t.toLowerCase()]||as.rajan}const $c={critical:"bg-red-50/60",warning:"bg-orange-50/60",watch:"bg-yellow-50/50",optimal:"bg-green-50/50"};function zc({status:t}){const a=Bc[t];return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2 py-1 text-xs font-bold uppercase tracking-wide",style:{backgroundColor:a.bgColor,color:a.color},children:[e.jsx("span",{children:a.emoji}),e.jsx("span",{children:a.label})]})}function Gc({trend:t}){if(!t)return null;const a=t==="up"?ee:t==="down"?fe:pa,s=t==="up"?"#DC2626":t==="down"?"#2563EB":"#6B7280";return e.jsx(a,{className:"w-4 h-4",style:{color:s}})}function Uc({insight:t,index:a}){return e.jsx(M.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:a*.1},className:"border-b-2 border-gray-100 last:border-b-0",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(zc,{status:t.status}),e.jsx("h4",{className:"text-base font-black text-black uppercase tracking-tight mt-2",children:t.headline})]}),t.metric&&e.jsxs("div",{className:"flex-shrink-0 text-right",children:[e.jsxs("div",{className:"flex items-center gap-1 justify-end",children:[e.jsx("span",{className:"text-2xl font-black text-black",children:t.metric.value}),e.jsx(Gc,{trend:t.metric.trend})]}),e.jsx("span",{className:"text-xs text-gray-500",children:t.metric.label})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3 leading-relaxed",children:t.explanation}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase",children:"Sources:"}),t.dataSources.map((s,i)=>e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 bg-gray-100 text-xs font-medium text-gray-600",children:s},i))]})]})})}function Yc({personaId:t}){const a=Fc(t),s=["critical","warning","watch","optimal"],i=[...a].sort((r,n)=>s.indexOf(r.status)-s.indexOf(n.status));return a.reduce((r,n)=>(r[n.status]=(r[n.status]||0)+1,r),{}),e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-emerald-600 to-teal-600 text-white",children:e.jsx("div",{className:"px-6 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Longevity Insights"})]}),e.jsx("span",{className:"text-xs font-medium opacity-80",children:"What EHR Can't See"})]})})}),e.jsx("div",{className:"grid grid-cols-2 gap-0",children:i.map((r,n)=>e.jsx("div",{className:x($c[r.status],n%2===0?"border-r border-gray-200":"",n<2?"border-b border-gray-200":""),children:e.jsx(Uc,{insight:r,index:n})},r.id))}),e.jsx("div",{className:"px-6 py-3 bg-gray-50 border-t-2 border-gray-200",children:e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Cross-modal insights from wearables, CGM, and consumer health data • Updated in real-time"})})]})}function Zc(){const{activePersona:t}=Ft(),{insights:a,allInsights:s,minCertainty:i,setMinCertainty:r,variableTypes:n,toggleVariableType:o,categories:c,toggleCategory:l,actionableOnly:d,setActionableOnly:u,totalCount:m,filteredCount:h,resetFilters:p,categoryStats:b}=Tn(),y=Mn(),[w,v]=g.useState("grid"),[_,f]=g.useState(!1),j=b.reduce((T,C)=>(T[C.category]=C.count,T),{}),N=s.reduce((T,C)=>{const P=C.variableType;return T[P]=(T[P]||0)+1,T},{});a.slice(0,3);const S=(T,C)=>{console.log("Insight action:",T,C)},R={outcome:e.jsx(de,{className:"w-5 h-5"}),load:e.jsx(ee,{className:"w-5 h-5"}),marker:e.jsx(z,{className:"w-5 h-5"})},L={sleep:{label:"Sleep",emoji:"😴"},metabolic:{label:"Metabolic",emoji:"🔥"},recovery:{label:"Recovery",emoji:"💪"},cognitive:{label:"Cognitive",emoji:"🧠"},cardio:{label:"Cardio",emoji:"❤️"},activity:{label:"Activity",emoji:"🏃"},stress:{label:"Stress",emoji:"🧘"},nutrition:{label:"Nutrition",emoji:"🥗"}},I=n.length>0||c.length>0||i>0;return e.jsxs(Z,{title:"Your Insights",subtitle:"Personalized discoveries powered by causal AI",actions:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(fi,{}),e.jsxs("div",{className:"flex items-center border border-slate-200 rounded-lg overflow-hidden",children:[e.jsx("button",{onClick:()=>v("grid"),className:`p-2 ${w==="grid"?"bg-primary-50 text-primary-600":"bg-white text-slate-500 hover:bg-slate-50"}`,children:e.jsx(xr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>v("list"),className:`p-2 border-l border-slate-200 ${w==="list"?"bg-primary-50 text-primary-600":"bg-white text-slate-500 hover:bg-slate-50"}`,children:e.jsx(br,{className:"w-4 h-4"})})]})]}),children:[t&&e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-6",children:e.jsxs(k,{padding:"none",className:"overflow-hidden rounded-xl",children:[e.jsx("div",{className:"px-6 py-3 bg-primary-50 border-b border-primary-100",children:e.jsx("span",{className:"text-xs font-medium text-primary-600 uppercase tracking-wider",children:"Active Profile"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:t.avatar,alt:t.name,className:"w-24 h-24 object-cover rounded-xl border border-slate-200",onError:T=>{const C=T.target;C.style.display="none"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800",children:t.name}),e.jsxs(A,{variant:"outline",children:[t.age," YRS"]})]}),e.jsx("p",{className:"text-lg font-medium text-primary-600 mb-2",children:t.archetype}),e.jsx("p",{className:"text-gray-600 mb-4",children:t.narrative}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg",children:[e.jsx(_e,{className:"w-4 h-4 text-slate-500"}),e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:[t.daysOfData," Days"]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg",children:[e.jsx(z,{className:"w-4 h-4 text-slate-500"}),e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:[t.devices?.length||0," Devices"]})]}),t.hasBloodwork&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-rose-50 border border-rose-200 rounded-lg",children:[e.jsx(vs,{className:"w-4 h-4 text-rose-500"}),e.jsxs("span",{className:"text-sm font-medium text-rose-700",children:[t.labDraws," Lab Draws"]})]})]}),t.loads&&t.loads.length>0&&(()=>{const T=t.loads.filter(H=>H.kind==="load"),C=t.loads.filter(H=>H.kind==="marker"),P={low:{bar:"bg-emerald-400",bg:"bg-emerald-50",border:"border-emerald-200",text:"text-emerald-700"},moderate:{bar:"bg-amber-400",bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-700"},high:{bar:"bg-orange-500",bg:"bg-orange-50",border:"border-orange-200",text:"text-orange-700"},critical:{bar:"bg-red-500",bg:"bg-red-50",border:"border-red-200",text:"text-red-700"}},E=H=>{const ae=P[H.status],ge=H.trend==="rising"?ee:H.trend==="falling"?fe:pa,mt=H.trend==="stable"?"text-slate-400":H.trendPositive?"text-emerald-500":"text-red-500";return e.jsx(st,{content:H.detail||H.label,children:e.jsxs("div",{className:x("p-3 rounded-lg border",ae.bg,ae.border),children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-700 truncate",children:H.label}),e.jsx(ge,{className:x("w-3.5 h-3.5 flex-shrink-0",mt)})]}),e.jsx("div",{className:"w-full h-1.5 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:x("h-full rounded-full transition-all",ae.bar),style:{width:`${H.value}%`}})}),e.jsxs("div",{className:"flex items-center justify-between mt-1.5",children:[e.jsx("span",{className:x("text-xs font-medium",ae.text),children:H.status}),e.jsxs("span",{className:"text-xs text-slate-400",children:[H.value,"%"]})]})]})},H.id)};return e.jsxs("div",{className:"mt-5 pt-5 border-t border-slate-100 space-y-5",children:[T.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(pr,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Active Loads"})]}),e.jsx("div",{className:x("grid gap-3",T.length===1?"grid-cols-1":T.length===2?"grid-cols-2":T.length===3?"grid-cols-3":"grid-cols-4"),children:T.map(E)})]}),C.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(ws,{className:"w-4 h-4 text-violet-500"}),e.jsx("span",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Biomarkers"})]}),e.jsx("div",{className:x("grid gap-3",C.length===1?"grid-cols-1":C.length===2?"grid-cols-2":C.length===3?"grid-cols-3":"grid-cols-4"),children:C.map(E)})]})]})})()]})]})})]})}),e.jsxs(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"sticky top-0 z-20 -mx-6 px-6 py-4 bg-white/95 backdrop-blur-sm border-b border-slate-200 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700",children:"Filter by Variable Type"}),e.jsx(st,{content:"COMPLE Framework: Filter insights by the type of health variable they affect",children:e.jsx(Lt,{className:"w-4 h-4 text-gray-400 cursor-help"})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"font-semibold text-slate-800",children:h}),e.jsxs("span",{className:"text-gray-500",children:["of ",m," insights"]}),I&&e.jsx("button",{onClick:p,className:"ml-2 px-2.5 py-1 bg-primary-50 text-primary-600 text-xs font-medium rounded-lg hover:bg-primary-100 transition-colors",children:"Clear"})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:["outcome","load","marker"].map(T=>{const C=wi[T],P=n.length===0||n.includes(T),E=N[T]||0;return e.jsxs("button",{onClick:()=>o(T),className:x("relative flex items-center gap-3 p-3 text-left transition-all border rounded-xl",P?"bg-white border-slate-200 shadow-sm":"bg-slate-50 border-slate-100 opacity-50 hover:opacity-75"),children:[e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:P?C.color:"#F3F4F6"},children:e.jsx("span",{className:P?"text-white":"text-gray-400",children:R[T]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:x("font-medium text-sm",P?"text-slate-800":"text-gray-500"),children:C.label}),e.jsx("span",{className:x("px-2 py-0.5 text-xs font-medium rounded-full",P?"bg-primary-50 text-primary-600":"bg-gray-100 text-gray-500"),children:E})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5 truncate",children:C.description})]})]},T)})})]}),t&&e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.15},className:"mb-6",children:e.jsx(Yc,{personaId:t.id})}),e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"mb-6",children:e.jsxs(k,{padding:"none",className:"rounded-xl",children:[e.jsxs("div",{className:"p-4 flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider mr-1",children:"Domain:"}),y.map(T=>{const C=L[T.category]||{label:T.category,emoji:"📊"},P=c.includes(T.category),E=j[T.category]||0;return e.jsxs("button",{onClick:()=>l(T.category),className:x("inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium transition-all border rounded-full",P?"bg-primary-50 text-primary-700 border-primary-200":"bg-white text-slate-600 border-slate-200 hover:border-primary-200 hover:bg-primary-50/50"),children:[e.jsx("span",{children:C.emoji}),e.jsx("span",{children:C.label}),e.jsx("span",{className:x("px-1.5 py-0.5 text-xs rounded-full",P?"bg-primary-100 text-primary-600":"bg-slate-100 text-slate-500"),children:E})]},T.category)})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("button",{onClick:()=>f(!_),className:x("flex items-center gap-2 px-3 py-1.5 text-xs font-medium transition-all border rounded-lg",_?"bg-primary-50 text-primary-600 border-primary-200":"bg-white text-slate-600 border-slate-200 hover:border-slate-300"),children:[e.jsx(gr,{className:"w-4 h-4"}),"More Filters",e.jsx(ye,{className:x("w-4 h-4 transition-transform",_&&"rotate-180")})]})})]}),_&&e.jsx(M.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border-t border-slate-200",children:e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsxs("div",{className:"p-4 border-r border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Min Certainty"}),e.jsxs("span",{className:"text-sm font-semibold text-slate-800",children:[Math.round(i*100),"%"]})]}),e.jsx(ja,{value:Math.round(i*100),onChange:T=>r(T/100)}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:i>=.7?"High-confidence only":i>=.4?"Moderate certainty":"Including exploratory"})]}),e.jsx("div",{className:"p-4 flex items-start gap-3",children:e.jsx(se,{label:"Actionable only",description:"Show only insights with recommended actions",checked:d,onToggle:u,size:"sm"})})]})})]})}),e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25},children:a.length>0?w==="grid"?e.jsx(Mi,{insights:a,onInsightAction:S,variant:"detailed"}):e.jsx("div",{className:"space-y-3",children:a.map(T=>e.jsx(Ta,{insight:T,variant:"compact",onAction:C=>S(T.id,C)},T.id))}):e.jsxs(k,{padding:"none",className:"text-center rounded-xl",children:[e.jsx("div",{className:"px-6 py-3 bg-slate-50 border-b border-slate-200 rounded-t-xl",children:e.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase tracking-wider",children:"No Results"})}),e.jsxs("div",{className:"p-12",children:[e.jsx("div",{className:"w-16 h-16 bg-primary-50 rounded-xl flex items-center justify-center mx-auto mb-4",children:e.jsx(Ae,{className:"w-8 h-8 text-primary-400"})}),e.jsx("p",{className:"text-slate-500 mb-4",children:"No insights match your current filters."}),e.jsx(V,{variant:"outline",onClick:p,children:"Reset Filters"})]})]})})]})}const bt=[{id:"sleep-duration",category:"sleep",recommendation:"Target 7.0 hours of sleep per night",target:{value:7,unit:"hours",range:[6.7,7.4]},sourceInsights:[{insightId:"oron_insight_16",title:"Sleep Duration → Next-Day HRV",theta:6.73,thetaUnit:"hours",personalWeight:1,observations:2204,contribution:"HRV peaks near 6.7h — more sleep shows diminishing returns for HRV"},{insightId:"oron_insight_50",title:"Sleep Duration → Cortisol",theta:7.42,thetaUnit:"hours",personalWeight:.06,observations:452,contribution:"Cortisol drops sharply below 7.4h — longer sleep stabilizes stress hormones"},{insightId:"oron_insight_52",title:"Sleep Duration → Glucose",theta:7.2,thetaUnit:"hours",personalWeight:.07,observations:4,contribution:"Fasting glucose improves below 7.2h threshold — insulin sensitivity peaks"}],confidence:"high",reasoning:"Three insights affect sleep duration targeting. Your HRV data (2,204 observations, 100% personal) strongly supports 6.7h as the peak for next-day HRV. However, cortisol and glucose data suggest 7.2–7.4h for hormonal and metabolic benefits. Protocol targets 7.0h as a balanced median — protecting HRV recovery while staying within the metabolic benefit window.",conflictResolution:{description:"HRV insight suggests 6.7h optimal, but cortisol and glucose insights suggest 7.2–7.4h. Since HRV has the highest personal data (2,204 days, 100% personal weight) and the other two are primarily population-based (<7% personal), we anchor closer to the HRV threshold while staying conservative for cortisol.",insights:[{id:"oron_insight_16",title:"Sleep Duration → HRV",suggests:"6.7 hours",weight:1},{id:"oron_insight_50",title:"Sleep Duration → Cortisol",suggests:"7.4 hours",weight:.06},{id:"oron_insight_52",title:"Sleep Duration → Glucose",suggests:"7.2 hours",weight:.07}],winner:"oron_insight_16",rule:"Higher personalWeight wins (100% personal vs <7% personal); target shifted conservative toward metabolic safety"}},{id:"sleep-workout-cutoff",category:"sleep",recommendation:"Finish workouts before 7:45 PM to protect sleep efficiency",target:{value:19.75,unit:"hour (24h)",range:[17.5,21]},sourceInsights:[{insightId:"oron_insight_13",title:"Workout Time → Sleep Efficiency",theta:19.74,thetaUnit:"hour",personalWeight:1,observations:1181,contribution:"Sleep efficiency drops sharply (-2.0%/hr) when workouts end after ~7:45 PM"}],confidence:"high",reasoning:"1,181 days of personal data (100% personal weight). Above 7:45 PM, each additional hour of late exercise costs -2.0% sleep efficiency. Below that threshold, timing has negligible effect (-0.06%/hr)."},{id:"sleep-travel-recovery",category:"sleep",recommendation:"After travel (jet lag > 0.6), expect 2–3 nights of disrupted sleep",target:{value:.57,unit:"jet lag score",range:[0,.6]},sourceInsights:[{insightId:"oron_insight_23",title:"Travel Load → Sleep Efficiency",theta:.57,thetaUnit:"jet lag score",personalWeight:1,observations:1181,contribution:"Sleep efficiency plummets (-29.5%/unit) above 0.6 jet lag score"},{insightId:"oron_insight_62",title:"Travel Load → Deep Sleep",theta:.57,thetaUnit:"jet lag score",personalWeight:1,observations:1136,contribution:"Deep sleep drops sharply (-59.7 min/unit) above threshold"}],confidence:"high",reasoning:"Both insights agree on 0.57 jet lag threshold (≈0.6 displayed). Two independent sleep outcomes (efficiency + deep sleep) confirm severe disruption above this point. Plan rest days after significant travel."},{id:"training-weekly-volume",category:"training",recommendation:"Target 25 km/week running volume for HRV optimization",target:{value:25.3,unit:"km/week",range:[15,35]},sourceInsights:[{insightId:"oron_insight_22",title:"Weekly Volume → HRV Baseline",theta:25.31,thetaUnit:"km/week",personalWeight:1,observations:2401,contribution:"HRV improves up to 25.3 km/week, then plateaus — beyond this, diminishing returns"},{insightId:"oron_insight_1",title:"Running Volume → Iron",theta:177.17,thetaUnit:"km/month",personalWeight:.06,observations:452,contribution:"Iron depletion accelerates sharply above 177 km/month (≈44 km/week). Keep below to protect iron stores."}],confidence:"high",reasoning:"HRV data strongly supports 25 km/week as optimal (2,401 days personal data). Iron insight warns against exceeding 44 km/week. Current iron at 37 mcg/dL (critically low) means staying at 25 km/week protects both HRV and iron stores.",conflictResolution:{description:"HRV peaks at 25 km/week, while iron depletion accelerates above 44 km/week. These are complementary — the HRV-optimal volume is safely below the iron danger zone. But given Oron's critical iron status (37 mcg/dL), the protocol caps volume at the HRV threshold rather than exploring higher.",insights:[{id:"oron_insight_22",title:"Weekly Volume → HRV",suggests:"≤25 km/week",weight:1},{id:"oron_insight_1",title:"Running Volume → Iron",suggests:"<44 km/week",weight:.06}],winner:"oron_insight_22",rule:"Complementary constraints — both satisfied by targeting 25 km/week; iron-critical status makes lower bound preferred"}},{id:"training-acwr-range",category:"training",recommendation:"Maintain ACWR between 0.8 and 1.2 to avoid immune stress and HR elevation",target:{value:1,unit:"ratio",range:[.8,1.2]},sourceInsights:[{insightId:"oron_insight_40",title:"ACWR → Neutrophil-Lymphocyte Ratio",theta:1.19,thetaUnit:"ratio",personalWeight:.27,observations:618,contribution:"NLR spikes (+0.15/0.1 ACWR) above 1.2 — immune suppression risk"},{insightId:"oron_insight_10",title:"ACWR → Resting HR Trend",theta:1.8,thetaUnit:"ratio",personalWeight:1,observations:2400,contribution:"Resting HR drops (-4.3 bpm/0.1 ACWR) up to 1.8 — cardiovascular adaptation. But NLR data limits the safe upper bound."}],confidence:"high",reasoning:'The NLR insight caps ACWR at 1.2 (immune stress threshold). While resting HR continues to improve up to 1.8 ACWR, the immune cost above 1.2 makes it unsafe. Current ACWR is 0.93 — within range but on the low side (training load is "low").',conflictResolution:{description:"Resting HR insight suggests ACWR up to 1.8 is beneficial for cardiovascular fitness, but NLR insight shows immune suppression starts at 1.2. The immune constraint takes priority as a safety guardrail.",insights:[{id:"oron_insight_10",title:"ACWR → Resting HR",suggests:"Up to 1.8 ratio",weight:1},{id:"oron_insight_40",title:"ACWR → NLR",suggests:"Stay below 1.2 ratio",weight:.27}],winner:"oron_insight_40",rule:"Safety constraint wins — immune suppression is a health risk even if cardiovascular adaptation continues; stricter constraint prioritized"}},{id:"training-zone2-lipids",category:"training",recommendation:"Accumulate ≥200 min/month Zone 2 for lipid optimization",target:{value:200,unit:"min/month",range:[150,260]},sourceInsights:[{insightId:"oron_insight_8",title:"Zone 2 Volume → LDL",theta:201.76,thetaUnit:"min/month",personalWeight:.07,observations:618,contribution:"LDL drops below 200 min/month; rebounds above it"},{insightId:"oron_insight_34",title:"Zone 2 Volume → Non-HDL Cholesterol",theta:202.83,thetaUnit:"min/month",personalWeight:.07,observations:618,contribution:"Non-HDL drops optimally near 200 min/month"},{insightId:"oron_insight_35",title:"Zone 2 Volume → Total Cholesterol",theta:152.11,thetaUnit:"min/month",personalWeight:.07,observations:618,contribution:"Total cholesterol improves up to ~150 min/month"},{insightId:"oron_insight_6",title:"Zone 2 Volume → Triglycerides",theta:208.7,thetaUnit:"min/month",personalWeight:.07,observations:618,contribution:"Triglycerides respond optimally near 210 min/month"}],confidence:"medium",reasoning:"Four lipid-related insights converge on ~200 min/month Zone 2 as the inflection point. All are predominantly population-based (7% personal), but the convergence across LDL, non-HDL, total cholesterol, and triglycerides reinforces confidence. Current lipid panel (LDL 68, TG 62) is excellent — maintain with 200+ min/month Zone 2."},{id:"training-daily-load",category:"training",recommendation:"Keep daily TRIMP below 80 to protect next-day HRV recovery",target:{value:80,unit:"TRIMP",range:[0,80]},sourceInsights:[{insightId:"oron_insight_18",title:"Daily Training Load → Next-Day HRV",theta:80.2,thetaUnit:"TRIMP",personalWeight:1,observations:2391,contribution:"HRV depressed below threshold; recovers above 80 TRIMP"}],confidence:"high",reasoning:"2,391 days of personal data. Below 80 TRIMP, HRV drops modestly (-0.10 ms/50 TRIMP). Above 80 TRIMP, HRV paradoxically improves — suggesting the body adapts to moderate-high loads. Practical target: don't fear sessions near 80 TRIMP, but avoid sustained overload above ACWR 1.2."},{id:"training-active-energy",category:"training",recommendation:"Target 500+ active calories on training days for deep sleep benefit",target:{value:500,unit:"kcal",range:[400,900]},sourceInsights:[{insightId:"oron_insight_21",title:"Active Energy → Deep Sleep",theta:504.43,thetaUnit:"kcal",personalWeight:1,observations:1136,contribution:"Deep sleep improves more steeply above 500 kcal active energy"}],confidence:"medium",reasoning:"1,136 days of personal data. The effect is small (+0.008 min/100 kcal above threshold vs +0.004 below), but consistently positive. On training days, aiming for 500+ active calories supports both fitness and sleep quality."},{id:"recovery-travel-deload",category:"recovery",recommendation:"Reduce training intensity by 50% for 2–3 days after travel crossing time zones",target:{value:50,unit:"% intensity reduction",range:[40,60]},sourceInsights:[{insightId:"oron_insight_23",title:"Travel Load → Sleep Efficiency",theta:.57,thetaUnit:"jet lag score",personalWeight:1,observations:1181,contribution:"Sleep efficiency drops 29%/unit above threshold"},{insightId:"oron_insight_62",title:"Travel Load → Deep Sleep",theta:.57,thetaUnit:"jet lag score",personalWeight:1,observations:1136,contribution:"Deep sleep drops 60 min/unit above threshold"},{insightId:"oron_insight_61",title:"Travel Load → NLR",theta:.53,thetaUnit:"jet lag score",personalWeight:1,observations:611,contribution:"Immune stress rises after travel"}],confidence:"high",reasoning:"Three insights converge: travel above 0.6 jet lag score disrupts sleep efficiency, deep sleep, and immune balance simultaneously. Combined, this creates a recovery deficit that compounds with hard training. The protocol recommends deloading 50% to allow circadian re-alignment."},{id:"recovery-iron-protection",category:"recovery",recommendation:"Cap running at 35 km/week until iron normalizes (>50 mcg/dL)",target:{value:35,unit:"km/week",range:[25,40]},sourceInsights:[{insightId:"oron_insight_1",title:"Running Volume → Iron",theta:177.17,thetaUnit:"km/month",personalWeight:.06,observations:452,contribution:"Iron depletion accelerates above 177 km/month (~44 km/week)"},{insightId:"oron_insight_12",title:"Ferritin → VO2peak",theta:35.65,thetaUnit:"ng/mL",personalWeight:.27,observations:452,contribution:"VO2peak improves faster when ferritin is above 35.6 ng/mL"}],confidence:"medium",reasoning:"Iron at 37 mcg/dL is below reference range (50–180). Running accelerates foot-strike hemolysis. Ferritin at 46 ng/mL is approaching the VO2peak inflection point (35.6 ng/mL). Capping volume at 35 km/week protects iron stores while allowing enough volume for VO2peak benefits once ferritin exceeds the threshold."},{id:"recovery-ferritin-performance",category:"recovery",recommendation:"Prioritize ferritin repletion — VO2peak gains accelerate above 35 ng/mL",target:{value:50,unit:"ng/mL ferritin",range:[35,150]},sourceInsights:[{insightId:"oron_insight_12",title:"Ferritin → VO2peak",theta:35.65,thetaUnit:"ng/mL",personalWeight:.27,observations:452,contribution:"VO2peak improves +0.23 ml/min/kg per 10 ng/mL below threshold, +0.12 above"}],confidence:"medium",reasoning:'Current ferritin is 46 ng/mL — above the 35.6 threshold, meaning VO2peak gains are in the "above threshold" regime (+0.12 per 10 ng/mL). Continue iron repletion toward 50+ ng/mL for additional endurance benefit. The effect is moderate but consistent.'},{id:"nutrition-training-glucose",category:"nutrition",recommendation:"Maintain 1,200+ min/month training to keep fasting glucose in check",target:{value:1272,unit:"min/month",range:[1e3,1500]},sourceInsights:[{insightId:"oron_insight_36",title:"Training Hours → Glucose",theta:1272.1,thetaUnit:"min/month",personalWeight:.07,observations:616,contribution:"Glucose rises sharply above 1,272 min/month threshold — currently at 96 mg/dL"}],confidence:"low",reasoning:"Primarily population-based (7% personal). The glucose response to training volume has a threshold at ~1,272 min/month (~21 hrs/week). Current fasting glucose at 96 mg/dL is at the upper end of normal. Maintaining adequate training volume supports insulin sensitivity."},{id:"nutrition-sleep-glucose",category:"nutrition",recommendation:"Sleep ≥7.2 hours to protect fasting glucose below 100 mg/dL",target:{value:7.2,unit:"hours sleep",range:[6.8,7.5]},sourceInsights:[{insightId:"oron_insight_52",title:"Sleep Duration → Glucose",theta:7.2,thetaUnit:"hours",personalWeight:.07,observations:4,contribution:"Glucose improves below 7.2h threshold"}],confidence:"low",reasoning:"Only 4 observations and 7% personal weight — this is a population-derived estimate. However, it aligns with established literature (Spiegel et al.) linking sleep restriction to insulin resistance. At 96 mg/dL fasting glucose, sleep hygiene matters."},{id:"nutrition-body-composition",category:"nutrition",recommendation:"Maintain 13,000+ daily steps for weight management",target:{value:13e3,unit:"steps/day",range:[1e4,15e3]},sourceInsights:[{insightId:"oron_insight_27",title:"Daily Activity → Body Mass",theta:13004.9,thetaUnit:"steps",personalWeight:.27,observations:171,contribution:"Body mass stabilizes above 13,000 steps/day"}],confidence:"medium",reasoning:"171 observations with 27% personal weight. Weight management benefit is seen up to 13,000 steps/day, after which additional steps have negligible effect on body mass. Current weight at 72.8 kg is healthy for his frame."}],Ai=new Date("2026-02-08");function Se(t){const a=new Date(Ai);return a.setDate(a.getDate()+t),a.toISOString().split("T")[0]}function Te(t){const a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s=new Date(Ai);return s.setDate(s.getDate()+t),a[s.getDay()]}const Dt=[{date:Se(0),dayOfWeek:Te(0),dayType:"rest",sleepTarget:{bedtime:"22:30",wakeTime:"06:00",duration:7.5,durationRange:[7,8]},trainingTarget:null,recoveryNotes:["Rest day — focus on mobility and iron repletion","ACWR at 0.93; rest day brings 7-day load down gently"],nutritionNotes:["Iron supplement with vitamin C (empty stomach, morning)","Fatty fish for dinner (omega-3 optimization)","Last meal by 20:00"],morningBlock:[{time:"06:00",action:"Wake",category:"routine"},{time:"06:15",action:"Iron supplement + vitamin C",category:"nutrition",detail:"Take on empty stomach, 30 min before food"},{time:"06:30",action:"Light mobility / stretching (20 min)",category:"recovery"},{time:"07:00",action:"Breakfast",category:"nutrition"}],afternoonBlock:[{time:"12:00",action:"Lunch — protein-rich meal",category:"nutrition"},{time:"14:00",action:"Caffeine cutoff",category:"routine",sourceInsightId:"oron_insight_13",detail:"Personalized threshold: 14:00"}],eveningBlock:[{time:"18:30",action:"Dinner — salmon or mackerel",category:"nutrition",detail:"AA/EPA ratio at 30.9, target <10"},{time:"20:00",action:"Eating window closes",category:"nutrition"},{time:"21:30",action:"Screen cutoff & wind-down",category:"sleep"},{time:"22:30",action:"Bedtime",category:"sleep",sourceInsightId:"oron_insight_16",detail:"Target 7.0h sleep (range 6.7–7.4h)"}],campaignActions:[{campaignId:"campaign-iron-recovery",campaignName:"Iron Recovery",phaseId:"iron-phase-3",phaseName:"Verify",actions:["Iron bisglycinate 25 mg + vitamin C (06:15)","No coffee within 2h of iron dose"]},{campaignId:"campaign-training-ramp",campaignName:"Training Ramp-Up",phaseId:"training-phase-1",phaseName:"Reactivation",actions:["Rest day — consistent with reactivation phase (3 sessions/week)"]}]},{date:Se(1),dayOfWeek:Te(1),dayType:"easy",sleepTarget:{bedtime:"22:30",wakeTime:"06:00",duration:7.5,durationRange:[7,7.5]},trainingTarget:{type:"Zone 2 Run",duration:50,intensity:"Low (HR 120–140)",zone:"Zone 2",window:"06:15–07:05",notes:"Morning Zone 2 — lipid optimization. Keep HR in Zone 2 for LDL/TG benefit."},recoveryNotes:["Easy day — ACWR will stay below 1.2 with this load"],nutritionNotes:["Iron supplement with vitamin C (morning, pre-run)","Post-run: protein + carbs within 60 min","Last meal by 20:00"],morningBlock:[{time:"06:00",action:"Wake",category:"routine"},{time:"06:05",action:"Iron supplement + vitamin C",category:"nutrition"},{time:"06:15",action:"Zone 2 Run — 50 min",category:"training",sourceInsightId:"oron_insight_8",detail:"Target 200 min/month Zone 2 for lipids"},{time:"07:10",action:"Post-run nutrition",category:"nutrition"}],afternoonBlock:[{time:"12:00",action:"Lunch",category:"nutrition"},{time:"14:00",action:"Caffeine cutoff",category:"routine"}],eveningBlock:[{time:"19:00",action:"Dinner",category:"nutrition"},{time:"20:00",action:"Eating window closes",category:"nutrition"},{time:"21:30",action:"Wind-down begins",category:"sleep"},{time:"22:30",action:"Bedtime",category:"sleep",sourceInsightId:"oron_insight_16"}],campaignActions:[{campaignId:"campaign-iron-recovery",campaignName:"Iron Recovery",phaseId:"iron-phase-3",phaseName:"Verify",actions:["Iron bisglycinate 25 mg + vitamin C (06:05)","Running volume constraint: keep weekly total <35 km"]},{campaignId:"campaign-training-ramp",campaignName:"Training Ramp-Up",phaseId:"training-phase-1",phaseName:"Reactivation",actions:["Zone 2 session (1 of 3 this week)","Keep HR in Zone 1-2 only"]}]},{date:Se(2),dayOfWeek:Te(2),dayType:"moderate",sleepTarget:{bedtime:"22:30",wakeTime:"06:00",duration:7.5,durationRange:[7,7.5]},trainingTarget:{type:"Zone 2 Bike",duration:60,intensity:"Low-Moderate (HR 120–145)",zone:"Zone 2",window:"06:15–07:15",notes:"Bike session — no foot-strike hemolysis. Protects iron while building aerobic base."},recoveryNotes:["Bike preferred over run to reduce foot-strike hemolysis","Iron at 37 mcg/dL — cycling preserves iron better than running"],nutritionNotes:["Iron supplement with vitamin C","EPA/DHA supplement with dinner (2g)","Last meal by 20:00"],morningBlock:[{time:"06:00",action:"Wake",category:"routine"},{time:"06:05",action:"Iron supplement + vitamin C",category:"nutrition"},{time:"06:15",action:"Zone 2 Bike — 60 min",category:"training",sourceInsightId:"oron_insight_8",detail:"Non-impact aerobic — iron-sparing"},{time:"07:20",action:"Post-ride nutrition",category:"nutrition"}],afternoonBlock:[{time:"12:00",action:"Lunch",category:"nutrition"},{time:"14:00",action:"Caffeine cutoff",category:"routine"}],eveningBlock:[{time:"19:00",action:"Dinner + EPA/DHA supplement",category:"nutrition"},{time:"20:00",action:"Eating window closes",category:"nutrition"},{time:"21:30",action:"Wind-down begins",category:"sleep"},{time:"22:30",action:"Bedtime",category:"sleep"}]},{date:Se(3),dayOfWeek:Te(3),dayType:"rest",sleepTarget:{bedtime:"22:30",wakeTime:"06:00",duration:7.5,durationRange:[7,8]},trainingTarget:null,recoveryNotes:["Mid-week rest — allows adaptation from Mon/Tue sessions","Monitor HRV trend; should be recovering toward 32 ms baseline"],nutritionNotes:["Iron supplement with vitamin C","Focus on iron-rich foods: red meat, lentils, spinach","Last meal by 20:00"],morningBlock:[{time:"06:00",action:"Wake",category:"routine"},{time:"06:15",action:"Iron supplement + vitamin C",category:"nutrition"},{time:"06:30",action:"Light walk or mobility (20 min)",category:"recovery"},{time:"07:00",action:"Breakfast",category:"nutrition"}],afternoonBlock:[{time:"12:00",action:"Lunch — iron-rich meal",category:"nutrition"},{time:"14:00",action:"Caffeine cutoff",category:"routine"}],eveningBlock:[{time:"19:00",action:"Dinner",category:"nutrition"},{time:"20:00",action:"Eating window closes",category:"nutrition"},{time:"21:30",action:"Wind-down begins",category:"sleep"},{time:"22:30",action:"Bedtime",category:"sleep"}]},{date:Se(4),dayOfWeek:Te(4),dayType:"hard",sleepTarget:{bedtime:"22:30",wakeTime:"05:45",duration:7.25,durationRange:[7,7.5]},trainingTarget:{type:"Tempo Run",duration:40,intensity:"Moderate-High (HR 150–170)",zone:"Zone 3–4",window:"06:00–06:40",notes:"Keep TRIMP below 80. Short but quality session. Finish well before 19:45 cutoff."},recoveryNotes:["Hard day — expect HRV dip tomorrow","Keep ACWR below 1.2 (currently 0.93)"],nutritionNotes:["Iron supplement with vitamin C (pre-run)","Post-run: fast-absorbing protein + carbs","Extra calories to match training expenditure"],morningBlock:[{time:"05:45",action:"Wake",category:"routine"},{time:"05:50",action:"Iron supplement + vitamin C",category:"nutrition"},{time:"06:00",action:"Tempo Run — 40 min",category:"training",sourceInsightId:"oron_insight_18",detail:"Keep TRIMP <80 for HRV protection"},{time:"06:45",action:"Post-run nutrition",category:"nutrition"}],afternoonBlock:[{time:"12:00",action:"Lunch",category:"nutrition"},{time:"14:00",action:"Caffeine cutoff",category:"routine"}],eveningBlock:[{time:"19:00",action:"Dinner",category:"nutrition"},{time:"20:00",action:"Eating window closes",category:"nutrition"},{time:"21:30",action:"Wind-down & recovery focus",category:"sleep"},{time:"22:30",action:"Bedtime",category:"sleep"}],campaignActions:[{campaignId:"campaign-iron-recovery",campaignName:"Iron Recovery",phaseId:"iron-phase-3",phaseName:"Verify",actions:["Iron bisglycinate 25 mg + vitamin C (05:50)","Hard session OK — monitor total weekly running km"]},{campaignId:"campaign-training-ramp",campaignName:"Training Ramp-Up",phaseId:"training-phase-1",phaseName:"Reactivation",actions:["Tempo run — building toward ACWR 0.85","Keep TRIMP <80 for HRV protection"]}]},{date:Se(5),dayOfWeek:Te(5),dayType:"easy",sleepTarget:{bedtime:"22:30",wakeTime:"06:00",duration:7.5,durationRange:[7,7.5]},trainingTarget:{type:"Easy Zone 2 Run",duration:35,intensity:"Low (HR 115–135)",zone:"Zone 2",window:"06:15–06:50",notes:"Recovery run after Thursday hard session. Keep effort very easy."},recoveryNotes:["Recovery day after hard session","Monitor HRV — expect partial recovery from Thursday"],nutritionNotes:["Iron supplement with vitamin C","EPA/DHA supplement with dinner (2g)","Last meal by 20:00"],morningBlock:[{time:"06:00",action:"Wake",category:"routine"},{time:"06:05",action:"Iron supplement + vitamin C",category:"nutrition"},{time:"06:15",action:"Easy Zone 2 Run — 35 min",category:"training",detail:"Very easy — recovery pace"},{time:"06:55",action:"Post-run nutrition",category:"nutrition"}],afternoonBlock:[{time:"12:00",action:"Lunch",category:"nutrition"},{time:"14:00",action:"Caffeine cutoff",category:"routine"}],eveningBlock:[{time:"19:00",action:"Dinner + EPA/DHA",category:"nutrition"},{time:"20:00",action:"Eating window closes",category:"nutrition"},{time:"21:30",action:"Wind-down begins",category:"sleep"},{time:"22:30",action:"Bedtime",category:"sleep"}]},{date:Se(6),dayOfWeek:Te(6),dayType:"moderate",sleepTarget:{bedtime:"23:00",wakeTime:"06:30",duration:7.5,durationRange:[7,8]},trainingTarget:{type:"Zone 2 Bike (Long)",duration:75,intensity:"Low-Moderate (HR 120–145)",zone:"Zone 2",window:"07:00–08:15",notes:"Weekend long ride — builds aerobic base without running impact. Iron-sparing."},recoveryNotes:["Bike instead of run — protects iron stores","Longer session for aerobic base and Zone 2 minutes accumulation"],nutritionNotes:["Iron supplement with vitamin C","Pre-ride: light carbs","Post-ride: protein + carbs + hydration","Fatty fish for dinner"],morningBlock:[{time:"06:30",action:"Wake",category:"routine"},{time:"06:35",action:"Iron supplement + vitamin C",category:"nutrition"},{time:"06:50",action:"Light pre-ride snack",category:"nutrition"},{time:"07:00",action:"Zone 2 Bike — 75 min",category:"training",sourceInsightId:"oron_insight_8",detail:"Long Zone 2 — iron-sparing, lipid benefit"},{time:"08:20",action:"Post-ride nutrition",category:"nutrition"}],afternoonBlock:[{time:"12:00",action:"Lunch",category:"nutrition"},{time:"14:00",action:"Caffeine cutoff",category:"routine"}],eveningBlock:[{time:"19:00",action:"Dinner — salmon or mackerel",category:"nutrition"},{time:"20:00",action:"Eating window closes",category:"nutrition"},{time:"22:00",action:"Wind-down begins",category:"sleep"},{time:"23:00",action:"Bedtime",category:"sleep"}]}],ue={totalRunKm:12.5,totalZone2Min:220,totalTrainingMin:260,hardDays:1,easyDays:2,moderateDays:2,restDays:2,estimatedACWR:1.05,Zone2Pct:85},Ii=[{id:"z2-run",label:"Zone 2 Run",dayType:"easy",duration:50,isRunning:!0,estimatedTRIMP:40},{id:"z2-bike",label:"Zone 2 Bike",dayType:"moderate",duration:60,isRunning:!1,estimatedTRIMP:45},{id:"rest-1",label:"Rest Day",dayType:"rest",duration:0,isRunning:!1,estimatedTRIMP:0},{id:"tempo-run",label:"Tempo Run",dayType:"hard",duration:40,isRunning:!0,estimatedTRIMP:75},{id:"easy-z2-run",label:"Easy Zone 2 Run",dayType:"easy",duration:35,isRunning:!0,estimatedTRIMP:30},{id:"z2-bike-long",label:"Zone 2 Bike (Long)",dayType:"moderate",duration:75,isRunning:!1,estimatedTRIMP:55},{id:"rest-2",label:"Rest Day",dayType:"rest",duration:0,isRunning:!1,estimatedTRIMP:0}],qc=["rest-1","z2-run","z2-bike","rest-2","tempo-run","easy-z2-run","z2-bike-long"],Li=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function Q(t){return Li[t]??""}function Ie(t){return Li[t]?.slice(0,3)??""}function Kc(t){return t.map((a,s)=>({dayIndex:s,activity:a?Ii.find(i=>i.id===a)??null:null}))}function Xc(t){const a=new Set(t.map(s=>s.activity?.id).filter(Boolean));return Ii.filter(s=>!a.has(s.id))}function Qc(t){return t.every(a=>a.activity!==null)}function Jc(t){const a=[],s=t.map(n=>n.activity);for(let n=0;n<s.length-1;n++){const o=s[n],c=s[n+1];if(o&&c){const l=o.dayType==="hard",d=c.dayType==="hard";l&&d&&a.push({id:`back-to-back-hard-${n}`,label:"Back-to-back hard days",severity:"error",message:`${Q(n)} and ${Q(n+1)} are both hard sessions. This significantly increases injury and overtraining risk.`})}}for(let n=0;n<s.length-1;n++){const o=s[n],c=s[n+1];o&&c&&o.isRunning&&c.isRunning&&a.push({id:`adjacent-run-${n}`,label:"Adjacent running days",severity:"warning",message:`${Q(n)} and ${Q(n+1)} are both running sessions. With iron at 37 mcg/dL, consecutive foot-strike hemolysis days accelerate iron depletion.`})}for(let n=1;n<s.length;n++){const o=s[n],c=s[n-1];o&&o.dayType==="hard"&&c&&c.dayType!=="rest"&&a.push({id:`no-rest-before-hard-${n}`,label:"No rest before hard session",severity:"warning",message:`${Q(n)} is a hard session but ${Q(n-1)} is not a rest day. Recovery may be suboptimal for peak performance.`})}for(let n=0;n<s.length-1;n++){const o=s[n],c=s[n+1];o&&o.dayType==="hard"&&c&&c.dayType==="hard"||o&&o.dayType==="hard"&&c&&c.dayType!=="rest"&&c.dayType!=="easy"&&a.push({id:`no-recovery-after-hard-${n}`,label:"No recovery after hard session",severity:"warning",message:`${Q(n)} is a hard session but ${Q(n+1)} is a ${c.dayType} day. HRV expects 24-48h recovery after hard efforts.`})}let i=0,r=0;for(let n=0;n<s.length;n++)if(s[n]&&s[n].dayType!=="rest"){if(i===0&&(r=n),i++,i>=4){a.push({id:`consecutive-training-${r}-${n}`,label:"4+ consecutive training days",severity:"warning",message:`${Q(r)} through ${Q(n)} is ${i} consecutive training days. Consider adding a rest day to reduce overtraining risk.`});break}}else i=0;return a.length===0&&a.push({id:"all-clear",label:"All clear",severity:"pass",message:"No constraint violations found. This arrangement respects recovery, iron protection, and load management guidelines."}),a}const ed=.93,td=.167;function ad(t){const a=t.map(f=>f.activity).filter(Boolean),s=a.reduce((f,j)=>f+j.duration,0),i=a.filter(f=>f.isRunning),r=a.filter(f=>!f.isRunning&&f.duration>0),n=i.reduce((f,j)=>f+j.duration,0),o=Math.round(n*td*10)/10,c=r.reduce((f,j)=>f+j.duration,0),l=a.find(f=>f.id==="tempo-run"),d=s-(l?l.duration:0),u=a.reduce((f,j)=>f+j.estimatedTRIMP,0),m=a.filter(f=>f.dayType==="hard").length,h=a.filter(f=>f.dayType==="easy").length,p=a.filter(f=>f.dayType==="moderate").length,b=7-a.filter(f=>f.dayType!=="rest").length,y=u,w=y/ed,v=w>0?Math.round(y/w*100)/100:0,_=s>0?Math.round(d/s*100):0;return{totalTrainingMin:s,totalRunKm:o,totalBikeMin:c,totalZone2Min:d,estimatedACWR:Math.max(.7,Math.min(1.5,v||1.05)),hardDays:m,easyDays:h,moderateDays:p,restDays:b,sleepTargetAvg:7.4,zone2Pct:_,totalTRIMP:u}}function Ei(t){return t.some(a=>a.severity==="error")?"error":t.some(a=>a.severity==="warning")?"warning":"pass"}const Wi={hard:{label:"Hard",color:"text-rose-700",bgColor:"bg-rose-50",borderColor:"border-rose-200",icon:Bt},moderate:{label:"Moderate",color:"text-amber-700",bgColor:"bg-amber-50",borderColor:"border-amber-200",icon:Ot},easy:{label:"Easy",color:"text-emerald-700",bgColor:"bg-emerald-50",borderColor:"border-emerald-200",icon:ot},rest:{label:"Rest",color:"text-slate-600",bgColor:"bg-slate-100",borderColor:"border-slate-200",icon:X}};function sd({activity:t,isInPool:a}){const s=Wi[t.dayType],i=s.icon;return e.jsxs("div",{draggable:!0,onDragStart:r=>{r.dataTransfer.setData("text/plain",t.id),r.dataTransfer.effectAllowed="move"},className:`flex items-center gap-2.5 px-3 py-2.5 rounded-lg border cursor-grab active:cursor-grabbing select-none transition-all
        ${s.bgColor} ${s.borderColor}
        ${a?"hover:shadow-md hover:scale-[1.02]":""}
      `,children:[a&&e.jsx(yr,{className:"w-3.5 h-3.5 text-slate-400 flex-shrink-0"}),e.jsx(i,{className:`w-4 h-4 flex-shrink-0 ${s.color}`}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:`text-xs font-semibold ${s.color}`,children:t.label}),t.duration>0&&e.jsxs("div",{className:"text-[10px] text-slate-400",children:[t.duration," min | ~",t.estimatedTRIMP," TRIMP"]})]}),e.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded text-[9px] font-semibold ${s.color} ${s.bgColor}`,children:s.label})]})}function id({dayIndex:t,activity:a,onDrop:s,onRemove:i}){const[r,n]=g.useState(!1),o=g.useCallback(m=>{m.preventDefault(),m.dataTransfer.dropEffect="move",n(!0)},[]),c=g.useCallback(()=>{n(!1)},[]),l=g.useCallback(m=>{m.preventDefault(),n(!1);const h=m.dataTransfer.getData("text/plain");h&&s(t,h)},[t,s]),d=a?Wi[a.dayType]:null,u=d?.icon;return e.jsxs("div",{onDragOver:o,onDragLeave:c,onDrop:l,className:`relative rounded-lg border-2 border-dashed transition-all min-h-[80px] flex flex-col
        ${r?"border-blue-400 bg-blue-50/50 scale-[1.02]":""}
        ${a?"border-solid "+(d?.borderColor??"border-slate-200"):"border-slate-200"}
        ${!a&&!r?"bg-slate-50/50":""}
      `,children:[e.jsxs("div",{className:"px-3 pt-2 pb-1 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] font-semibold text-slate-500 uppercase tracking-wider",children:Ie(t)}),e.jsx("span",{className:"text-[10px] text-slate-400 ml-1.5",children:Q(t)})]}),a&&e.jsx("button",{onClick:()=>i(t),className:"p-0.5 rounded hover:bg-slate-200/60 text-slate-400 hover:text-slate-600 transition-colors",title:"Remove activity",children:e.jsx(je,{className:"w-3 h-3"})})]}),e.jsx("div",{className:"px-3 pb-2.5 flex-1 flex items-center",children:a?e.jsxs("div",{draggable:!0,onDragStart:m=>{m.dataTransfer.setData("text/plain",a.id),m.dataTransfer.effectAllowed="move"},className:`w-full flex items-center gap-2 px-2.5 py-2 rounded-md cursor-grab active:cursor-grabbing ${d?.bgColor}`,children:[u&&e.jsx(u,{className:`w-3.5 h-3.5 ${d?.color}`}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:`text-xs font-semibold ${d?.color}`,children:a.label}),a.duration>0&&e.jsxs("div",{className:"text-[10px] text-slate-400",children:[a.duration," min"]})]})]}):e.jsx("div",{className:"w-full text-center text-[10px] text-slate-400 italic py-2",children:r?"Drop here":"Drag activity here"})})]})}function rd({assignments:t,unassigned:a,allPlaced:s,onAssign:i,onRemove:r,onLoadDefault:n,onReset:o,onNext:c}){return e.jsxs("div",{className:"space-y-4",children:[e.jsx(k,{padding:"sm",children:e.jsxs("p",{className:"text-sm text-slate-600",children:["Drag your 7 training activities onto the calendar below. The training types and durations are fixed — only ",e.jsx("strong",{children:"day placement"})," is mutable. Drop onto an occupied slot to swap."]})}),e.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[e.jsx("div",{className:"col-span-4",children:e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-2.5 bg-slate-50 border-b border-slate-200 flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-700 uppercase tracking-wider",children:"Activity Pool"}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:[a.length," remaining"]})]}),e.jsx("div",{className:"p-3 space-y-2",children:a.length>0?a.map(l=>e.jsx(M.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.15},children:e.jsx(sd,{activity:l,isInPool:!0})},l.id)):e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"text-sm font-medium text-emerald-700",children:"All placed!"}),e.jsx("div",{className:"text-[10px] text-slate-400 mt-1",children:"Every activity has been assigned to a day"})]})}),e.jsxs("div",{className:"px-3 pb-3 flex gap-2",children:[e.jsxs("button",{onClick:n,className:"flex-1 flex items-center justify-center gap-1.5 px-3 py-2 text-xs font-medium text-slate-600 bg-slate-100 rounded-lg hover:bg-slate-200 transition-colors",children:[e.jsx(fr,{className:"w-3.5 h-3.5"}),"Use Default"]}),e.jsxs("button",{onClick:o,className:"flex-1 flex items-center justify-center gap-1.5 px-3 py-2 text-xs font-medium text-slate-600 bg-slate-100 rounded-lg hover:bg-slate-200 transition-colors",children:[e.jsx(js,{className:"w-3.5 h-3.5"}),"Reset"]})]})]})}),e.jsx("div",{className:"col-span-8",children:e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsx("div",{className:"px-4 py-2.5 bg-slate-50 border-b border-slate-200",children:e.jsx("span",{className:"text-xs font-semibold text-slate-700 uppercase tracking-wider",children:"Weekly Calendar"})}),e.jsx("div",{className:"p-3 grid grid-cols-7 gap-2",children:t.map(l=>e.jsx(id,{dayIndex:l.dayIndex,activity:l.activity,onDrop:i,onRemove:r},l.dayIndex))})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:c,disabled:!s,className:`flex items-center gap-2 px-5 py-2.5 rounded-lg text-sm font-semibold transition-all
            ${s?"bg-slate-800 text-white hover:bg-slate-700 shadow-sm":"bg-slate-200 text-slate-400 cursor-not-allowed"}
          `,children:["Review Plan",e.jsx(U,{className:"w-4 h-4"})]})})]})}const oa={hard:{label:"Hard",color:"text-rose-700",bgColor:"bg-rose-50",icon:Bt},moderate:{label:"Moderate",color:"text-amber-700",bgColor:"bg-amber-50",icon:Ot},easy:{label:"Easy",color:"text-emerald-700",bgColor:"bg-emerald-50",icon:ot},rest:{label:"Rest",color:"text-slate-600",bgColor:"bg-slate-100",icon:X}};function nd({assignments:t}){return e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsx("div",{className:"px-4 py-2.5 bg-slate-50 border-b border-slate-200",children:e.jsx("span",{className:"text-xs font-semibold text-slate-700 uppercase tracking-wider",children:"Your Arrangement"})}),e.jsx("div",{className:"p-3 flex gap-2",children:t.map(a=>{const s=a.activity,i=s?oa[s.dayType]:null,r=i?.icon;return e.jsxs("div",{className:`flex-1 rounded-lg p-2.5 text-center ${i?.bgColor??"bg-slate-50"}`,children:[e.jsx("div",{className:"text-[10px] font-semibold text-slate-500 uppercase",children:Ie(a.dayIndex)}),r&&e.jsx(r,{className:`w-4 h-4 mx-auto mt-1 ${i?.color}`}),e.jsx("div",{className:`text-[10px] font-medium mt-1 ${i?.color??"text-slate-400"}`,children:s?.label??"—"}),s&&s.duration>0&&e.jsxs("div",{className:"text-[9px] text-slate-400 mt-0.5",children:[s.duration,"m"]})]},a.dayIndex)})})]})}const ss={error:{icon:oe,borderColor:"border-l-rose-500",bgColor:"bg-rose-50/60",textColor:"text-rose-700",badgeColor:"bg-rose-100 text-rose-700",badgeLabel:"Error"},warning:{icon:le,borderColor:"border-l-amber-500",bgColor:"bg-amber-50/60",textColor:"text-amber-700",badgeColor:"bg-amber-100 text-amber-700",badgeLabel:"Warning"},pass:{icon:Ne,borderColor:"border-l-emerald-500",bgColor:"bg-emerald-50/60",textColor:"text-emerald-700",badgeColor:"bg-emerald-100 text-emerald-700",badgeLabel:"Pass"}};function od({checks:t}){const a=Ei(t),s=ss[a],i=s.icon;return e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-2.5 border-b border-slate-200 flex items-center gap-2",style:{backgroundColor:a==="pass"?"#f0fdf4":a==="error"?"#fff1f2":"#fffbeb"},children:[e.jsx(Oe,{className:"w-4 h-4 text-slate-500"}),e.jsx("span",{className:"text-xs font-semibold text-slate-700 uppercase tracking-wider",children:"Constraint Checks"}),e.jsxs("span",{className:`ml-auto inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] font-semibold ${s.badgeColor}`,children:[e.jsx(i,{className:"w-3 h-3"}),a==="pass"?"All Clear":`${t.filter(r=>r.severity!=="pass").length} issue${t.filter(r=>r.severity!=="pass").length!==1?"s":""}`]})]}),e.jsx("div",{className:"p-3 space-y-2",children:t.map((r,n)=>{const o=ss[r.severity],c=o.icon;return e.jsx(M.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:n*.05},className:`p-3 rounded-lg border-l-4 ${o.borderColor} ${o.bgColor}`,children:e.jsxs("div",{className:"flex items-start gap-2.5",children:[e.jsx(c,{className:`w-4 h-4 mt-0.5 flex-shrink-0 ${o.textColor}`}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs font-semibold ${o.textColor}`,children:r.label}),e.jsx("span",{className:`px-1.5 py-0.5 rounded text-[9px] font-semibold ${o.badgeColor}`,children:o.badgeLabel})]}),e.jsx("p",{className:"text-[11px] text-slate-600 mt-1 leading-relaxed",children:r.message})]})]})},r.id)})})]})}function ld({value:t}){const r=(Math.max(.5,Math.min(1.5,t))-.5)/(1.5-.5)*100,n=(.8-.5)/(1.5-.5)*100,o=(1.2-.5)/(1.5-.5)*100,c=t>=.8&&t<=1.2,l=c?"#059669":t>1.2?"#e11d48":"#d97706";return e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-2.5 bg-slate-50 border-b border-slate-200 flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4 text-slate-500"}),e.jsx("span",{className:"text-xs font-semibold text-slate-700 uppercase tracking-wider",children:"Estimated ACWR"}),e.jsx("span",{className:"ml-auto text-sm font-mono font-semibold",style:{color:l},children:t.toFixed(2)})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("svg",{viewBox:"0 0 400 40",className:"w-full h-10",children:[e.jsx("rect",{x:"0",y:"14",width:"400",height:"12",rx:"6",fill:"#f1f5f9"}),e.jsx("rect",{x:n*4,y:"14",width:(o-n)*4,height:"12",rx:"0",fill:"#d1fae5"}),e.jsx("rect",{x:n*4,y:"14",width:(o-n)*4,height:"12",rx:"0",fill:"none",stroke:"#6ee7b7",strokeWidth:"1"}),e.jsx("circle",{cx:r*4,cy:"20",r:"7",fill:l}),e.jsx("circle",{cx:r*4,cy:"20",r:"4",fill:"white"}),e.jsx("text",{x:"0",y:"38",fontSize:"9",fill:"#94a3b8",textAnchor:"start",children:"0.5"}),e.jsx("text",{x:n*4,y:"10",fontSize:"9",fill:"#6ee7b7",textAnchor:"middle",children:"0.8"}),e.jsx("text",{x:o*4,y:"10",fontSize:"9",fill:"#6ee7b7",textAnchor:"middle",children:"1.2"}),e.jsx("text",{x:"400",y:"38",fontSize:"9",fill:"#94a3b8",textAnchor:"end",children:"1.5"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"inline-block w-3 h-2 rounded-sm bg-emerald-100 border border-emerald-300"}),e.jsx("span",{className:"text-[10px] text-slate-400",children:"Target zone (0.8–1.2)"}),c?e.jsx("span",{className:"text-[10px] text-emerald-600 font-medium ml-auto",children:"Within range"}):e.jsx("span",{className:"text-[10px] text-amber-600 font-medium ml-auto",children:t<.8?"Below target — undertraining":"Above target — overload risk"})]})]})]})}function cd({assignments:t}){const a=Math.max(...t.map(s=>s.activity?.estimatedTRIMP??0),80);return e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-2.5 bg-slate-50 border-b border-slate-200 flex items-center gap-2",children:[e.jsx(ke,{className:"w-4 h-4 text-slate-500"}),e.jsx("span",{className:"text-xs font-semibold text-slate-700 uppercase tracking-wider",children:"Weekly Load Distribution"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"flex items-end gap-2 h-28",children:t.map(s=>{const i=s.activity,r=i?.estimatedTRIMP??0,n=a>0?r/a*100:0,o=i?oa[i.dayType]:null,c={hard:"#ffe4e6",moderate:"#fef3c7",easy:"#d1fae5",rest:"#f1f5f9"},l={hard:"#fb7185",moderate:"#fbbf24",easy:"#34d399",rest:"#cbd5e1"};return e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[e.jsx("div",{className:"text-[9px] font-mono text-slate-400",children:r}),e.jsx(M.div,{initial:{height:0},animate:{height:`${Math.max(n,4)}%`},transition:{duration:.3,delay:s.dayIndex*.05},className:"w-full rounded-t-md",style:{backgroundColor:c[i?.dayType??"rest"],borderBottom:`3px solid ${l[i?.dayType??"rest"]}`}}),e.jsx("span",{className:`text-[9px] font-medium ${o?.color??"text-slate-400"}`,children:Ie(s.dayIndex)})]},s.dayIndex)})}),e.jsx("div",{className:"flex items-center gap-4 mt-3",children:Object.entries(oa).map(([s,i])=>e.jsxs("span",{className:"flex items-center gap-1 text-[9px] text-slate-400",children:[e.jsx("span",{className:`inline-block w-2 h-2 rounded-sm ${i.bgColor}`}),i.label]},s))})]})]})}function dd({assignments:t}){const a=[];for(let i=0;i<t.length-1;i++){const r=t[i].activity,n=t[i+1].activity;r&&(r.dayType==="hard"||r.dayType==="moderate")&&(n?.dayType==="rest"?a.push({afterDay:i,beforeDay:i+1,quality:"good"}):n?.dayType==="easy"?a.push({afterDay:i,beforeDay:i+1,quality:"partial"}):a.push({afterDay:i,beforeDay:i+1,quality:"none"}))}if(a.length===0)return null;const s={good:{label:"Full Recovery",color:"text-emerald-700",bgColor:"bg-emerald-50",borderColor:"border-emerald-200"},partial:{label:"Partial Recovery",color:"text-amber-700",bgColor:"bg-amber-50",borderColor:"border-amber-200"},none:{label:"No Recovery",color:"text-rose-700",bgColor:"bg-rose-50",borderColor:"border-rose-200"}};return e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsx("div",{className:"px-4 py-2.5 bg-slate-50 border-b border-slate-200",children:e.jsx("span",{className:"text-xs font-semibold text-slate-700 uppercase tracking-wider",children:"Recovery Windows"})}),e.jsx("div",{className:"p-3 space-y-2",children:a.map((i,r)=>{const n=s[i.quality];return e.jsxs("div",{className:`flex items-center gap-3 px-3 py-2 rounded-lg border ${n.borderColor} ${n.bgColor}`,children:[e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:"text-xs text-slate-600",children:["After ",e.jsx("strong",{children:Ie(i.afterDay)})," →"," ",e.jsx("strong",{children:Ie(i.beforeDay)})]})}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[10px] font-semibold ${n.color} ${n.bgColor}`,children:n.label})]},r)})})]})}function md({assignments:t,constraints:a,metrics:s,onBack:i,onNext:r}){const o=Ei(a)==="error";return e.jsxs("div",{className:"space-y-4",children:[e.jsx(nd,{assignments:t}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(od,{checks:a}),e.jsx(ld,{value:s.estimatedACWR})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(cd,{assignments:t}),e.jsx(dd,{assignments:t})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsx(ft,{label:"Total Training",value:`${s.totalTrainingMin}`,unit:"min"}),e.jsx(ft,{label:"Zone 2 Volume",value:`${s.totalZone2Min}`,unit:"min",detail:`${s.zone2Pct}% of total`}),e.jsx(ft,{label:"Running Volume",value:`${s.totalRunKm}`,unit:"km",detail:"Capped for iron protection"}),e.jsx(ft,{label:"Est. TRIMP",value:`${s.totalTRIMP}`,unit:"total",detail:`${s.hardDays} hard, ${s.easyDays} easy, ${s.restDays} rest`})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:i,className:"flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium text-slate-600 hover:bg-slate-100 transition-colors",children:[e.jsx(It,{className:"w-4 h-4"}),"Back to Arrange"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[o&&e.jsxs("span",{className:"text-xs text-rose-600 flex items-center gap-1",children:[e.jsx(oe,{className:"w-3.5 h-3.5"}),"Fix errors before proceeding"]}),e.jsxs("button",{onClick:r,disabled:o,className:`flex items-center gap-2 px-5 py-2.5 rounded-lg text-sm font-semibold transition-all
              ${o?"bg-slate-200 text-slate-400 cursor-not-allowed":"bg-slate-800 text-white hover:bg-slate-700 shadow-sm"}
            `,children:["Lock In Plan",e.jsx(U,{className:"w-4 h-4"})]})]})]})]})}function ft({label:t,value:a,unit:s,detail:i}){return e.jsxs(k,{padding:"sm",children:[e.jsx("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider",children:t}),e.jsxs("div",{className:"flex items-baseline mt-1",children:[e.jsx("span",{className:"text-xl font-semibold font-mono text-slate-800",children:a}),e.jsx("span",{className:"text-xs text-slate-400 ml-1",children:s})]}),i&&e.jsx("div",{className:"text-[10px] text-slate-400 mt-1",children:i})]})}const la={hard:{label:"Hard",color:"text-rose-700",bgColor:"bg-rose-50",icon:Bt},moderate:{label:"Moderate",color:"text-amber-700",bgColor:"bg-amber-50",icon:Ot},easy:{label:"Easy",color:"text-emerald-700",bgColor:"bg-emerald-50",icon:ot},rest:{label:"Rest",color:"text-slate-600",bgColor:"bg-slate-100",icon:X}};function is({assignments:t}){return e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsx("div",{className:"px-5 py-3 bg-slate-50 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"w-4 h-4 text-slate-500"}),e.jsx("span",{className:"text-sm font-semibold text-slate-700",children:"Your 7-Day Training Plan"})]})}),e.jsx("div",{className:"divide-y divide-slate-100",children:t.map(a=>{const s=a.activity,i=s?la[s.dayType]:null,r=i?.icon;return e.jsxs("div",{className:"px-5 py-3 flex items-center gap-4 hover:bg-slate-50/50 transition-colors",children:[e.jsxs("div",{className:"w-32 flex-shrink-0",children:[e.jsx("div",{className:"text-sm font-medium text-slate-800",children:Q(a.dayIndex)}),e.jsx("div",{className:"text-[10px] text-slate-400",children:Ie(a.dayIndex)})]}),e.jsx("div",{className:"w-24 flex-shrink-0",children:i&&r&&e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] font-semibold ${i.color} ${i.bgColor}`,children:[e.jsx(r,{className:"w-2.5 h-2.5"}),i.label]})}),e.jsx("div",{className:"flex-1 min-w-0",children:s&&s.duration>0?e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:s.label}),e.jsxs("span",{className:"text-xs text-slate-400 ml-2",children:[s.duration," min | ~",s.estimatedTRIMP," TRIMP"]})]}):e.jsx("span",{className:"text-sm text-slate-400 italic",children:"Rest — mobility only"})}),e.jsx("div",{className:"w-20 flex-shrink-0 text-right",children:s?.isRunning&&e.jsxs("span",{className:"text-[10px] text-slate-400",children:[e.jsx(ot,{className:"w-3 h-3 inline mr-1"}),"Running"]})})]},a.dayIndex)})})]})}function rs({metrics:t}){const a=[{label:"Total Training",value:`${t.totalTrainingMin}`,unit:"min",detail:`${t.hardDays} hard, ${t.easyDays} easy, ${t.moderateDays} moderate, ${t.restDays} rest`},{label:"Zone 2 Volume",value:`${t.totalZone2Min}`,unit:"min/wk",detail:`${t.zone2Pct}% of training is Zone 2`},{label:"Running Volume",value:`${t.totalRunKm}`,unit:"km",detail:"Capped at 35 km/wk for iron protection"},{label:"Est. ACWR",value:`${t.estimatedACWR}`,unit:"ratio",detail:"Target: 0.8–1.2 (from 0.93 current)"}];return e.jsx("div",{className:"grid grid-cols-4 gap-4",children:a.map(s=>e.jsxs(k,{padding:"sm",children:[e.jsx("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider",children:s.label}),e.jsxs("div",{className:"flex items-baseline mt-1",children:[e.jsx("span",{className:"text-xl font-semibold font-mono text-slate-800",children:s.value}),e.jsx("span",{className:"text-xs text-slate-400 ml-1",children:s.unit})]}),e.jsx("div",{className:"text-[10px] text-slate-400 mt-1",children:s.detail})]},s.label))})}function ud({onStartOver:t}){return e.jsxs(M.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3},className:"text-center py-8",children:[e.jsx(M.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:300,damping:20,delay:.1},children:e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-emerald-50 mb-4",children:e.jsx(Ne,{className:"w-8 h-8 text-emerald-600"})})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Plan Locked In"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1 max-w-md mx-auto",children:`Your weekly training plan has been set. Daily protocols will auto-adjust schedule blocks based on your arrangement. Check the "Today's Plan" tab for your updated daily view.`}),e.jsxs("button",{onClick:t,className:"mt-6 inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 transition-colors",children:[e.jsx(js,{className:"w-3.5 h-3.5"}),"Plan Another Week"]})]})}function hd({assignments:t,metrics:a,locked:s,onLockIn:i,onBack:r,onStartOver:n}){return e.jsx("div",{className:"space-y-4",children:e.jsx(re,{mode:"wait",children:s?e.jsxs(M.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[e.jsx(ud,{onStartOver:n}),e.jsx("div",{className:"mt-4",children:e.jsx(is,{assignments:t})}),e.jsx("div",{className:"mt-4",children:e.jsx(rs,{metrics:a})})]},"success"):e.jsxs(M.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[e.jsx(k,{padding:"md",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-8 h-8 rounded-full bg-slate-100",children:e.jsx(Ae,{className:"w-4 h-4 text-slate-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Ready to Lock In?"}),e.jsx("p",{className:"text-[11px] text-slate-500",children:"Review your finalized plan below. Once locked, daily schedule blocks will be auto-adjusted to match this arrangement."})]})]})}),e.jsx("div",{className:"mt-4",children:e.jsx(is,{assignments:t})}),e.jsx("div",{className:"mt-4",children:e.jsx(rs,{metrics:a})}),e.jsx("div",{className:"mt-4",children:e.jsxs(k,{padding:"md",children:[e.jsx("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider mb-3",children:"Load Distribution"}),e.jsx("div",{className:"flex items-center gap-2",children:t.map(o=>{const c=o.activity,l={hard:"h-20",moderate:"h-14",easy:"h-10",rest:"h-4"},d=c?la[c.dayType]:null;return e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[e.jsx("div",{className:`w-full rounded-t-md ${l[c?.dayType??"rest"]} ${d?.bgColor??"bg-slate-100"}`,style:{borderBottom:"3px solid #5ba8d4"}}),e.jsx("span",{className:"text-[9px] text-slate-400",children:Ie(o.dayIndex)})]},o.dayIndex)})}),e.jsx("div",{className:"flex items-center gap-4 mt-2",children:Object.entries(la).map(([o,c])=>e.jsxs("span",{className:"flex items-center gap-1 text-[9px] text-slate-400",children:[e.jsx("span",{className:`inline-block w-2 h-2 rounded-sm ${c.bgColor}`}),c.label]},o))})]})}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium text-slate-600 hover:bg-slate-100 transition-colors",children:[e.jsx(It,{className:"w-4 h-4"}),"Back to Review"]}),e.jsxs("button",{onClick:i,className:"flex items-center gap-2 px-6 py-2.5 rounded-lg text-sm font-semibold bg-emerald-600 text-white hover:bg-emerald-700 shadow-sm transition-all",children:[e.jsx(Ns,{className:"w-4 h-4"}),"Lock In Plan"]})]})]},"confirm")})})}const ns=[{id:"arrange",label:"Arrange"},{id:"review",label:"Review"},{id:"lockin",label:"Lock In"}];function pd(){const[t,a]=g.useState("arrange"),[s,i]=g.useState(Array(7).fill(null)),[r,n]=g.useState(!1),o=Kc(s),c=Xc(o),l=Qc(o),d=Jc(o),u=ad(o),m=ns.findIndex(f=>f.id===t),h=ns.map((f,j)=>({label:f.label,completed:j<m||r,active:j===m})),p=g.useCallback((f,j)=>{i(N=>{const S=[...N];if(j){const R=S.indexOf(j);R!==-1&&R!==f&&(S[R]=S[f])}return S[f]=j,S})},[]),b=g.useCallback(f=>{i(j=>{const N=[...j];return N[f]=null,N})},[]),y=g.useCallback(()=>{i([...qc])},[]),w=g.useCallback(()=>{i(Array(7).fill(null))},[]),v=g.useCallback(()=>{n(!0)},[]),_=g.useCallback(()=>{n(!1),a("arrange")},[]);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-72",children:e.jsx(_a,{steps:h,size:"md",showLabels:!0})})}),e.jsx(re,{mode:"wait",children:e.jsxs(M.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.15},children:[t==="arrange"&&e.jsx(rd,{assignments:o,unassigned:c,allPlaced:l,onAssign:p,onRemove:b,onLoadDefault:y,onReset:w,onNext:()=>a("review")}),t==="review"&&e.jsx(md,{assignments:o,constraints:d,metrics:u,onBack:()=>a("arrange"),onNext:()=>a("lockin")}),t==="lockin"&&e.jsx(hd,{assignments:o,metrics:u,locked:r,onLockIn:v,onBack:()=>a("review"),onStartOver:_})]},t)})]})}function gd({trajectory:t,goalValue:a,currentWeek:s,currentUnit:i,height:r=200}){if(!t||t.length===0)return null;const n=t.map(o=>({week:o.weekNumber,expected:o.expectedValue,rangeLow:o.rangeLow,rangeHigh:o.rangeHigh,label:o.label,range:[o.rangeLow,o.rangeHigh]}));return e.jsx("div",{className:"w-full",style:{height:r},children:e.jsx(nt,{width:"100%",height:"100%",children:e.jsxs(_s,{data:n,margin:{top:10,right:10,left:0,bottom:5},children:[e.jsx(Et,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),e.jsx(Wt,{dataKey:"week",tick:{fontSize:10,fill:"#94a3b8"},label:{value:"Week",position:"insideBottom",offset:-2,fontSize:10,fill:"#94a3b8"}}),e.jsx(Ht,{tick:{fontSize:10,fill:"#94a3b8"},label:{value:i,angle:-90,position:"insideLeft",offset:10,fontSize:10,fill:"#94a3b8"},domain:["auto","auto"]}),e.jsx(Vt,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"11px",padding:"8px 12px"},formatter:(o,c)=>c==="expected"?[`${o} ${i}`,"Expected"]:c==="rangeHigh"?[`${o} ${i}`,"High"]:c==="rangeLow"?[`${o} ${i}`,"Low"]:[o,c],labelFormatter:o=>`Week ${o}`}),e.jsx(Pe,{type:"monotone",dataKey:"rangeHigh",stackId:"range",stroke:"none",fill:"transparent"}),e.jsx(Pe,{type:"monotone",dataKey:"rangeLow",stackId:"range-base",stroke:"none",fill:"transparent"}),e.jsx(Pe,{type:"monotone",dataKey:"rangeHigh",stroke:"none",fill:"#5ba8d4",fillOpacity:.1}),e.jsx(Pe,{type:"monotone",dataKey:"rangeLow",stroke:"none",fill:"#ffffff",fillOpacity:.8}),e.jsx(Pe,{type:"monotone",dataKey:"expected",stroke:"#5ba8d4",strokeWidth:2,fill:"#5ba8d4",fillOpacity:.08,dot:o=>{const{cx:c,cy:l,payload:d}=o;return d.label?e.jsx("circle",{cx:c,cy:l,r:4,fill:"#5ba8d4",stroke:"#fff",strokeWidth:2},`dot-${c}`):e.jsx("circle",{cx:0,cy:0,r:0,fill:"none"},`dot-${c}`)}}),e.jsx(Ve,{y:a,stroke:"#10b981",strokeDasharray:"6 3",strokeWidth:1.5,label:{value:`Goal: ${a}`,position:"right",fontSize:10,fill:"#10b981"}}),s!==void 0&&e.jsx(Ve,{x:s,stroke:"#f59e0b",strokeDasharray:"4 2",strokeWidth:1.5,label:{value:"Now",position:"top",fontSize:10,fill:"#f59e0b"}})]})})})}function Gt({strategy:t,className:a=""}){return t==="maintain"?e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] font-semibold text-emerald-700 bg-emerald-50 ${a}`,children:[e.jsx(Oe,{className:"w-2.5 h-2.5"}),"Maintain"]}):e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] font-semibold text-orange-700 bg-orange-50 ${a}`,children:[e.jsx(de,{className:"w-2.5 h-2.5"}),"Recover"]})}const xd={active:{label:"Active",color:"text-emerald-700",bgColor:"bg-emerald-50"},planned:{label:"Planned",color:"text-blue-700",bgColor:"bg-blue-50"},completed:{label:"Completed",color:"text-slate-600",bgColor:"bg-slate-100"},paused:{label:"Paused",color:"text-amber-700",bgColor:"bg-amber-50"}},bd={high:{label:"High Confidence",color:"text-emerald-700",bgColor:"bg-emerald-50"},medium:{label:"Medium Confidence",color:"text-amber-700",bgColor:"bg-amber-50"},low:{label:"Low Confidence",color:"text-slate-600",bgColor:"bg-slate-100"}};function os({campaign:t}){const[a,s]=g.useState(!1),i=xd[t.status],r=bd[t.confidence],n=t.phases.find(l=>l.id===t.activePhaseId),o=t.estimatedDurationWeeks>0&&t.currentWeek!==void 0?Math.min(100,Math.round(t.currentWeek/t.estimatedDurationWeeks*100)):0,c=t.phases.map(l=>({label:l.name,completed:t.activePhaseId?t.phases.findIndex(d=>d.id===t.activePhaseId)>t.phases.findIndex(d=>d.id===l.id):!1,active:l.id===t.activePhaseId}));return e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsx("div",{className:"px-5 py-3 border-b cursor-pointer hover:bg-slate-50/50 transition-colors",style:{borderColor:"#5ba8d420"},onClick:()=>s(!a),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-800",children:t.name}),e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-semibold ${i.color} ${i.bgColor}`,children:i.label}),e.jsx(Gt,{strategy:"recover"})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-lg font-semibold font-mono text-slate-800",children:t.currentValue}),e.jsx(ve,{className:"w-3.5 h-3.5 text-slate-400"}),e.jsx("span",{className:"text-lg font-semibold font-mono text-emerald-600",children:t.goalValue}),e.jsx("span",{className:"text-xs text-slate-400",children:t.currentUnit}),t.currentWeek!==void 0&&e.jsxs("span",{className:"text-[10px] text-slate-400 ml-2",children:["Week ",t.currentWeek," of ",t.estimatedDurationWeeks]})]}),e.jsx("div",{className:"w-full bg-slate-100 rounded-full h-1.5 mb-2",children:e.jsx("div",{className:"h-1.5 rounded-full bg-blue-400 transition-all",style:{width:`${o}%`}})}),e.jsx(_a,{steps:c,size:"sm",showLabels:!0}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-semibold ${r.color} ${r.bgColor}`,children:r.label}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:[t.estimatedDurationWeeks," weeks | ",t.phases.length," phases |"," ",t.checkpoints.length," checkpoints"]})]})]}),e.jsx(U,{className:`w-4 h-4 text-slate-400 transition-transform flex-shrink-0 mt-1 ${a?"rotate-90":""}`})]})}),a&&e.jsxs(M.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{duration:.15},children:[e.jsxs("div",{className:"px-5 py-3 border-b border-slate-100",children:[e.jsx("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider mb-2",children:"Projected Trajectory"}),e.jsx(gd,{trajectory:t.trajectory,goalValue:t.goalValue,currentWeek:t.currentWeek,currentUnit:t.currentUnit,height:180})]}),n&&e.jsxs("div",{className:"px-5 py-3 border-b border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(_t,{className:"w-3.5 h-3.5 text-blue-500"}),e.jsxs("span",{className:"text-[10px] font-semibold text-slate-700 uppercase tracking-wider",children:["Active Phase: ",n.name," (Weeks ",n.weekRange[0],"–",n.weekRange[1],")"]})]}),e.jsx("p",{className:"text-sm text-slate-600 mb-3",children:n.goal}),e.jsx("div",{className:"space-y-1.5",children:n.dailyActions.map(l=>e.jsxs("div",{className:"flex items-start gap-2 p-2 bg-slate-50 rounded-lg",children:[e.jsx(tt,{className:"w-3 h-3 text-emerald-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-700",children:l.action}),e.jsx("span",{className:"text-[9px] text-slate-400",children:l.frequency})]}),l.timing&&e.jsxs("div",{className:"flex items-center gap-1 mt-0.5 text-[10px] text-slate-400",children:[e.jsx(pe,{className:"w-2 h-2"}),l.timing]}),l.detail&&e.jsx("p",{className:"text-[10px] text-slate-400 mt-0.5",children:l.detail})]})]},l.id))}),n.constraints&&n.constraints.length>0&&e.jsx("div",{className:"mt-3 space-y-1",children:n.constraints.map((l,d)=>e.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] text-amber-600",children:[e.jsx(le,{className:"w-2.5 h-2.5 flex-shrink-0"}),l]},d))})]}),e.jsxs("div",{className:"px-5 py-3 border-b border-slate-100",children:[e.jsx("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider mb-2",children:"All Phases"}),e.jsx("div",{className:"space-y-1.5",children:t.phases.map(l=>{const d=l.id===t.activePhaseId,u=t.activePhaseId?t.phases.findIndex(m=>m.id===t.activePhaseId)>t.phases.findIndex(m=>m.id===l.id):!1;return e.jsxs("div",{className:`flex items-center gap-3 px-2.5 py-1.5 rounded-md text-xs ${d?"bg-blue-50 border border-blue-200":u?"bg-emerald-50/50 border border-emerald-100":"bg-white border border-slate-200"}`,children:[u?e.jsx(tt,{className:"w-3 h-3 text-emerald-500 flex-shrink-0"}):d?e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-400 ring-2 ring-blue-100 flex-shrink-0"}):e.jsx("div",{className:"w-3 h-3 rounded-full border border-slate-300 flex-shrink-0"}),e.jsx("span",{className:`font-medium ${d?"text-blue-800":u?"text-emerald-700":"text-slate-600"}`,children:l.name}),e.jsxs("span",{className:"text-slate-400 text-[10px]",children:["Weeks ",l.weekRange[0],"–",l.weekRange[1]]}),e.jsxs("span",{className:"text-slate-400 text-[10px] ml-auto",children:[l.goal.slice(0,60),l.goal.length>60?"...":""]})]},l.id)})})]}),e.jsxs("div",{className:"px-5 py-3 border-b border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(_e,{className:"w-3.5 h-3.5 text-slate-400"}),e.jsx("span",{className:"text-[10px] text-slate-400 uppercase tracking-wider",children:"Checkpoints"})]}),e.jsx("div",{className:"space-y-1.5",children:t.checkpoints.map(l=>{const d=t.currentWeek!==void 0&&l.weekNumber<=t.currentWeek;return e.jsxs("div",{className:`flex items-start gap-2.5 p-2 rounded-lg ${d?"bg-emerald-50/50":"bg-slate-50"}`,children:[e.jsx(Fe,{className:`w-3 h-3 mt-0.5 flex-shrink-0 ${d?"text-emerald-500":"text-slate-400"}`}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsxs("span",{className:"text-xs font-medium text-slate-700",children:["Week ",l.weekNumber,": ",l.description]})}),e.jsxs("div",{className:"text-[10px] text-slate-400 mt-0.5",children:[l.metric,l.targetValue!==void 0?` target: ${l.targetValue}`:""," |"," ",l.action]})]})]},l.id)})})]}),e.jsxs("div",{className:"px-5 py-3",children:[e.jsx("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider mb-1",children:"Reasoning"}),e.jsx("p",{className:"text-xs text-slate-500 leading-relaxed",children:t.reasoning})]})]})]})}const fd={immediate:{label:"Immediate",color:"text-rose-700",bgColor:"bg-rose-50"},days:{label:"Days",color:"text-amber-700",bgColor:"bg-amber-50"},weeks:{label:"Weeks",color:"text-blue-700",bgColor:"bg-blue-50"},months:{label:"Months",color:"text-violet-700",bgColor:"bg-violet-50"}},yd={sleep:"#b8aadd",training:"#5ba8d4",recovery:"#e99bbe",nutrition:"#f59e0b",medical:"#ef4444"};function vd({levers:t,loadLabel:a,decreaseIsGood:s=!0}){return!t||t.length===0?null:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider mb-2",children:["What Moves ",a]}),e.jsx("div",{className:"space-y-2",children:t.map(i=>{const r=fd[i.timeConstant],n=s&&i.effect.direction==="decrease"||!s&&i.effect.direction==="increase",o=i.effect.direction==="decrease"?vr:wr,c=n?"text-emerald-600":"text-rose-600",l=n?"bg-emerald-50":"bg-rose-50";return e.jsx("div",{className:"p-2.5 bg-slate-50 rounded-lg border border-slate-100",children:e.jsxs("div",{className:"flex items-start gap-2.5",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full mt-1.5 flex-shrink-0",style:{backgroundColor:yd[i.category]??"#94a3b8"}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-700",children:i.action}),e.jsxs("div",{className:`flex items-center gap-1 px-1.5 py-0.5 rounded ${l} flex-shrink-0`,children:[e.jsx(o,{className:`w-2.5 h-2.5 ${c}`}),e.jsxs("span",{className:`text-[10px] font-semibold ${c}`,children:[i.effect.magnitude," ",i.effect.unit]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[e.jsxs("span",{className:`inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded-full text-[9px] font-semibold ${r.color} ${r.bgColor}`,children:[e.jsx(pe,{className:"w-2 h-2"}),r.label]}),e.jsx("span",{className:"text-[9px] text-slate-400 truncate",children:i.evidenceSource})]}),i.prerequisites&&i.prerequisites.length>0&&e.jsxs("div",{className:"flex items-center gap-1 mt-1.5 text-[10px] text-amber-600",children:[e.jsx(le,{className:"w-2.5 h-2.5 flex-shrink-0"}),"Requires: ",i.prerequisites.join(", ")]})]})]})},i.id)})})]})}const wd=[{id:"daily",label:"Today's Plan"},{id:"weekly",label:"Weekly View"},{id:"protocols",label:"All Protocols"},{id:"campaigns",label:"Campaigns"},{id:"wizard",label:"Plan Your Week"}],Ma={sleep:{color:"#b8aadd",bgColor:"bg-violet-50",borderColor:"border-violet-200",icon:X},training:{color:"#5ba8d4",bgColor:"bg-blue-50",borderColor:"border-blue-200",icon:z},recovery:{color:"#e99bbe",bgColor:"bg-pink-50",borderColor:"border-pink-200",icon:ke},nutrition:{color:"#f59e0b",bgColor:"bg-amber-50",borderColor:"border-amber-200",icon:ks}},jd={high:{label:"High Confidence",color:"text-emerald-700",bgColor:"bg-emerald-50"},medium:{label:"Medium Confidence",color:"text-amber-700",bgColor:"bg-amber-50"},low:{label:"Low Confidence",color:"text-slate-600",bgColor:"bg-slate-100"}},Je={hard:{label:"Hard",color:"text-rose-700",bgColor:"bg-rose-50",icon:Bt},moderate:{label:"Moderate",color:"text-amber-700",bgColor:"bg-amber-50",icon:Ot},easy:{label:"Easy",color:"text-emerald-700",bgColor:"bg-emerald-50",icon:ot},rest:{label:"Rest",color:"text-slate-600",bgColor:"bg-slate-100",icon:X}},Nd={recovery:["iron-depletion","training-load"],training:["training-load"],nutrition:["omega3-status","iron-depletion"]};function _d({day:t}){const a=Je[t.dayType],s=a.icon;return e.jsxs("div",{className:"space-y-6",children:[e.jsx(k,{padding:"md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-800",children:[t.dayOfWeek,", ",Hi(t.date)]}),e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-semibold ${a.color} ${a.bgColor}`,children:[e.jsx(s,{className:"w-3 h-3"}),a.label," Day"]})]}),e.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:["Sleep target: ",t.sleepTarget.duration,"h (",t.sleepTarget.bedtime," →"," ",t.sleepTarget.wakeTime,")",t.trainingTarget?` | Training: ${t.trainingTarget.type} (${t.trainingTarget.duration} min)`:" | No training scheduled"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:"text-sm text-slate-500",children:"Updated now"})]})]})}),t.campaignActions&&t.campaignActions.length>0&&e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsx("div",{className:"px-5 py-3 border-b",style:{backgroundColor:"#f59e0b12",borderColor:"#f59e0b30"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4 text-orange-500"}),e.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Campaign Actions"}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:[t.campaignActions.length," active campaign",t.campaignActions.length!==1?"s":""]})]})}),e.jsx("div",{className:"p-4 space-y-3",children:t.campaignActions.map(i=>e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Gt,{strategy:"recover"}),e.jsx("span",{className:"text-xs font-semibold text-slate-700",children:i.campaignName}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:["Phase: ",i.phaseName]})]}),e.jsx("div",{className:"pl-4 space-y-1",children:i.actions.map((r,n)=>e.jsxs("div",{className:"flex items-start gap-2 text-xs text-slate-600",children:[e.jsx(U,{className:"w-3 h-3 mt-0.5 flex-shrink-0 text-orange-400"}),r]},n))})]},i.campaignId))})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Kt,{title:"Morning",items:t.morningBlock,accent:"#5ba8d4"}),e.jsx(Kt,{title:"Afternoon",items:t.afternoonBlock,accent:"#f59e0b"}),e.jsx(Kt,{title:"Evening",items:t.eveningBlock,accent:"#b8aadd"})]}),t.trainingTarget&&e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsx("div",{className:"px-5 py-3 border-b",style:{backgroundColor:"#5ba8d418",borderColor:"#5ba8d440"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4",style:{color:"#5ba8d4"}}),e.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Training Detail"})]})}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider",children:"Type"}),e.jsx("div",{className:"text-sm font-semibold font-mono text-slate-800",children:t.trainingTarget.type})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider",children:"Duration"}),e.jsxs("div",{className:"text-sm font-semibold font-mono text-slate-800",children:[t.trainingTarget.duration," min"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider",children:"Intensity"}),e.jsx("div",{className:"text-sm font-semibold font-mono text-slate-800",children:t.trainingTarget.intensity})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider",children:"Window"}),e.jsx("div",{className:"text-sm font-semibold font-mono text-slate-800",children:t.trainingTarget.window})]})]}),e.jsx("p",{className:"text-sm text-slate-600",children:t.trainingTarget.notes})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(ls,{title:"Recovery Notes",items:t.recoveryNotes,icon:e.jsx(ke,{className:"w-4 h-4",style:{color:"#e99bbe"}}),accent:"#e99bbe"}),e.jsx(ls,{title:"Nutrition Notes",items:t.nutritionNotes,icon:e.jsx(ks,{className:"w-4 h-4",style:{color:"#f59e0b"}}),accent:"#f59e0b"})]})]})}function Kt({title:t,items:a,accent:s}){const i={sleep:"#b8aadd",training:"#5ba8d4",recovery:"#e99bbe",nutrition:"#f59e0b",routine:"#94a3b8"};return e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsx("div",{className:"px-4 py-2.5 border-b",style:{backgroundColor:s+"12",borderColor:s+"30"},children:e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:s},children:t})}),e.jsx("div",{className:"p-3 space-y-2",children:a.map((r,n)=>e.jsxs("div",{className:"flex items-start gap-2.5",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full mt-1.5 flex-shrink-0",style:{backgroundColor:i[r.category]??"#94a3b8"}}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-[10px] font-mono text-slate-400 flex-shrink-0",children:r.time}),e.jsx("span",{className:"text-xs font-medium text-slate-700",children:r.action})]}),r.detail&&e.jsx("p",{className:"text-[10px] text-slate-400 mt-0.5",children:r.detail})]})]},n))})]})}function ls({title:t,items:a,icon:s,accent:i}){return e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-2.5 border-b flex items-center gap-2",style:{backgroundColor:i+"12",borderColor:i+"30"},children:[s,e.jsx("span",{className:"text-xs font-semibold text-slate-700",children:t})]}),e.jsx("div",{className:"p-4",children:e.jsx("ul",{className:"space-y-2",children:a.map((r,n)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-slate-600",children:[e.jsx(U,{className:"w-3 h-3 mt-0.5 flex-shrink-0",style:{color:i}}),r]},n))})})]})}function kd(){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsx(yt,{label:"Total Training",value:`${ue.totalTrainingMin}`,unit:"min",detail:`${ue.hardDays} hard, ${ue.easyDays} easy, ${ue.moderateDays} moderate, ${ue.restDays} rest`}),e.jsx(yt,{label:"Zone 2 Volume",value:`${ue.totalZone2Min}`,unit:"min/wk",detail:`${ue.Zone2Pct}% of training is Zone 2`}),e.jsx(yt,{label:"Running Volume",value:`${ue.totalRunKm}`,unit:"km",detail:"Capped at 35 km/wk for iron protection"}),e.jsx(yt,{label:"Est. ACWR",value:`${ue.estimatedACWR}`,unit:"ratio",detail:"Target: 0.8–1.2 (from 0.93 current)"})]}),e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsx("div",{className:"px-5 py-3 bg-slate-50 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"w-4 h-4 text-slate-500"}),e.jsx("span",{className:"text-sm font-semibold text-slate-700",children:"7-Day Training Plan"})]})}),e.jsx("div",{className:"divide-y divide-slate-100",children:Dt.map(t=>{const a=Je[t.dayType],s=a.icon;return e.jsxs("div",{className:"px-5 py-3 flex items-center gap-4 hover:bg-slate-50/50 transition-colors",children:[e.jsxs("div",{className:"w-32 flex-shrink-0",children:[e.jsx("div",{className:"text-sm font-medium text-slate-800",children:t.dayOfWeek}),e.jsx("div",{className:"text-[10px] text-slate-400",children:Hi(t.date)})]}),e.jsx("div",{className:"w-24 flex-shrink-0",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] font-semibold ${a.color} ${a.bgColor}`,children:[e.jsx(s,{className:"w-2.5 h-2.5"}),a.label]})}),e.jsx("div",{className:"flex-1 min-w-0",children:t.trainingTarget?e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:t.trainingTarget.type}),e.jsxs("span",{className:"text-xs text-slate-400 ml-2",children:[t.trainingTarget.duration," min | ",t.trainingTarget.zone," |"," ",t.trainingTarget.window]})]}):e.jsx("span",{className:"text-sm text-slate-400 italic",children:"Rest — mobility only"})}),e.jsxs("div",{className:"w-28 flex-shrink-0 text-right",children:[e.jsx("div",{className:"text-xs text-slate-400",children:"Sleep"}),e.jsxs("div",{className:"text-sm font-mono font-medium text-slate-700",children:[t.sleepTarget.duration,"h"]})]})]},t.date)})})]}),e.jsxs(k,{padding:"md",children:[e.jsx("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider mb-3",children:"Weekly Load Distribution"}),e.jsx("div",{className:"flex items-center gap-2 mb-2",children:Dt.map(t=>{const a=Je[t.dayType],s={hard:"h-20",moderate:"h-14",easy:"h-10",rest:"h-4"};return e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[e.jsx("div",{className:`w-full rounded-t-md ${s[t.dayType]} ${a.bgColor}`,style:{borderBottom:`3px solid ${Ma.training.color}`}}),e.jsx("span",{className:"text-[9px] text-slate-400",children:t.dayOfWeek.slice(0,3)})]},t.date)})}),e.jsx("div",{className:"flex items-center gap-4 mt-2",children:Object.entries(Je).map(([t,a])=>e.jsxs("span",{className:"flex items-center gap-1 text-[9px] text-slate-400",children:[e.jsx("span",{className:`inline-block w-2 h-2 rounded-sm ${a.bgColor}`}),a.label]},t))})]})]})}function yt({label:t,value:a,unit:s,detail:i}){return e.jsxs(k,{padding:"sm",children:[e.jsx("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider",children:t}),e.jsxs("div",{className:"flex items-baseline mt-1",children:[e.jsx("span",{className:"text-xl font-semibold font-mono text-slate-800",children:a}),e.jsx("span",{className:"text-xs text-slate-400 ml-1",children:s})]}),e.jsx("div",{className:"text-[10px] text-slate-400 mt-1",children:i})]})}function Cd(){const t={sleep:bt.filter(i=>i.category==="sleep"),training:bt.filter(i=>i.category==="training"),recovery:bt.filter(i=>i.category==="recovery"),nutrition:bt.filter(i=>i.category==="nutrition")},a=(J.loads??[]).filter(i=>i.strategy==="recover"),s=new Set(a.map(i=>i.id));return e.jsx("div",{className:"space-y-8",children:Object.entries(t).map(([i,r])=>{if(r.length===0)return null;const n=Ma[i],o=n.icon,l=(Nd[i]??[]).filter(d=>s.has(d)).length>0;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"p-1.5 rounded-md",style:{backgroundColor:n.color+"18"},children:e.jsx(o,{className:"w-4 h-4",style:{color:n.color}})}),e.jsxs("h3",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wider",children:[i," Protocols"]}),e.jsxs("span",{className:"text-xs text-slate-400",children:["(",r.length,")"]}),l&&e.jsx(Gt,{strategy:"recover"})]}),e.jsx("div",{className:"space-y-4",children:r.map(d=>e.jsx(Sd,{protocol:d},d.id))})]},i)})})}function Sd({protocol:t}){const[a,s]=g.useState(!1),i=Ma[t.category],r=jd[t.confidence],n=new Set,o=J.loads??[];for(const d of t.sourceInsights)for(const u of o)u.affectedInsightIds?.includes(d.insightId)&&n.add(u.id);const c=Array.from(n).flatMap(d=>o.find(m=>m.id===d)?.levers??zs[d]??[]),l=Array.from(n).map(d=>o.find(u=>u.id===d)?.label??d).join(" / ");return e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsx("div",{className:"px-5 py-3 border-b cursor-pointer",style:{backgroundColor:i.color+"08",borderColor:i.color+"20"},onClick:()=>s(!a),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("h4",{className:"text-sm font-semibold text-slate-800",children:t.recommendation})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-semibold ${r.color} ${r.bgColor}`,children:r.label}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:["Target: ",t.target.value," ",t.target.unit,t.target.range&&e.jsxs(e.Fragment,{children:[" (range: ",t.target.range[0],"–",t.target.range[1],")"]})]}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:[t.sourceInsights.length," source insight",t.sourceInsights.length!==1?"s":""]})]})]}),e.jsx(U,{className:`w-4 h-4 text-slate-400 transition-transform flex-shrink-0 mt-1 ${a?"rotate-90":""}`})]})}),a&&e.jsxs(M.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{duration:.15},children:[e.jsx("div",{className:"px-5 py-3 border-b border-slate-100",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Lt,{className:"w-3.5 h-3.5 text-slate-400 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:t.reasoning})]})}),e.jsxs("div",{className:"px-5 py-3 border-b border-slate-100",children:[e.jsx("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider mb-2",children:"Source Insights"}),e.jsx("div",{className:"space-y-2",children:t.sourceInsights.map(d=>e.jsxs("div",{className:"flex items-start gap-3 p-2.5 bg-slate-50 rounded-lg",children:[e.jsx(Fe,{className:"w-3.5 h-3.5 text-slate-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-700",children:d.title}),e.jsx("span",{className:"text-[10px] font-mono text-slate-400",children:d.insightId})]}),e.jsx("div",{className:"text-[10px] text-slate-500 mt-0.5",children:d.contribution}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-[10px] text-slate-400",children:[e.jsxs("span",{children:["Threshold: ",d.theta," ",d.thetaUnit]}),e.jsx("span",{children:"|"}),e.jsxs("span",{children:["Personal weight: ",(d.personalWeight*100).toFixed(0),"%"]}),e.jsx("span",{children:"|"}),e.jsxs("span",{children:[d.observations.toLocaleString()," observations"]})]})]})]},d.insightId))})]}),c.length>0&&e.jsx("div",{className:"px-5 py-3 border-b border-slate-100",children:e.jsx(vd,{levers:c,loadLabel:l})}),t.conflictResolution&&e.jsx(Td,{resolution:t.conflictResolution})]})]})}function Td({resolution:t}){return e.jsxs("div",{className:"px-5 py-3 bg-amber-50/40 border-t border-amber-100/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(le,{className:"w-3.5 h-3.5 text-amber-600"}),e.jsx("span",{className:"text-[10px] font-semibold text-amber-700 uppercase tracking-wider",children:"Conflict Resolution"})]}),e.jsx("p",{className:"text-sm text-slate-600 mb-3",children:t.description}),e.jsx("div",{className:"space-y-1.5 mb-3",children:t.insights.map(a=>{const s=a.id===t.winner;return e.jsxs("div",{className:`flex items-center gap-2 px-2.5 py-1.5 rounded-md text-xs ${s?"bg-emerald-50 border border-emerald-200":"bg-white border border-slate-200"}`,children:[s?e.jsx(Ne,{className:"w-3 h-3 text-emerald-600 flex-shrink-0"}):e.jsx("div",{className:"w-3 h-3 rounded-full border border-slate-300 flex-shrink-0"}),e.jsx("span",{className:`font-medium ${s?"text-emerald-800":"text-slate-700"}`,children:a.title}),e.jsxs("span",{className:"text-slate-400 ml-auto",children:["suggests ",a.suggests]}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:["(",(a.weight*100).toFixed(0),"% personal)"]})]},a.id)})}),e.jsxs("div",{className:"flex items-start gap-2 px-2.5 py-2 bg-white rounded-md border border-slate-200",children:[e.jsx(Oe,{className:"w-3 h-3 text-slate-400 mt-0.5 flex-shrink-0"}),e.jsxs("span",{className:"text-[10px] text-slate-500",children:[e.jsx("strong",{className:"text-slate-600",children:"Rule applied:"})," ",t.rule]})]})]})}function Md(){const t=J.loads??[],a=wt.filter(i=>i.status==="active"),s=wt.filter(i=>i.status==="planned");return e.jsxs("div",{className:"space-y-8",children:[a.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"p-1.5 rounded-md bg-emerald-50",children:e.jsx(de,{className:"w-4 h-4 text-emerald-600"})}),e.jsx("h3",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wider",children:"Active Campaigns"}),e.jsxs("span",{className:"text-xs text-slate-400",children:["(",a.length,")"]})]}),e.jsx("div",{className:"space-y-4",children:a.map(i=>e.jsx(os,{campaign:i},i.id))})]}),s.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"p-1.5 rounded-md bg-blue-50",children:e.jsx(_e,{className:"w-4 h-4 text-blue-600"})}),e.jsx("h3",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wider",children:"Planned Campaigns"}),e.jsxs("span",{className:"text-xs text-slate-400",children:["(",s.length,")"]})]}),e.jsx("div",{className:"space-y-4",children:s.map(i=>e.jsx(os,{campaign:i},i.id))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"p-1.5 rounded-md bg-slate-100",children:e.jsx(z,{className:"w-4 h-4 text-slate-500"})}),e.jsx("h3",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wider",children:"Load Overview"})]}),e.jsx(k,{padding:"none",className:"overflow-hidden",children:e.jsx("div",{className:"divide-y divide-slate-100",children:t.map(i=>{const r=i.levers?.length??zs[i.id]?.length??0,n=wt.some(o=>o.loadId===i.id);return e.jsxs("div",{className:"px-5 py-3 flex items-center gap-4 hover:bg-slate-50/50 transition-colors",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-800",children:i.label}),i.strategy&&e.jsx(Gt,{strategy:i.strategy}),n&&e.jsx("span",{className:"text-[10px] text-blue-500 font-medium",children:"Has campaign"})]}),e.jsx("div",{className:"text-[10px] text-slate-400 mt-0.5",children:i.detail})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsxs("div",{className:"text-sm font-mono font-semibold text-slate-800",children:[i.value,i.unit]}),i.targetRange&&e.jsxs("div",{className:"text-[10px] text-slate-400",children:["Target: ",i.targetRange[0],"–",i.targetRange[1]," ",i.targetUnit]})]}),e.jsxs("div",{className:"text-right flex-shrink-0 w-16",children:[e.jsxs("div",{className:"text-[10px] text-slate-400",children:[r," levers"]}),e.jsx("div",{className:`text-[10px] font-medium ${i.status==="critical"?"text-rose-600":i.status==="high"?"text-amber-600":i.status==="moderate"?"text-blue-600":"text-emerald-600"}`,children:i.status})]})]},i.id)})})})]})]})}function Hi(t){return new Date(t+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}function Rd(){const[t,a]=g.useState("daily"),[s,i]=g.useState(0),r=Dt[s];return e.jsxs(Z,{title:"Synthesized Protocols",subtitle:"Actionable daily protocols derived from Oron's 20 Bayesian insights — conflicts resolved, sources traced",children:[e.jsx("div",{className:"flex items-center gap-1 mb-6 border-b border-slate-200",children:wd.map(n=>e.jsx("button",{onClick:()=>a(n.id),className:`px-4 py-2.5 text-sm font-medium transition-colors border-b-2 ${t===n.id?"text-slate-800 border-slate-800":"text-slate-500 border-transparent hover:text-slate-700 hover:border-slate-300"}`,children:n.label},n.id))}),e.jsxs(M.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.15},children:[t==="daily"&&e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-1 mb-4 overflow-x-auto",children:Dt.map((n,o)=>{const c=o===s,l=Je[n.dayType];return e.jsxs("button",{onClick:()=>i(o),className:`px-3 py-2 rounded-lg text-xs font-medium transition-all flex-shrink-0 ${c?"bg-white border border-slate-200 shadow-sm text-slate-800":"text-slate-500 hover:bg-slate-50 border border-transparent"}`,children:[e.jsx("div",{children:n.dayOfWeek.slice(0,3)}),e.jsx("div",{className:`text-[9px] mt-0.5 ${l.color}`,children:l.label})]},n.date)})}),e.jsx(_d,{day:r})]}),t==="weekly"&&e.jsx(kd,{}),t==="protocols"&&e.jsx(Cd,{}),t==="campaigns"&&e.jsx(Md,{}),t==="wizard"&&e.jsx(pd,{})]},t)]})}const Pd=[{id:"member-rajan",personaId:"rajan",name:"Rajan P.",avatar:"/assets/avatars/rajan.jpg",status:"at-risk",statusReason:"Sleep declining, glucose trending up",flags:["sleep_regression","late_workouts","glucose_creep"],lastSession:"2024-12-20",nextSession:new Date(Date.now()+2880*60*1e3).toISOString().split("T")[0],keyMetrics:[{name:"Sleep Score",previous:78,current:65,unit:"score",trend:"down",isGood:!1},{name:"HRV",previous:48,current:42,unit:"ms",trend:"down",isGood:!1},{name:"Fasting Glucose",previous:95,current:104,unit:"mg/dL",trend:"up",isGood:!1},{name:"Triglycerides",previous:142,current:131,unit:"mg/dL",trend:"down",isGood:!0}],topDrivers:[{driver:"Late workout timing",direction:"negative",certainty:.89},{driver:"Afternoon caffeine",direction:"negative",certainty:.84},{driver:"Zone 2 training",direction:"positive",certainty:.91}],todayReco:[{text:"Finish workout before 7 PM",certainty:.89},{text:"No caffeine after 2:15 PM",certainty:.84},{text:"Lower bedroom temp to 19°C",certainty:.76}],coachMessage:"Hi Rajan, I noticed your sleep has been declining over the past two weeks. Looking at your data, it seems like your workout times have shifted later—which correlates strongly with your increased sleep latency. Can we chat about your current schedule and find a time that works better for your body?"},{id:"member-sarah",personaId:"sarah",name:"Sarah M.",avatar:"/assets/avatars/sarah.jpg",status:"on-track",statusReason:"Glucose improving, great adherence",flags:[],lastSession:"2024-12-18",nextSession:new Date(Date.now()+7200*60*1e3).toISOString().split("T")[0],keyMetrics:[{name:"Fasting Glucose",previous:102,current:94,unit:"mg/dL",trend:"down",isGood:!0},{name:"Time in Range",previous:78,current:87,unit:"%",trend:"up",isGood:!0},{name:"HbA1c",previous:5.5,current:5.3,unit:"%",trend:"down",isGood:!0},{name:"Sleep Score",previous:78,current:82,unit:"score",trend:"up",isGood:!0}],topDrivers:[{driver:"8-hour eating window",direction:"positive",certainty:.93},{driver:"Post-meal walks",direction:"positive",certainty:.88},{driver:"Sleep consistency",direction:"positive",certainty:.86}],todayReco:[{text:"Maintain 10 AM - 6 PM eating window",certainty:.93},{text:"15-min walk after lunch",certainty:.88},{text:"Continue 7.5+ hrs sleep",certainty:.86}],coachMessage:"Sarah, your progress over the past 3 months has been incredible! Your fasting glucose dropped from 118 to 94—that's a 20% improvement. Your consistency with the eating window and post-meal walks is really paying off. Let's talk about what's next in our upcoming session."},{id:"member-marcus",personaId:"marcus",name:"Marcus J.",avatar:"/assets/avatars/marcus.jpg",status:"needs-attention",statusReason:"High strain, recovery lagging",flags:["overtraining_risk","hrv_suppressed"],lastSession:"2024-12-15",nextSession:new Date(Date.now()+1440*60*1e3).toISOString().split("T")[0],keyMetrics:[{name:"Recovery Score",previous:68,current:58,unit:"%",trend:"down",isGood:!1},{name:"HRV",previous:62,current:52,unit:"ms",trend:"down",isGood:!1},{name:"hsCRP",previous:2.8,current:1.6,unit:"mg/L",trend:"down",isGood:!0},{name:"Deep Sleep",previous:58,current:62,unit:"min",trend:"up",isGood:!0}],topDrivers:[{driver:"Training spacing",direction:"negative",certainty:.91},{driver:"Cold exposure",direction:"positive",certainty:.74},{driver:"Zero alcohol",direction:"positive",certainty:.87}],todayReco:[{text:"No high-intensity today",certainty:.91},{text:"Cold shower post-activity",certainty:.74},{text:"Early caffeine cutoff (noon)",certainty:.83}],coachMessage:"Marcus, I see you've had 3 high-strain days back-to-back. Your HRV is showing signs of overreaching—it dropped from 62 to 52. Let's discuss adjusting your training schedule to include more recovery days. The good news: your inflammation markers (hsCRP) continue to improve!"},{id:"member-emma",personaId:"emma",name:"Emma L.",avatar:"/assets/avatars/emma.jpg",status:"insufficient-data",statusReason:"Only 12 days of data—building baseline",flags:["new_user","irregular_bedtime"],lastSession:"2024-12-22",nextSession:new Date(Date.now()+10080*60*1e3).toISOString().split("T")[0],keyMetrics:[{name:"Sleep Score",previous:68,current:71,unit:"score",trend:"up",isGood:!0},{name:"Steps",previous:4800,current:5200,unit:"steps",trend:"up",isGood:!0},{name:"HRV",previous:36,current:38,unit:"ms",trend:"up",isGood:!0}],topDrivers:[{driver:"Bedtime consistency",direction:"negative",certainty:.62},{driver:"Step count",direction:"positive",certainty:.58}],todayReco:[{text:"Try 10:30 PM bedtime",certainty:.62},{text:"Aim for 8,000 steps",certainty:.58},{text:"Keep wearing Apple Watch to bed",certainty:1}],coachMessage:"Hi Emma! Welcome to your second week of tracking. I'm seeing some interesting patterns already—your bedtime varies by about 90 minutes, which might be affecting your sleep quality. Let's experiment with a consistent bedtime this week and see how your data responds."}];function Dd(){return Pd}const Ad={"member-rajan":{memberId:"member-rajan",memberName:"Rajan P.",sessionDate:new Date(Date.now()+2880*60*1e3).toISOString().split("T")[0],sessionDuration:30,prepTimeSaved:"45 minutes",discussionPoints:[{title:"Sleep Regression",priority:"high",priorityColor:"#EF4444",whatIsHappening:["Sleep score dropped from 78 to 65 over 2 weeks","Sleep latency increased from 12 to 22 minutes","Deep sleep declined by 18 minutes"],rootCause:"Workout timing shifted from 6:30 PM to 8:15 PM average over the past 2 weeks, likely due to work deadline pressure.",suggestedIntervention:"Discuss schedule constraints and explore morning workout option. If evenings are required, recommend finishing by 7 PM.",expectedImpact:"-10 min sleep latency, +12 deep sleep minutes within 7 days",talkingPoints:["Ask about current work situation and schedule pressures","Explore feasibility of morning workouts","Discuss the 7 PM threshold and why it matters for him specifically","Set a realistic goal for this week"]},{title:"HRV Suppression",priority:"high",priorityColor:"#EF4444",whatIsHappening:["HRV dropped from 48ms to 42ms","Coincides with later caffeine consumption","Resting HR elevated by 4 bpm"],rootCause:"Caffeine consumption shifted from before 2 PM to 3-4 PM, suppressing overnight autonomic recovery.",suggestedIntervention:"Reinforce 2:15 PM caffeine cutoff. Consider switching to decaf for afternoon energy.",expectedImpact:"+6ms HRV within 10 days if caffeine cutoff is maintained",talkingPoints:["Review his current caffeine habits","Explain the HRV-caffeine connection in his data","Suggest alternatives for afternoon energy dips","Consider sleep debt as root cause of afternoon fatigue"]},{title:"Zone 2 Success (Positive)",priority:"low",priorityColor:"#3B82F6",whatIsHappening:["Triglycerides dropped from 156 to 131 mg/dL","Consistent 185 min/week Zone 2 training","Testosterone improved 26% over 3 months"],rootCause:"Sustained Zone 2 cardiovascular training is improving metabolic markers.",suggestedIntervention:"Celebrate this win! Encourage continuation of Zone 2 focus.",expectedImpact:"Continued improvement if maintained",talkingPoints:["Acknowledge his consistency with Zone 2","Share the triglyceride improvement data","Discuss how this proves the system works when he follows it","Use as motivation for sleep/caffeine changes"]}],metrics:[{name:"Sleep Score",previous:78,current:65,unit:"score",trend:"down",isGood:!1},{name:"HRV",previous:48,current:42,unit:"ms",trend:"down",isGood:!1},{name:"Sleep Latency",previous:12,current:22,unit:"min",trend:"up",isGood:!1},{name:"Deep Sleep",previous:58,current:40,unit:"min",trend:"down",isGood:!1},{name:"Fasting Glucose",previous:95,current:104,unit:"mg/dL",trend:"up",isGood:!1},{name:"Triglycerides",previous:142,current:131,unit:"mg/dL",trend:"down",isGood:!0}],lastSessionNotes:"Discussed Zone 2 progress and set goal of maintaining 175+ min/week. Rajan mentioned increased work pressure but committed to keeping workouts before 7 PM. Follow up on this commitment.",adherence:[{category:"Workout Timing",percentage:42},{category:"Caffeine Cutoff",percentage:58},{category:"Bedroom Temp",percentage:35},{category:"Zone 2 Training",percentage:92}]},"member-sarah":{memberId:"member-sarah",memberName:"Sarah M.",sessionDate:new Date(Date.now()+7200*60*1e3).toISOString().split("T")[0],sessionDuration:30,prepTimeSaved:"40 minutes",discussionPoints:[{title:"Metabolic Transformation (Celebrate!)",priority:"low",priorityColor:"#3B82F6",whatIsHappening:["Fasting glucose dropped from 118 to 94 mg/dL (20% improvement)","HbA1c improved from 5.9% to 5.3%","Time in range increased from 72% to 87%"],rootCause:"Consistent adherence to 8-hour eating window and post-meal walks for 90 days.",suggestedIntervention:"Celebrate this major milestone! Discuss what made her successful and how to maintain.",expectedImpact:"Continued improvement toward optimal ranges",talkingPoints:["Share the transformation data visually","Ask what helped her stay consistent","Discuss her long-term goals now that pre-diabetes is reversed","Explore any new health goals she wants to pursue"]},{title:"Next Phase Planning",priority:"medium",priorityColor:"#F59E0B",whatIsHappening:["Core metabolic goals largely achieved","Sleep and energy are stable","Ready for optimization phase"],rootCause:"Foundation phase complete—time to introduce new optimization targets.",suggestedIntervention:"Introduce secondary goals like fitness performance or stress management.",expectedImpact:"Expanded health optimization beyond metabolic markers",talkingPoints:["Explore her interest areas (fitness, stress, longevity)","Discuss potential new wearable additions (CGM retention?)","Set 90-day goals for next phase"]}],metrics:[{name:"Fasting Glucose",previous:102,current:94,unit:"mg/dL",trend:"down",isGood:!0},{name:"HbA1c",previous:5.5,current:5.3,unit:"%",trend:"down",isGood:!0},{name:"Time in Range",previous:78,current:87,unit:"%",trend:"up",isGood:!0},{name:"Sleep Score",previous:78,current:82,unit:"score",trend:"up",isGood:!0},{name:"HRV",previous:48,current:52,unit:"ms",trend:"up",isGood:!0}],lastSessionNotes:"Sarah expressed excitement about her glucose improvements. Wants to eventually reduce CGM usage and maintain gains without continuous monitoring. Discussed transition plan.",adherence:[{category:"Eating Window",percentage:95},{category:"Post-Meal Walks",percentage:88},{category:"Sleep Schedule",percentage:82},{category:"Protein First",percentage:71}]},"member-marcus":{memberId:"member-marcus",memberName:"Marcus J.",sessionDate:new Date(Date.now()+1440*60*1e3).toISOString().split("T")[0],sessionDuration:45,prepTimeSaved:"50 minutes",discussionPoints:[{title:"Overtraining Risk",priority:"high",priorityColor:"#EF4444",whatIsHappening:["HRV dropped from 62 to 52ms (16% decline)","Recovery score at 58% (down from 68%)","3 consecutive high-strain days last week"],rootCause:"Insufficient recovery time between high-intensity sessions. Training load exceeding recovery capacity.",suggestedIntervention:"Implement mandatory 48-hour spacing between high-intensity workouts. Add dedicated recovery days.",expectedImpact:"+8ms HRV and 70%+ recovery score within 7 days",talkingPoints:["Review his training log and strain patterns","Explain the 48-hour HRV recovery window in his data","Discuss his competition/training goals","Create a realistic training schedule together"]},{title:"Inflammation Progress (Positive)",priority:"medium",priorityColor:"#F59E0B",whatIsHappening:["hsCRP dropped from 2.8 to 1.6 mg/L (43% improvement)","Zero alcohol maintained for 60 days","Cold exposure protocol consistent"],rootCause:"Alcohol elimination and consistent recovery practices are reducing systemic inflammation.",suggestedIntervention:"Reinforce the alcohol-inflammation connection and encourage continuation.",expectedImpact:"Target hsCRP below 1.0 with continued protocol",talkingPoints:["Celebrate the inflammation improvement","Discuss any challenges with alcohol abstinence","Review cold exposure routine and benefits","Consider adding omega-3 or other anti-inflammatory support"]}],metrics:[{name:"Recovery Score",previous:68,current:58,unit:"%",trend:"down",isGood:!1},{name:"HRV",previous:62,current:52,unit:"ms",trend:"down",isGood:!1},{name:"hsCRP",previous:2.8,current:1.6,unit:"mg/L",trend:"down",isGood:!0},{name:"Deep Sleep",previous:58,current:62,unit:"min",trend:"up",isGood:!0},{name:"Resting HR",previous:54,current:52,unit:"bpm",trend:"down",isGood:!0}],lastSessionNotes:"Marcus committed to maintaining zero alcohol and was excited about inflammation improvements. Discussed potential return to competitive events in Q1. Need to balance training intensity with recovery.",adherence:[{category:"Training Spacing",percentage:45},{category:"Cold Exposure",percentage:85},{category:"No Alcohol",percentage:100},{category:"Caffeine Cutoff",percentage:78}]}};new Date(Date.now()-10080*60*1e3).toISOString().split("T")[0];function Vi(){return Object.values(Ad).map(t=>{const a=t.discussionPoints||[],s=a[0];return{...t,id:t.memberId,clientName:t.memberName,focus:typeof s=="object"&&s?.title||"General coaching",urgency:a.some(i=>typeof i=="object"&&i.priority==="high")?"high":"medium",sessionTime:t.sessionDate,keyMetrics:t.metrics.slice(0,4).map(i=>({label:i.name,value:`${i.current}${i.unit}`,trend:i.trend==="up"?i.isGood?"+":"-":i.trend==="down"?i.isGood?"-":"+":""})),alerts:a.filter(i=>typeof i=="object"&&i.priority==="high").map(i=>typeof i=="object"?i.whatIsHappening?.[0]:i)}})}function Id(){return{totalSessions:Vi().length,newInsights:24,protocolsStarted:8,avgCertainty:76,needsAttention:[{name:"Rajan P.",reason:"Sleep regression - workout timing shifted"},{name:"Marcus J.",reason:"Overtraining risk - HRV declining"}],topProtocols:[{name:"Zone 2 Training",clients:8,improvement:"+12% cardio"},{name:"Caffeine Cutoff",clients:6,improvement:"+8ms HRV"},{name:"Time-Restricted Eating",clients:5,improvement:"-8 mg/dL glucose"}]}}const cs={"action-required":{label:"Action Required",color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",icon:oe},"needs-support":{label:"Needs Support",color:"text-amber-600",bgColor:"bg-amber-50",borderColor:"border-amber-200",icon:le},"on-track":{label:"On Track",color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200",icon:Ne}},Ld=t=>[{driver:"Sleep consistency",effectSize:"+18%",confidence:"85-92%",direction:"positive",icon:X},{driver:"Evening caffeine",effectSize:"-12%",confidence:"78-88%",direction:"negative",icon:Le},{driver:"Morning HRV",effectSize:"+8%",confidence:"72-84%",direction:"positive",icon:ke},{driver:"Screen time before bed",effectSize:"-6%",confidence:"68-79%",direction:"negative",icon:Cs}],ds={"slow-metabolizer":{label:"Slow Metabolizer",color:"text-purple-600",bg:"bg-purple-100"},"high-responder":{label:"High Responder",color:"text-primary-600",bg:"bg-primary-100"},"stress-sensitive":{label:"Stress Sensitive",color:"text-amber-600",bg:"bg-amber-100"},"recovery-optimized":{label:"Recovery Optimized",color:"text-green-600",bg:"bg-green-100"}};function Ed(){const[t,a]=g.useState("roster"),[s,i]=g.useState(null),r=Dd(),n=Vi(),o=Id(),c=r.map((u,m)=>({...u,coachStatus:m===0?"action-required":m===1?"needs-support":"on-track",archetype:Object.keys(ds)[m%4],traitModifiers:["Caffeine sensitive","Morning chronotype"].slice(0,m%2+1),lastUpdate:`${Math.floor(Math.random()*24)+1}h ago`})),l=[{value:"roster",label:"Member Overview",count:r.length},{value:"sessions",label:"Session Prep",count:n.length},{value:"digest",label:"Weekly Digest"}],d={"action-required":c.filter(u=>u.coachStatus==="action-required").length,"needs-support":c.filter(u=>u.coachStatus==="needs-support").length,"on-track":c.filter(u=>u.coachStatus==="on-track").length};return e.jsxs(Z,{title:"Coach Dashboard",subtitle:"Member insights, session prep, and causal intelligence",children:[e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-6",children:e.jsx($,{columns:3,gap:"md",children:Object.entries(cs).map(([u,m])=>{const h=m.icon,p=d[u];return e.jsx(k,{className:`p-4 ${m.bgColor} ${m.borderColor} border cursor-pointer hover:shadow-md transition-shadow`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-white/80",children:e.jsx(h,{className:`w-5 h-5 ${m.color}`})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-2xl font-bold ${m.color}`,children:p}),e.jsx("p",{className:"text-sm text-gray-600",children:m.label})]})]})},u)})})}),e.jsx(di,{tabs:l,activeTab:t,onTabChange:u=>a(u),variant:"underline",className:"mb-6"}),t==="roster"&&e.jsx(M.div,{initial:{opacity:0},animate:{opacity:1},children:e.jsx("div",{className:"space-y-4",children:c.map(u=>{const m=cs[u.coachStatus],h=m.icon,p=ds[u.archetype],b=Ld(u.id);return e.jsxs(k,{className:`p-5 ${s===u.id?"ring-2 ring-primary-500":""}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-primary-400 to-primary-600 rounded-full flex items-center justify-center text-white font-bold text-lg",children:u.name.charAt(0)}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:u.name}),e.jsx(A,{className:`${p.bg} ${p.color} border-0`,children:p.label})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("p",{className:"text-sm text-gray-500",children:u.focus}),u.traitModifiers.map((y,w)=>e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 rounded text-gray-600",children:y},w))]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-lg ${m.bgColor}`,children:[e.jsx(h,{className:`w-4 h-4 ${m.color}`}),e.jsx("span",{className:`text-sm font-medium ${m.color}`,children:m.label})]}),e.jsx("span",{className:"text-xs text-gray-500",children:u.lastUpdate})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:u.daysOfData}),e.jsx("div",{className:"text-xs text-gray-500",children:"Days of Data"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:u.insightCount}),e.jsx("div",{className:"text-xs text-gray-500",children:"Insights"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:u.activeProtocols}),e.jsx("div",{className:"text-xs text-gray-500",children:"Active Protocols"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-semibold text-primary-600",children:[Math.round(75+Math.random()*20),"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Evidence Weight"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("h5",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(Ae,{className:"w-4 h-4 text-primary-500"}),"Top Causal Drivers"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:b.slice(0,4).map((y,w)=>{const v=y.icon;return e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded-lg ${y.direction==="positive"?"bg-green-50":"bg-red-50"}`,children:[e.jsx(v,{className:`w-4 h-4 ${y.direction==="positive"?"text-green-600":"text-red-600"}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:y.driver}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs font-semibold ${y.direction==="positive"?"text-green-600":"text-red-600"}`,children:y.effectSize}),e.jsxs("span",{className:"text-xs text-gray-500",children:["CrI: ",y.confidence]})]})]})]},w)})})]}),e.jsxs(V,{size:"sm",variant:"outline",onClick:()=>i(s===u.id?null:u.id),children:[s===u.id?"Collapse":"View Full Profile",e.jsx(U,{className:`w-4 h-4 ml-1 transition-transform ${s===u.id?"rotate-90":""}`})]})]},u.id)})})}),t==="sessions"&&e.jsx(M.div,{initial:{opacity:0},animate:{opacity:1},children:e.jsx("div",{className:"grid gap-4 lg:grid-cols-2","data-tour":"session-prep",children:n.map(u=>e.jsxs(k,{className:"p-5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-primary-400 to-primary-600 rounded-full flex items-center justify-center text-white font-bold text-lg",children:u.clientName.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:u.clientName}),e.jsx("p",{className:"text-sm text-gray-500",children:u.focus})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs(A,{variant:u.urgency==="high"?"warning":"default",children:[u.urgency," priority"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[e.jsx(pe,{className:"w-3 h-3 inline mr-1"}),u.sessionTime]})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-4",children:u.keyMetrics.slice(0,3).map((m,h)=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:m.value}),e.jsx("div",{className:"text-xs text-gray-500",children:m.label}),m.trend&&e.jsxs("div",{className:`text-xs flex items-center justify-center gap-1 ${m.trend.startsWith("+")?"text-green-600":"text-red-600"}`,children:[m.trend.startsWith("+")?e.jsx(ee,{className:"w-3 h-3"}):e.jsx(fe,{className:"w-3 h-3"}),m.trend]})]},h))}),e.jsxs("div",{className:"mb-4 p-3 bg-green-50 border border-green-100 rounded-lg",children:[e.jsxs("h4",{className:"text-sm font-medium text-green-800 mb-2 flex items-center gap-2",children:[e.jsx(Ne,{className:"w-4 h-4"}),"Celebration Points"]}),e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{className:"text-sm text-green-700",children:"3 consecutive days of sleep goal achieved"}),e.jsx("li",{className:"text-sm text-green-700",children:"HRV trending up 12% this week"})]})]}),e.jsxs("div",{className:"mb-4 p-3 bg-primary-50 border border-primary-100 rounded-lg",children:[e.jsxs("h4",{className:"text-sm font-medium text-primary-800 mb-2 flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),"Suggested Interventions"]}),e.jsx("ul",{className:"space-y-1",children:u.discussionPoints.slice(0,2).map((m,h)=>e.jsx("li",{className:"text-sm text-primary-700",children:typeof m=="string"?m:m.title},h))})]}),u.alerts&&u.alerts.length>0&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-700 text-sm",children:[e.jsx(oe,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Attention Needed"})]}),e.jsx("ul",{className:"mt-1 text-xs text-amber-600",children:u.alerts.map((m,h)=>e.jsxs("li",{children:["• ",m]},h))})]}),e.jsxs(V,{size:"sm",variant:"outline",fullWidth:!0,children:["View Full Prep",e.jsx(U,{className:"w-4 h-4 ml-1"})]})]},u.id))})}),t==="digest"&&e.jsxs(M.div,{initial:{opacity:0},animate:{opacity:1},children:[e.jsx(k,{className:"p-6 bg-gradient-to-r from-navy-900 to-navy-800 text-white mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-2",children:"This Week's Impact"}),e.jsx("p",{className:"text-gray-300",children:"Your coaching generated measurable improvements"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-4xl font-bold text-primary-400",children:"+14%"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Avg. Outcome Improvement"})]})]})}),e.jsxs($,{columns:2,gap:"md",children:[e.jsxs(k,{className:"p-5",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-primary-500"}),"Weekly Metrics"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center pb-3 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Total Sessions"}),e.jsx("span",{className:"text-xl font-bold text-gray-900",children:o.totalSessions})]}),e.jsxs("div",{className:"flex justify-between items-center pb-3 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"New Insights Generated"}),e.jsx("span",{className:"text-xl font-bold text-gray-900",children:o.newInsights})]}),e.jsxs("div",{className:"flex justify-between items-center pb-3 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Protocols Started"}),e.jsx("span",{className:"text-xl font-bold text-gray-900",children:o.protocolsStarted})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Avg Member Certainty"}),e.jsxs("span",{className:"text-xl font-bold text-primary-600",children:[o.avgCertainty,"%"]})]})]})]}),e.jsxs(k,{className:"p-5",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(le,{className:"w-5 h-5 text-amber-500"}),"Members Needing Attention"]}),e.jsx("div",{className:"space-y-3",children:o.needsAttention.map((u,m)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-amber-50 rounded-lg border border-amber-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-amber-200 rounded-full flex items-center justify-center text-amber-700 font-bold text-sm",children:u.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:u.name}),e.jsx("p",{className:"text-xs text-amber-600",children:u.reason})]})]}),e.jsx(V,{size:"xs",variant:"outline",children:"Review"})]},m))})]})]}),e.jsx(F,{title:"Top Performing Protocols This Week",className:"mt-6",children:e.jsx($,{columns:3,gap:"md",children:o.topProtocols.map((u,m)=>e.jsxs(k,{className:"p-4 hover:border-primary-200 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-1.5 bg-green-100 rounded",children:e.jsx(ee,{className:"w-4 h-4 text-green-600"})}),e.jsx("span",{className:"font-medium text-gray-900",children:u.name})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[u.clients," members enrolled"]}),e.jsxs("p",{className:"text-sm font-semibold text-green-600",children:[u.improvement," avg improvement"]})]},m))})}),e.jsx(F,{title:"Top Causal Discoveries This Week",className:"mt-6",children:e.jsx(k,{className:"p-5",children:e.jsx("div",{className:"space-y-3",children:[{insight:"Sleep consistency shows 2.3x stronger effect than duration alone",confidence:"91%",members:8},{insight:"Evening screen cutoff improving outcomes for stress-sensitive archetypes",confidence:"87%",members:5},{insight:"Morning protein timing correlating with sustained energy levels",confidence:"82%",members:6}].map((u,m)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ae,{className:"w-5 h-5 text-primary-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:u.insight}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Observed in ",u.members," members"]})]})]}),e.jsxs(A,{variant:"outline",className:"text-primary-600 border-primary-200",children:[u.confidence," confidence"]})]},m))})})})]})]})}const qe={insights:{endpoint:"GET /api/v1/insights",description:"Retrieve personalized insights for a user",response:{insights:[{id:"ins_001",category:"sleep",title:"Caffeine significantly impacts your sleep quality",certainty:.87,evidenceWeight:.82,actionable:!0,suggestedAction:"Limit caffeine after 2:15 PM",causalChain:["Caffeine intake","Adenosine blocking","Sleep latency","Sleep quality"]}],meta:{total:6,filtered:4,certaintyThreshold:.5}}},protocols:{endpoint:"GET /api/v1/protocols",description:"Get active and suggested protocols",response:{protocols:[{id:"prot_001",category:"sleep",title:"Caffeine Timing Protocol",status:"active",personalizedTiming:"No caffeine after 2:15 PM",expectedImpact:"+8% sleep score",certainty:.87}],meta:{active:2,suggested:3}}},simulate:{endpoint:"POST /api/v1/simulate",description:"Run what-if simulation",response:{simulation:{baseline:{sleepScore:72,hrv:45},projected:{sleepScore:78,hrv:48},change:{sleepScore:"+6",hrv:"+3"},certainty:.75,timeToEffect:"3-7 days",confidenceInterval:{low:74,high:82}}}},metrics:{endpoint:"GET /api/v1/metrics",description:"Retrieve raw metrics data",response:{metrics:[{date:"2024-12-15",sleepScore:72,sleepDuration:420,hrv:45,restingHr:58,steps:8500}],meta:{days:45,lastSync:"2024-12-15T08:30:00Z"}}}};function Wd(){const{activePersona:t}=Ft(),[a,s]=g.useState("insights"),[i,r]=g.useState(!1),[n,o]=g.useState(qe.insights.response),[c,l]=g.useState(!1);Object.entries(qe).map(([h,p])=>({value:h,label:p.endpoint.split(" ")[1].split("/").pop()||h}));const d=async()=>{r(!0),await St(800),o(qe[a].response),r(!1)},u=async()=>{await navigator.clipboard.writeText(JSON.stringify(n,null,2)),l(!0),setTimeout(()=>l(!1),2e3)},m=qe[a];return e.jsxs(Z,{title:"API Explorer",subtitle:"Explore Serif's REST API endpoints",children:[e.jsxs($,{columns:2,gap:"lg",children:[e.jsxs("div",{children:[e.jsx(F,{title:"Available Endpoints",children:e.jsx("div",{className:"space-y-2",children:Object.entries(qe).map(([h,p])=>e.jsxs(k,{interactive:!0,onClick:()=>{s(h),o(p.response)},className:`p-4 ${a===h?"ring-2 ring-primary-500 border-primary-500":""}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(A,{variant:p.endpoint.startsWith("GET")?"success":"primary",size:"sm",children:p.endpoint.split(" ")[0]}),e.jsx("code",{className:"text-sm font-mono text-gray-700",children:p.endpoint.split(" ")[1]})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:p.description})]},h))})}),e.jsxs(F,{title:"Request",className:"mt-6",children:[e.jsxs(k,{className:"p-4 bg-gray-900",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 text-gray-400 text-xs",children:[e.jsx(jr,{className:"w-4 h-4"}),e.jsx("span",{children:"cURL"})]}),e.jsx("pre",{className:"text-sm text-green-400 font-mono overflow-x-auto",children:`curl -X ${m.endpoint.split(" ")[0]} \\
  '${m.endpoint.split(" ")[1]}' \\
  -H 'Authorization: Bearer <token>' \\
  -H 'X-User-ID: ${t?.id||"user_123"}'`})]}),e.jsxs(V,{onClick:d,loading:i,className:"mt-4",fullWidth:!0,children:[e.jsx(Nr,{className:"w-4 h-4 mr-2"}),"Run Request"]})]})]}),e.jsxs("div",{"data-tour":"api-response",children:[e.jsx(F,{title:"Response",actions:e.jsx(V,{size:"sm",variant:"ghost",onClick:u,children:c?e.jsx(ie,{className:"w-4 h-4"}):e.jsx(rt,{className:"w-4 h-4"})}),children:e.jsx($t,{data:n,theme:"dark",expandLevel:3,className:"max-h-[600px] overflow-auto"})}),e.jsx(F,{title:"Response Schema",className:"mt-6",children:e.jsx(k,{className:"p-4",children:e.jsxs("div",{className:"space-y-3 text-sm",children:[a==="insights"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-mono text-primary-600",children:"certainty"}),e.jsx("span",{className:"text-gray-500 ml-2",children:"float (0-1)"}),e.jsx("p",{className:"text-gray-600 text-xs mt-1",children:"Confidence level based on personal data quality"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-mono text-primary-600",children:"evidenceWeight"}),e.jsx("span",{className:"text-gray-500 ml-2",children:"float (0-1)"}),e.jsx("p",{className:"text-gray-600 text-xs mt-1",children:"Balance between personal data vs population prior"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-mono text-primary-600",children:"causalChain"}),e.jsx("span",{className:"text-gray-500 ml-2",children:"string[]"}),e.jsx("p",{className:"text-gray-600 text-xs mt-1",children:"Causal path from action to outcome"})]})]}),a==="simulate"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-mono text-primary-600",children:"confidenceInterval"}),e.jsx("span",{className:"text-gray-500 ml-2",children:"object"}),e.jsx("p",{className:"text-gray-600 text-xs mt-1",children:"95% confidence bounds for projected outcome"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-mono text-primary-600",children:"timeToEffect"}),e.jsx("span",{className:"text-gray-500 ml-2",children:"string"}),e.jsx("p",{className:"text-gray-600 text-xs mt-1",children:"Expected duration to see results"})]})]})]})})})]})]}),e.jsx(F,{title:"Integration Guide",className:"mt-8",children:e.jsx(k,{className:"p-6",children:e.jsxs($,{columns:3,gap:"md",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"1. Authentication"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Use API keys for server-to-server, OAuth for user-facing apps. All requests require Authorization header."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"2. Rate Limits"}),e.jsx("p",{className:"text-sm text-gray-600",children:"1000 requests/minute per API key. Insights cached for 5 minutes. Real-time webhooks available for Pro tier."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"3. Webhooks"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Subscribe to insight.created, protocol.updated events. Retry with exponential backoff."})]})]})})}),e.jsx(F,{title:"Enterprise Architecture",className:"mt-8",children:e.jsxs($,{columns:2,gap:"lg",children:[e.jsxs(k,{className:"p-6 border-2 border-blue-200 bg-gradient-to-br from-blue-50/50 to-white",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(ga,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Multi-Tenant Isolation"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Complete data separation per partner"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-gray-700",children:"Tenant-scoped encryption keys (AES-256)"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-gray-700",children:"Isolated compute environments per partner"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-gray-700",children:"Partner data never co-mingled in storage"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-gray-700",children:"Cross-platform learning uses anonymized aggregates only"})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:e.jsx("code",{className:"text-xs text-blue-800",children:"X-Tenant-ID: partner_human_edge"})})]}),e.jsxs(k,{className:"p-6 border-2 border-emerald-200 bg-gradient-to-br from-emerald-50/50 to-white",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:e.jsx(ce,{className:"w-5 h-5 text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"FHIR R4 Native"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Healthcare interoperability standard"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),e.jsx("span",{className:"text-gray-700",children:"Native FHIR R4 resource support"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),e.jsx("span",{className:"text-gray-700",children:"Observation, DiagnosticReport, Patient"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),e.jsx("span",{className:"text-gray-700",children:"SMART on FHIR authentication"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),e.jsx("span",{className:"text-gray-700",children:"Bulk FHIR export for analytics"})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-emerald-50 rounded-lg border border-emerald-200",children:e.jsx("code",{className:"text-xs text-emerald-800",children:"Content-Type: application/fhir+json"})})]})]})}),e.jsx(F,{title:"Security & Compliance",className:"mt-8",children:e.jsxs(k,{className:"p-6 border-2 border-violet-200 bg-gradient-to-r from-violet-50/30 to-white",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-violet-100 rounded-lg",children:e.jsx(Oe,{className:"w-5 h-5 text-violet-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Enterprise-Grade Security"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Built for healthcare data compliance"})]})]}),e.jsxs($,{columns:4,gap:"md",children:[e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg border border-violet-100",children:[e.jsx(Ns,{className:"w-6 h-6 text-violet-500 mx-auto mb-2"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"HIPAA Ready"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"BAA available"})]}),e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg border border-violet-100",children:[e.jsx(Oe,{className:"w-6 h-6 text-violet-500 mx-auto mb-2"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"SOC 2 Type II"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"In progress"})]}),e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg border border-violet-100",children:[e.jsx(_r,{className:"w-6 h-6 text-violet-500 mx-auto mb-2"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"End-to-End Encryption"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"TLS 1.3 + AES-256"})]}),e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg border border-violet-100",children:[e.jsx(kr,{className:"w-6 h-6 text-violet-500 mx-auto mb-2"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"Data Residency"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"US, EU options"})]})]})]})}),e.jsx(F,{title:"SDK Integration",className:"mt-8",children:e.jsxs($,{columns:2,gap:"lg",children:[e.jsxs(k,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(A,{variant:"outline",children:"TypeScript"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Official SDK"})]}),e.jsx("pre",{className:"bg-gray-900 text-green-400 p-4 rounded-lg text-xs overflow-x-auto",children:`import { SerifClient } from '@serif/sdk';

const serif = new SerifClient({
  apiKey: process.env.SERIF_API_KEY,
  tenantId: 'partner_human_edge'
});

// Get personalized insights
const insights = await serif.insights.list({
  userId: 'user_123',
  category: 'sleep',
  minCertainty: 0.7
});

// Run what-if simulation
const simulation = await serif.simulate({
  userId: 'user_123',
  intervention: { caffeineCutoff: '14:00' }
});`})]}),e.jsxs(k,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(A,{variant:"outline",children:"Python"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Official SDK"})]}),e.jsx("pre",{className:"bg-gray-900 text-green-400 p-4 rounded-lg text-xs overflow-x-auto",children:`from serif import SerifClient

client = SerifClient(
    api_key=os.environ["SERIF_API_KEY"],
    tenant_id="partner_human_edge"
)

# Get personalized insights
insights = client.insights.list(
    user_id="user_123",
    category="sleep",
    min_certainty=0.7
)

# Subscribe to real-time updates
@client.on("insight.created")
def handle_insight(event):
    print(f"New insight: {event.data}")`})]})]})}),e.jsx(F,{title:"Enterprise SLA",className:"mt-8",children:e.jsx(k,{className:"p-6",children:e.jsxs($,{columns:4,gap:"md",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-primary-600",children:"99.9%"}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Uptime SLA"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-primary-600",children:"<100ms"}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"P95 Latency"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-primary-600",children:"24/7"}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Enterprise Support"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-primary-600",children:"6 weeks"}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Avg Integration Time"})]})]})})})]})}function Hd(){const[t,a]=g.useState(50),[s,i]=g.useState({insights:!0,protocols:!0,weeklyDigest:!0,deviceAlerts:!1});return e.jsxs(Z,{title:"Settings",subtitle:"Manage your preferences and account settings",children:[e.jsx(F,{title:"Insight Preferences",subtitle:"Control how insights are displayed",children:e.jsxs($,{columns:2,gap:"md",children:[e.jsxs(k,{className:"p-5",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Certainty Threshold"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Minimum certainty level for showing insights. Lower values show more exploratory insights."}),e.jsx(wa,{value:t,onChange:a,min:0,max:100,step:5,showValue:!0,showLabels:!0,minLabel:"Exploratory",maxLabel:"High Confidence",variant:"certainty"})]}),e.jsxs(k,{className:"p-5",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Evidence Display"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(se,{label:"Show evidence breakdown",description:"Display personal vs population data contribution",checked:!0,size:"sm"}),e.jsx(se,{label:"Show confidence intervals",description:"Display uncertainty ranges on predictions",checked:!0,size:"sm"}),e.jsx(se,{label:"Explain causal chains",description:"Show how insights connect to outcomes",checked:!1,size:"sm"})]})]})]})}),e.jsx(F,{title:"Notifications",subtitle:"Choose what updates you receive",className:"mt-8",children:e.jsx(k,{className:"p-5",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(se,{label:"New insights",description:"Get notified when new high-certainty insights are discovered",checked:s.insights,onToggle:()=>i(r=>({...r,insights:!r.insights})),size:"sm"}),e.jsx(se,{label:"Protocol reminders",description:"Daily reminders for your active protocols",checked:s.protocols,onToggle:()=>i(r=>({...r,protocols:!r.protocols})),size:"sm"}),e.jsx(se,{label:"Weekly digest",description:"Summary of your progress and trends",checked:s.weeklyDigest,onToggle:()=>i(r=>({...r,weeklyDigest:!r.weeklyDigest})),size:"sm"}),e.jsx(se,{label:"Device sync alerts",description:"Notify when device sync fails or data is stale",checked:s.deviceAlerts,onToggle:()=>i(r=>({...r,deviceAlerts:!r.deviceAlerts})),size:"sm"})]})})}),e.jsx(F,{title:"Privacy & Data",subtitle:"Manage your data and privacy settings",className:"mt-8",children:e.jsxs($,{columns:2,gap:"md",children:[e.jsxs(k,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-50",children:e.jsx(ce,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Data Management"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Control your health data"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(V,{variant:"outline",size:"sm",fullWidth:!0,children:"Export All Data"}),e.jsx(V,{variant:"outline",size:"sm",fullWidth:!0,children:"Download Insights Report"}),e.jsx(V,{variant:"outline",size:"sm",fullWidth:!0,className:"text-red-600 hover:bg-red-50",children:"Delete All Data"})]})]}),e.jsxs(k,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 rounded-lg bg-green-50",children:e.jsx(Oe,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Privacy Controls"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage data sharing"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(se,{label:"Contribute to research",description:"Allow anonymized data for health research",checked:!1,size:"sm"}),e.jsx(se,{label:"Share with coach",description:"Allow your coach to view your insights",checked:!0,size:"sm"})]})]})]})}),e.jsx(F,{title:"Connected Accounts",subtitle:"Manage linked services",className:"mt-8",children:e.jsx(k,{className:"p-5",children:e.jsx("div",{className:"space-y-4",children:[{name:"Apple Health",connected:!0,lastSync:"2 hours ago"},{name:"Oura Ring",connected:!0,lastSync:"30 minutes ago"},{name:"Mito Labs",connected:!0,lastSync:"3 days ago"},{name:"Garmin Connect",connected:!1}].map(r=>e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${r.connected?"bg-green-500":"bg-gray-300"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:r.name}),r.connected&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Last synced: ",r.lastSync]})]})]}),e.jsx(V,{variant:"outline",size:"sm",children:r.connected?"Disconnect":"Connect"})]},r.name))})})})]})}const Vd=[{id:"he-ds-labs",type:"pathology-lab",name:"Partner Pathology Labs",description:"Thyrocare, Metropolis - ~78 biomarkers via PDF/HL7. OCR pipeline (Google Vision + regex) → BigQuery blood_results",cadence:"quarterly",pipeline:"Lab PDF → Portal/Email → OCR (Vision/Textract) → Validation → BigQuery",lastSync:"2025-01-15T08:30:00Z",status:"active",recordCount:15420},{id:"he-ds-terra",type:"terra-api",name:"Terra API Aggregator",description:"Apple Watch, Fitbit, Garmin, Oura - steps, HR, HRV, sleep stages, workouts, stress",cadence:"continuous",pipeline:"User OAuth → Terra webhook → GCP Pub/Sub → Kafka → BigQuery raw_wearable → daily ETL",lastSync:"2025-01-20T06:00:00Z",status:"active",recordCount:2847e3},{id:"he-ds-cgm",type:"ble-device",name:"CGM (Abbott FreeStyle Libre)",description:"Continuous glucose monitoring - interstitial glucose every 15 min, TIR/TAR metrics",cadence:"continuous",pipeline:"LibreView Cloud → Terra pull → webhook → BigQuery cgm_readings",lastSync:"2025-01-20T05:45:00Z",status:"active",recordCount:892e3},{id:"he-ds-bp",type:"ble-device",name:"BP Monitor (Omron Connect)",description:"Blood pressure readings - SBP/DBP, HR",cadence:"event-based",pipeline:"Omron Cloud → Terra → BigQuery bp_readings",lastSync:"2025-01-19T19:30:00Z",status:"active",recordCount:8450},{id:"he-ds-scale",type:"ble-device",name:"Body Composition Scale (Withings)",description:"Weight, body fat %, muscle mass, bone mass, water %",cadence:"event-based",pipeline:"Withings Health Cloud → Terra → BigQuery weight_readings",lastSync:"2025-01-20T07:15:00Z",status:"active",recordCount:4200},{id:"he-ds-profile",type:"self-report",name:"Profile & Lifestyle Forms",description:"Demographics, diet, caffeine/alcohol, goals, medications, surgeries",cadence:"event-based",pipeline:"React-Native form → Firestore user_profile → Cloud Function → BigQuery",lastSync:"2025-01-18T14:00:00Z",status:"active",recordCount:1250},{id:"he-ds-surveys",type:"self-report",name:"Weekly Micro-Surveys",description:"Sleep quality, stress, energy, mood - subjective wellbeing tracking",cadence:"weekly",pipeline:"App survey → Firestore → BigQuery survey_responses",lastSync:"2025-01-19T20:00:00Z",status:"active",recordCount:18500},{id:"he-ds-interventions",type:"intervention",name:"Intervention Catalogue",description:"1,200 clinician-vetted intervention codes (nutrition, Zone-2, supplements, sleep hygiene)",cadence:"event-based",pipeline:"PostgreSQL CMS → REST API → BigQuery intervention_events",lastSync:"2025-01-20T02:00:00Z",status:"active",recordCount:32e3},{id:"he-ds-compliance",type:"compliance",name:"Compliance & Behavior Logs",description:"Adherence tracking - passive detection from wearables + manual confirmations",cadence:"daily",pipeline:"Compliance micro-service evaluates sensors vs. goal → compliance_log at 02:00 local",lastSync:"2025-01-20T02:00:00Z",status:"active",recordCount:156e3},{id:"he-ds-environment",type:"environment",name:"Environmental Context",description:"Weather (temp, humidity), AQI, daylight hours - nightly pull",cadence:"daily",pipeline:"OpenWeatherMap/BreezoMeter APIs → nightly cron → BigQuery environment_context",lastSync:"2025-01-20T00:00:00Z",status:"active",recordCount:45e3},{id:"he-ds-engagement",type:"engagement",name:"Engagement & UX Telemetry",description:"Push delivery, open/click rates, screen views",cadence:"real-time",pipeline:"Firebase Cloud Messaging + Analytics → BigQuery eng_events",lastSync:"2025-01-20T07:59:00Z",status:"active",recordCount:425e4}],Od=[{id:"x-steps",name:"Daily Steps",category:"Activity",dataSource:"terra-api",unit:"steps",description:"Total daily step count from wearable",sampleRate:"daily"},{id:"x-active-energy",name:"Active Energy",category:"Activity",dataSource:"terra-api",unit:"kcal",description:"Calories burned through activity",sampleRate:"daily"},{id:"x-zone2-minutes",name:"Zone 2 Training Minutes",category:"Exercise",dataSource:"terra-api",unit:"minutes",description:"Time spent in aerobic zone (60-70% max HR)",sampleRate:"daily"},{id:"x-workout-frequency",name:"Workout Frequency",category:"Exercise",dataSource:"terra-api",unit:"sessions/week",description:"Number of logged workouts per week",sampleRate:"weekly"},{id:"x-sleep-duration",name:"Sleep Duration",category:"Sleep",dataSource:"terra-api",unit:"hours",description:"Total time asleep",sampleRate:"daily"},{id:"x-deep-sleep",name:"Deep Sleep",category:"Sleep",dataSource:"terra-api",unit:"minutes",description:"Time in deep/slow-wave sleep",sampleRate:"daily"},{id:"x-rem-sleep",name:"REM Sleep",category:"Sleep",dataSource:"terra-api",unit:"minutes",description:"Time in REM sleep stage",sampleRate:"daily"},{id:"x-sleep-latency",name:"Sleep Latency",category:"Sleep",dataSource:"terra-api",unit:"minutes",description:"Time to fall asleep",sampleRate:"daily"},{id:"x-hrv",name:"Heart Rate Variability",category:"Recovery",dataSource:"terra-api",unit:"ms RMSSD",description:"Overnight HRV - parasympathetic tone indicator",sampleRate:"daily"},{id:"x-resting-hr",name:"Resting Heart Rate",category:"Recovery",dataSource:"terra-api",unit:"bpm",description:"Lowest sustained HR during sleep",sampleRate:"daily"},{id:"x-stress-score",name:"Stress Score",category:"Recovery",dataSource:"terra-api",unit:"0-100",description:"Garmin/Fitbit stress index",sampleRate:"daily"},{id:"x-avg-glucose",name:"Average Glucose",category:"Metabolic",dataSource:"ble-device",unit:"mg/dL",description:"Mean interstitial glucose over 24h",sampleRate:"96/day"},{id:"x-glucose-variability",name:"Glucose Variability",category:"Metabolic",dataSource:"ble-device",unit:"CV%",description:"Coefficient of variation in glucose",sampleRate:"daily"},{id:"x-time-in-range",name:"Time in Range",category:"Metabolic",dataSource:"ble-device",unit:"%",description:"Percentage of time glucose 70-140 mg/dL",sampleRate:"daily"},{id:"x-dawn-effect",name:"Dawn Phenomenon",category:"Metabolic",dataSource:"ble-device",unit:"mg/dL rise",description:"Morning glucose spike (4-8am)",sampleRate:"daily"},{id:"x-systolic",name:"Systolic BP",category:"Cardiovascular",dataSource:"ble-device",unit:"mmHg",description:"Systolic blood pressure",sampleRate:"event-based"},{id:"x-diastolic",name:"Diastolic BP",category:"Cardiovascular",dataSource:"ble-device",unit:"mmHg",description:"Diastolic blood pressure",sampleRate:"event-based"},{id:"x-weight",name:"Body Weight",category:"Body Composition",dataSource:"ble-device",unit:"kg",description:"Morning fasted weight",sampleRate:"event-based"},{id:"x-body-fat",name:"Body Fat Percentage",category:"Body Composition",dataSource:"ble-device",unit:"%",description:"Bioimpedance-estimated body fat",sampleRate:"event-based"},{id:"x-hba1c",name:"HbA1c",category:"Metabolic Lab",dataSource:"pathology-lab",unit:"%",description:"Glycated hemoglobin - 3mo glucose average",sampleRate:"quarterly"},{id:"x-fasting-insulin",name:"Fasting Insulin",category:"Metabolic Lab",dataSource:"pathology-lab",unit:"mIU/L",description:"Insulin resistance marker",sampleRate:"quarterly"},{id:"x-apob",name:"ApoB",category:"Lipid Lab",dataSource:"pathology-lab",unit:"mg/dL",description:"Atherogenic particle count",sampleRate:"quarterly"},{id:"x-hscrp",name:"hs-CRP",category:"Inflammatory Lab",dataSource:"pathology-lab",unit:"mg/L",description:"High-sensitivity C-reactive protein",sampleRate:"quarterly"},{id:"x-vitamin-d",name:"Vitamin D (25-OH)",category:"Vitamin Lab",dataSource:"pathology-lab",unit:"ng/mL",description:"Vitamin D status",sampleRate:"quarterly"},{id:"x-aqi",name:"Air Quality Index",category:"Environment",dataSource:"environment",unit:"AQI",description:"Local air quality from BreezoMeter",sampleRate:"daily"},{id:"x-temp",name:"Ambient Temperature",category:"Environment",dataSource:"environment",unit:"°C",description:"Local weather temperature",sampleRate:"daily"},{id:"x-daylight",name:"Daylight Hours",category:"Environment",dataSource:"environment",unit:"hours",description:"Hours of daylight",sampleRate:"daily"},{id:"x-caffeine",name:"Caffeine Intake",category:"Lifestyle",dataSource:"self-report",unit:"units/day",description:"Self-reported caffeine consumption",sampleRate:"weekly"},{id:"x-alcohol",name:"Alcohol Intake",category:"Lifestyle",dataSource:"self-report",unit:"units/week",description:"Self-reported alcohol consumption",sampleRate:"weekly"},{id:"x-subjective-stress",name:"Subjective Stress",category:"Wellbeing",dataSource:"self-report",unit:"1-5",description:"Weekly self-reported stress level",sampleRate:"weekly"}],Bd=[{id:"y-hba1c",name:"HbA1c",category:"Metabolic",description:"Glycemic control - target <5.7%",targetDirection:"decrease",unit:"%"},{id:"y-fasting-glucose",name:"Fasting Glucose",category:"Metabolic",description:"Morning fasted blood glucose - target 70-100 mg/dL",targetDirection:"optimize",unit:"mg/dL"},{id:"y-time-in-range",name:"Time in Range",category:"Metabolic",description:"CGM time 70-140 mg/dL - target >90%",targetDirection:"increase",unit:"%"},{id:"y-apob",name:"ApoB",category:"Cardiovascular",description:"Atherogenic burden - target <90 mg/dL",targetDirection:"decrease",unit:"mg/dL"},{id:"y-hscrp",name:"hs-CRP",category:"Inflammation",description:"Systemic inflammation - target <1.0 mg/L",targetDirection:"decrease",unit:"mg/L"},{id:"y-body-fat",name:"Body Fat Percentage",category:"Body Composition",description:"Target: men <20%, women <28%",targetDirection:"decrease",unit:"%"},{id:"y-vo2max",name:"VO2 Max",category:"Fitness",description:"Cardiorespiratory fitness - target age-appropriate percentile",targetDirection:"increase",unit:"mL/kg/min"},{id:"y-hrv",name:"HRV (RMSSD)",category:"Recovery",description:"Autonomic balance - higher is generally better",targetDirection:"increase",unit:"ms"},{id:"y-sleep-efficiency",name:"Sleep Efficiency",category:"Sleep",description:"Time asleep / time in bed - target >85%",targetDirection:"increase",unit:"%"},{id:"y-deep-sleep-pct",name:"Deep Sleep Percentage",category:"Sleep",description:"Restorative sleep proportion - target 15-20%",targetDirection:"optimize",unit:"%"}],Fd=[{id:"he-user-001",name:"Arjun K.",avatar:"👨‍💼",enrollmentDate:"2024-07-15",activeDays:180,complianceRate:94,currentPhase:"Optimization",tags:["prediabetes","tech-professional","apple-watch","cgm-user"]},{id:"he-user-002",name:"Priya M.",avatar:"👩‍⚕️",enrollmentDate:"2024-09-01",activeDays:135,complianceRate:88,currentPhase:"Active Intervention",tags:["metabolic-syndrome","physician","garmin","high-engagement"]},{id:"he-user-003",name:"Vikram S.",avatar:"🧑‍💻",enrollmentDate:"2024-06-01",activeDays:225,complianceRate:91,currentPhase:"Maintenance",tags:["diabetes-reversal","entrepreneur","oura","cgm-user","star-performer"]},{id:"he-user-004",name:"Anita R.",avatar:"👩‍🏫",enrollmentDate:"2024-10-15",activeDays:95,complianceRate:76,currentPhase:"Baseline",tags:["weight-management","educator","fitbit","new-user"]}],$d=[{id:"he-insight-001",title:"Post-Dinner Walk Improves Glucose Response",description:"A 15-minute walk within 30 minutes after dinner reduces glucose spike by 18% on average",xVariables:["x-steps","x-avg-glucose"],yVariable:"y-time-in-range",modelType:"causal",confidence:.89,theta:1500,beta:.18,recommendation:"Schedule a 15-minute walk after your largest meal of the day",linkedResources:["cgm-reading-001","wearable-001"]},{id:"he-insight-002",title:"Sleep Duration Correlates with HRV",description:"Each additional hour of sleep above 6h increases next-day HRV by ~8ms",xVariables:["x-sleep-duration","x-deep-sleep"],yVariable:"y-hrv",modelType:"causal",confidence:.82,theta:6,beta:8,recommendation:"Prioritize 7-8 hours of sleep for optimal recovery",linkedResources:["wearable-sleep-001"]},{id:"he-insight-003",title:"Zone 2 Training Reduces hs-CRP",description:"≥150 min/week of Zone 2 cardio associated with 22% lower hs-CRP at 90 days",xVariables:["x-zone2-minutes","x-workout-frequency"],yVariable:"y-hscrp",modelType:"causal",confidence:.78,theta:150,beta:-.22,recommendation:"Build to 150+ minutes of Zone 2 training weekly (walking, easy cycling)",linkedResources:["lab-crp-001","wearable-workout-001"]},{id:"he-insight-004",title:"Caffeine Cutoff Improves Deep Sleep",description:"No caffeine after 2pm increases deep sleep duration by 12 minutes on average",xVariables:["x-caffeine","x-sleep-latency"],yVariable:"y-deep-sleep-pct",modelType:"causal",confidence:.75,theta:14,beta:12,recommendation:"Avoid caffeine after 2pm to protect deep sleep",linkedResources:["survey-001","wearable-sleep-002"]},{id:"he-insight-005",title:"Fasting Insulin Predicts Glucose Variability",description:"Fasting insulin >10 mIU/L associated with 35% higher glucose CV",xVariables:["x-fasting-insulin"],yVariable:"y-time-in-range",modelType:"predictive",confidence:.85,theta:10,beta:.35,recommendation:"Focus on insulin sensitizing interventions: time-restricted eating, strength training",linkedResources:["lab-insulin-001","cgm-summary-001"]},{id:"he-insight-006",title:"Dawn Phenomenon Mitigation via Evening Routine",description:"Completing sleep hygiene protocol reduces morning glucose spike by 15 mg/dL",xVariables:["x-dawn-effect","x-sleep-duration","x-sleep-latency"],yVariable:"y-fasting-glucose",modelType:"causal",confidence:.72,theta:0,beta:-15,recommendation:"Follow evening wind-down: dim lights 9pm, no screens 10pm, bedroom 18°C",linkedResources:["cgm-dawn-001","compliance-001"]}],zd={id:"human-edge",name:"Human Edge",logo:"🏃‍♂️",description:"Comprehensive metabolic health optimization platform with ~78 biomarkers, continuous wearable data, CGM, and clinician-guided interventions",dataSources:Vd,xVariables:Od,yVariables:Bd,insights:$d,users:Fd},Gd=[{id:"hb-ds-habits",type:"self-report",name:"Habit Tracker Core",description:"Primary habit logging via band tap + app confirmation. Captures completion timestamps, streak data, habit metadata, and contextual notes.",cadence:"real-time",pipeline:"Band BLE tap → Mobile SDK → Firebase Realtime → Cloud Function → BigQuery habit_completions",lastSync:"2025-01-20T08:15:00Z",status:"active",recordCount:12450},{id:"hb-ds-terra",type:"terra-api",name:"Wearables (Terra API)",description:"Apple Watch, Fitbit, Garmin integration for sleep quality, HRV, steps, and activity correlation with habit success.",cadence:"continuous",pipeline:"User OAuth → Terra webhook → GCP Pub/Sub → BigQuery raw_wearable → daily ETL join with habits",lastSync:"2025-01-20T06:00:00Z",status:"active",recordCount:245e3},{id:"hb-ds-surveys",type:"self-report",name:"Weekly Check-ins",description:"Motivation score, habit difficulty ratings, mood, life events. Used for confounding control in causal models.",cadence:"weekly",pipeline:"App survey modal → Firestore → Cloud Function → BigQuery weekly_surveys",lastSync:"2025-01-19T20:00:00Z",status:"active",recordCount:890},{id:"hb-ds-engagement",type:"engagement",name:"App Engagement Telemetry",description:"Notification delivery/response times, app opens, screen views, feature usage, reminder interactions.",cadence:"real-time",pipeline:"Firebase Analytics + Cloud Messaging → BigQuery engagement_events",lastSync:"2025-01-20T08:20:00Z",status:"active",recordCount:78500}],Ud=[{id:"x-completion-hour",name:"Habit Completion Hour",category:"Timing",dataSource:"self-report",unit:"hour (0-23)",description:"Hour of day when habit was completed",sampleRate:"per-completion"},{id:"x-day-of-week",name:"Day of Week",category:"Timing",dataSource:"self-report",unit:"1-7",description:"Day of week (1=Monday, 7=Sunday)",sampleRate:"daily"},{id:"x-days-since-start",name:"Days Since Habit Started",category:"Timing",dataSource:"self-report",unit:"days",description:"Number of days since habit was created",sampleRate:"daily"},{id:"x-current-streak",name:"Current Streak Length",category:"Behavior",dataSource:"self-report",unit:"days",description:"Consecutive days habit completed without break",sampleRate:"daily"},{id:"x-reminder-response-time",name:"Reminder Response Time",category:"Behavior",dataSource:"engagement",unit:"minutes",description:"Time between reminder notification and habit completion",sampleRate:"per-completion"},{id:"x-habit-stack-count",name:"Habit Stack Count",category:"Behavior",dataSource:"self-report",unit:"count",description:"Number of habits completed within 30-min window (stacking)",sampleRate:"per-completion"},{id:"x-previous-day-completed",name:"Previous Day Completion",category:"Behavior",dataSource:"self-report",unit:"boolean (0/1)",description:"Whether habit was completed the previous day",sampleRate:"daily"},{id:"x-sleep-score",name:"Prior Night Sleep Score",category:"Context",dataSource:"terra-api",unit:"0-100",description:"Sleep quality score from previous night",sampleRate:"daily"},{id:"x-morning-hrv",name:"Morning HRV",category:"Context",dataSource:"terra-api",unit:"ms RMSSD",description:"Heart rate variability upon waking",sampleRate:"daily"},{id:"x-prior-day-steps",name:"Prior Day Steps",category:"Context",dataSource:"terra-api",unit:"steps",description:"Total steps from previous day",sampleRate:"daily"},{id:"x-app-opens",name:"Daily App Opens",category:"Engagement",dataSource:"engagement",unit:"count",description:"Number of times app opened that day",sampleRate:"daily"},{id:"x-time-in-app",name:"Time in App",category:"Engagement",dataSource:"engagement",unit:"minutes",description:"Total time spent in app that day",sampleRate:"daily"},{id:"x-notification-tap-rate",name:"Notification Tap Rate",category:"Engagement",dataSource:"engagement",unit:"%",description:"7-day rolling average of notification tap rate",sampleRate:"daily"},{id:"x-motivation-score",name:"Weekly Motivation Score",category:"Self-Report",dataSource:"self-report",unit:"1-10",description:"Self-reported motivation level from weekly survey",sampleRate:"weekly"},{id:"x-perceived-difficulty",name:"Perceived Habit Difficulty",category:"Self-Report",dataSource:"self-report",unit:"1-5",description:"How hard the habit feels to complete",sampleRate:"weekly"}],Yd=[{id:"y-completion-rate",name:"Daily Habit Completion Rate",category:"Habit Success",description:"Percentage of target habits completed each day - target 80%+",targetDirection:"increase",unit:"%"},{id:"y-streak-survival",name:"Streak Survival Days",category:"Habit Success",description:"Number of days until streak is broken - higher is better",targetDirection:"increase",unit:"days"},{id:"y-weekly-consistency",name:"Weekly Completion Consistency",category:"Habit Success",description:"Consistency of completion times across the week (lower variance = better)",targetDirection:"optimize",unit:"std dev (hours)"},{id:"y-automaticity",name:"Habit Automaticity Score",category:"Habit Formation",description:"Self-reported ease of habit (SRHI scale) - target 5+",targetDirection:"increase",unit:"1-7 scale"},{id:"y-retention",name:"30-Day User Retention",category:"Engagement",description:"Whether user is still active after 30 days",targetDirection:"increase",unit:"boolean"}],Zd=[{id:"hb-user-001",name:"Marcus T.",avatar:"💪",enrollmentDate:"2024-12-05",activeDays:45,complianceRate:92,currentPhase:"Active Optimization",tags:["fitness-focused","morning-person","apple-watch","high-performer"],dataSources:["Apple Watch","Habit Band","Weekly Surveys"],insightCount:4},{id:"hb-user-002",name:"Elena R.",avatar:"🌱",enrollmentDate:"2024-12-30",activeDays:21,complianceRate:68,currentPhase:"Baseline",tags:["new-user","multiple-habits","needs-reminders","evening-person"],dataSources:["Fitbit","Habit Band","Weekly Surveys"],insightCount:3}],qd=[{id:"hb-insight-001",title:"Morning Magic Window",description:'Habits completed before 8 AM have 2.3x higher streak survival than those completed later. Early completion creates psychological "win" that reinforces the habit loop.',xVariables:["x-completion-hour","x-sleep-score"],yVariable:"y-streak-survival",modelType:"causal",confidence:.87,theta:8,beta:2.3,recommendation:"Set habit reminders for 6:30-7:30 AM. Complete highest-priority habit before breakfast.",linkedResources:["habit-log-001","wearable-sleep-001"]},{id:"hb-insight-002",title:"Habit Stacking Multiplier",description:"Completing a new habit immediately after an existing routine increases completion rate by 47%. Anchoring to established behaviors reduces friction.",xVariables:["x-habit-stack-count","x-previous-day-completed"],yVariable:"y-completion-rate",modelType:"causal",confidence:.82,theta:1,beta:.47,recommendation:"Pair new habits with existing routines: meditation after morning coffee, stretching after brushing teeth.",linkedResources:["habit-stack-001"]},{id:"hb-insight-003",title:"Sleep-Habit Connection",description:"Sleep quality below 70% predicts a 35% drop in next-day habit completion. Poor sleep depletes willpower reserves needed for habit execution.",xVariables:["x-sleep-score","x-morning-hrv"],yVariable:"y-completion-rate",modelType:"causal",confidence:.79,theta:70,beta:-.35,recommendation:"On low-sleep days, reduce habit targets to essentials only. Protect sleep as the foundation.",linkedResources:["wearable-sleep-002","habit-log-002"]},{id:"hb-insight-004",title:"Reminder Response Window",description:"Responding to habit reminders within 5 minutes correlates with 89% completion rate. Delayed response drops completion to 34%.",xVariables:["x-reminder-response-time","x-notification-tap-rate"],yVariable:"y-completion-rate",modelType:"causal",confidence:.91,theta:5,beta:.89,recommendation:"Act immediately when reminder fires. Set reminders for moments of low friction (post-meal, transitions).",linkedResources:["engagement-001"]}],Kd={id:"habit-bandz",name:"Habit Bandz",logo:"🎯",description:"Habit tracking platform with companion wearable band. Focus on behavioral habit formation, streak optimization, and habit stacking. 2 pilot users in early beta.",dataSources:Gd,xVariables:Ud,yVariables:Yd,insights:qd,users:Zd},Oi=[zd,Kd];function ca(t){return Oi.find(a=>a.id===t)}function Xd(){return Oi.map(t=>({id:t.id,name:t.name,logo:t.logo,dataSourceCount:t.dataSources.length,xVariableCount:t.xVariables.length,yVariableCount:t.yVariables.length,insightCount:t.insights.length,userCount:t.users.length,totalRecords:t.dataSources.reduce((a,s)=>a+(s.recordCount||0),0)}))}function Qd(){const t=[],a=new Date("2025-01-20");for(let s=44;s>=0;s--){const i=new Date(a);i.setDate(i.getDate()-s);const r=i.toISOString().split("T")[0],n=i.getDay()===0||i.getDay()===6,o=70+Math.floor(Math.random()*25),c=42+Math.floor(Math.random()*18),l=.92,d=o<70?.15:0,u=l-d,m=[];if(Math.random()<u+.05){const h=n?7+Math.random()*1.5:6+Math.random();m.push({habitId:"habit-workout",completedAt:`${r}T${String(Math.floor(h)).padStart(2,"0")}:${String(Math.floor(h%1*60)).padStart(2,"0")}:00Z`,reminderResponseMin:Math.floor(Math.random()*3)+1})}if(m.length>0&&Math.random()<u){const h=new Date(m[0].completedAt);h.setMinutes(h.getMinutes()+35+Math.floor(Math.random()*15)),m.push({habitId:"habit-meditation",completedAt:h.toISOString(),reminderResponseMin:Math.floor(Math.random()*2)+1})}Math.random()<u-.05&&m.push({habitId:"habit-reading",completedAt:`${r}T${21+Math.floor(Math.random()*2)}:${String(Math.floor(Math.random()*60)).padStart(2,"0")}:00Z`,reminderResponseMin:Math.floor(Math.random()*8)+2}),t.push({date:r,habitsCompleted:m.length,habitsTarget:3,completions:m,sleepScorePriorNight:o,hrvMorning:c,motivationLevel:7+Math.floor(Math.random()*3)})}return t}function Jd(){const t=[],a=new Date("2025-01-20");for(let s=20;s>=0;s--){const i=new Date(a);i.setDate(i.getDate()-s);const r=i.toISOString().split("T")[0],n=i.getDay()===0||i.getDay()===6,o=55+Math.floor(Math.random()*35),c=35+Math.floor(Math.random()*20),l=.68,d=o<70?.25:0,u=n?.1:0,m=l-d+u,h=[];if(Math.random()<m+.15&&h.push({habitId:"habit-journaling",completedAt:`${r}T${20+Math.floor(Math.random()*2)}:${String(Math.floor(Math.random()*60)).padStart(2,"0")}:00Z`,reminderResponseMin:Math.floor(Math.random()*5)+2}),h.some(p=>p.habitId==="habit-journaling")&&Math.random()<.87){const p=new Date(h.find(b=>b.habitId==="habit-journaling").completedAt);p.setMinutes(p.getMinutes()+10+Math.floor(Math.random()*10)),h.push({habitId:"habit-gratitude",completedAt:p.toISOString(),reminderResponseMin:1})}Math.random()<m-.1&&h.push({habitId:"habit-stretching",completedAt:`${r}T${18+Math.floor(Math.random()*3)}:${String(Math.floor(Math.random()*60)).padStart(2,"0")}:00Z`,reminderResponseMin:Math.floor(Math.random()*15)+5}),Math.random()<m-.15&&h.push({habitId:"habit-water",completedAt:`${r}T${12+Math.floor(Math.random()*8)}:${String(Math.floor(Math.random()*60)).padStart(2,"0")}:00Z`,reminderResponseMin:Math.floor(Math.random()*20)+5}),Math.random()<m-.25&&h.push({habitId:"habit-screen-cutoff",completedAt:`${r}T21:30:00Z`,reminderResponseMin:Math.floor(Math.random()*10)+3}),t.push({date:r,habitsCompleted:h.length,habitsTarget:5,completions:h,sleepScorePriorNight:o,hrvMorning:c,motivationLevel:5+Math.floor(Math.random()*4)})}return t}const e0={userId:"hb-user-001",name:"Marcus T.",avatar:"💪",archetype:"The Streak Builder",enrollmentDate:"2024-12-05",activeDays:45,complianceRate:92,currentPhase:"Active Optimization",tags:["fitness-focused","morning-person","apple-watch","high-performer"],dataSources:[{id:"ds-apple",name:"Apple Watch",icon:"watch",connected:!0,lastSync:"2025-01-20T08:00:00Z"},{id:"ds-band",name:"Habit Band",icon:"target",connected:!0,lastSync:"2025-01-20T07:15:00Z"},{id:"ds-surveys",name:"Weekly Surveys",icon:"clipboard",connected:!0,lastSync:"2025-01-19T20:00:00Z"}],habits:[{id:"habit-workout",name:"Morning Workout",category:"Fitness",emoji:"🏋️",targetFrequency:"daily",currentStreak:28,bestStreak:28,completionRate:96,avgCompletionTime:"6:45 AM"},{id:"habit-meditation",name:"Meditation",category:"Mindfulness",emoji:"🧘",targetFrequency:"daily",currentStreak:28,bestStreak:28,completionRate:91,avgCompletionTime:"7:25 AM",stackedWith:"habit-workout"},{id:"habit-reading",name:"Evening Reading",category:"Learning",emoji:"📚",targetFrequency:"daily",currentStreak:12,bestStreak:19,completionRate:84,avgCompletionTime:"9:30 PM"}],dailyLogs:Qd(),personalInsights:[{id:"ins-marcus-001",title:"Early Bird Advantage",subtitle:"Your workouts before 7 AM have 98% streak survival",xVariable:"Workout completion time",yVariable:"Streak survival",theta:{value:7,unit:"hour",displayValue:"7:00 AM"},betaBelow:{value:.98,description:"98% streak survival rate"},betaAbove:{value:-.18,description:"-18% survival per hour after 7 AM"},currentValue:6.75,currentUnit:"hour",currentStatus:"at_optimal",personalDataPct:94,populationDataPct:6,observations:42,daysOfData:45,curveType:"plateau_down",actionableAdvice:"Your 6:45 AM average is perfect. Keep protecting this window."},{id:"ins-marcus-002",title:"Meditation Stack",subtitle:"Stacking meditation after workout gives 3x streak survival",xVariable:"Minutes after workout",yVariable:"Meditation streak",theta:{value:45,unit:"min",displayValue:"45 min after workout"},betaBelow:{value:3,description:"3x streak survival"},betaAbove:{value:-.5,description:"-50% survival if delayed >45 min"},currentValue:35,currentUnit:"min",currentStatus:"at_optimal",personalDataPct:91,populationDataPct:9,observations:38,daysOfData:45,curveType:"plateau_down",actionableAdvice:"Your habit stack is working perfectly. Meditation follows workout 91% of the time."},{id:"ins-marcus-003",title:"Sleep-Recovery Link",subtitle:"HRV below 45ms predicts skipped meditation",xVariable:"Morning HRV",yVariable:"Meditation completion",theta:{value:45,unit:"ms",displayValue:"45 ms RMSSD"},betaBelow:{value:-.28,description:"-28% completion rate"},betaAbove:{value:.02,description:"Minimal additional benefit"},currentValue:52,currentUnit:"ms",currentStatus:"at_optimal",personalDataPct:88,populationDataPct:12,observations:45,daysOfData:45,curveType:"plateau_up",actionableAdvice:"Your average HRV is 52ms - well above threshold. Keep prioritizing recovery."},{id:"ins-marcus-004",title:"Reading Timing",subtitle:"Reading after 10 PM reduces next-day workout quality",xVariable:"Reading completion time",yVariable:"Next-day workout intensity",theta:{value:22,unit:"hour",displayValue:"10:00 PM"},betaBelow:{value:.85,description:"85% workout intensity maintained"},betaAbove:{value:-.12,description:"-12% intensity per hour after 10 PM"},currentValue:21.5,currentUnit:"hour",currentStatus:"at_optimal",personalDataPct:78,populationDataPct:22,observations:35,daysOfData:45,curveType:"plateau_down",actionableAdvice:"Your 9:30 PM average is great. Consider a hard stop at 10 PM."}],keyMetrics:[{id:"km-streak",name:"Current Streak",value:28,unit:"days",change:7,changeDirection:"up",isGood:!0,sparklineData:[14,15,18,21,24,26,28],period:"7-day"},{id:"km-completion",name:"Completion Rate",value:92,unit:"%",change:4,changeDirection:"up",isGood:!0,sparklineData:[85,87,88,90,91,91,92],period:"7-day"},{id:"km-consistency",name:"Timing Consistency",value:.8,unit:"hr std",change:-.3,changeDirection:"down",isGood:!0,sparklineData:[1.4,1.2,1.1,1,.9,.85,.8],period:"7-day"},{id:"km-response",name:"Avg Reminder Response",value:2.1,unit:"min",change:-.8,changeDirection:"down",isGood:!0,sparklineData:[3.5,3.2,2.8,2.5,2.3,2.2,2.1],period:"7-day"}],weeklyStats:[{week:"2025-W03",completionRate:92,avgStreakLength:26,habitStackEvents:6,avgReminderResponse:2.1},{week:"2025-W02",completionRate:90,avgStreakLength:19,habitStackEvents:6,avgReminderResponse:2.5},{week:"2025-W01",completionRate:88,avgStreakLength:12,habitStackEvents:5,avgReminderResponse:3.2},{week:"2024-W52",completionRate:85,avgStreakLength:5,habitStackEvents:4,avgReminderResponse:4.1}]},t0={userId:"hb-user-002",name:"Elena R.",avatar:"🌱",archetype:"The Habit Explorer",enrollmentDate:"2024-12-30",activeDays:21,complianceRate:68,currentPhase:"Baseline",tags:["new-user","multiple-habits","needs-reminders","evening-person"],dataSources:[{id:"ds-fitbit",name:"Fitbit",icon:"watch",connected:!0,lastSync:"2025-01-20T07:30:00Z"},{id:"ds-band",name:"Habit Band",icon:"target",connected:!0,lastSync:"2025-01-20T06:45:00Z"},{id:"ds-surveys",name:"Weekly Surveys",icon:"clipboard",connected:!0,lastSync:"2025-01-19T21:00:00Z"}],habits:[{id:"habit-journaling",name:"Evening Journaling",category:"Mindfulness",emoji:"📝",targetFrequency:"daily",currentStreak:5,bestStreak:8,completionRate:81,avgCompletionTime:"8:45 PM"},{id:"habit-gratitude",name:"Gratitude Practice",category:"Mindfulness",emoji:"🙏",targetFrequency:"daily",currentStreak:5,bestStreak:7,completionRate:76,avgCompletionTime:"9:00 PM",stackedWith:"habit-journaling"},{id:"habit-stretching",name:"Evening Stretching",category:"Fitness",emoji:"🧘‍♀️",targetFrequency:"daily",currentStreak:2,bestStreak:5,completionRate:58,avgCompletionTime:"7:15 PM"},{id:"habit-water",name:"Water Intake (8 glasses)",category:"Health",emoji:"💧",targetFrequency:"daily",currentStreak:1,bestStreak:4,completionRate:52,avgCompletionTime:"3:30 PM"},{id:"habit-screen-cutoff",name:"Screen Cutoff (9:30 PM)",category:"Sleep",emoji:"📵",targetFrequency:"daily",currentStreak:0,bestStreak:3,completionRate:38,avgCompletionTime:"9:30 PM"}],dailyLogs:Jd(),personalInsights:[{id:"ins-elena-001",title:"Journaling-Gratitude Stack",subtitle:"When you journal first, gratitude completion is 87%",xVariable:"Journaling completed",yVariable:"Gratitude completion",theta:{value:1,unit:"boolean",displayValue:"Journal first"},betaBelow:{value:.35,description:"35% gratitude completion alone"},betaAbove:{value:.87,description:"87% when stacked with journaling"},currentValue:1,currentUnit:"stack",currentStatus:"at_optimal",personalDataPct:86,populationDataPct:14,observations:17,daysOfData:21,curveType:"plateau_up",actionableAdvice:"This stack is working! Consider dropping other habits to focus on this pair."},{id:"ins-elena-002",title:"Sleep-Habit Correlation",subtitle:"Sleep below 70% predicts 42% drop in next-day habits",xVariable:"Prior night sleep score",yVariable:"Next-day completion rate",theta:{value:70,unit:"%",displayValue:"70% sleep score"},betaBelow:{value:-.42,description:"-42% completion rate"},betaAbove:{value:.05,description:"+5% per 10 points above threshold"},currentValue:62,currentUnit:"%",currentStatus:"below_optimal",personalDataPct:82,populationDataPct:18,observations:21,daysOfData:21,curveType:"plateau_up",actionableAdvice:"Your avg sleep score is 62%. Improving sleep would boost all your habits."},{id:"ins-elena-003",title:"Too Many Habits",subtitle:"You complete 2.1 habits/day on average vs 5 target",xVariable:"Number of active habits",yVariable:"Per-habit completion rate",theta:{value:3,unit:"habits",displayValue:"3 habits max"},betaBelow:{value:.78,description:"78% completion per habit"},betaAbove:{value:-.15,description:"-15% per additional habit"},currentValue:5,currentUnit:"habits",currentStatus:"above_optimal",personalDataPct:75,populationDataPct:25,observations:21,daysOfData:21,curveType:"plateau_down",actionableAdvice:"Research shows 2-3 habits is optimal for new users. Consider pausing Water and Screen Cutoff."}],keyMetrics:[{id:"km-streak",name:"Best Active Streak",value:5,unit:"days",change:2,changeDirection:"up",isGood:!0,sparklineData:[2,3,0,2,4,5,5],period:"7-day"},{id:"km-completion",name:"Completion Rate",value:68,unit:"%",change:8,changeDirection:"up",isGood:!0,sparklineData:[55,58,62,60,65,68,68],period:"7-day"},{id:"km-stack-rate",name:"Stack Success Rate",value:87,unit:"%",change:12,changeDirection:"up",isGood:!0,sparklineData:[70,72,78,80,82,85,87],period:"7-day"},{id:"km-response",name:"Avg Reminder Response",value:6.8,unit:"min",change:-2.1,changeDirection:"down",isGood:!0,sparklineData:[12,10,9,8.5,7.5,7,6.8],period:"7-day"}],weeklyStats:[{week:"2025-W03",completionRate:68,avgStreakLength:4.2,habitStackEvents:5,avgReminderResponse:6.8},{week:"2025-W02",completionRate:62,avgStreakLength:3.1,habitStackEvents:4,avgReminderResponse:8.5},{week:"2025-W01",completionRate:55,avgStreakLength:2,habitStackEvents:2,avgReminderResponse:11.2}]},a0={"hb-user-001":e0,"hb-user-002":t0};function s0(t){return a0[t]}function i0(){const t=[],a=new Date("2025-01-20T00:00:00Z");for(let s=6;s>=0;s--)for(let i=0;i<96;i++){const r=new Date(a);r.setDate(r.getDate()-s),r.setMinutes(i*15);const n=Math.floor(i*15/60);let o=95;n>=7&&n<9?o=105+Math.sin((n-7)*Math.PI)*25:n>=12&&n<14?o=110+Math.sin((n-12)*Math.PI)*35:n>=19&&n<21?o=115+Math.sin((n-19)*Math.PI)*45:n>=4&&n<7&&(o=98+(n-4)*3);const c=(Math.random()-.5)*15,l=Math.round(Math.max(70,Math.min(180,o+c)));let d="stable";if(t.length>0){const u=l-t[t.length-1].glucose;u>10?d="rising_fast":u>3?d="rising":u<-10?d="falling_fast":u<-3&&(d="falling")}t.push({timestamp:r.toISOString(),glucose:l,trend:d})}return t}function r0(){const t=[],a=new Date("2025-01-20");for(let s=29;s>=0;s--){const i=new Date(a);i.setDate(i.getDate()-s);const r=1-s/60;t.push({date:i.toISOString().split("T")[0],sleepScore:Math.round(72+r*10+(Math.random()-.5)*8),sleepDuration:Math.round(390+r*30+(Math.random()-.5)*40),deepSleep:Math.round(60+r*15+(Math.random()-.5)*15),remSleep:Math.round(85+r*10+(Math.random()-.5)*20),hrv:Math.round(38+r*8+(Math.random()-.5)*8),restingHR:Math.round(62-r*4+(Math.random()-.5)*4),steps:Math.round(7e3+r*2e3+(Math.random()-.5)*3e3),activeEnergy:Math.round(350+r*100+(Math.random()-.5)*100),zone2Minutes:Math.round(15+r*20+Math.random()*15),stressScore:Math.round(45-r*10+(Math.random()-.5)*15)})}return t}const n0={userId:"he-user-001",name:"Arjun K.",avatar:"/avatars/arjun.jpg",archetype:"The Optimizing Executive",enrollmentDate:"2024-07-15",activeDays:180,complianceRate:94,currentPhase:"Optimization",tags:["prediabetes","tech-professional","apple-watch","cgm-user"],dataSources:[{id:"ds-apple",name:"Apple Watch",icon:"watch",connected:!0,lastSync:"2025-01-20T08:00:00Z"},{id:"ds-cgm",name:"Libre CGM",icon:"activity",connected:!0,lastSync:"2025-01-20T07:45:00Z"},{id:"ds-thyrocare",name:"Thyrocare Labs",icon:"flask",connected:!0,lastSync:"2025-01-10T00:00:00Z"},{id:"ds-withings",name:"Withings Scale",icon:"scale",connected:!0,lastSync:"2025-01-20T06:30:00Z"},{id:"ds-omron",name:"Omron BP",icon:"heart",connected:!0,lastSync:"2025-01-19T20:00:00Z"}],cgmReadings:i0(),dailyMetrics:r0(),labHistory:[{biomarker:"HbA1c",code:"4548-4",unit:"%",readings:[{date:"2024-07-15",value:6.2},{date:"2024-10-15",value:5.9},{date:"2025-01-10",value:5.6}],trend:"improving",targetRange:{low:4,high:5.6},currentInterpretation:"optimal"},{biomarker:"Fasting Glucose",code:"2339-0",unit:"mg/dL",readings:[{date:"2024-07-15",value:118},{date:"2024-10-15",value:108},{date:"2025-01-10",value:98}],trend:"improving",targetRange:{low:70,high:100},currentInterpretation:"optimal"},{biomarker:"Fasting Insulin",code:"2484-4",unit:"mIU/L",readings:[{date:"2024-07-15",value:18.2},{date:"2024-10-15",value:14.5},{date:"2025-01-10",value:10.8}],trend:"improving",targetRange:{low:2.6,high:11},currentInterpretation:"normal"},{biomarker:"hs-CRP",code:"1988-5",unit:"mg/L",readings:[{date:"2024-07-15",value:3.8},{date:"2024-10-15",value:2.4},{date:"2025-01-10",value:1.6}],trend:"improving",targetRange:{low:0,high:1},currentInterpretation:"borderline"},{biomarker:"Vitamin D",code:"1989-3",unit:"ng/mL",readings:[{date:"2024-07-15",value:22},{date:"2024-10-15",value:32},{date:"2025-01-10",value:45}],trend:"improving",targetRange:{low:40,high:80},currentInterpretation:"optimal"},{biomarker:"ApoB",code:"1884-6",unit:"mg/dL",readings:[{date:"2024-07-15",value:112},{date:"2024-10-15",value:102},{date:"2025-01-10",value:94}],trend:"improving",targetRange:{low:0,high:90},currentInterpretation:"borderline"}],personalInsights:[{id:"ins-001",title:"Post-Dinner Walk",subtitle:"Reduces your glucose spike by 22%",xVariable:"Post-meal steps",yVariable:"Glucose spike",theta:{value:1200,unit:"steps",displayValue:"1,200 steps"},betaBelow:{value:-.22,description:"-22% glucose spike reduction"},betaAbove:{value:.03,description:"+3% minimal additional benefit"},currentValue:1847,currentUnit:"steps",currentStatus:"at_optimal",personalDataPct:89,populationDataPct:11,observations:142,daysOfData:156,curveType:"plateau_down",actionableAdvice:"Keep this up! Your post-meal walks are working well."},{id:"ins-002",title:"Bedtime Threshold",subtitle:"Your sleep efficiency drops after 10:15 PM",xVariable:"Bedtime",yVariable:"Sleep efficiency",theta:{value:22.25,unit:"hour",displayValue:"10:15 PM"},betaBelow:{value:.85,description:"85% sleep efficiency"},betaAbove:{value:-.023,description:"-2.3% per hour after threshold"},currentValue:22.5,currentUnit:"hour",currentStatus:"above_optimal",personalDataPct:92,populationDataPct:8,observations:168,daysOfData:180,curveType:"plateau_down",actionableAdvice:"Try winding down 30 minutes earlier tonight."},{id:"ins-003",title:"Zone 2 Training",subtitle:"Optimal at 150+ minutes/week for your HRV",xVariable:"Weekly Zone 2 minutes",yVariable:"HRV (RMSSD)",theta:{value:150,unit:"min/week",displayValue:"150 min/week"},betaBelow:{value:.12,description:"+12% HRV per 30 min added"},betaAbove:{value:.02,description:"+2% diminishing returns"},currentValue:135,currentUnit:"min/week",currentStatus:"below_optimal",personalDataPct:78,populationDataPct:22,observations:24,daysOfData:168,curveType:"plateau_up",actionableAdvice:"Add one more 30-min easy walk this week to hit your threshold."},{id:"ins-004",title:"Caffeine Cutoff",subtitle:"Your deep sleep improves with 2 PM cutoff",xVariable:"Last caffeine time",yVariable:"Deep sleep %",theta:{value:14,unit:"hour",displayValue:"2:00 PM"},betaBelow:{value:.18,description:"18% deep sleep"},betaAbove:{value:-.015,description:"-1.5% per hour after 2 PM"},currentValue:15,currentUnit:"hour",currentStatus:"above_optimal",personalDataPct:85,populationDataPct:15,observations:89,daysOfData:120,curveType:"plateau_down",actionableAdvice:"Your afternoon coffee at 3 PM is costing you ~12 min of deep sleep."}],interventions:[{code:"INT-Z2-001",name:"Zone 2 Cardio Protocol",category:"exercise",startDate:"2024-08-01",targetMetric:"VO2max, hs-CRP",compliance:88,lastCompleted:"2025-01-19",streak:12},{code:"INT-TRE-001",name:"Time-Restricted Eating (16:8)",category:"nutrition",startDate:"2024-09-15",targetMetric:"Fasting glucose, TIR",compliance:92,lastCompleted:"2025-01-20",streak:28},{code:"INT-VITD-001",name:"Vitamin D3 5000 IU",category:"supplement",startDate:"2024-07-20",targetMetric:"Vitamin D level",compliance:98,lastCompleted:"2025-01-20",streak:45},{code:"INT-SLEEP-001",name:"Sleep Hygiene Protocol",category:"sleep",startDate:"2024-10-01",targetMetric:"Deep sleep %, HRV",compliance:76,lastCompleted:"2025-01-19",streak:5}],dailyProtocol:[{priority:1,code:"PROTO_POSTMEAL_WALK",action:"15-min walk after dinner",reason:"Reduces your glucose spike by 22%",linkedInsightId:"ins-001",timeOfDay:"After dinner"},{priority:2,code:"SUPP_VITAMIN_D",action:"Take Vitamin D with breakfast",reason:"Maintaining your level at 45 ng/mL",timeOfDay:"Morning"},{priority:3,code:"CARDIO_ZONE2",action:"Zone 2 cardio: 30 min easy pace",reason:"2 more sessions this week to hit 150 min target",linkedInsightId:"ins-003",timeOfDay:"Anytime"},{priority:4,code:"PROTO_BEDTIME_ROUTINE",action:"Wind down by 10:00 PM",reason:"Your sleep efficiency drops 2.3%/hr after 10:15 PM",linkedInsightId:"ins-002",timeOfDay:"Evening"},{priority:5,code:"NUTRITION_CAFFEINE",action:"No caffeine after 2 PM",reason:"Protects your deep sleep",linkedInsightId:"ins-004",timeOfDay:"Afternoon"}],keyMetrics:[{id:"km-tir",name:"Time in Range",value:85,unit:"%",change:8,changeDirection:"up",isGood:!0,sparklineData:[72,74,78,76,80,82,85],period:"7-day"},{id:"km-hba1c",name:"HbA1c",value:5.6,unit:"%",change:-.3,changeDirection:"down",isGood:!0,sparklineData:[6.2,5.9,5.6],period:"quarterly"},{id:"km-hrv",name:"HRV",value:45,unit:"ms",change:7,changeDirection:"up",isGood:!0,sparklineData:[38,40,42,41,44,43,45],period:"7-day"},{id:"km-deep",name:"Deep Sleep",value:78,unit:"min",change:12,changeDirection:"up",isGood:!0,sparklineData:[62,68,70,72,75,74,78],period:"7-day"},{id:"km-steps",name:"Avg Steps",value:9234,unit:"steps",change:1850,changeDirection:"up",isGood:!0,sparklineData:[7200,8100,8900,9500,8800,9400,9234],period:"7-day"},{id:"km-crp",name:"hs-CRP",value:1.6,unit:"mg/L",change:-.8,changeDirection:"down",isGood:!0,sparklineData:[3.8,2.4,1.6],period:"quarterly"}]},o0={"he-user-001":n0};function l0(t){return o0[t]}function c0(t,a){if(t==="human-edge")return l0(a);if(t==="habit-bandz")return s0(a)}const Xt={dataSourceTypes:[],variableCategories:[],searchQuery:""},te=At((t,a)=>({activeClientId:null,activeClient:null,viewMode:"overview",selectedDataSourceId:null,selectedInsightId:null,selectedUserId:null,userDetail:null,userDetailLoading:!1,filters:{...Xt},clientSummaries:Xd(),setActiveClient:s=>{const i=ca(s);t({activeClientId:s,activeClient:i||null,selectedDataSourceId:null,selectedInsightId:null,selectedUserId:null,userDetail:null,filters:{...Xt}})},setViewMode:s=>{t({viewMode:s})},setSelectedDataSource:s=>{t({selectedDataSourceId:s})},setSelectedInsight:s=>{t({selectedInsightId:s})},setSelectedUser:s=>{t({selectedUserId:s})},loadUserDetail:(s,i)=>{t({userDetailLoading:!0}),setTimeout(()=>{const r=c0(s,i);t({userDetail:r||null,userDetailLoading:!1,selectedUserId:i,activeClientId:s,activeClient:ca(s)||null})},100)},clearUserDetail:()=>{t({userDetail:null,selectedUserId:null})},setFilters:s=>{t(i=>({filters:{...i.filters,...s}}))},resetFilters:()=>{t({filters:{...Xt}})},getDataSources:()=>a().activeClient?.dataSources||[],getXVariables:()=>a().activeClient?.xVariables||[],getYVariables:()=>a().activeClient?.yVariables||[],getInsights:()=>a().activeClient?.insights||[],getUsers:()=>a().activeClient?.users||[],getDataSourceById:s=>a().getDataSources().find(i=>i.id===s),getInsightById:s=>a().getInsights().find(i=>i.id===s),getUserById:s=>a().getUsers().find(i=>i.id===s),getFilteredXVariables:()=>{const{filters:s}=a();let i=a().getXVariables();if(s.dataSourceTypes.length>0&&(i=i.filter(r=>s.dataSourceTypes.includes(r.dataSource))),s.variableCategories.length>0&&(i=i.filter(r=>s.variableCategories.includes(r.category))),s.searchQuery){const r=s.searchQuery.toLowerCase();i=i.filter(n=>n.name.toLowerCase().includes(r)||n.description.toLowerCase().includes(r))}return i},getFilteredInsights:()=>{const{filters:s}=a();let i=a().getInsights();if(s.searchQuery){const r=s.searchQuery.toLowerCase();i=i.filter(n=>n.title.toLowerCase().includes(r)||n.description.toLowerCase().includes(r))}return i}})),d0=()=>te(t=>t.activeClient),m0=()=>te(t=>t.clientSummaries),Bi=()=>te(a=>a.activeClient)?.dataSources||[],Fi=()=>te(a=>a.activeClient)?.xVariables||[],$i=()=>te(a=>a.activeClient)?.yVariables||[],u0=()=>te(a=>a.activeClient)?.insights||[],h0=()=>te(a=>a.activeClient)?.users||[],p0=()=>{const t=Bi(),a=t.reduce((n,o)=>n+(o.recordCount||0),0),s=t.filter(n=>n.status==="active").length,i=t.filter(n=>n.status==="error").length,r=t.reduce((n,o)=>{if(!o.lastSync)return n;const c=new Date(o.lastSync);return c>n?c:n},new Date(0));return{totalSources:t.length,totalRecords:a,activeCount:s,errorCount:i,lastSync:r.getTime()>0?r.toISOString():null}},g0=()=>te(t=>t.userDetail),x0=()=>te(t=>t.userDetailLoading);function b0(t){return t?"cgmReadings"in t:!1}function f0({source:t}){const a={active:"bg-green-100 text-green-700 border-green-200",pending:"bg-yellow-100 text-yellow-700 border-yellow-200",error:"bg-red-100 text-red-700 border-red-200"},i={active:Ne,pending:pe,error:oe}[t.status],r=n=>n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(0)}K`:n.toString();return e.jsxs(k,{className:"p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-primary-50 rounded-lg",children:e.jsx(ce,{className:"w-4 h-4 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:t.name}),e.jsx("p",{className:"text-xs text-gray-500",children:t.type})]})]}),e.jsxs(A,{className:a[t.status],children:[e.jsx(i,{className:"w-3 h-3 mr-1"}),t.status]})]}),e.jsx("p",{className:"text-xs text-gray-600 mb-3 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[e.jsx(ga,{className:"w-3 h-3"}),e.jsxs("span",{children:[r(t.recordCount||0)," records"]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[e.jsx(et,{className:"w-3 h-3"}),e.jsx("span",{children:t.cadence})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:e.jsx("p",{className:"text-xs text-gray-400 font-mono truncate",title:t.pipeline,children:t.pipeline})})]})}function ms({variable:t,type:a}){const s=a==="y",i=t;return e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold ${s?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:a.toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 text-sm truncate",children:t.name}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:t.category})]}),!s&&t.unit&&e.jsx(A,{variant:"outline",className:"text-xs",children:t.unit}),s&&e.jsxs(A,{variant:"outline",className:`text-xs ${i.targetDirection==="increase"?"text-green-600 border-green-200":i.targetDirection==="decrease"?"text-red-600 border-red-200":"text-blue-600 border-blue-200"}`,children:[i.targetDirection==="increase"&&"↑",i.targetDirection==="decrease"&&"↓",i.targetDirection==="optimize"&&"◎",i.targetDirection==="maintain"&&"→"]})]})}function y0({insight:t}){const a=Fi(),s=$i(),i=t.xVariables.map(n=>a.find(o=>o.id===n)).filter(Boolean),r=s.find(n=>n.id===t.yVariable);return e.jsxs(k,{className:"p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx(A,{className:`text-xs ${t.modelType==="causal"?"bg-purple-100 text-purple-700":t.modelType==="predictive"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:t.modelType}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[e.jsx(de,{className:"w-3 h-3"}),Math.round(t.confidence*100),"% confidence"]})]}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center gap-2 mb-3 flex-wrap",children:[i.map((n,o)=>e.jsxs("span",{children:[e.jsx(A,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700",children:n.name}),o<i.length-1&&e.jsx("span",{className:"text-gray-400 mx-1",children:"+"})]},n.id)),e.jsx(ve,{className:"w-4 h-4 text-gray-400"}),r&&e.jsx(A,{variant:"outline",className:"text-xs bg-green-50 text-green-700",children:r.name})]}),(t.theta!==void 0||t.beta!==void 0)&&e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500 mb-3",children:[t.theta!==void 0&&e.jsxs("span",{children:["θ = ",e.jsx("span",{className:"font-mono text-gray-700",children:t.theta})]}),t.beta!==void 0&&e.jsxs("span",{children:["β = ",e.jsx("span",{className:"font-mono text-gray-700",children:t.beta})]})]}),t.recommendation&&e.jsx("div",{className:"pt-3 border-t border-gray-100",children:e.jsxs("p",{className:"text-xs text-primary-600 flex items-start gap-1",children:[e.jsx(Le,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),t.recommendation]})})]})}function v0({user:t,clientId:a}){const[s,i]=g.useState(!1),r=t.complianceRate>=90?"text-emerald-600 bg-emerald-50 border-emerald-200":t.complianceRate>=70?"text-amber-600 bg-amber-50 border-amber-200":"text-rose-600 bg-rose-50 border-rose-200";return e.jsxs(k,{className:"overflow-hidden transition-all duration-200 hover:shadow-md",children:[e.jsxs("div",{className:"p-4 flex items-center gap-4 cursor-pointer hover:bg-slate-50/50 transition-colors",onClick:()=>i(!s),children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center text-white text-lg font-semibold flex-shrink-0",children:t.avatar||t.name.charAt(0)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-slate-800 truncate",children:t.name}),e.jsx("p",{className:"text-xs text-slate-500",children:t.currentPhase})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-700",children:t.activeDays}),e.jsx("p",{className:"text-[10px] text-slate-400 uppercase tracking-wider",children:"Days"})]}),e.jsxs("div",{className:`px-2.5 py-1 rounded-full text-xs font-medium border ${r}`,children:[t.complianceRate,"%"]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-500",children:[e.jsx(ce,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:t.dataSources?.length||0})]})]}),e.jsx(M.div,{animate:{rotate:s?180:0},transition:{duration:.2},className:"flex-shrink-0",children:e.jsx(U,{className:"w-5 h-5 text-slate-400 transform rotate-90"})})]}),e.jsx(re,{children:s&&e.jsx(M.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:e.jsxs("div",{className:"px-4 pb-4 pt-2 border-t border-slate-100 bg-slate-50/30",children:[t.tags.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:t.tags.map(n=>e.jsx(A,{variant:"outline",className:"text-xs",children:n},n))})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-slate-100",children:[e.jsx("p",{className:"text-lg font-semibold text-slate-800",children:t.activeDays}),e.jsx("p",{className:"text-[10px] text-slate-500 uppercase tracking-wider",children:"Active Days"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-slate-100",children:[e.jsxs("p",{className:"text-lg font-semibold text-slate-800",children:[t.complianceRate,"%"]}),e.jsx("p",{className:"text-[10px] text-slate-500 uppercase tracking-wider",children:"Compliance"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-slate-100",children:[e.jsx("p",{className:"text-lg font-semibold text-slate-800",children:t.insightCount||0}),e.jsx("p",{className:"text-[10px] text-slate-500 uppercase tracking-wider",children:"Insights"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-slate-100",children:[e.jsx("p",{className:"text-lg font-semibold text-slate-800",children:t.dataSources?.length||0}),e.jsx("p",{className:"text-[10px] text-slate-500 uppercase tracking-wider",children:"Data Sources"})]})]}),t.dataSources&&t.dataSources.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Connected Sources"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.dataSources.map(n=>e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-white border border-slate-200 rounded-lg text-xs text-slate-600",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500"}),n]},n))})]}),e.jsxs(xs,{to:`/clients/${a}/users/${t.id}`,className:"flex items-center justify-center gap-2 w-full py-2.5 bg-primary-50 hover:bg-primary-100 text-primary-600 text-sm font-medium rounded-lg transition-colors",children:["View Full Profile",e.jsx(Sr,{className:"w-4 h-4"})]})]})})})]})}function w0({client:t,onSelect:a,isSelected:s}){const i=r=>r>=1e6?`${(r/1e6).toFixed(1)}M`:r>=1e3?`${(r/1e3).toFixed(0)}K`:r.toString();return e.jsxs(k,{className:`p-6 cursor-pointer transition-all ${s?"ring-2 ring-primary-500 bg-primary-50/50":"hover:shadow-lg hover:border-primary-200"}`,onClick:a,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-4xl",children:t.logo}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:t.name}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enterprise Client"})]})]}),e.jsx(U,{className:`w-5 h-5 transition-transform ${s?"rotate-90 text-primary-600":"text-gray-400"}`})]}),e.jsxs($,{columns:2,gap:"sm",className:"mb-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-1",children:[e.jsx(ce,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Data Sources"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.dataSourceCount})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-1",children:[e.jsx(ga,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Total Records"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i(t.totalRecords)})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-1",children:[e.jsx(z,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"X Variables"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.xVariableCount})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-1",children:[e.jsx(de,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Y Variables"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.yVariableCount})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(Le,{className:"w-4 h-4 text-primary-500"}),e.jsxs("span",{children:[t.insightCount," Active Insights"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(da,{className:"w-4 h-4"}),e.jsxs("span",{children:[t.userCount," Users"]})]})]})]})}function j0(){const t=m0(),a=d0(),s=Bi(),i=Fi(),r=$i(),n=u0(),o=h0(),c=p0(),{setActiveClient:l,activeClientId:d,viewMode:u,setViewMode:m}=te(),[h,p]=g.useState(!1),[b,y]=g.useState(!1);g.useEffect(()=>{!d&&t.length>0&&l(t[0].id)},[d,t,l]);const w=h?s:s.slice(0,6),v=b?i:i.slice(0,8),_=r.slice(0,5);return e.jsxs(Z,{title:"Enterprise Clients",subtitle:"Data infrastructure and causal insights for enterprise partners",actions:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(A,{variant:"outline",className:"text-sm",children:[e.jsx(Cr,{className:"w-4 h-4 mr-1"}),t.length," Active Clients"]})}),children:[e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:e.jsx($,{columns:2,gap:"lg",children:t.map(f=>e.jsx(w0,{client:f,onSelect:()=>l(f.id),isSelected:d===f.id},f.id))})}),a&&e.jsxs(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-8",children:[e.jsxs(k,{className:"p-6 bg-gradient-to-r from-slate-900 to-slate-800 text-white",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("span",{className:"text-5xl",children:a.logo}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:a.name}),e.jsx("p",{className:"text-gray-300",children:a.description})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mt-6",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-4",children:[e.jsx("p",{className:"text-3xl font-bold",children:c.totalSources}),e.jsx("p",{className:"text-sm text-gray-300",children:"Data Sources"})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-4",children:[e.jsx("p",{className:"text-3xl font-bold",children:c.totalRecords>=1e6?`${(c.totalRecords/1e6).toFixed(1)}M`:`${(c.totalRecords/1e3).toFixed(0)}K`}),e.jsx("p",{className:"text-sm text-gray-300",children:"Total Records"})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-4",children:[e.jsx("p",{className:"text-3xl font-bold",children:c.activeCount}),e.jsx("p",{className:"text-sm text-gray-300",children:"Active Pipelines"})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-4",children:[e.jsx("p",{className:"text-3xl font-bold",children:n.length}),e.jsx("p",{className:"text-sm text-gray-300",children:"Causal Insights"})]})]})]}),d==="human-edge"&&e.jsxs(k,{className:"p-6 border-2 border-emerald-200 bg-gradient-to-br from-emerald-50/50 to-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:e.jsx(ee,{className:"w-5 h-5 text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Serif Impact Dashboard"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Human Edge pilot metrics since integration (6 weeks)"})]})]}),e.jsxs(A,{className:"bg-emerald-100 text-emerald-700 border-emerald-200",children:[e.jsx(Ne,{className:"w-3 h-3 mr-1"}),"Live Pilot"]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-5 border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Retention Lift"}),e.jsx("span",{className:"text-xs text-emerald-600 font-medium",children:"vs baseline"})]}),e.jsx("p",{className:"text-4xl font-bold text-emerald-600",children:"3.2x"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Users with Serif insights"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-5 border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Daily Opens"}),e.jsx("span",{className:"text-xs text-emerald-600 font-medium",children:"+242%"})]}),e.jsx("p",{className:"text-4xl font-bold text-slate-800",children:"4.1x"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"vs 1.2x industry avg"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-5 border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider",children:"30-Day Retention"}),e.jsx("span",{className:"text-xs text-emerald-600 font-medium",children:"+8pp"})]}),e.jsx("p",{className:"text-4xl font-bold text-slate-800",children:"92%"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"vs 84% industry avg"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-5 border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Build vs Buy"}),e.jsx("span",{className:"text-xs text-emerald-600 font-medium",children:"saved"})]}),e.jsx("p",{className:"text-4xl font-bold text-slate-800",children:"$58K"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"/month vs in-house team"})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-slate-50 rounded-lg border border-slate-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ia,{className:"w-5 h-5 text-primary-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-700",children:"Serif's causal intelligence layer has increased user retention by 3.2x while reducing development costs by 85%."}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Integration completed in 6 weeks vs 18-24 month internal build estimate."})]})]})})]}),d==="habit-bandz"&&e.jsxs(k,{className:"p-6 border-2 border-violet-200 bg-gradient-to-br from-violet-50/50 to-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-violet-100 rounded-lg",children:e.jsx(ee,{className:"w-5 h-5 text-violet-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Serif Impact Dashboard"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Habit Bandz pilot metrics since integration (3 weeks)"})]})]}),e.jsxs(A,{className:"bg-violet-100 text-violet-700 border-violet-200",children:[e.jsx(pe,{className:"w-3 h-3 mr-1"}),"Early Pilot"]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-5 border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Streak Survival"}),e.jsx("span",{className:"text-xs text-violet-600 font-medium",children:"vs baseline"})]}),e.jsx("p",{className:"text-4xl font-bold text-violet-600",children:"2.8x"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Avg 11 days vs 4 days"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-5 border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider",children:"30-Day Retention"}),e.jsx("span",{className:"text-xs text-violet-600 font-medium",children:"+33pp"})]}),e.jsx("p",{className:"text-4xl font-bold text-slate-800",children:"78%"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"vs 45% habit app avg"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-5 border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Completion Lift"}),e.jsx("span",{className:"text-xs text-violet-600 font-medium",children:"+34%"})]}),e.jsx("p",{className:"text-4xl font-bold text-slate-800",children:"+34%"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Daily habit completion"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-5 border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Build vs Buy"}),e.jsx("span",{className:"text-xs text-violet-600 font-medium",children:"saved"})]}),e.jsx("p",{className:"text-4xl font-bold text-slate-800",children:"$42K"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"/month vs in-house ML"})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-slate-50 rounded-lg border border-slate-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ia,{className:"w-5 h-5 text-violet-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-700",children:"Serif's causal insights have increased average streak length from 4 days to 11 days, driving 2.8x improvement in habit success rates."}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Cross-platform insight: Sleep data from wearables predicts next-day habit completion with 79% accuracy."})]})]})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5 text-primary-600"}),"Data Sources & Pipelines"]}),s.length>6&&e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>p(!h),children:h?"Show Less":`Show All (${s.length})`})]}),e.jsx($,{columns:3,gap:"md",children:w.map(f=>e.jsx(f0,{source:f},f.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center text-xs font-bold",children:"X"}),"Predictor Variables (",i.length,")"]}),i.length>8&&e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>y(!b),children:b?"Show Less":"Show All"})]}),e.jsx(k,{className:"p-4",children:e.jsxs("div",{className:"space-y-2",children:[v.map(f=>e.jsx(ms,{variable:f,type:"x"},f.id)),!b&&i.length>8&&e.jsxs("p",{className:"text-xs text-gray-400 text-center py-2",children:["+",i.length-8," more variables"]})]})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2 mb-4",children:[e.jsx("span",{className:"w-6 h-6 rounded-full bg-green-100 text-green-700 flex items-center justify-center text-xs font-bold",children:"Y"}),"Outcome Variables (",r.length,")"]}),e.jsx(k,{className:"p-4",children:e.jsx("div",{className:"space-y-2",children:_.map(f=>e.jsx(ms,{variable:f,type:"y"},f.id))})})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2 mb-4",children:[e.jsx(Le,{className:"w-5 h-5 text-primary-600"}),"Causal Insights (X → Y Relationships)"]}),e.jsx($,{columns:2,gap:"md",children:n.map(f=>e.jsx(y0,{insight:f},f.id))})]}),o.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[e.jsx(da,{className:"w-5 h-5 text-primary-500"}),"Patient Overview (",o.length,")"]}),e.jsx("p",{className:"text-xs text-slate-500",children:"Click to expand details"})]}),e.jsx("div",{className:"space-y-3",children:o.map(f=>e.jsx(v0,{user:f,clientId:d},f.id))})]})]},a.id)]})}const N0={watch:ma,smartphone:Mr,flask:Fe,scale:xa,heart:ke,activity:z,cloud:Tr};function _0({name:t,avatar:a,archetype:s,clientName:i,clientLogo:r,enrollmentDate:n,activeDays:o,complianceRate:c,currentPhase:l,tags:d,dataSources:u,additionalStats:m=[],className:h}){const p=new Date(n).toLocaleDateString("en-US",{month:"short",year:"numeric"});return e.jsxs("div",{className:x("bg-white rounded-xl border border-gray-100 p-6",h),children:[e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsxs("div",{className:"flex-shrink-0",children:[a?e.jsx("img",{src:a,alt:t,className:"w-20 h-20 rounded-full object-cover border-4 border-white shadow-lg",onError:b=>{const y=b.target;y.style.display="none",y.nextElementSibling?.classList.remove("hidden")}}):null,e.jsx("div",{className:x("w-20 h-20 rounded-full bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center text-white text-3xl font-bold shadow-lg border-4 border-white",a&&"hidden"),children:t.charAt(0)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 truncate",children:t}),e.jsxs("span",{className:"px-2.5 py-1 bg-gray-100 text-gray-700 rounded-full text-sm font-medium flex items-center gap-1.5",children:[r&&e.jsx("span",{children:r}),i]})]}),e.jsxs("p",{className:"text-lg text-primary-600 font-medium mb-2",children:['"',s,'"']}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:d.map(b=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-50 text-gray-600 rounded text-xs font-medium",children:b},b))}),e.jsxs("div",{className:"flex flex-wrap gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(_e,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-gray-600",children:[e.jsx("strong",{children:o})," days active"]}),e.jsxs("span",{className:"text-gray-400",children:["since ",p]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(tt,{className:"w-4 h-4 text-green-500"}),e.jsxs("span",{className:"text-gray-600",children:[e.jsxs("strong",{children:[c,"%"]})," compliance"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(z,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:"text-gray-600",children:["Phase: ",e.jsx("strong",{children:l})]})]}),m.map(b=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(De,{className:"w-4 h-4 text-amber-500"}),e.jsxs("span",{className:"text-gray-600",children:[e.jsx("strong",{children:b.value})," ",b.label]})]},b.label))]})]})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-100",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-3",children:"Connected Data Sources"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(b=>{const y=N0[b.icon]||z;return e.jsxs("div",{className:x("flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium",b.connected?"bg-green-50 text-green-700 border border-green-200":"bg-gray-50 text-gray-500 border border-gray-200"),children:[e.jsx(y,{className:"w-4 h-4"}),b.name,b.connected&&e.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500",title:"Connected"})]},b.id)})})]})]})}function zi({isOpen:t,onClose:a,data:s,title:i}){const[r,n]=g.useState("inbound"),[o,c]=g.useState(0);if(!t)return null;const l=[{id:"inbound",label:"Inbound Data",icon:e.jsx(ce,{className:"w-4 h-4"}),count:s.inbound.length},{id:"model",label:"Model",icon:e.jsx(Jt,{className:"w-4 h-4"})},{id:"outbound",label:"Outbound Response",icon:e.jsx(ea,{className:"w-4 h-4"})}];return e.jsx(re,{children:e.jsx(M.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:a,children:e.jsxs(M.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2},className:"bg-white rounded-xl shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col",onClick:d=>d.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-100",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Data Pipeline Inspector"}),e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:i})]}),e.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(je,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg border border-gray-200 shadow-sm",children:[e.jsx(ce,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Device/Lab Data"})]}),e.jsx(ve,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg border border-gray-200 shadow-sm",children:[e.jsx(Jt,{className:"w-4 h-4 text-purple-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Serif Model"})]}),e.jsx(ve,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg border border-gray-200 shadow-sm",children:[e.jsx(ea,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"API Response"})]})]})}),e.jsx("div",{className:"flex border-b border-gray-100 px-6",children:l.map(d=>e.jsxs("button",{onClick:()=>n(d.id),className:x("flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 -mb-px transition-colors",r===d.id?"text-primary-600 border-primary-500":"text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300"),children:[d.icon,d.label,d.count!==void 0&&e.jsx(A,{variant:"outline",className:"ml-1 text-xs",children:d.count})]},d.id))}),e.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[r==="inbound"&&e.jsx(k0,{data:s.inbound,expandedIndex:o,onExpandChange:c}),r==="model"&&s.model&&e.jsx(C0,{model:s.model}),r==="outbound"&&e.jsx(S0,{data:s.outbound})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-100 bg-gray-50 flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx(Rr,{className:"w-3.5 h-3.5 inline mr-1"}),"All data structures follow FHIR-analogous schemas"]}),e.jsx(V,{variant:"outline",size:"sm",onClick:a,children:"Close"})]})]})})})}function k0({data:t,expandedIndex:a,onExpandChange:s}){return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsxs(A,{variant:"outline",className:"text-blue-600 border-blue-200",children:[e.jsx(ce,{className:"w-3 h-3 mr-1"}),t.length," Data Source",t.length!==1?"s":""]}),e.jsx("span",{className:"text-sm text-gray-500",children:"Raw data received from devices and labs"})]}),t.map((i,r)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>s(a===r?-1:r),className:"w-full flex items-center justify-between px-4 py-3 bg-gray-50 hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[a===r?e.jsx(ye,{className:"w-4 h-4 text-gray-400"}):e.jsx(U,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-gray-900",children:i.label}),e.jsx("p",{className:"text-xs text-gray-500",children:i.description})]})]}),e.jsx(A,{variant:"outline",className:"text-xs",children:i.schema})]}),a===r&&e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsx($t,{data:i.data,theme:"dark",expandLevel:2,showCopy:!0})})]},r))]})}function C0({model:t}){const[a,s]=g.useState(!1),i=async()=>{await navigator.clipboard.writeText(t.computation),s(!0),setTimeout(()=>s(!1),2e3)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsxs(A,{variant:"outline",className:"text-purple-600 border-purple-200",children:[e.jsx(Jt,{className:"w-3 h-3 mr-1"}),t.label]}),e.jsx("span",{className:"text-sm text-gray-500",children:t.description})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:i,className:"absolute top-3 right-3 p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-700 rounded-md transition-colors z-10",children:a?e.jsx(ie,{className:"w-4 h-4 text-green-400"}):e.jsx(rt,{className:"w-4 h-4"})}),e.jsx("pre",{className:"bg-gray-900 rounded-lg p-4 overflow-auto max-h-[400px] text-sm font-mono",children:e.jsx("code",{className:"text-gray-200 whitespace-pre-wrap",children:t.computation})})]}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-amber-800",children:[e.jsx("strong",{children:"Note:"})," This is a simplified representation of the model computation. The actual implementation includes additional statistical validation, edge case handling, and performance optimizations."]})})]})}function S0({data:t}){return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsxs(A,{variant:"outline",className:"text-green-600 border-green-200",children:[e.jsx(ea,{className:"w-3 h-3 mr-1"}),"API Response"]}),e.jsx("span",{className:"text-sm text-gray-500",children:t.description})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-4 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Schema"}),e.jsx("p",{className:"font-mono text-sm text-gray-700",children:t.schema})]}),e.jsx("div",{className:"h-8 w-px bg-gray-200"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Label"}),e.jsx("p",{className:"text-sm text-gray-700",children:t.label})]})]}),e.jsx($t,{data:t.data,theme:"dark",expandLevel:3,showCopy:!0})]})}const Gi={user:{user_id:"terra_u_8a7f9b2c",provider:"APPLE",last_webhook_update:"2025-01-19T22:15:00Z",reference_id:"he-user-001"},type:"activity",data:[{metadata:{start_time:"2025-01-19T19:30:00Z",end_time:"2025-01-19T19:48:00Z",upload_type:"automatic"},activity_data:{steps:1847,active_duration_seconds:1080,moderate_intensity_seconds:720,low_intensity_seconds:360,calories_data:{total_burned_calories:98,active_calories:72,bmr_calories:26},distance_data:{distance_meters:1420}},heart_data:{resting_hr_bpm:58,avg_hr_bpm:98,max_hr_bpm:112,min_hr_bpm:62}}]},Ui={device_id:"libre_3_f8a2b9c4",user_id:"he-user-001",sensor_serial:"MH00L1234X7",readings:[{timestamp:"2025-01-19T19:00:00Z",glucose_mg_dl:142,trend_arrow:"rising",quality_flag:"good"},{timestamp:"2025-01-19T19:15:00Z",glucose_mg_dl:158,trend_arrow:"rising",quality_flag:"good"},{timestamp:"2025-01-19T19:30:00Z",glucose_mg_dl:165,trend_arrow:"rising",quality_flag:"good"},{timestamp:"2025-01-19T19:45:00Z",glucose_mg_dl:152,trend_arrow:"falling",quality_flag:"good"},{timestamp:"2025-01-19T20:00:00Z",glucose_mg_dl:138,trend_arrow:"falling",quality_flag:"good"},{timestamp:"2025-01-19T20:15:00Z",glucose_mg_dl:124,trend_arrow:"falling",quality_flag:"good"},{timestamp:"2025-01-19T20:30:00Z",glucose_mg_dl:118,trend_arrow:"stable",quality_flag:"good"},{timestamp:"2025-01-19T20:45:00Z",glucose_mg_dl:112,trend_arrow:"stable",quality_flag:"good"}],daily_summary:{date:"2025-01-19",time_in_range_pct:85,time_above_range_pct:12,time_below_range_pct:3,time_very_high_pct:2,time_very_low_pct:0,average_glucose:108,glucose_management_indicator:5.6,coefficient_of_variation:18.2,standard_deviation:19.7,readings_count:96},meta:{sensor_start_time:"2025-01-05T08:00:00Z",sensor_end_time:"2025-01-19T08:00:00Z",days_remaining:0,firmware_version:"3.2.1"}},T0={insight_id:"ins_he001_postdinner_walk",user_id:"he-user-001",client_id:"human-edge",created_at:"2025-01-12T00:00:00Z",updated_at:"2025-01-19T23:00:00Z",model:{name:"PersonalDoseResponse",version:"2.4.1",type:"causal",last_trained:"2025-01-19T06:00:00Z"},content:{title:"Post-Dinner Walk → Glucose Control",headline:"Your 15-minute walks reduce post-meal glucose spikes by 22%",summary:"Analysis of 142 post-dinner observations shows that walking at least 1,200 steps within 30 minutes of dinner significantly reduces your glucose excursion. The effect plateaus beyond this threshold.",category:"metabolic"},causal_parameters:{x_variable:{id:"post_dinner_steps",name:"Post-Dinner Steps",description:"Steps taken within 30 minutes after evening meal",current_value:1847,unit:"steps",data_source:"Terra/Apple Watch",sample_rate:"per meal event"},y_variable:{id:"glucose_delta_auc",name:"Glucose Spike (AUC)",description:"Area under the curve above baseline for 2 hours post-meal",unit:"mg·min/dL",target_direction:"decrease"},theta:{value:1200,unit:"steps",display_value:"1,200 steps",confidence_interval_95:[980,1420],standard_error:112,p_value:.001,interpretation:"The minimum effective dose for glucose spike reduction"},beta:{below_threshold:{coefficient:-.018,std_error:.004,t_statistic:-4.5,p_value:1e-4,description:"Each additional 100 steps reduces spike by 1.8%"},above_threshold:{coefficient:.002,std_error:.003,t_statistic:.67,p_value:.52,description:"Minimal additional benefit beyond threshold"}},curve_type:"plateau_down",model_fit:{r_squared:.68,adjusted_r_squared:.66,rmse:142,aic:1823,bic:1847}},evidence:{personal:{observations:142,days_of_data:180,weight:.89,date_range:{start:"2024-07-22",end:"2025-01-19"},data_quality_score:.94},population:{sample_size:12847,studies_referenced:3,weight:.11,source_description:"Human Edge metabolic cohort + published literature"},combined_confidence:.91,confidence_category:"very_high",calibration_status:"high_confidence",min_days_for_stable:30},status:{current_position:"at_optimal",distance_from_threshold:647,distance_unit:"steps above",trend:"stable",trend_days:14,priority_score:72},linked_data:{data_sources:["Terra/Apple Watch","Libre CGM"],observation_ids:["obs_142","obs_141","obs_140"],time_range:{start:"2024-07-22",end:"2025-01-19"},contributing_records:284},recommendation:{action:"Continue your post-dinner walks",detailed_guidance:"Your current 1,847 steps post-dinner is above your optimal threshold of 1,200. Keep up this habit for sustained glucose control.",protocol_code:"PROTO_POSTMEAL_WALK",urgency:"routine",expected_impact:"Maintain 22% reduction in post-meal glucose spikes"},_meta:{request_id:"req_8f7a6b5c4d3e2f1a",processing_time_ms:127,cache_hit:!1,api_version:"v1.2.0"}},Yi={user:{user_id:"terra_u_8a7f9b2c",provider:"APPLE",last_webhook_update:"2025-01-20T07:30:00Z",reference_id:"he-user-001"},type:"sleep",data:[{metadata:{start_time:"2025-01-19T22:45:00Z",end_time:"2025-01-20T06:15:00Z",upload_type:"automatic"},sleep_data:{sleep_durations_data:{asleep_seconds:25200,awake_seconds:1800,deep_seconds:5400,rem_seconds:6300,light_seconds:13500,in_bed_seconds:27e3},sleep_efficiency:93.3,latency_seconds:540,awakenings_count:2},heart_data:{resting_hr_bpm:52,avg_hr_bpm:54,min_hr_bpm:48,hrv_data:{avg_sdnn:48,avg_rmssd:45}}}]},M0={insight_id:"ins_he001_bedtime_sleep",user_id:"he-user-001",client_id:"human-edge",created_at:"2025-01-05T00:00:00Z",updated_at:"2025-01-19T23:00:00Z",model:{name:"PersonalDoseResponse",version:"2.4.1",type:"causal",last_trained:"2025-01-19T06:00:00Z"},content:{title:"Bedtime → Sleep Efficiency",headline:"Every hour after 10:15 PM costs you 2.3% sleep efficiency",summary:"Your sleep efficiency drops significantly when you go to bed after 10:15 PM. This threshold is personalized to your chronotype and lifestyle.",category:"sleep"},causal_parameters:{x_variable:{id:"bedtime_hour",name:"Bedtime",description:"Time you get into bed",current_value:22.75,unit:"hour (24h)",data_source:"Terra/Apple Watch",sample_rate:"daily"},y_variable:{id:"sleep_efficiency",name:"Sleep Efficiency",description:"Percentage of time in bed spent asleep",unit:"%",target_direction:"increase"},theta:{value:22.25,unit:"hour",display_value:"10:15 PM",confidence_interval_95:[21.75,22.75],standard_error:.25,p_value:.002,interpretation:"Your optimal bedtime threshold"},beta:{below_threshold:{coefficient:.3,std_error:.15,t_statistic:2,p_value:.06,description:"Minimal improvement from earlier bedtimes"},above_threshold:{coefficient:-2.3,std_error:.4,t_statistic:-5.75,p_value:1e-4,description:"Each hour later decreases efficiency by 2.3%"}},curve_type:"plateau_down",model_fit:{r_squared:.52,adjusted_r_squared:.49,rmse:4.2,aic:892,bic:912}},evidence:{personal:{observations:156,days_of_data:180,weight:.82,date_range:{start:"2024-07-22",end:"2025-01-19"},data_quality_score:.91},population:{sample_size:8923,studies_referenced:2,weight:.18,source_description:"Human Edge sleep cohort"},combined_confidence:.85,confidence_category:"high",calibration_status:"stable",min_days_for_stable:30},status:{current_position:"below_optimal",distance_from_threshold:30,distance_unit:"minutes late",trend:"stable",trend_days:7,priority_score:68},linked_data:{data_sources:["Terra/Apple Watch"],observation_ids:["obs_156","obs_155","obs_154"],time_range:{start:"2024-07-22",end:"2025-01-19"},contributing_records:156},recommendation:{action:"Start winding down by 10:00 PM",detailed_guidance:"Last night you went to bed at 10:45 PM, 30 minutes after your optimal threshold. Building a wind-down routine can help you get to bed earlier.",protocol_code:"PROTO_BEDTIME_ROUTINE",urgency:"suggested",expected_impact:"Could improve sleep efficiency by 1.2%"},_meta:{request_id:"req_2a3b4c5d6e7f8g9h",processing_time_ms:98,cache_hit:!0,api_version:"v1.2.0"}},R0={report_id:"lab_thyrocare_20250115",user_id:"he-user-001",lab_name:"Thyrocare Technologies",lab_location:"Mumbai, Maharashtra",collection_date:"2025-01-15",report_date:"2025-01-16",received_date:"2025-01-16T14:30:00Z",processing:{method:"ocr_vision",confidence:.97,processing_time_ms:2340,review_status:"auto_approved"},patient:{name:"Arjun Kumar",age:42,sex:"M",reference_id:"he-user-001"},results:[{loinc_code:"1989-3",name:"Vitamin D, 25-Hydroxy",value:28,unit:"ng/mL",reference_range:{low:20,high:100,optimal_low:40,optimal_high:60,age_adjusted:!1,sex_specific:!1},interpretation:"low",flag:"Below Optimal",method:"Chemiluminescence Immunoassay"},{loinc_code:"4548-4",name:"Hemoglobin A1c",value:5.6,unit:"%",reference_range:{low:4,high:5.6,optimal_low:4.5,optimal_high:5.4,age_adjusted:!0,sex_specific:!1},interpretation:"normal",method:"HPLC"},{loinc_code:"2093-3",name:"Total Cholesterol",value:185,unit:"mg/dL",reference_range:{low:0,high:200,optimal_low:0,optimal_high:180,age_adjusted:!1,sex_specific:!1},interpretation:"optimal",method:"Enzymatic"}],attachments:{pdf_url:"https://storage.serif.health/labs/he-user-001/2025-01-15.pdf",ocr_text_url:"https://storage.serif.health/labs/he-user-001/2025-01-15_ocr.txt",ocr_json_url:"https://storage.serif.health/labs/he-user-001/2025-01-15_ocr.json"}},P0={items:[{item_id:"item_walk_postdinner",priority:1,priority_label:"high",code:"PROTO_POSTMEAL_WALK",action:"15-min walk after dinner",action_detail:"Take a 15-minute walk within 30 minutes of finishing dinner",category:"exercise",rationale:{linked_insight_id:"ins_he001_postdinner_walk",linked_insight_title:"Post-Dinner Walk → Glucose Control",effect_description:"Reduces your post-meal glucose spike by 22%",evidence_summary:"Based on 142 personal observations over 180 days",personalization_note:"Your threshold is 1,200 steps - you typically hit 1,800+"},timing:{time_of_day:"evening",window_start:"19:00",window_end:"21:00",suggested_time:"19:30",duration_minutes:15,frequency:"daily"},tracking:{detection_method:"passive_wearable",success_criteria:{type:"threshold",metric:"post_dinner_steps",threshold:1200,unit:"steps",operator:"gte"},verification_source:"Terra/Apple Watch",verification_delay_minutes:30},status:{state:"pending"}},{item_id:"item_vitamin_d",priority:2,priority_label:"high",code:"SUPP_VITAMIN_D",action:"Take Vitamin D with breakfast",action_detail:"2000 IU Vitamin D3 with a meal containing fat for absorption",category:"supplement",rationale:{linked_lab_id:"lab_thyrocare_20250115",linked_lab_result:"Vitamin D: 28 ng/mL (optimal: 40-60)",effect_description:"Addresses your suboptimal Vitamin D level",evidence_summary:"Lab result from Jan 15, 2025 shows level below optimal range"},timing:{time_of_day:"morning",window_start:"07:00",window_end:"10:00",suggested_time:"08:00",frequency:"daily"},tracking:{detection_method:"manual_confirmation",success_criteria:{type:"boolean"}},status:{state:"pending"}},{item_id:"item_zone2",priority:3,priority_label:"medium",code:"CARDIO_ZONE2",action:"Zone 2 cardio: 30 min",action_detail:"Easy pace where you can hold a conversation (HR 105-125 for you)",category:"exercise",rationale:{effect_description:"Improves metabolic flexibility and insulin sensitivity",evidence_summary:"3 sessions this week to hit your 150 min/week target",personalization_note:"You have completed 60 minutes so far this week"},timing:{time_of_day:"anytime",duration_minutes:30,frequency:"3x per week"},tracking:{detection_method:"passive_wearable",success_criteria:{type:"duration",metric:"zone2_minutes",threshold:30,unit:"minutes",operator:"gte"},verification_source:"Terra/Apple Watch"},status:{state:"pending"}},{item_id:"item_bedtime",priority:4,priority_label:"medium",code:"PROTO_BEDTIME_ROUTINE",action:"Wind down by 10:00 PM",action_detail:"Start your wind-down routine to be in bed by 10:15 PM",category:"sleep",rationale:{linked_insight_id:"ins_he001_bedtime_sleep",linked_insight_title:"Bedtime → Sleep Efficiency",effect_description:"Your sleep efficiency drops 2.3% per hour after 10:15 PM",evidence_summary:"Based on 156 nights of sleep data"},timing:{time_of_day:"night",window_start:"21:30",window_end:"22:15",suggested_time:"22:00",frequency:"daily"},tracking:{detection_method:"passive_wearable",success_criteria:{type:"threshold",metric:"bedtime_hour",threshold:22.25,unit:"hour",operator:"lte"},verification_source:"Terra/Apple Watch",verification_delay_minutes:480},status:{state:"pending"}}]};function D0(t){switch(t){case"ins-001":return{insightId:"ins-001",inbound:[{label:"Terra Webhook (Activity)",description:"Apple Watch activity data received via Terra API webhook",data:Gi,schema:"TerraWebhookPayload"},{label:"CGM Readings",description:"Abbott Libre glucose readings pulled from LibreView Cloud",data:Ui,schema:"CGMReadingPayload"}],model:{label:"PersonalDoseResponse v2.4.1",description:"Piecewise linear regression with change-point detection",computation:`
// Identify threshold (θ) using change-point detection
const theta = findChangePoint(x_data, y_data);

// Fit piecewise linear model
const beta_below = linearRegression(
  x_data.filter(x => x < theta),
  y_data.filter((_, i) => x_data[i] < theta)
);

const beta_above = linearRegression(
  x_data.filter(x => x >= theta),
  y_data.filter((_, i) => x_data[i] >= theta)
);

// Combine with population prior (Bayesian update)
const posterior = bayesianUpdate({
  personal: { observations: 142, weight: 0.89 },
  population: { n: 12847, weight: 0.11 }
});
          `.trim()},outbound:{label:"Insight API Response",description:"Personalized causal insight with θ/β parameters",data:T0,schema:"InsightAPIResponse"}};case"ins-002":return{insightId:"ins-002",inbound:[{label:"Terra Webhook (Sleep)",description:"Apple Watch sleep data received via Terra API webhook",data:Yi,schema:"TerraWebhookPayload"}],model:{label:"PersonalDoseResponse v2.4.1",description:"Piecewise linear regression with change-point detection",computation:`
// Sleep efficiency vs bedtime analysis
const bedtimes = sleepData.map(s => parseTime(s.bedtime));
const efficiencies = sleepData.map(s => s.efficiency);

// Find optimal bedtime threshold
const theta = findChangePoint(bedtimes, efficiencies);

// Effect is negative after threshold (efficiency drops)
const beta_above = linearRegression(
  bedtimes.filter(t => t > theta),
  efficiencies.filter((_, i) => bedtimes[i] > theta)
); // Returns ~ -2.3%/hour
          `.trim()},outbound:{label:"Insight API Response",description:"Personalized bedtime optimization insight",data:M0,schema:"InsightAPIResponse"}};default:return null}}function A0(t,a){if(a==="human-edge"){const s=P0.items.find(r=>r.code===t);if(!s)return null;const i=[];return s.rationale.linked_insight_id&&(s.code==="PROTO_POSTMEAL_WALK"?(i.push({label:"Terra Activity Webhook",description:"Recent activity data showing post-dinner walking pattern",data:Gi,schema:"TerraWebhookPayload"}),i.push({label:"CGM Readings",description:"Post-meal glucose response data",data:Ui,schema:"CGMReadingPayload"})):s.code==="PROTO_BEDTIME_ROUTINE"&&i.push({label:"Terra Sleep Webhook",description:"Recent sleep data with bedtime patterns",data:Yi,schema:"TerraWebhookPayload"})),s.rationale.linked_lab_id&&i.push({label:"Lab Result (OCR)",description:"Processed lab report from Thyrocare",data:R0,schema:"LabResultPayload"}),{protocolItemId:t,inbound:i,model:{label:"ProtocolPrioritizer v1.8.0",description:"Multi-objective optimization for daily actions",computation:`
// Score each potential protocol item
const scores = candidates.map(item => ({
  item,
  score: weightedSum([
    { factor: 'impact_magnitude', weight: 0.35, value: item.expectedImpact },
    { factor: 'confidence', weight: 0.25, value: item.evidenceConfidence },
    { factor: 'urgency', weight: 0.20, value: item.urgencyScore },
    { factor: 'user_preference', weight: 0.10, value: item.preferenceMatch },
    { factor: 'feasibility', weight: 0.10, value: item.feasibilityScore },
  ])
}));

// Apply constraints and rank
const protocol = scores
  .filter(s => !userExclusions.includes(s.item.code))
  .filter(s => fitsSchedule(s.item, userSchedule))
  .sort((a, b) => b.score - a.score)
  .slice(0, MAX_DAILY_ITEMS);
        `.trim()},outbound:{label:"Protocol Item Response",description:"Prioritized action with rationale and tracking spec",data:s,schema:"ProtocolItemResponse"}}}return null}const I0={plateau_up:{line:"#10B981",fill:"rgba(16, 185, 129, 0.15)",bg:"bg-green-50",text:"text-green-700"},plateau_down:{line:"#EF4444",fill:"rgba(239, 68, 68, 0.15)",bg:"bg-red-50",text:"text-red-700"},v_min:{line:"#06B6D4",fill:"rgba(6, 182, 212, 0.15)",bg:"bg-cyan-50",text:"text-cyan-700"},v_max:{line:"#8B5CF6",fill:"rgba(139, 92, 246, 0.15)",bg:"bg-purple-50",text:"text-purple-700"},linear:{line:"#6B7280",fill:"rgba(107, 114, 128, 0.15)",bg:"bg-gray-50",text:"text-gray-700"}};function L0({curveType:t,currentXPercent:a,thetaXPercent:s=.5,color:i}){const c=()=>{switch(t){case"plateau_up":return`M 12 68 Q ${58.8} ${51.2} 90 26 L 168 26`;case"plateau_down":return`M 12 26 L 90 26 Q ${121.2} ${31.599999999999998} 168 68`;case"v_min":return`M 12 ${23.200000000000003} Q 51 ${62.4} 90 ${62.4} Q 129 ${62.4} 168 ${23.200000000000003}`;case"v_max":return`M 12 ${56.8} Q 51 ${17.6} 90 ${17.6} Q 129 ${17.6} 168 ${56.8}`;default:return"M 12 68 L 168 12"}},l=b=>{switch(t){case"plateau_up":return b<.5?68-b*2*56*.75:26;case"plateau_down":return b<.5?26:26+(b-.5)*2*56*.5;case"v_min":return 62.4-Math.abs(b-.5)*2*56*.6;case"v_max":return 17.6+Math.abs(b-.5)*2*56*.6;default:return 68-b*56}},d=c(),u=12+156*s,m=l(s),h=12+156*a,p=l(a);return e.jsxs("svg",{width:180,height:80,className:"overflow-visible",children:[e.jsx("path",{d:`${d} L 168 68 L 12 68 Z`,fill:i.fill}),e.jsx("path",{d,fill:"none",stroke:i.line,strokeWidth:"2",strokeLinecap:"round"}),e.jsx("line",{x1:u,y1:12,x2:u,y2:68,stroke:i.line,strokeWidth:"1",strokeDasharray:"3 2",opacity:.6}),e.jsx("circle",{cx:u,cy:m,r:"4",fill:i.line}),e.jsx("circle",{cx:u,cy:m,r:"2",fill:"white"}),e.jsx("circle",{cx:h,cy:p,r:"5",fill:"#F59E0B",stroke:"white",strokeWidth:"2"})]})}function E0({insight:t,compact:a=!1,className:s}){const i=I0[t.curveType],[r,n]=g.useState(!1),o=g.useMemo(()=>D0(t.id),[t.id]),c=g.useMemo(()=>{const m=t.theta.value*.6,h=t.theta.value-m,p=t.theta.value+m,b=(t.currentValue-h)/(p-h);return Math.max(.05,Math.min(.95,b))},[t.currentValue,t.theta.value]),l={below_optimal:{icon:oe,label:"Below Optimal",color:"text-amber-600 bg-amber-50 border-amber-200"},at_optimal:{icon:tt,label:"At Optimal",color:"text-green-600 bg-green-50 border-green-200"},above_optimal:{icon:oe,label:"Above Optimal",color:"text-amber-600 bg-amber-50 border-amber-200"},below_threshold:{icon:oe,label:"Below θ",color:"text-blue-600 bg-blue-50 border-blue-200"},above_threshold:{icon:oe,label:"Above θ",color:"text-blue-600 bg-blue-50 border-blue-200"}},d=l[t.currentStatus]??l.at_optimal,u=d.icon;return a?e.jsxs("div",{className:x("bg-white rounded-lg border border-gray-100 p-4",s),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:t.title}),e.jsx("p",{className:"text-sm text-gray-500",children:t.subtitle})]}),e.jsxs("div",{className:x("px-2 py-1 rounded-full text-xs font-medium flex items-center gap-1",d.color),children:[e.jsx(u,{className:"w-3 h-3"}),d.label]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Current:"}),e.jsxs("span",{className:"font-mono font-medium",children:[t.currentValue," ",t.currentUnit]}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsxs("span",{className:"text-gray-500",children:[t.personalDataPct,"% your data"]})]})]}):e.jsxs("div",{className:x("bg-white rounded-xl border border-gray-100 overflow-hidden",s),children:[e.jsx("div",{className:"p-4 border-b border-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:x("p-2 rounded-lg",i.bg),children:e.jsx(de,{className:x("w-5 h-5",i.text)})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:t.title}),e.jsx("p",{className:"text-sm text-primary-600",children:t.subtitle})]})]}),e.jsxs("div",{className:x("px-2.5 py-1 rounded-full text-xs font-medium flex items-center gap-1.5 border",d.color),children:[e.jsx(u,{className:"w-3.5 h-3.5"}),d.label]})]})}),e.jsxs("div",{className:"p-4 flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(L0,{curveType:t.curveType,currentXPercent:c,color:i})}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Your threshold (θ)"}),e.jsx("span",{className:x("font-mono font-semibold",i.text),children:t.theta.displayValue})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Below θ"}),e.jsx("span",{className:"font-mono text-gray-700",children:t.betaBelow.description})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Above θ"}),e.jsx("span",{className:"font-mono text-gray-700",children:t.betaAbove.description})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm pt-2 border-t border-gray-100",children:[e.jsx("span",{className:"text-gray-500",children:"Current value"}),e.jsxs("span",{className:"font-mono font-semibold text-amber-600",children:[t.currentValue," ",t.currentUnit]})]})]})]}),e.jsxs("div",{className:"px-4 pb-4",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1.5",children:e.jsxs("div",{className:"flex-1 h-2 bg-gray-100 rounded-full overflow-hidden flex",children:[e.jsx("div",{className:"h-full bg-primary-500",style:{width:`${t.personalDataPct}%`}}),e.jsx("div",{className:"h-full bg-gray-300",style:{width:`${t.populationDataPct}%`}})]})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:[e.jsxs("strong",{children:[t.personalDataPct,"%"]})," your data |"," ",e.jsxs("strong",{children:[t.populationDataPct,"%"]})," population"]}),e.jsxs("span",{children:["n = ",t.observations," observations"]})]})]}),e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-50 rounded-lg border border-amber-100",children:[e.jsx(De,{className:"w-4 h-4 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-amber-800",children:t.actionableAdvice})]})}),e.jsxs("div",{className:"px-4 pb-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-400",children:[e.jsx(Lt,{className:"w-3 h-3"}),e.jsxs("span",{children:["Based on ",t.daysOfData," days of your data"]})]}),o&&e.jsxs("button",{onClick:()=>n(!0),className:"flex items-center gap-1.5 px-2.5 py-1.5 text-xs font-medium text-gray-600 hover:text-primary-600 bg-gray-50 hover:bg-primary-50 rounded-md border border-gray-200 hover:border-primary-200 transition-colors",children:[e.jsx(Ss,{className:"w-3.5 h-3.5"}),"View Data"]})]}),o&&e.jsx(zi,{isOpen:r,onClose:()=>n(!1),data:o,title:t.title})]})}function W0({readings:t,selectedDate:a,onDateChange:s,className:i}){const r=g.useMemo(()=>{const p=new Map;t.forEach(y=>{const w=y.timestamp.split("T")[0];p.has(w)||p.set(w,[]),p.get(w).push(y)});const b=[];return p.forEach((y,w)=>{const v=y.map(N=>N.glucose),_=v.reduce((N,S)=>N+S,0)/v.length,f=v.filter(N=>N>=70&&N<=140).length,j=Math.sqrt(v.reduce((N,S)=>N+Math.pow(S-_,2),0)/v.length);b.push({date:w,readings:y.sort((N,S)=>N.timestamp.localeCompare(S.timestamp)),avgGlucose:Math.round(_),tir:Math.round(f/v.length*100),cv:Math.round(j/_*100),min:Math.min(...v),max:Math.max(...v)})}),b.sort((y,w)=>w.date.localeCompare(y.date))},[t]),[n,o]=g.useState(0),c=r[n];if(!c)return e.jsx("div",{className:x("bg-white rounded-xl border border-gray-100 p-6",i),children:e.jsx("p",{className:"text-gray-500 text-center",children:"No CGM data available"})});const l=c.readings.map(p=>{const b=new Date(p.timestamp);return{time:b.getHours()+b.getMinutes()/60,timeLabel:b.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),glucose:p.glucose,trend:p.trend}}),d=new Date(c.date).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}),u=n<r.length-1,m=n>0,h=p=>p<70?"#EF4444":p>140?"#F59E0B":"#10B981";return e.jsxs("div",{className:x("bg-white rounded-xl border border-gray-100 overflow-hidden",i),children:[e.jsx("div",{className:"p-4 border-b border-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(_e,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Glucose Trace"}),e.jsx("p",{className:"text-sm text-gray-500",children:d})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>o(p=>p+1),disabled:!u,className:"p-1.5 rounded-lg hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(It,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("span",{className:"text-sm text-gray-500 min-w-[100px] text-center",children:["Day ",r.length-n," of ",r.length]}),e.jsx("button",{onClick:()=>o(p=>p-1),disabled:!m,className:"p-1.5 rounded-lg hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(U,{className:"w-5 h-5 text-gray-600"})})]})]})}),e.jsxs("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-100 flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"TIR:"}),e.jsxs("span",{className:x("font-semibold",c.tir>=70?"text-green-600":c.tir>=50?"text-amber-600":"text-red-600"),children:[c.tir,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Avg:"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[c.avgGlucose," mg/dL"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"CV:"}),e.jsxs("span",{className:x("font-semibold",c.cv<=36?"text-green-600":"text-amber-600"),children:[c.cv,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Range:"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[c.min,"-",c.max," mg/dL"]})]})]}),e.jsx("div",{className:"p-4",children:e.jsx(nt,{width:"100%",height:220,children:e.jsxs(_s,{data:l,margin:{top:10,right:10,left:-10,bottom:0},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"glucoseGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#6366F1",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#6366F1",stopOpacity:.05})]})}),e.jsx(Et,{strokeDasharray:"3 3",stroke:"#E5E7EB",vertical:!1}),e.jsx(Wt,{dataKey:"time",tickFormatter:p=>`${Math.floor(p)}:00`,ticks:[0,6,12,18,24],domain:[0,24],fontSize:12,stroke:"#9CA3AF"}),e.jsx(Ht,{domain:[50,200],ticks:[70,100,140,180],fontSize:12,stroke:"#9CA3AF"}),e.jsx(Pr,{y1:70,y2:140,fill:"#10B981",fillOpacity:.1}),e.jsx(Ve,{y:70,stroke:"#10B981",strokeDasharray:"3 3"}),e.jsx(Ve,{y:140,stroke:"#10B981",strokeDasharray:"3 3"}),e.jsx(Vt,{content:({active:p,payload:b})=>{if(!p||!b||!b[0])return null;const y=b[0].payload;return e.jsxs("div",{className:"bg-white p-2 rounded-lg shadow-lg border border-gray-100 text-sm",children:[e.jsx("p",{className:"font-medium text-gray-900",children:y.timeLabel}),e.jsxs("p",{style:{color:h(y.glucose)},children:[e.jsx("strong",{children:y.glucose})," mg/dL"]}),e.jsx("p",{className:"text-gray-500 text-xs capitalize",children:y.trend.replace("_"," ")})]})}}),e.jsx(Pe,{type:"monotone",dataKey:"glucose",stroke:"#6366F1",strokeWidth:2,fill:"url(#glucoseGradient)",dot:!1,activeDot:{r:4,fill:"#6366F1",stroke:"white",strokeWidth:2}})]})})}),e.jsxs("div",{className:"px-4 pb-4 flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-green-100 border border-green-300"}),e.jsx("span",{children:"Target range (70-140 mg/dL)"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-primary-500"}),e.jsx("span",{children:"Glucose level"})]})]})]})}const H0={Morning:Ar,"After dinner":X,Evening:X,Afternoon:Dr,Anytime:pe};function V0({items:t,date:a,clientId:s,onToggle:i,className:r}){const[n,o]=g.useState(new Set(t.filter(f=>f.completed).map((f,j)=>j))),[c,l]=g.useState(!1),[d,u]=g.useState(null),m=g.useMemo(()=>!d||!s?null:A0(d,s),[d,s]),h=t.find(f=>f.code===d),p=f=>{u(f),l(!0)},b=a||new Date().toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}),y=f=>{const j=new Set(n);j.has(f)?j.delete(f):j.add(f),o(j),i?.(f,!n.has(f))},w=n.size,v=t.length,_=Math.round(w/v*100);return e.jsxs("div",{className:x("bg-white rounded-xl border border-gray-100 overflow-hidden",r),children:[e.jsx("div",{className:"p-4 border-b border-gray-50 bg-gradient-to-r from-amber-50 to-orange-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Today's Protocol"}),e.jsx("p",{className:"text-sm text-gray-500",children:b})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-2xl font-bold text-gray-900",children:w}),e.jsxs("span",{className:"text-gray-400",children:["/",v]})]}),e.jsxs("div",{className:"w-12 h-12 relative",children:[e.jsxs("svg",{className:"w-12 h-12 transform -rotate-90",children:[e.jsx("circle",{cx:"24",cy:"24",r:"20",fill:"none",stroke:"#E5E7EB",strokeWidth:"4"}),e.jsx("circle",{cx:"24",cy:"24",r:"20",fill:"none",stroke:"#F59E0B",strokeWidth:"4",strokeLinecap:"round",strokeDasharray:`${_*1.26} 126`})]}),e.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-semibold text-gray-700",children:[_,"%"]})]})]})]})}),e.jsx("div",{className:"divide-y divide-gray-50",children:t.sort((f,j)=>f.priority-j.priority).map((f,j)=>{const N=n.has(j),S=f.timeOfDay?H0[f.timeOfDay]||pe:pe;return e.jsxs("div",{className:x("p-4 flex items-start gap-3 transition-colors",N?"bg-green-50/50":"hover:bg-gray-50"),children:[e.jsx("button",{onClick:()=>y(j),className:x("flex-shrink-0 mt-0.5 transition-colors",N?"text-green-500":"text-gray-300 hover:text-gray-400"),children:N?e.jsx(tt,{className:"w-5 h-5"}):e.jsx(Ir,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:x("w-5 h-5 rounded-full flex items-center justify-center text-xs font-semibold",f.priority===1?"bg-amber-100 text-amber-700":f.priority===2?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600"),children:f.priority}),e.jsx("span",{className:x("font-medium",N?"text-gray-400 line-through":"text-gray-900"),children:f.action})]}),e.jsx("p",{className:x("text-sm ml-7",N?"text-gray-400":"text-gray-500"),children:f.reason}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 ml-7",children:[f.timeOfDay&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-gray-100 rounded text-xs text-gray-600",children:[e.jsx(S,{className:"w-3 h-3"}),f.timeOfDay]}),f.linkedInsightId&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-primary-50 rounded text-xs text-primary-600",children:[e.jsx(bs,{className:"w-3 h-3"}),"Linked insight"]}),s&&f.code&&e.jsxs("button",{onClick:R=>{R.stopPropagation(),p(f.code)},className:"inline-flex items-center gap-1 px-2 py-0.5 bg-gray-50 hover:bg-primary-50 rounded text-xs text-gray-500 hover:text-primary-600 border border-gray-200 hover:border-primary-200 transition-colors",children:[e.jsx(Ss,{className:"w-3 h-3"}),"View Data"]})]})]})]},j)})}),w===v&&e.jsx("div",{className:"p-4 bg-green-50 border-t border-green-100",children:e.jsx("p",{className:"text-sm text-green-700 font-medium text-center",children:"All items completed! Great work today."})}),m&&h&&e.jsx(zi,{isOpen:c,onClose:()=>{l(!1),u(null)},data:m,title:h.action})]})}function Zi({data:t,width:a=80,height:s=24,color:i="#6366F1",showDots:r=!1,className:n}){if(!t||t.length<2)return null;const o=2,c=Math.min(...t),d=Math.max(...t)-c||1,u=t.map((h,p)=>{const b=o+p/(t.length-1)*(a-o*2),y=s-o-(h-c)/d*(s-o*2);return{x:b,y,value:h}}),m=u.map((h,p)=>`${p===0?"M":"L"} ${h.x} ${h.y}`).join(" ");return e.jsxs("svg",{width:a,height:s,className:x("overflow-visible",n),viewBox:`0 0 ${a} ${s}`,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:`sparkline-gradient-${i}`,x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:i,stopOpacity:"0.2"}),e.jsx("stop",{offset:"100%",stopColor:i,stopOpacity:"0"})]})}),e.jsx("path",{d:`${m} L ${u[u.length-1].x} ${s-o} L ${o} ${s-o} Z`,fill:`url(#sparkline-gradient-${i})`}),e.jsx("path",{d:m,fill:"none",stroke:i,strokeWidth:"1.5",strokeLinecap:"round"}),r&&u.length>0&&e.jsx("circle",{cx:u[u.length-1].x,cy:u[u.length-1].y,r:"2.5",fill:i})]})}function O0({name:t,value:a,unit:s,change:i,changeDirection:r,isGood:n,sparklineData:o,period:c,className:l}){const d=r==="up"?ee:r==="down"?fe:pa,u=n?"text-green-600 bg-green-50":r==="stable"?"text-gray-600 bg-gray-50":"text-red-600 bg-red-50",m=n?"#10B981":r==="stable"?"#6B7280":"#EF4444";return e.jsxs("div",{className:x("bg-white rounded-xl p-4 border border-gray-100",l),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:t}),e.jsxs("div",{className:x("flex items-center gap-1 px-1.5 py-0.5 rounded text-xs font-medium",u),children:[e.jsx(d,{className:"w-3 h-3"}),r!=="stable"&&e.jsxs("span",{children:[i>0?"+":"",typeof i=="number"&&i%1!==0?i.toFixed(1):i]})]})]}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-2xl font-bold text-gray-900",children:typeof a=="number"&&a%1!==0?a.toFixed(1):a}),e.jsx("span",{className:"text-sm text-gray-500 ml-1",children:s})]}),e.jsx(Zi,{data:o,color:m,width:60,height:20,showDots:!0})]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:[c," trend"]})]})}function B0(){const{clientId:t,userId:a}=ar(),s=gs(),i=te(d=>d.loadUserDetail),r=te(d=>d.clearUserDetail),n=g0(),o=x0(),c=t?ca(t):null;if(g.useEffect(()=>(t&&a&&i(t,a),()=>{r()}),[t,a,i,r]),o)return e.jsx(Z,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(et,{className:"w-8 h-8 text-primary-500 animate-spin"})})});if(!n||!c)return e.jsx(Z,{children:e.jsxs(k,{className:"p-12 text-center",children:[e.jsx("p",{className:"text-gray-500 mb-4",children:"User not found"}),e.jsx(V,{variant:"outline",onClick:()=>s("/clients"),children:"Back to Clients"})]})});const l=b0(n);return e.jsxs(Z,{title:n.name,subtitle:`${c.name} - ${n.archetype}`,maxWidth:"2xl",actions:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(xs,{to:"/clients",children:e.jsxs(V,{variant:"ghost",size:"sm",children:[e.jsx(Lr,{className:"w-4 h-4 mr-1"}),"Back to Clients"]})}),e.jsxs(V,{variant:"outline",size:"sm",children:[e.jsx(Er,{className:"w-4 h-4 mr-1"}),"Export Report"]})]}),children:[e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-6",children:e.jsx(_0,{name:n.name,avatar:n.avatar,archetype:n.archetype,clientName:c.name,clientLogo:c.logo,enrollmentDate:n.enrollmentDate,activeDays:n.activeDays,complianceRate:n.complianceRate,currentPhase:n.currentPhase,tags:n.tags,dataSources:n.dataSources,additionalStats:[{label:"insights",value:n.personalInsights.length}]})}),e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-6",children:e.jsx(F,{title:"Key Metrics",subtitle:"Your most important health indicators",children:e.jsx($,{columns:3,gap:"md",children:n.keyMetrics.map(d=>e.jsx(O0,{name:d.name,value:d.value,unit:d.unit,change:d.change,changeDirection:d.changeDirection,isGood:d.isGood,sparklineData:d.sparklineData,period:d.period},d.id))})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[l&&n.cgmReadings.length>0&&e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsx(W0,{readings:n.cgmReadings})}),e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsx(F,{title:"Personal Insights",subtitle:"Causal discoveries unique to you",actions:e.jsxs(A,{variant:"outline",className:"text-primary-600 border-primary-200",children:[e.jsx(De,{className:"w-3 h-3 mr-1"}),n.personalInsights.length," insights"]}),children:e.jsx("div",{className:"space-y-4",children:n.personalInsights.map(d=>e.jsx(E0,{insight:d},d.id))})})}),l&&n.labHistory.length>0&&e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:e.jsx(F,{title:"Lab Trends",subtitle:"Biomarker progress over time",actions:e.jsxs(A,{variant:"outline",className:"text-rose-600 border-rose-200",children:[e.jsx(Fe,{className:"w-3 h-3 mr-1"}),n.labHistory.length," markers"]}),children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:n.labHistory.map(d=>{const u=d.readings[d.readings.length-1]?.value,m=d.readings[d.readings.length-2]?.value,h=m?u-m:0;return e.jsxs(k,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:d.biomarker}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Target: ",d.targetRange.low,"-",d.targetRange.high," ",d.unit]})]}),e.jsx(A,{variant:d.trend==="improving"?"success":d.trend==="worsening"?"danger":"outline",children:d.trend})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-2xl font-bold text-gray-900",children:u}),e.jsx("span",{className:"text-sm text-gray-500",children:d.unit}),h!==0&&e.jsxs("span",{className:d.trend==="improving"?"text-green-600 text-sm":"text-red-600 text-sm",children:[h>0?"+":"",h.toFixed(1)]})]}),e.jsx("div",{className:"mt-2 flex gap-1",children:d.readings.map((p,b)=>e.jsx("div",{className:"flex-1 h-1 rounded",style:{backgroundColor:p.value>=d.targetRange.low&&p.value<=d.targetRange.high?"#10B981":"#F59E0B"},title:`${p.date}: ${p.value} ${d.unit}`},b))})]},d.biomarker)})})})})]}),e.jsxs("div",{className:"space-y-6",children:[l&&n.dailyProtocol&&e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25},children:e.jsx(V0,{items:n.dailyProtocol,clientId:t})}),l&&n.interventions.length>0&&e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.35},children:e.jsxs(k,{className:"overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-50",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Active Interventions"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Your current health protocols"})]}),e.jsx("div",{className:"divide-y divide-gray-50",children:n.interventions.map(d=>e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:d.name}),e.jsx("p",{className:"text-xs text-gray-500",children:d.category})]}),e.jsxs(A,{variant:d.compliance>=90?"success":d.compliance>=70?"warning":"danger",children:[d.compliance,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("span",{children:["Target: ",d.targetMetric]}),e.jsxs("span",{children:["Streak: ",d.streak," days"]})]}),e.jsx("div",{className:"mt-2 h-1.5 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${d.compliance}%`,backgroundColor:d.compliance>=90?"#10B981":d.compliance>=70?"#F59E0B":"#EF4444"}})})]},d.code))})]})})]})]})]})}function F0(t){return()=>{t|=0,t=t+1831565813|0;let a=Math.imul(t^t>>>15,1|t);return a=a+Math.imul(a^a>>>7,61|a)^a,((a^a>>>14)>>>0)/4294967296}}const $0=[{id:"sleep_duration",name:"Sleep Duration",unit:"hours",category:"sleep",baseMin:6.2,baseMax:7.8,source:"Apple Health",referenceRange:{low:7,high:9},dayMultipliers:[1.08,.95,.96,.97,.95,.93,1.06],smoothing:.3,decimals:1},{id:"sleep_efficiency",name:"Sleep Efficiency",unit:"%",category:"sleep",baseMin:80,baseMax:93,source:"Apple Health",referenceRange:{low:85,high:100},dayMultipliers:[1.02,.98,.99,1,.98,.97,1.03],smoothing:.4,decimals:0},{id:"deep_sleep",name:"Deep Sleep",unit:"min",category:"sleep",baseMin:35,baseMax:75,source:"Apple Health",referenceRange:{low:45,high:90},smoothing:.2,decimals:0},{id:"rem_sleep",name:"REM Sleep",unit:"min",category:"sleep",baseMin:65,baseMax:115,source:"Apple Health",referenceRange:{low:80,high:120},smoothing:.2,decimals:0},{id:"steps",name:"Steps",unit:"steps",category:"activity",baseMin:4e3,baseMax:26e3,source:"Apple Watch",referenceRange:{low:7e3,high:15e3},dayMultipliers:[.6,1.1,1,1.1,1,.9,.7],smoothing:.1,decimals:0},{id:"active_calories",name:"Active Calories",unit:"kcal",category:"activity",baseMin:180,baseMax:950,source:"Apple Watch",dayMultipliers:[.5,1.1,1,1.1,1,.9,.6],smoothing:.1,decimals:0},{id:"workout_duration",name:"Workout Duration",unit:"min",category:"activity",baseMin:30,baseMax:120,source:"Apple Watch + GPX",zeroProb:.38,dayMultipliers:[.4,1.2,1,1.2,1,.8,.5],smoothing:0,decimals:0},{id:"acwr",name:"ACWR",unit:"ratio",category:"activity",baseMin:.5,baseMax:1.5,source:"Computed (GPX + Apple Watch)",referenceRange:{low:.8,high:1.3},smoothing:.7,decimals:2},{id:"resting_hrv",name:"Resting HRV",unit:"ms",category:"hrv",baseMin:20,baseMax:50,source:"Apple Watch",referenceRange:{low:25,high:60},smoothing:.35,decimals:0},{id:"hrv_7d_trend",name:"HRV 7-Day Trend",unit:"ms",category:"hrv",baseMin:26,baseMax:40,source:"Apple Watch (computed)",referenceRange:{low:25,high:60},smoothing:.85,decimals:1},{id:"resting_hr",name:"Resting Heart Rate",unit:"bpm",category:"heart",baseMin:47,baseMax:58,source:"Apple Watch",referenceRange:{low:40,high:65},smoothing:.5,decimals:0},{id:"max_hr_workout",name:"Max HR (Workout)",unit:"bpm",category:"heart",baseMin:138,baseMax:188,source:"Apple Watch",zeroProb:.38,smoothing:0,decimals:0},{id:"weight",name:"Weight",unit:"kg",category:"body",baseMin:71,baseMax:74.5,source:"Apple Health",smoothing:.85,decimals:1},{id:"body_fat",name:"Body Fat",unit:"%",category:"body",baseMin:12,baseMax:16,source:"Apple Health",smoothing:.9,decimals:1}];function z0(t=42){const a=F0(t),s=new Date("2026-02-07"),i=[];for(const r of $0){const n=[];let o=(r.baseMin+r.baseMax)/2;for(let d=89;d>=0;d--){const u=new Date(s);u.setDate(u.getDate()-d);const m=u.getDay(),h=u.toISOString().split("T")[0];if(r.zeroProb&&a()<r.zeroProb){n.push({date:h,value:0});continue}let p=r.baseMin+a()*(r.baseMax-r.baseMin);r.dayMultipliers&&(p*=r.dayMultipliers[m]),r.smoothing>0&&(p=o*r.smoothing+p*(1-r.smoothing));const b=(r.baseMax-r.baseMin)*.05;p=Math.max(r.baseMin-b,Math.min(r.baseMax+b,p));const y=Math.pow(10,r.decimals??0);p=Math.round(p*y)/y,o=p,n.push({date:h,value:p})}const l={deep_sleep:J.currentMetrics.deepSleepMin,rem_sleep:J.currentMetrics.remSleepMin,resting_hrv:J.currentMetrics.hrv,resting_hr:J.currentMetrics.restingHr,weight:J.currentMetrics.weight}[r.id];if(l&&l>0){const d=n.slice(-30),u=d.reduce((h,p)=>h+p.value,0)/d.length,m=l-u;for(let h=0;h<n.length;h++){if(n[h].value===0)continue;const p=h<60?h/60:1,b=Math.pow(10,r.decimals??0);n[h].value=Math.round((n[h].value+m*p)*b)/b}}i.push({id:r.id,name:r.name,unit:r.unit,category:r.category,data:n,referenceRange:r.referenceRange,source:r.source,lastUpdated:"2026-02-07T08:00:00Z"})}return i}const us=z0(42),qi=[{name:"Iron (Serum)",key:"iron",unit:"mcg/dL",subcategory:"iron",referenceRange:{low:50,high:180},optimalRange:[60,170],description:"Serum iron level; reflects circulating iron available for hemoglobin synthesis."},{name:"Ferritin",key:"ferritin",unit:"ng/mL",subcategory:"iron",referenceRange:{low:20,high:345},optimalRange:[50,150],description:"Iron storage protein; best single marker of total body iron stores."},{name:"TIBC",key:"tibc",unit:"mcg/dL",subcategory:"iron",referenceRange:{low:250,high:425},optimalRange:[260,400],description:"Total iron-binding capacity; elevated in iron deficiency."},{name:"Iron Saturation",key:"ironSaturationPct",unit:"%",subcategory:"iron",referenceRange:{low:20,high:50},optimalRange:[20,45],description:"Percentage of transferrin bound with iron; <20% suggests iron deficiency."},{name:"Total Cholesterol",key:"totalCholesterol",unit:"mg/dL",subcategory:"lipids",referenceRange:{low:125,high:200},optimalRange:[125,180],description:"Sum of LDL, HDL, and other lipoproteins."},{name:"LDL Cholesterol",key:"ldl",unit:"mg/dL",subcategory:"lipids",referenceRange:{low:0,high:100},optimalRange:[0,70],description:"Low-density lipoprotein; primary driver of atherosclerosis."},{name:"HDL Cholesterol",key:"hdl",unit:"mg/dL",subcategory:"lipids",referenceRange:{low:40,high:100},optimalRange:[50,90],description:"High-density lipoprotein; protective against cardiovascular disease."},{name:"Triglycerides",key:"triglycerides",unit:"mg/dL",subcategory:"lipids",referenceRange:{low:0,high:150},optimalRange:[0,80],description:"Blood fats; elevated by carbohydrate intake, alcohol, and inactivity."},{name:"ApoB",key:"apob",unit:"mg/dL",subcategory:"lipids",referenceRange:{low:40,high:100},optimalRange:[40,70],description:"Apolipoprotein B; one molecule per atherogenic particle. Best predictor of CVD risk."},{name:"hsCRP",key:"hsCrp",unit:"mg/L",subcategory:"inflammation",referenceRange:{low:0,high:3},optimalRange:[0,1],description:"High-sensitivity C-reactive protein; systemic inflammation marker."},{name:"Homocysteine",key:"homocysteine",unit:"umol/L",subcategory:"inflammation",referenceRange:{low:4,high:15},optimalRange:[5,10],description:"Amino acid linked to cardiovascular risk; elevated by B12/folate deficiency."},{name:"Fasting Glucose",key:"fastingGlucose",unit:"mg/dL",subcategory:"metabolic",referenceRange:{low:65,high:100},optimalRange:[72,90],description:"Blood sugar after 8+ hour fast; marker of metabolic health."},{name:"HbA1c",key:"hba1c",unit:"%",subcategory:"metabolic",referenceRange:{low:4,high:5.7},optimalRange:[4,5.2],description:"Glycated hemoglobin; reflects average blood sugar over 2-3 months."},{name:"Insulin (Fasting)",key:"insulin",unit:"uIU/mL",subcategory:"metabolic",referenceRange:{low:2,high:19.6},optimalRange:[2,8],description:"Fasting insulin level; elevated values indicate insulin resistance."},{name:"Testosterone (Total)",key:"testosterone",unit:"ng/dL",subcategory:"hormones",referenceRange:{low:264,high:916},optimalRange:[400,700],description:"Total testosterone; important for muscle recovery, energy, and bone density."},{name:"Cortisol (AM)",key:"cortisol",unit:"mcg/dL",subcategory:"hormones",referenceRange:{low:6.2,high:19.4},optimalRange:[8,15],description:"Morning cortisol; primary stress hormone. Chronically elevated values impair recovery."},{name:"TSH",key:"tsh",unit:"mIU/L",subcategory:"hormones",referenceRange:{low:.45,high:4.5},optimalRange:[.5,2.5],description:"Thyroid-stimulating hormone; screens for thyroid dysfunction."},{name:"Vitamin D (25-OH)",key:"vitaminD",unit:"ng/mL",subcategory:"other",referenceRange:{low:30,high:100},optimalRange:[40,60],description:"Active vitamin D metabolite; crucial for bone health, immunity, and athletic performance."},{name:"Vitamin B12",key:"b12",unit:"pg/mL",subcategory:"other",referenceRange:{low:232,high:1245},optimalRange:[400,800],description:"Essential for nerve function and red blood cell formation."},{name:"EPA",key:"epa",unit:"% of total FA",subcategory:"other",referenceRange:{low:.5,high:3},optimalRange:[1,2.5],description:"Eicosapentaenoic acid; anti-inflammatory omega-3 fatty acid."},{name:"DHA",key:"dha",unit:"% of total FA",subcategory:"other",referenceRange:{low:2,high:6},optimalRange:[3,5],description:"Docosahexaenoic acid; structural omega-3, critical for brain and heart health."},{name:"AA/EPA Ratio",key:"aaEpaRatio",unit:"ratio",subcategory:"other",referenceRange:{low:1.5,high:15},optimalRange:[1.5,5],description:"Arachidonic acid to EPA ratio; lower is better for inflammation balance."}];function G0(t){const a=t.filter(o=>o.value>0);if(a.length===0)return{avg7d:0,avg30d:0,min:0,max:0,current:0};const s=a.slice(-7),i=a.slice(-30),r=o=>o.length>0?o.reduce((c,l)=>c+l.value,0)/o.length:0,n=a.map(o=>o.value);return{current:a[a.length-1]?.value??0,avg7d:Math.round(r(s)*10)/10,avg30d:Math.round(r(i)*10)/10,min:Math.min(...n),max:Math.max(...n)}}const U0=[{key:"iron",label:"Iron Panel"},{key:"lipids",label:"Lipids"},{key:"inflammation",label:"Inflammation"},{key:"metabolic",label:"Metabolic"},{key:"hormones",label:"Hormones"},{key:"other",label:"Other"}],Ki=[{id:"overview",label:"Overview",icon:Wr,color:"#64748B",metricCount:"Summary"},{id:"sleep",label:"Sleep",icon:X,color:"#b8aadd",metricCount:"4 metrics"},{id:"activity",label:"Activity & Training",icon:z,color:"#5ba8d4",metricCount:"4 metrics"},{id:"heart",label:"Heart & HRV",icon:ke,color:"#e99bbe",metricCount:"4 metrics"},{id:"labs",label:"Lab Biomarkers",icon:Fe,color:"#9182c4",metricCount:`${qi.length} markers`},{id:"body",label:"Body Composition",icon:xa,color:"#5ba8d4",metricCount:"2 metrics"}],Y0={sleep:"sleep",activity:"activity",heart:"heart",body:"body"};function Z0(t){if(t==="heart")return us.filter(s=>s.category==="heart"||s.category==="hrv");const a=Y0[t];return a?us.filter(s=>s.category===a):[]}function q0({active:t,onChange:a}){const s={overview:"",sleep:"2 hours ago",activity:"2 hours ago",heart:"2 hours ago",labs:at[0]?.date??"",body:"2 hours ago"};return e.jsxs("nav",{className:"space-y-1 sticky top-4",children:[e.jsx("div",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wider mb-3 px-3",children:"Data Categories"}),Ki.map(i=>{const r=i.icon,n=t===i.id;return e.jsxs("button",{onClick:()=>a(i.id),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-left transition-all duration-150 ${n?"bg-white border border-slate-200 shadow-sm":"hover:bg-slate-50 border border-transparent"}`,children:[e.jsx("div",{className:"p-1.5 rounded-md flex-shrink-0",style:{backgroundColor:n?i.color+"18":"transparent"},children:e.jsx(r,{className:"w-4 h-4",style:{color:n?i.color:"#94a3b8"}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:`text-sm font-medium truncate ${n?"text-slate-800":"text-slate-600"}`,children:i.label}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] text-slate-400",children:i.metricCount}),s[i.id]&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-[10px] text-slate-300",children:"|"}),e.jsx("span",{className:"text-[10px] text-slate-400",children:s[i.id]})]})]})]}),n&&e.jsx("div",{className:"w-1.5 h-6 rounded-full flex-shrink-0",style:{backgroundColor:i.color}})]},i.id)})]})}function K0({metric:t,color:a}){const s=G0(t.data),i=t.data.map(r=>r.value);return e.jsxs(k,{padding:"sm",className:"mb-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-44 flex-shrink-0",children:[e.jsx("div",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wider",children:t.name}),e.jsxs("div",{className:"flex items-baseline mt-1",children:[e.jsx("span",{className:"text-xl font-semibold font-mono text-slate-800",children:s.current}),e.jsx("span",{className:"ml-1.5 text-xs text-slate-400",children:t.unit})]})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Zi,{data:i,width:200,height:36,color:a,showDots:!0})}),e.jsxs("div",{className:"flex-1 flex items-center gap-4 justify-end",children:[e.jsx(Qt,{label:"7d avg",value:s.avg7d,unit:t.unit}),e.jsx(Qt,{label:"30d avg",value:s.avg30d,unit:t.unit}),e.jsx(Qt,{label:"range",value:`${s.min}–${s.max}`,unit:t.unit})]})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-3 text-[10px] text-slate-400",children:[e.jsx("span",{children:t.source}),e.jsx("span",{children:"|"}),e.jsx("span",{children:"Updated 2 hours ago"}),t.referenceRange&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"|"}),e.jsxs("span",{children:["Ref: ",t.referenceRange.low,"–",t.referenceRange.high," ",t.unit]})]})]})]})}function Qt({label:t,value:a,unit:s}){return e.jsxs("div",{className:"text-center px-2",children:[e.jsx("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider",children:t}),e.jsxs("div",{className:"text-sm font-mono font-medium text-slate-700",children:[a,e.jsx("span",{className:"text-[10px] text-slate-400 ml-0.5",children:s})]})]})}function X0({def:t}){const a=at.filter(c=>c[t.key]!=null).sort((c,l)=>c.date.localeCompare(l.date)).map(c=>({date:c.date,value:c[t.key]}));if(a.length===0)return null;const s=a[a.length-1],i=a.length>=2?a[a.length-2]:null;let r=e.jsx(ve,{className:"w-3 h-3 text-slate-500"}),n="stable",o="text-slate-500";if(i){const c=(s.value-i.value)/i.value*100;Math.abs(c)>5&&(c>0?(r=e.jsx(ee,{className:"w-3 h-3 text-emerald-600"}),n=`+${c.toFixed(0)}%`,o="text-emerald-600"):(r=e.jsx(fe,{className:"w-3 h-3 text-rose-600"}),n=`${c.toFixed(0)}%`,o="text-rose-600"))}return e.jsxs(k,{padding:"sm",className:"mb-3",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-800",children:t.name}),e.jsx("div",{className:"text-[10px] text-slate-400 mt-0.5",children:t.description})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[r,e.jsx("span",{className:`text-xs font-medium ${o}`,children:n})]})]}),e.jsxs("div",{className:"flex items-baseline gap-2 mb-3",children:[e.jsx("span",{className:"text-2xl font-semibold font-mono text-slate-800",children:s.value}),e.jsx("span",{className:"text-sm text-slate-400",children:t.unit})]}),e.jsx(J0,{value:s.value,referenceRange:t.referenceRange,optimalRange:t.optimalRange}),a.length>1&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-100",children:[e.jsx("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider mb-2",children:"Draw History"}),e.jsx("div",{className:"flex flex-wrap gap-x-4 gap-y-1",children:a.map(c=>e.jsxs("div",{className:"flex items-baseline gap-1.5",children:[e.jsx("span",{className:"text-[10px] text-slate-400",children:Q0(c.date)}),e.jsx("span",{className:"text-xs font-mono font-medium text-slate-700",children:c.value})]},c.date))})]})]})}function Q0(t){return new Date(t+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"2-digit"})}function J0({value:t,referenceRange:a,optimalRange:s}){const o=a.high-a.low,c=a.low-o*.2,l=a.high+o*.2,d=y=>4+(y-c)/(l-c)*252,u=d(a.low),m=d(a.high),h=s?d(s[0]):u,p=s?d(s[1]):m,b=Math.max(4,Math.min(256,d(t)));return e.jsxs("div",{children:[e.jsxs("svg",{width:260,height:34,className:"overflow-visible",children:[e.jsx("rect",{x:4,y:2,width:252,height:16,rx:4,fill:"#fecdd3",opacity:.4}),e.jsx("rect",{x:u,y:2,width:m-u,height:16,rx:3,fill:"#fde68a",opacity:.5}),s&&e.jsx("rect",{x:h,y:2,width:p-h,height:16,rx:3,fill:"#bbf7d0",opacity:.6}),e.jsx("circle",{cx:b,cy:2+16/2,r:5,fill:"#1e293b"}),e.jsx("circle",{cx:b,cy:2+16/2,r:3,fill:"white"}),e.jsx("text",{x:u,y:30,fontSize:"9",fill:"#94a3b8",textAnchor:"middle",children:a.low}),e.jsx("text",{x:m,y:30,fontSize:"9",fill:"#94a3b8",textAnchor:"middle",children:a.high})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsxs("span",{className:"flex items-center gap-1 text-[9px] text-slate-400",children:[e.jsx("span",{className:"inline-block w-2 h-2 rounded-sm",style:{backgroundColor:"#bbf7d0"}}),"Optimal"]}),e.jsxs("span",{className:"flex items-center gap-1 text-[9px] text-slate-400",children:[e.jsx("span",{className:"inline-block w-2 h-2 rounded-sm",style:{backgroundColor:"#fde68a"}}),"Reference"]}),e.jsxs("span",{className:"flex items-center gap-1 text-[9px] text-slate-400",children:[e.jsx("span",{className:"inline-block w-2 h-2 rounded-sm",style:{backgroundColor:"#fecdd3"}}),"Out of range"]})]})]})}function em(){const t=J.currentMetrics;return e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsx(Me,{label:"Resting HR",value:t.restingHr,unit:"bpm",trend:"stable",trendValue:"30d avg",icon:e.jsx(ke,{className:"w-4 h-4"})}),e.jsx(Me,{label:"HRV (SDNN)",value:t.hrv,unit:"ms",trend:"stable",trendValue:"30d avg",icon:e.jsx(z,{className:"w-4 h-4"})}),e.jsx(Me,{label:"Weight",value:t.weight,unit:"kg",trend:"stable",trendValue:"latest",icon:e.jsx(xa,{className:"w-4 h-4"})}),e.jsx(Me,{label:"Deep Sleep",value:t.deepSleepMin,unit:"min",trend:"stable",trendValue:"30d avg",icon:e.jsx(X,{className:"w-4 h-4"})}),e.jsx(Me,{label:"REM Sleep",value:t.remSleepMin,unit:"min",trend:"stable",trendValue:"30d avg",icon:e.jsx(X,{className:"w-4 h-4"})}),e.jsx(Me,{label:"Fasting Glucose",value:t.fastingGlucose,unit:"mg/dL",trend:"stable",trendValue:"last draw",icon:e.jsx(Fe,{className:"w-4 h-4"})})]}),e.jsxs(k,{padding:"none",className:"overflow-hidden rounded-xl",children:[e.jsx("div",{className:"px-6 py-4 bg-gradient-to-r from-slate-800 to-slate-700 text-white rounded-t-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/10 rounded-lg",children:e.jsx(_e,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Data Coverage & Cadence"}),e.jsx("p",{className:"text-sm text-slate-300",children:"Temporal coverage of Oron's connected data sources — 4,000+ days across 7 streams"})]})]})}),e.jsxs("div",{className:"px-6 py-4",children:[e.jsx(Pc,{}),e.jsxs("div",{className:"flex items-center gap-6 mt-3 text-[10px] text-slate-400 uppercase tracking-wider",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"inline-block w-6 h-2 rounded-sm bg-emerald-500 opacity-80"}),"Daily stream"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"inline-block w-6 h-2 rounded-sm bg-amber-500 opacity-50"}),"Ad-hoc (density)"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("svg",{width:10,height:10,viewBox:"0 0 10 10",children:e.jsx("polygon",{points:"5,1 9,5 5,9 1,5",fill:"#8B5CF6"})}),"Episodic event"]})]})]})]})]})}function vt({categoryId:t,color:a}){const s=Z0(t);return s.length===0?null:e.jsx("div",{children:s.map(i=>e.jsx(K0,{metric:i,color:a},i.id))})}function tm(){return e.jsxs("div",{children:[U0.map(t=>{const s=qi.filter(i=>i.subcategory===t.key).filter(i=>at.some(r=>r[i.key]!=null));return s.length===0?null:e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wider mb-3 px-1",children:t.label}),s.map(i=>e.jsx(X0,{def:i},i.key))]},t.key)}),e.jsxs("div",{className:"mt-4 px-1 text-[10px] text-slate-400",children:["Last lab draw: ",at[0]?.date??"N/A"," | ",J.labDraws," total draws | Source: Quest Labs"]})]})}function am(){const[t,a]=g.useState("overview"),s=Ki.find(i=>i.id===t);return e.jsx(Z,{title:"Oron's Raw Data",subtitle:"Browsable source-of-truth view — wearable time series, lab biomarkers, body composition, and training metrics",children:e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsxs("div",{className:"flex gap-6",children:[e.jsx("aside",{className:"flex-shrink-0",style:{width:"240px"},children:e.jsx(q0,{active:t,onChange:a})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[t!=="overview"&&e.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:s.color+"18"},children:e.jsx(s.icon,{className:"w-5 h-5",style:{color:s.color}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:s.label}),e.jsx("p",{className:"text-xs text-slate-400",children:s.metricCount})]})]}),e.jsxs(M.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},transition:{duration:.15},children:[t==="overview"&&e.jsx(em,{}),t==="sleep"&&e.jsx(vt,{categoryId:"sleep",color:"#b8aadd"}),t==="activity"&&e.jsx(vt,{categoryId:"activity",color:"#5ba8d4"}),t==="heart"&&e.jsx(vt,{categoryId:"heart",color:"#e99bbe"}),t==="labs"&&e.jsx(tm,{}),t==="body"&&e.jsx(vt,{categoryId:"body",color:"#5ba8d4"})]},t)]})]})})})}const D={title:"Sleep Duration → Recovery Score",theta:"7.2 hours",beta:"+18%",certainty:87,personalData:89},dt=[{label:"Outcomes",count:12,color:"#10B981"},{label:"Loads",count:8,color:"#F59E0B"},{label:"Markers",count:5,color:"#8B5CF6"}];function sm(){return e.jsxs("div",{className:"p-8 bg-white rounded-2xl",children:[e.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-emerald-600 uppercase tracking-wider mb-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full"}),"Sleep Insight"]}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:D.title})]}),e.jsx("div",{className:"grid grid-cols-3 gap-px bg-gray-200 rounded-lg overflow-hidden mb-6",children:dt.map(t=>e.jsxs("div",{className:"bg-white p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t.count}),e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide mt-1",children:t.label})]},t.label))}),e.jsxs("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:[e.jsx("div",{className:"h-1 bg-emerald-500"}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-baseline justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Your threshold"}),e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:D.theta})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Effect above"}),e.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:D.beta})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsx("span",{children:"Certainty"}),e.jsxs("span",{className:"font-medium text-gray-900",children:[D.certainty,"%"]})]}),e.jsx("div",{className:"h-1.5 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-500 rounded-full",style:{width:`${D.certainty}%`}})})]}),e.jsx("div",{className:"h-px bg-gray-100 my-4"}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Evidence mix"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"w-24 h-1.5 bg-gray-100 rounded-full overflow-hidden flex",children:[e.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${D.personalData}%`}}),e.jsx("div",{className:"h-full bg-emerald-200",style:{width:`${100-D.personalData}%`}})]}),e.jsxs("span",{className:"text-gray-900 font-medium",children:[D.personalData,"% yours"]})]})]})]})]}),e.jsxs("button",{className:"w-full mt-4 py-3 text-sm font-medium text-emerald-600 border border-emerald-200 rounded-lg hover:bg-emerald-50 transition-colors flex items-center justify-center gap-2",children:["View Full Analysis",e.jsx(ve,{className:"w-4 h-4"})]})]})}function im(){return e.jsxs("div",{className:"p-8 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 rounded-2xl text-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-emerald-400 text-xs font-bold uppercase tracking-widest mb-1",children:"Sleep Insight"}),e.jsx("h3",{className:"text-xl font-bold",children:D.title})]}),e.jsxs("div",{className:"px-3 py-1 bg-emerald-500/20 border border-emerald-500/30 rounded-full text-emerald-400 text-xs font-bold",children:[D.certainty,"% CERTAIN"]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-6",children:dt.map(t=>e.jsxs("div",{className:"relative p-4 rounded-xl overflow-hidden",style:{backgroundColor:`${t.color}15`},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-3xl font-black",style:{color:t.color},children:t.count}),e.jsx("div",{className:"text-xs text-slate-400 uppercase tracking-wider mt-1",children:t.label})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1",style:{backgroundColor:t.color}})]},t.label))}),e.jsxs("div",{className:"bg-white/5 backdrop-blur border border-white/10 rounded-xl p-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-5",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400 text-xs uppercase tracking-wider mb-1",children:"Threshold θ"}),e.jsx("div",{className:"text-4xl font-black bg-gradient-to-r from-emerald-400 to-cyan-400 bg-clip-text text-transparent",children:D.theta})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400 text-xs uppercase tracking-wider mb-1",children:"Effect β"}),e.jsx("div",{className:"text-4xl font-black text-emerald-400",children:D.beta})]})]}),e.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden mb-2",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-cyan-400 rounded-full",style:{width:`${D.certainty}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[e.jsx("span",{children:"0%"}),e.jsxs("span",{className:"text-emerald-400 font-bold",children:[D.certainty,"% Certainty"]}),e.jsx("span",{children:"100%"})]}),e.jsx("div",{className:"mt-5 pt-5 border-t border-white/10",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 h-3 rounded-full overflow-hidden flex",children:[e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-400",style:{width:`${D.personalData}%`}}),e.jsx("div",{className:"h-full bg-slate-600",style:{width:`${100-D.personalData}%`}})]}),e.jsxs("span",{className:"text-xs text-slate-400",children:[e.jsxs("span",{className:"text-emerald-400 font-bold",children:[D.personalData,"%"]})," Personal"]})]})})]}),e.jsxs("button",{className:"w-full mt-4 py-3 bg-gradient-to-r from-emerald-500 to-cyan-500 text-white font-bold rounded-xl hover:from-emerald-400 hover:to-cyan-400 transition-all flex items-center justify-center gap-2",children:[e.jsx(Le,{className:"w-4 h-4"}),"Explore Insight"]})]})}function rm(){return e.jsxs("div",{className:"p-8 bg-gradient-to-br from-stone-50 to-amber-50/30 rounded-3xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-emerald-100 to-teal-100 rounded-2xl flex items-center justify-center",children:e.jsx(X,{className:"w-6 h-6 text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-emerald-600 uppercase tracking-wide",children:"Sleep Pattern"}),e.jsx("h3",{className:"text-lg font-semibold text-stone-800",children:D.title})]})]}),e.jsx("div",{className:"flex gap-2 mb-6",children:dt.map(t=>e.jsxs("div",{className:"flex-1 py-3 px-4 rounded-2xl text-center",style:{backgroundColor:`${t.color}12`},children:[e.jsx("div",{className:"text-xl font-bold",style:{color:t.color},children:t.count}),e.jsx("div",{className:"text-xs text-stone-500 mt-0.5",children:t.label})]},t.label))}),e.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-sm shadow-stone-200/50 border border-stone-100",children:[e.jsxs("div",{className:"flex gap-1 mb-4",children:[e.jsx("div",{className:"h-1 flex-1 bg-emerald-400 rounded-full"}),e.jsx("div",{className:"h-1 w-8 bg-emerald-200 rounded-full"}),e.jsx("div",{className:"h-1 w-4 bg-emerald-100 rounded-full"})]}),e.jsxs("div",{className:"flex items-end justify-between mb-5",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-stone-400 mb-1",children:"Your optimal threshold"}),e.jsx("div",{className:"text-3xl font-bold text-stone-800",children:D.theta})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"inline-flex items-center gap-1 px-3 py-1.5 bg-emerald-50 rounded-full",children:[e.jsx(ee,{className:"w-3.5 h-3.5 text-emerald-600"}),e.jsx("span",{className:"text-sm font-semibold text-emerald-700",children:D.beta})]})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-stone-400",children:"Certainty level"}),e.jsxs("span",{className:"font-semibold text-stone-600",children:[D.certainty,"%"]})]}),e.jsx("div",{className:"h-2.5 bg-stone-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-400 to-teal-400 rounded-full transition-all",style:{width:`${D.certainty}%`}})})]}),e.jsxs("div",{className:"relative my-5",children:[e.jsx("div",{className:"h-px bg-stone-100"}),e.jsx("div",{className:"absolute left-0 top-0 w-12 h-px bg-emerald-300"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"h-2 rounded-full overflow-hidden flex bg-stone-100",children:e.jsx("div",{className:"h-full bg-emerald-400 rounded-l-full",style:{width:`${D.personalData}%`}})})}),e.jsxs("div",{className:"text-xs text-stone-500",children:[e.jsxs("span",{className:"font-semibold text-emerald-600",children:[D.personalData,"%"]})," your data"]})]})]}),e.jsxs("button",{className:"w-full mt-4 py-3 text-sm font-semibold text-emerald-700 bg-emerald-50 hover:bg-emerald-100 rounded-2xl transition-colors flex items-center justify-center gap-2",children:["See Full Pattern",e.jsx(ve,{className:"w-4 h-4"})]})]})}function nm(){return e.jsxs("div",{className:"p-8 bg-white rounded-lg border-2 border-black",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"inline-block px-2 py-1 bg-emerald-500 text-white text-xs font-black uppercase tracking-wider mb-2",children:"Sleep"}),e.jsx("h3",{className:"text-xl font-black text-black uppercase tracking-tight",children:D.title})]}),e.jsxs("div",{className:"text-4xl font-black text-emerald-500",children:[D.certainty,"%"]})]}),e.jsx("div",{className:"flex border-2 border-black divide-x-2 divide-black mb-6",children:dt.map(t=>e.jsxs("div",{className:"flex-1 p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-black",style:{color:t.color},children:t.count}),e.jsx("div",{className:"text-xs font-bold text-black uppercase tracking-widest mt-1",children:t.label})]},t.label))}),e.jsxs("div",{className:"border-2 border-black",children:[e.jsx("div",{className:"bg-emerald-500 px-5 py-3 border-b-2 border-black",children:e.jsx("span",{className:"text-white font-black uppercase tracking-wider text-sm",children:"Your Numbers"})}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-5",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Threshold θ"}),e.jsx("div",{className:"text-4xl font-black text-black mt-1",children:D.theta})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Effect β"}),e.jsx("div",{className:"text-4xl font-black text-emerald-500 mt-1",children:D.beta})]})]}),e.jsx("div",{className:"h-4 bg-gray-200 mb-2",children:e.jsx("div",{className:"h-full bg-black",style:{width:`${D.certainty}%`}})}),e.jsxs("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:["Certainty: ",D.certainty,"%"]}),e.jsx("div",{className:"h-0.5 bg-black my-5"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-1 h-3 bg-gray-200 flex",children:e.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${D.personalData}%`}})}),e.jsxs("span",{className:"text-xs font-black text-black uppercase",children:[D.personalData,"% Personal"]})]})]})]}),e.jsxs("button",{className:"w-full mt-4 py-4 bg-black text-white font-black uppercase tracking-wider hover:bg-emerald-500 transition-colors flex items-center justify-center gap-2",children:["Analyze",e.jsx(ve,{className:"w-5 h-5"})]})]})}function om(){return e.jsxs("div",{className:"p-8 bg-gradient-to-br from-slate-900 via-violet-950 to-slate-900 rounded-3xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-emerald-500/20 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-violet-500/20 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-white/10 backdrop-blur-xl rounded-xl border border-white/20 flex items-center justify-center",children:e.jsx(X,{className:"w-5 h-5 text-emerald-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-emerald-400 text-xs font-medium tracking-wider uppercase",children:"Sleep Insight"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:D.title})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-6",children:dt.map(t=>e.jsxs("div",{className:"p-4 rounded-2xl bg-white/5 backdrop-blur-xl border border-white/10 text-center relative overflow-hidden group hover:bg-white/10 transition-all",children:[e.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity",style:{boxShadow:`inset 0 0 30px ${t.color}20`}}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:t.count}),e.jsx("div",{className:"text-xs text-white/50 mt-1",children:t.label})]}),e.jsx("div",{className:"absolute bottom-0 left-1/4 right-1/4 h-px opacity-60",style:{background:`linear-gradient(90deg, transparent, ${t.color}, transparent)`}})]},t.label))}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-xl rounded-2xl border border-white/10 p-5 relative",children:[e.jsx("div",{className:"absolute top-0 left-8 right-8 h-px bg-gradient-to-r from-transparent via-emerald-400/50 to-transparent"}),e.jsxs("div",{className:"flex items-end justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-white/40 text-xs uppercase tracking-wider mb-1",children:"Threshold θ"}),e.jsx("div",{className:"text-4xl font-bold text-white",children:D.theta})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-white/40 text-xs uppercase tracking-wider mb-1",children:"Effect β"}),e.jsx("div",{className:"text-3xl font-bold text-emerald-400",children:D.beta})]})]}),e.jsxs("div",{className:"relative mb-2",children:[e.jsx("div",{className:"h-2 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-400 rounded-full relative",style:{width:`${D.certainty}%`},children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent to-white/30"})})}),e.jsx("div",{className:"absolute -bottom-2 left-0 h-4 bg-emerald-500/30 blur-md rounded-full",style:{width:`${D.certainty}%`}})]}),e.jsxs("div",{className:"text-xs text-white/40",children:[e.jsxs("span",{className:"text-emerald-400 font-medium",children:[D.certainty,"%"]})," certainty"]}),e.jsxs("div",{className:"relative my-5",children:[e.jsx("div",{className:"h-px bg-white/10"}),e.jsx("div",{className:"absolute left-0 top-0 w-1/3 h-px bg-gradient-to-r from-emerald-400/50 to-transparent"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-1 h-1.5 bg-white/10 rounded-full overflow-hidden flex",children:e.jsx("div",{className:"h-full bg-emerald-400/80 rounded-l-full",style:{width:`${D.personalData}%`}})}),e.jsxs("span",{className:"text-xs text-white/50",children:[e.jsxs("span",{className:"text-emerald-400",children:[D.personalData,"%"]})," personal"]})]})]}),e.jsxs("button",{className:"w-full mt-4 py-3.5 bg-gradient-to-r from-emerald-500/80 to-emerald-600/80 backdrop-blur text-white font-medium rounded-xl border border-emerald-400/30 hover:from-emerald-500 hover:to-emerald-600 transition-all flex items-center justify-center gap-2 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"}),e.jsx("span",{className:"relative",children:"Explore Insight"}),e.jsx(Ae,{className:"w-4 h-4 relative"})]})]})]})}function lm(){const[t,a]=g.useState(null),s=[{id:1,name:"Precision",subtitle:"Neo-Medical",description:"Clean, clinical, generous whitespace. Thin borders and single accent colors per section. Inspired by premium medical devices.",component:sm},{id:2,name:"Signal",subtitle:"Data-Forward",description:"Bold gradients, dark backgrounds, chart-like feel. High contrast with prominent metrics. Inspired by financial terminals.",component:im},{id:3,name:"Meridian",subtitle:"Soft Science",description:"Organic curves, warm pastels, thin accent lines. Scientific but approachable. Inspired by wellness apps.",component:rm},{id:4,name:"Contrast",subtitle:"Brutalist Modern",description:"Hard edges, bold borders, high contrast blocks. Magazine-like typography. Striking and memorable.",component:nm},{id:5,name:"Aurora",subtitle:"Luminous Glass",description:"Glassmorphism with glows, layered depth, ethereal feel. Premium and futuristic. Inspired by luxury interfaces.",component:om}];return e.jsx("div",{className:"min-h-screen bg-gray-100 py-12 px-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-3",children:"Choose Your Signature Style"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Select the aesthetic direction that best represents the Serif platform. Each style uses your color scheme with different approaches to color blocking, typography, and visual hierarchy."})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8 mb-12",children:s.map(i=>{const r=i.component,n=t===i.id;return e.jsxs(M.div,{whileHover:{y:-4},className:`relative ${n?"ring-4 ring-primary-500 ring-offset-4 rounded-3xl":""}`,children:[n&&e.jsx("div",{className:"absolute -top-3 -right-3 w-8 h-8 bg-primary-500 rounded-full flex items-center justify-center z-10 shadow-lg",children:e.jsx(ie,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-primary-600",children:["Style ",i.id]}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:i.name}),e.jsxs("span",{className:"text-sm text-gray-500",children:["/ ",i.subtitle]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:i.description})]}),e.jsx("div",{className:"cursor-pointer transition-transform",onClick:()=>a(i.id),children:e.jsx(r,{})}),e.jsx("button",{onClick:()=>a(i.id),className:`w-full mt-4 py-3 rounded-xl font-semibold transition-all ${n?"bg-primary-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:n?"Selected":"Select This Style"})]},i.id)})}),t&&e.jsxs(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl p-8 shadow-lg border border-gray-200 text-center",children:[e.jsx("div",{className:"text-sm font-medium text-primary-600 mb-2",children:"You've selected"}),e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:[s.find(i=>i.id===t)?.name," / ",s.find(i=>i.id===t)?.subtitle]}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Tell me to apply this style and I'll update the entire platform with this aesthetic direction."}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx("button",{onClick:()=>a(null),className:"px-6 py-3 border border-gray-300 rounded-xl font-medium text-gray-700 hover:bg-gray-50",children:"Compare Again"}),e.jsx("button",{className:"px-6 py-3 bg-primary-600 text-white rounded-xl font-medium hover:bg-primary-700",children:"Apply This Style"})]})]})]})})}const Ke={source:"bedtime_hour",target:"sleep_efficiency",theta:{value:22.25,unit:"hour",low:21.75,high:22.75,displayValue:"10:15 PM"},betaBelow:{value:.02,unit:"%",description:"+2% per hour earlier"},betaAbove:{value:-.023,unit:"%",description:"-2.3% per hour later"},curveType:"plateau_down",observations:142,completePct:94.5,changepointProb:.92,sizeCategory:"medium",currentValue:23.5,currentStatus:"above_optimal"},B={curve:"#10B981",threshold:"#10B981",current:"#F59E0B",fill:"rgba(16, 185, 129, 0.15)"};function cm({params:t}){const i={top:30,right:50,bottom:50,left:60},r=400-i.left-i.right,n=180-i.top-i.bottom;return e.jsx("div",{className:"bg-white border-2 border-black p-4",children:e.jsxs("svg",{width:400,height:180,children:[e.jsx("rect",{x:i.left,y:i.top,width:r,height:n,fill:"#FAFAFA",stroke:"#E5E7EB",strokeWidth:"1"}),[.25,.5,.75].map(o=>e.jsx("line",{x1:i.left,y1:i.top+n*o,x2:i.left+r,y2:i.top+n*o,stroke:"#E5E7EB",strokeDasharray:"2 4"},o)),e.jsx("path",{d:`M ${i.left} ${i.top+n*.15}
              L ${i.left+r*.5} ${i.top+n*.15}
              Q ${i.left+r*.65} ${i.top+n*.3}
              ${i.left+r} ${i.top+n*.85}`,fill:"none",stroke:B.curve,strokeWidth:"3",strokeLinecap:"round"}),e.jsx("path",{d:`M ${i.left} ${i.top+n*.15}
              L ${i.left+r*.5} ${i.top+n*.15}
              Q ${i.left+r*.65} ${i.top+n*.3}
              ${i.left+r} ${i.top+n*.85}
              L ${i.left+r} ${i.top+n}
              L ${i.left} ${i.top+n}
              Z`,fill:B.fill}),e.jsx("line",{x1:i.left+r*.5,y1:i.top,x2:i.left+r*.5,y2:i.top+n,stroke:B.threshold,strokeWidth:"2",strokeDasharray:"6 4"}),e.jsx("circle",{cx:i.left+r*.5,cy:i.top+n*.15,r:"8",fill:B.threshold}),e.jsx("circle",{cx:i.left+r*.5,cy:i.top+n*.15,r:"4",fill:"white"}),e.jsx("circle",{cx:i.left+r*.75,cy:i.top+n*.55,r:"7",fill:B.current}),e.jsx("circle",{cx:i.left+r*.75,cy:i.top+n*.55,r:"3",fill:"white"}),e.jsx("text",{x:15,y:i.top+n/2,textAnchor:"middle",className:"text-xs font-bold fill-gray-600 uppercase",transform:`rotate(-90, 15, ${i.top+n/2})`,children:"Sleep Efficiency"}),e.jsx("text",{x:i.left+r/2,y:172,textAnchor:"middle",className:"text-xs font-bold fill-gray-600 uppercase",children:"Bedtime Hour"}),e.jsx("text",{x:i.left+r*.5,y:i.top-10,textAnchor:"middle",className:"text-sm font-black fill-emerald-600",children:"θ = 10:15 PM"}),e.jsx("text",{x:i.left+r*.75,y:i.top-10,textAnchor:"middle",className:"text-sm font-bold fill-amber-600",children:"YOU: 11:30 PM"})]})})}function dm({params:t}){return e.jsxs("div",{className:"flex border-2 border-black",children:[e.jsx("div",{className:"p-4 border-r-2 border-black bg-gray-50",children:e.jsxs("svg",{width:160,height:160,children:[e.jsx("rect",{x:"0",y:"0",width:160,height:160,fill:"#FAFAFA"}),e.jsx("line",{x1:"0",y1:160,x2:160,y2:160,stroke:"#000",strokeWidth:"2"}),e.jsx("line",{x1:"0",y1:"0",x2:"0",y2:160,stroke:"#000",strokeWidth:"2"}),e.jsx("path",{d:`M 0 ${160*.2}
                L ${160*.5} ${160*.2}
                Q ${160*.7} ${160*.35}
                160 ${160*.85}`,fill:B.fill,stroke:B.curve,strokeWidth:"3"}),e.jsx("line",{x1:160*.5,y1:"0",x2:160*.5,y2:160,stroke:B.threshold,strokeWidth:"2",strokeDasharray:"4 4"}),e.jsx("circle",{cx:160*.5,cy:160*.2,r:"8",fill:B.threshold}),e.jsx("circle",{cx:160*.5,cy:160*.2,r:"4",fill:"white"}),e.jsx("circle",{cx:160*.75,cy:160*.55,r:"6",fill:B.current})]})}),e.jsx("div",{className:"flex-1 p-4 bg-white",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Threshold (θ)"}),e.jsx("div",{className:"text-2xl font-black text-black",children:"10:15 PM"})]}),e.jsx("div",{className:"h-0.5 bg-black"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase",children:"Before θ"}),e.jsx("div",{className:"text-lg font-bold text-emerald-600",children:"+2%/hr"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase",children:"After θ"}),e.jsx("div",{className:"text-lg font-bold text-rose-600",children:"-2.3%/hr"})]})]}),e.jsx("div",{className:"h-0.5 bg-gray-200"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase",children:"Your Current"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg font-black text-amber-600",children:"11:30 PM"}),e.jsx("span",{className:"px-2 py-0.5 bg-amber-500 text-white text-xs font-bold uppercase",children:"Above θ"})]})]})]})})]})}function mm({params:t}){return e.jsxs("div",{className:"border-2 border-black",children:[e.jsx("div",{className:"px-4 py-2 bg-black text-white",children:e.jsx("div",{className:"text-xs font-bold uppercase tracking-wider",children:"Dose-Response: Bedtime → Sleep"})}),e.jsx("div",{className:"p-4 bg-gray-50 border-b-2 border-black",children:e.jsxs("svg",{width:340,height:140,children:[e.jsx("rect",{x:"40",y:"10",width:280,height:110,fill:"white",stroke:"#E5E7EB"}),e.jsx("path",{d:`M 40 ${140*.2}
                L ${340*.45} ${140*.2}
                Q ${340*.6} ${140*.35}
                320 ${140*.75}`,fill:B.fill,stroke:B.curve,strokeWidth:"3",strokeLinecap:"round"}),e.jsx("line",{x1:340*.45,y1:"10",x2:340*.45,y2:120,stroke:B.threshold,strokeWidth:"2",strokeDasharray:"6 3"}),e.jsx("circle",{cx:340*.45,cy:140*.2,r:"10",fill:B.threshold}),e.jsx("text",{x:340*.45,y:140*.2+4,textAnchor:"middle",className:"text-xs font-black fill-white",children:"θ"}),e.jsx("circle",{cx:340*.7,cy:140*.5,r:"8",fill:B.current,stroke:"white",strokeWidth:"2"}),e.jsx("text",{x:"40",y:135,className:"text-xs fill-gray-500",children:"Early"}),e.jsx("text",{x:320,y:135,textAnchor:"end",className:"text-xs fill-gray-500",children:"Late"})]})}),e.jsxs("div",{className:"grid grid-cols-3",children:[e.jsxs("div",{className:"p-3 border-r-2 border-black text-center",children:[e.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase",children:"Threshold"}),e.jsx("div",{className:"text-xl font-black text-emerald-600",children:"10:15 PM"})]}),e.jsxs("div",{className:"p-3 border-r-2 border-black text-center",children:[e.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase",children:"Effect (β)"}),e.jsx("div",{className:"text-xl font-black text-rose-600",children:"-2.3%/hr"})]}),e.jsxs("div",{className:"p-3 text-center bg-amber-50",children:[e.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase",children:"You Now"}),e.jsx("div",{className:"text-xl font-black text-amber-600",children:"11:30 PM"})]})]})]})}function um({params:t}){return e.jsxs("div",{className:"relative border-2 border-black bg-white p-4",children:[e.jsxs("svg",{width:360,height:200,children:[e.jsx("defs",{children:e.jsx("pattern",{id:"minGrid",width:"40",height:"40",patternUnits:"userSpaceOnUse",children:e.jsx("path",{d:"M 40 0 L 0 0 0 40",fill:"none",stroke:"#F3F4F6",strokeWidth:"1"})})}),e.jsx("rect",{width:360,height:200,fill:"url(#minGrid)"}),e.jsx("path",{d:`M 20 ${200*.25}
              L ${360*.45} ${200*.25}
              Q ${360*.6} ${200*.4}
              340 ${200*.8}`,fill:"none",stroke:B.curve,strokeWidth:"4",strokeLinecap:"round"}),e.jsx("path",{d:`M 20 ${200*.25}
              L ${360*.45} ${200*.25}
              Q ${360*.6} ${200*.4}
              340 ${200*.8}
              L 340 200
              L 20 200
              Z`,fill:B.fill}),e.jsx("rect",{x:360*.45-3,y:"0",width:"6",height:200,fill:B.threshold,opacity:"0.2"}),e.jsx("circle",{cx:360*.45,cy:200*.25,r:"12",fill:B.threshold}),e.jsx("circle",{cx:360*.45,cy:200*.25,r:"6",fill:"white"}),e.jsx("circle",{cx:360*.72,cy:200*.55,r:"10",fill:B.current}),e.jsx("circle",{cx:360*.72,cy:200*.55,r:"5",fill:"white"}),e.jsx("line",{x1:360*.45,y1:200*.25,x2:360*.72,y2:200*.55,stroke:"#CBD5E1",strokeWidth:"1",strokeDasharray:"4 4"})]}),e.jsx("div",{className:"absolute px-3 py-1.5 bg-emerald-500 text-white font-black text-sm uppercase",style:{top:"10px",left:"calc(45% - 40px)"},children:"θ = 10:15 PM"}),e.jsx("div",{className:"absolute px-3 py-1.5 bg-amber-500 text-white font-black text-sm uppercase",style:{top:"45%",right:"20px"},children:"YOU: 11:30 PM"}),e.jsx("div",{className:"absolute px-2 py-1 bg-rose-500 text-white font-bold text-xs uppercase",style:{bottom:"20px",right:"60px"},children:"-2.3%/hr after θ"})]})}function hm({params:t}){return e.jsxs("div",{className:"border-2 border-black",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 border-b-2 border-black",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-black text-black uppercase",children:"Bedtime → Sleep Efficiency"}),e.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Plateau-Down Curve • n=142"})]}),e.jsxs("svg",{width:120,height:80,className:"border border-gray-200",children:[e.jsx("path",{d:`M 5 ${80*.25}
                L ${120*.45} ${80*.25}
                Q ${120*.6} ${80*.4}
                115 ${80*.8}`,fill:B.fill,stroke:B.curve,strokeWidth:"2"}),e.jsx("circle",{cx:120*.45,cy:80*.25,r:"4",fill:B.threshold}),e.jsx("circle",{cx:120*.72,cy:80*.55,r:"4",fill:B.current})]})]}),e.jsx("table",{className:"w-full",children:e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{className:"px-4 py-3 bg-emerald-50 font-bold text-xs uppercase text-gray-600 w-1/3",children:"Threshold (θ)"}),e.jsx("td",{className:"px-4 py-3 font-black text-xl text-emerald-600",children:"10:15 PM"})]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{className:"px-4 py-3 bg-gray-50 font-bold text-xs uppercase text-gray-600",children:"Effect Before θ"}),e.jsx("td",{className:"px-4 py-3 font-bold text-lg text-emerald-600",children:"+2% per hour earlier"})]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{className:"px-4 py-3 bg-gray-50 font-bold text-xs uppercase text-gray-600",children:"Effect After θ"}),e.jsx("td",{className:"px-4 py-3 font-bold text-lg text-rose-600",children:"-2.3% per hour later"})]}),e.jsxs("tr",{className:"bg-amber-50",children:[e.jsx("td",{className:"px-4 py-3 font-bold text-xs uppercase text-gray-600",children:"Your Current"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-black text-xl text-amber-600",children:"11:30 PM"}),e.jsx("span",{className:"px-2 py-1 bg-amber-500 text-white text-xs font-bold uppercase",children:"1h 15m after optimal"})]})})]})]})})]})}function pm(){const[t,a]=g.useState(null),s=[{id:1,name:"Expanded Horizontal",description:"Wide format with generous spacing. Labels outside chart area for maximum clarity.",pros:["Clear axis labels","No overlapping elements","Room for annotations"],cons:["Takes more horizontal space","May not fit in 2-column grid well"]},{id:2,name:"Split Panel",description:"Chart and parameters in separate panels. Clean separation of visual and numeric data.",pros:["Clear parameter display","Chart stays simple","Brutalist blocks aesthetic"],cons:["More complex layout","Duplicates some information"]},{id:3,name:"Stacked Vertical",description:"Large chart on top, parameter blocks below. Vertical flow is easy to scan.",pros:["Natural top-to-bottom flow","Parameters as color blocks","Works well in cards"],cons:["Taller component","Chart width limited"]},{id:4,name:"Minimal Annotation",description:"Large clean curve with floating badges. Emphasizes the visual relationship.",pros:["Dramatic visual impact","Clear markers","Modern feel"],cons:["Annotations could overlap","Less precise than numbers"]},{id:5,name:"Data Table Focus",description:"Mini chart as icon, emphasis on tabular parameter display. Best for data accuracy.",pros:["Precise numbers","Easy to scan","Most space-efficient"],cons:["Chart is decorative only","Less visual impact"]}];return e.jsx(Z,{title:"Curve Visualization Styles",subtitle:"Select the best format for dose-response curves",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-gray-100 border-b-2 border-black flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-black uppercase",children:["Style 1: ",s[0].name]}),e.jsx("p",{className:"text-sm text-gray-600",children:s[0].description})]}),e.jsx(V,{variant:t===1?"success":"outline",size:"sm",onClick:()=>a(1),leftIcon:t===1?e.jsx(ie,{className:"w-4 h-4"}):void 0,children:t===1?"Selected":"Select"})]}),e.jsx("div",{className:"p-6 bg-white",children:e.jsx(cm,{params:Ke})}),e.jsxs("div",{className:"p-4 bg-gray-50 border-t-2 border-black flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Pros:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s[0].pros.map(i=>e.jsx(A,{variant:"success",size:"sm",children:i},i))})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Cons:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s[0].cons.map(i=>e.jsx(A,{variant:"warning",size:"sm",children:i},i))})]})]})]}),e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-gray-100 border-b-2 border-black flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-black uppercase",children:["Style 2: ",s[1].name]}),e.jsx("p",{className:"text-sm text-gray-600",children:s[1].description})]}),e.jsx(V,{variant:t===2?"success":"outline",size:"sm",onClick:()=>a(2),leftIcon:t===2?e.jsx(ie,{className:"w-4 h-4"}):void 0,children:t===2?"Selected":"Select"})]}),e.jsx("div",{className:"p-6 bg-white",children:e.jsx(dm,{params:Ke})}),e.jsxs("div",{className:"p-4 bg-gray-50 border-t-2 border-black flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Pros:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s[1].pros.map(i=>e.jsx(A,{variant:"success",size:"sm",children:i},i))})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Cons:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s[1].cons.map(i=>e.jsx(A,{variant:"warning",size:"sm",children:i},i))})]})]})]}),e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-gray-100 border-b-2 border-black flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-black uppercase",children:["Style 3: ",s[2].name]}),e.jsx("p",{className:"text-sm text-gray-600",children:s[2].description})]}),e.jsx(V,{variant:t===3?"success":"outline",size:"sm",onClick:()=>a(3),leftIcon:t===3?e.jsx(ie,{className:"w-4 h-4"}):void 0,children:t===3?"Selected":"Select"})]}),e.jsx("div",{className:"p-6 bg-white",children:e.jsx(mm,{params:Ke})}),e.jsxs("div",{className:"p-4 bg-gray-50 border-t-2 border-black flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Pros:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s[2].pros.map(i=>e.jsx(A,{variant:"success",size:"sm",children:i},i))})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Cons:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s[2].cons.map(i=>e.jsx(A,{variant:"warning",size:"sm",children:i},i))})]})]})]}),e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-gray-100 border-b-2 border-black flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-black uppercase",children:["Style 4: ",s[3].name]}),e.jsx("p",{className:"text-sm text-gray-600",children:s[3].description})]}),e.jsx(V,{variant:t===4?"success":"outline",size:"sm",onClick:()=>a(4),leftIcon:t===4?e.jsx(ie,{className:"w-4 h-4"}):void 0,children:t===4?"Selected":"Select"})]}),e.jsx("div",{className:"p-6 bg-white",children:e.jsx(um,{params:Ke})}),e.jsxs("div",{className:"p-4 bg-gray-50 border-t-2 border-black flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Pros:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s[3].pros.map(i=>e.jsx(A,{variant:"success",size:"sm",children:i},i))})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Cons:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s[3].cons.map(i=>e.jsx(A,{variant:"warning",size:"sm",children:i},i))})]})]})]}),e.jsxs(k,{padding:"none",className:"overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-gray-100 border-b-2 border-black flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-black uppercase",children:["Style 5: ",s[4].name]}),e.jsx("p",{className:"text-sm text-gray-600",children:s[4].description})]}),e.jsx(V,{variant:t===5?"success":"outline",size:"sm",onClick:()=>a(5),leftIcon:t===5?e.jsx(ie,{className:"w-4 h-4"}):void 0,children:t===5?"Selected":"Select"})]}),e.jsx("div",{className:"p-6 bg-white",children:e.jsx(hm,{params:Ke})}),e.jsxs("div",{className:"p-4 bg-gray-50 border-t-2 border-black flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Pros:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s[4].pros.map(i=>e.jsx(A,{variant:"success",size:"sm",children:i},i))})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Cons:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s[4].cons.map(i=>e.jsx(A,{variant:"warning",size:"sm",children:i},i))})]})]})]}),t&&e.jsx("div",{className:"p-4 bg-emerald-50 border-2 border-emerald-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-bold text-emerald-700 uppercase",children:"Selected:"}),e.jsxs("span",{className:"ml-2 text-lg font-black text-emerald-900",children:["Style ",t,": ",s[t-1].name]})]}),e.jsx(V,{variant:"primary",size:"sm",children:"Apply to Insights"})]})})]})})}function He({label:t,value:a,subtitle:s,accent:i}){return e.jsxs(k,{variant:"outlined",padding:"md",accent:i,children:[e.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:t}),e.jsx("p",{className:"text-2xl font-bold text-slate-800 mt-1",children:a}),s&&e.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:s})]})}function gm({totalMechanisms:t,testableCount:a,testedPct:s,avgPersonalWeight:i,latentNodeCount:r,fittedEdgeCount:n,className:o}){return e.jsxs("div",{className:x("grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",o),children:[e.jsx(He,{label:"Mechanisms",value:t,subtitle:"known biological edges",accent:"cyan"}),e.jsx(He,{label:"Testable",value:a,subtitle:`${s}% coverage`,accent:"cyan"}),e.jsx(He,{label:"Fitted",value:n,subtitle:"edges with results"}),e.jsx(He,{label:"Avg Evidence",value:`${i}%`,subtitle:"personal weight",accent:"lavender"}),e.jsx(He,{label:"Latent Nodes",value:r,subtitle:"unobserved confounders",accent:"pink"}),e.jsx(He,{label:"Untestable",value:t-a,subtitle:"need new data"})]})}const xm={transformative:{stroke:"#059669",bg:"#ecfdf5",text:"text-emerald-700"},high:{stroke:"#2563eb",bg:"#eff6ff",text:"text-blue-700"},moderate:{stroke:"#d97706",bg:"#fffbeb",text:"text-amber-700"},low:{stroke:"#9ca3af",bg:"#f9fafb",text:"text-gray-500"}};function bm({score:t,size:a=80,tier:s,className:i}){const r=xm[s],n=(a-8)/2,o=2*Math.PI*n,c=Math.max(0,Math.min(100,t)),l=o-c/100*o;return e.jsxs("div",{className:x("relative inline-flex items-center justify-center",i),style:{width:a,height:a},children:[e.jsxs("svg",{width:a,height:a,className:"-rotate-90",children:[e.jsx("circle",{cx:a/2,cy:a/2,r:n,fill:"none",stroke:"#e5e7eb",strokeWidth:4}),e.jsx("circle",{cx:a/2,cy:a/2,r:n,fill:"none",stroke:r.stroke,strokeWidth:4,strokeLinecap:"round",strokeDasharray:o,strokeDashoffset:l,style:{transition:"stroke-dashoffset 0.6s ease-out"}})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("span",{className:x("text-lg font-bold",r.text),children:t})})]})}const hs={metabolic:{bg:"bg-amber-50",text:"text-amber-700",dot:"bg-amber-400"},cardio:{bg:"bg-rose-50",text:"text-rose-700",dot:"bg-rose-400"},recovery:{bg:"bg-blue-50",text:"text-blue-700",dot:"bg-blue-400"},sleep:{bg:"bg-indigo-50",text:"text-indigo-700",dot:"bg-indigo-400"}};function fm({mechanisms:t,className:a}){return t.length===0?null:e.jsxs("div",{className:x("space-y-1",a),children:[e.jsxs("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide mb-1.5",children:["New edges unlocked (",t.length,")"]}),t.map(s=>{const i=hs[s.category]??hs.metabolic;return e.jsxs("div",{className:x("flex items-center gap-2 px-2 py-1 rounded text-xs",i.bg),children:[e.jsx("span",{className:x("w-1.5 h-1.5 rounded-full flex-shrink-0",i.dot)}),e.jsx("span",{className:x("font-medium",i.text),children:s.name})]},s.id)})]})}const ym={sweat_iron_loss:"Sweat Iron Loss",gi_iron_loss:"GI Iron Loss",lipoprotein_lipase:"Lipoprotein Lipase",reverse_cholesterol_transport:"Reverse Cholesterol Transport",core_temperature:"Core Temperature",energy_expenditure:"Energy Expenditure",leptin:"Leptin",insulin_sensitivity:"Insulin Sensitivity"};function vm({nodeName:t,className:a}){const s=ym[t]??t.replace(/_/g," ");return e.jsxs("span",{className:x("inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium rounded-full","bg-violet-50 text-violet-700 border border-violet-200",a),children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-violet-400"}),s]})}const wm={Activity:z,Apple:Br,Heart:ke,Thermometer:Or,Brain:Cs,TestTube:ws,HeartPulse:ys,Dna:Vr,Wind:Hr},jm={transformative:"bg-emerald-50 text-emerald-700 border-emerald-200",high:"bg-blue-50 text-blue-700 border-blue-200",moderate:"bg-amber-50 text-amber-700 border-amber-200",low:"bg-gray-50 text-gray-500 border-gray-200"},Nm={transformative:"Transformative",high:"High Value",moderate:"Moderate",low:"Low Impact"};function _m({candidate:t,score:a,className:s}){const i=wm[t.icon]??z;return e.jsxs(k,{variant:"outlined",padding:"md",className:x("flex flex-col gap-4",s),children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-slate-100 flex items-center justify-center flex-shrink-0",children:e.jsx(i,{className:"w-5 h-5 text-slate-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("p",{className:"font-semibold text-slate-800 text-sm",children:t.name}),e.jsx("span",{className:x("px-2 py-0.5 text-[10px] font-medium rounded-full border",jm[a.tier]),children:Nm[a.tier]})]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:[t.category," · ",t.frequency]})]}),e.jsx(bm,{score:a.composite,tier:a.tier,size:64})]}),e.jsx("p",{className:"text-xs text-slate-600 leading-relaxed",children:t.description}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg py-2 px-1",children:[e.jsx("p",{className:"text-lg font-bold text-slate-800",children:a.newEdgesUnlocked}),e.jsx("p",{className:"text-[10px] text-slate-500",children:"New Edges"}),e.jsxs("p",{className:"text-[10px] text-slate-400",children:[a.newEdgePoints," pts"]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg py-2 px-1",children:[e.jsx("p",{className:"text-lg font-bold text-slate-800",children:a.confoundersResolved}),e.jsx("p",{className:"text-[10px] text-slate-500",children:"Confounders"}),e.jsxs("p",{className:"text-[10px] text-slate-400",children:[a.confounderPoints," pts"]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg py-2 px-1",children:[e.jsx("p",{className:"text-lg font-bold text-slate-800",children:a.signalBoostEdges}),e.jsx("p",{className:"text-[10px] text-slate-500",children:"Signal Boost"}),e.jsxs("p",{className:"text-[10px] text-slate-400",children:[a.signalBoostPoints," pts"]})]})]}),t.keyEdgeNarratives.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide mb-2",children:"Key edges affected"}),e.jsx("div",{className:"space-y-2.5",children:t.keyEdgeNarratives.map(r=>e.jsxs("div",{className:"relative pl-3 border-l-2 border-indigo-200",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e.jsx("span",{className:x("text-[10px] font-semibold uppercase px-1.5 py-0.5 rounded",r.type==="boost"&&"bg-blue-50 text-blue-600",r.type==="unlock"&&"bg-emerald-50 text-emerald-600",r.type==="confounder"&&"bg-violet-50 text-violet-600"),children:r.type==="boost"?"signal boost":r.type==="unlock"?"new edge":"confounder"}),e.jsx("span",{className:"text-xs font-semibold text-slate-700",children:r.edgeTitle})]}),e.jsx("p",{className:"text-[11px] text-slate-500 leading-relaxed",children:r.narrative})]},r.edgeTitle))})]}),a.resolvedLatentNodes.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5",children:a.resolvedLatentNodes.map(r=>e.jsx(vm,{nodeName:r},r))}),e.jsx(fm,{mechanisms:a.unlockedMechanisms}),a.boostedEdgeTitles.length>0&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide mb-1.5",children:["Signal boosted (",a.boostedEdgeTitles.length,")"]}),e.jsxs("div",{className:"space-y-0.5",children:[a.boostedEdgeTitles.slice(0,3).map(r=>e.jsx("p",{className:"text-xs text-slate-600 pl-2 border-l-2 border-slate-200",children:r},r)),a.boostedEdgeTitles.length>3&&e.jsxs("p",{className:"text-xs text-slate-400 pl-2",children:["+",a.boostedEdgeTitles.length-3," more"]})]})]}),e.jsxs("div",{className:"pt-2 border-t border-slate-100",children:[e.jsx("p",{className:"text-[10px] text-slate-400 mb-1",children:"Example products"}),e.jsx("p",{className:"text-xs text-slate-500",children:t.exampleProducts.join(", ")})]})]})}function km({rankedCandidates:t}){return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Ranked Data Opportunities"}),e.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Each candidate scored 0-100 based on new edges unlocked, confounders resolved, and signal boost potential."})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:t.map(({candidate:a,score:s})=>e.jsx(_m,{candidate:a,score:s},a.id))})]})}const Cm={metabolic:{bg:"bg-amber-100",text:"text-amber-800"},cardio:{bg:"bg-rose-100",text:"text-rose-800"},recovery:{bg:"bg-blue-100",text:"text-blue-800"},sleep:{bg:"bg-indigo-100",text:"text-indigo-800"}};function Sm({testableEdges:t,untestableEdges:a}){const s=[...t.map(r=>({...r,testable:!0})),...a.map(r=>({...r,testable:!1}))],i={};for(const r of s){const n=r.mechanism.category;i[n]||(i[n]=[]),i[n].push(r)}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Mechanism Coverage Matrix"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:["All ",s.length," mechanisms color-coded by testability. Green = testable with current data. Gray = needs new data source."]})]}),e.jsxs("div",{className:"flex gap-4 text-xs text-slate-600",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-emerald-200 border border-emerald-300"}),"Testable (",t.length,")"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-slate-200 border border-slate-300"}),"Untestable (",a.length,")"]})]}),["metabolic","cardio","recovery","sleep"].map(r=>{const n=i[r]??[];if(n.length===0)return null;const o=Cm[r],c=n.filter(l=>l.testable).length;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:x("px-2 py-0.5 text-xs font-medium rounded",o.bg,o.text),children:r.charAt(0).toUpperCase()+r.slice(1)}),e.jsxs("span",{className:"text-xs text-slate-400",children:[c,"/",n.length," testable"]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-1.5",children:n.map(l=>e.jsx("div",{className:x("px-3 py-2 rounded text-xs border",l.testable?"bg-emerald-50 border-emerald-200 text-emerald-800":"bg-slate-50 border-slate-200 text-slate-500"),children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-medium truncate",children:l.mechanism.name}),!l.testable&&e.jsx("span",{className:"text-[10px] text-slate-400 flex-shrink-0",children:l.hasDoseData?"no response":"no dose"})]})},l.mechanism.id))})]},r)})]})}function Tm(){const{rankedCandidates:t,testableEdges:a,untestableEdges:s,totalMechanisms:i,testableCount:r,testedPct:n,avgPersonalWeight:o,latentNodeCount:c,fittedEdgeCount:l}=Fn(),[d,u]=g.useState("opportunities");return e.jsxs(Z,{title:"Data Value",subtitle:"Marginal benefit analysis for new data sources",children:[e.jsx(gm,{totalMechanisms:i,testableCount:r,testedPct:n,avgPersonalWeight:o,latentNodeCount:c,fittedEdgeCount:l,className:"mb-6"}),e.jsxs(li,{value:d,onValueChange:u,variant:"underline",children:[e.jsxs(ci,{children:[e.jsx(ia,{value:"opportunities",children:"Data Opportunities"}),e.jsx(ia,{value:"coverage",children:"Edge Coverage Map"})]}),e.jsx(ra,{value:"opportunities",children:e.jsx(M.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsx(km,{rankedCandidates:t})})}),e.jsx(ra,{value:"coverage",children:e.jsx(M.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsx(Sm,{testableEdges:a,untestableEdges:s})})})]})]})}function Mm(){return e.jsx(sr,{basename:"/serif-demo",children:e.jsx(ir,{children:e.jsxs(K,{element:e.jsx(vi,{}),children:[e.jsx(K,{path:"/",element:e.jsx(Ho,{})}),e.jsx(K,{path:"/clients",element:e.jsx(j0,{})}),e.jsx(K,{path:"/clients/:clientId/users/:userId",element:e.jsx(B0,{})}),e.jsx(K,{path:"/data",element:e.jsx(am,{})}),e.jsx(K,{path:"/integration",element:e.jsx(Bo,{})}),e.jsx(K,{path:"/insights",element:e.jsx(Zc,{})}),e.jsx(K,{path:"/protocols",element:e.jsx(Rd,{})}),e.jsx(K,{path:"/coach",element:e.jsx(Ed,{})}),e.jsx(K,{path:"/api",element:e.jsx(Wd,{})}),e.jsx(K,{path:"/admin",element:e.jsx(Hd,{})}),e.jsx(K,{path:"/style-demo",element:e.jsx(lm,{})}),e.jsx(K,{path:"/curve-demo",element:e.jsx(pm,{})}),e.jsx(K,{path:"/data-value",element:e.jsx(Tm,{})})]})})})}Gr.createRoot(document.getElementById("root")).render(e.jsx(g.StrictMode,{children:e.jsx(Mm,{})}));
